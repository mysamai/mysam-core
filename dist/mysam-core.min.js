!function(t,e){"object"==typeof exports&&"object"==typeof module?module.exports=e():"function"==typeof define&&define.amd?define([],e):"object"==typeof exports?exports.core=e():(t.mysam=t.mysam||{},t.mysam.core=e())}(this,function(){return function(t){var e={};function n(r){if(e[r])return e[r].exports;var i=e[r]={i:r,l:!1,exports:{}};return t[r].call(i.exports,i,i.exports,n),i.l=!0,i.exports}return n.m=t,n.c=e,n.d=function(t,e,r){n.o(t,e)||Object.defineProperty(t,e,{enumerable:!0,get:r})},n.r=function(t){"undefined"!=typeof Symbol&&Symbol.toStringTag&&Object.defineProperty(t,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(t,"__esModule",{value:!0})},n.t=function(t,e){if(1&e&&(t=n(t)),8&e)return t;if(4&e&&"object"==typeof t&&t&&t.__esModule)return t;var r=Object.create(null);if(n.r(r),Object.defineProperty(r,"default",{enumerable:!0,value:t}),2&e&&"string"!=typeof t)for(var i in t)n.d(r,i,function(e){return t[e]}.bind(null,i));return r},n.n=function(t){var e=t&&t.__esModule?function(){return t.default}:function(){return t};return n.d(e,"a",e),e},n.o=function(t,e){return Object.prototype.hasOwnProperty.call(t,e)},n.p="",n(n.s=274)}([function(t,e,n){var r=n(2),i=n(20),o=n(12),a=n(13),s=n(21),u="prototype",c=function t(e,n,c){var l,f,h,p,d=e&t.F,y=e&t.G,v=e&t.P,g=e&t.B,m=y?r:e&t.S?r[n]||(r[n]={}):(r[n]||{})[u],b=y?i:i[n]||(i[n]={}),x=b[u]||(b[u]={});for(l in y&&(c=n),c)h=((f=!d&&m&&void 0!==m[l])?m:c)[l],p=g&&f?s(h,r):v&&"function"==typeof h?s(Function.call,h):h,m&&a(m,l,h,e&t.U),b[l]!=h&&o(b,l,p),v&&x[l]!=h&&(x[l]=h)};r.core=i,c.F=1,c.G=2,c.S=4,c.P=8,c.B=16,c.W=32,c.U=64,c.R=128,t.exports=c},function(t,e,n){var r=n(4);t.exports=function(t){if(!r(t))throw TypeError(t+" is not an object!");return t}},function(t,e){var n=t.exports="undefined"!=typeof window&&window.Math==Math?window:"undefined"!=typeof self&&self.Math==Math?self:Function("return this")();"number"==typeof __g&&(__g=n)},function(t,e){t.exports=function(t){try{return!!t()}catch(t){return!0}}},function(t,e){function n(t){return(n="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t})(t)}t.exports=function(t){return"object"===n(t)?null!==t:"function"==typeof t}},function(t,e,n){var r=n(76)("wks"),i=n(41),o=n(2).Symbol,a="function"==typeof o;(t.exports=function(t){return r[t]||(r[t]=a&&o[t]||(a?o:i)("Symbol."+t))}).store=r},function(t,e,n){var r=n(23),i=Math.min;t.exports=function(t){return 0<t?i(r(t),9007199254740991):0}},function(t,e,n){t.exports=!n(3)(function(){return 7!=Object.defineProperty({},"a",{get:function(){return 7}}).a})},function(t,e,n){var r=n(1),i=n(167),o=n(27),a=Object.defineProperty;e.f=n(7)?Object.defineProperty:function(t,e,n){if(r(t),e=o(e,!0),r(n),i)try{return a(t,e,n)}catch(t){}if("get"in n||"set"in n)throw TypeError("Accessors not supported!");return"value"in n&&(t[e]=n.value),t}},function(t,e,n){var r=n(28);t.exports=function(t){return Object(r(t))}},function(t,e,n){"use strict";function r(t){return(r="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t})(t)}var i="function"==typeof Symbol&&"symbol"===r(Symbol.iterator)?function(t){return r(t)}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":r(t)},o=function(){function t(t,e){for(var n=0;n<e.length;n++){var r=e[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(t,r.key,r)}}return function(e,n,r){return n&&t(e.prototype,n),r&&t(e,r),e}}(),a=n(246),s=n(101),u=n(73),c=/function ([^(]*)/,l=/((\/\/.*$)|(\/\*[\s\S]*?\*\/))/gm,f=/([^\s,]+)/g,h=function(){var t=new ArrayBuffer(4),e=new Uint32Array(t),n=new Uint8Array(t);if(e[0]=3735928559,239===n[0])return"LE";if(222===n[0])return"BE";throw new Error("unknown endianness")}(),p=null,d=null,y=function(){try{return new Function("let i = 1; const j = 1;")(),!0}catch(t){return!1}}(),v=null,g=function(t){function e(){return function(t,n){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this),function(t,e){if(!t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!e||"object"!==r(e)&&"function"!=typeof e?t:e}(this,(e.__proto__||Object.getPrototypeOf(e)).apply(this,arguments))}return function(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function, not "+r(e));t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,enumerable:!1,writable:!0,configurable:!0}}),e&&(Object.setPrototypeOf?Object.setPrototypeOf(t,e):t.__proto__=e)}(e,a),o(e,null,[{key:"systemEndianness",value:function(){return h}},{key:"isFunction",value:function(t){return"function"==typeof t}},{key:"isFunctionString",value:function(t){return null!==t&&"function"===t.toString().slice(0,"function".length).toLowerCase()}},{key:"getFunctionNameFromString",value:function(t){return c.exec(t)[1]}},{key:"getFunctionBodyFromString",value:function(t){return t.substring(t.indexOf("{")+1,t.lastIndexOf("}"))}},{key:"getParamNamesFromString",value:function(t){var e=t.toString().replace(l,""),n=e.slice(e.indexOf("(")+1,e.indexOf(")")).match(f);return null===n&&(n=[]),n}},{key:"clone",value:function(t){if(null===t||"object"!==(void 0===t?"undefined":i(t))||t.hasOwnProperty("isActiveClone"))return t;var n=t.constructor();for(var r in t)Object.prototype.hasOwnProperty.call(t,r)&&(t.isActiveClone=null,n[r]=e.clone(t[r]),delete t.isActiveClone);return n}},{key:"newPromise",value:function(t){var e=Promise||small_promise;if(null===e)throw TypeError("Browser is missing Promise implementation. Consider adding small_promise.js polyfill");return new e(t)}},{key:"functionBinder",value:function(t,e){return t.bind?t.bind(e):function(){var n=1===arguments.length?[arguments[0]]:Array.apply(null,arguments);return t.apply(e,n)}}},{key:"isArray",value:function(t){return!isNaN(t.length)}},{key:"getArgumentType",value:function(t){return e.isArray(t)?"IMG"===t[0].nodeName?"HTMLImageArray":"Array":"number"==typeof t?Number.isInteger(t)?"Integer":"Float":t instanceof u?t.type:t instanceof s?"Input":"IMG"===t.nodeName?"HTMLImage":"Unknown"}},{key:"isFloatReadPixelsSupported",value:function(){if(null!==p)return p;var t=new(n(100))({mode:"webgl-validator"}),e=t.createKernel(function(){return 1},{output:[2],floatTextures:!0,floatOutput:!0,floatOutputForce:!0})();return p=1===e[0],t.destroy(),p}},{key:"isFloatReadPixelsSupportedWebGL2",value:function(){if(null!==d)return d;var t=new(n(100))({mode:"webgl2-validator"}),e=t.createKernel(function(){return 1},{output:[2],floatTextures:!0,floatOutput:!0,floatOutputForce:!0})();return d=1===e[0],t.destroy(),d}},{key:"hasIntegerDivisionAccuracyBug",value:function(){if(null!==v)return v;var t=new(n(100))({mode:"webgl-validator"}),e=t.createKernel(function(t,e){return t[this.thread.x]/e[this.thread.x]},{output:[1]})([6,6030401],[3,3991]);return v=2!==e[0]||1511!==e[1],t.destroy(),v}},{key:"isMixedIdentifiersSupported",value:function(){return y}},{key:"dimToTexSize",value:function(t,e,n){for(var r=e[0],i=e[0],o=e[1],a=1;a<e.length;a++)r*=e[a];if(!t.floatTextures||n&&!t.floatOutput||(i=r=Math.ceil(r/4)),1<o&&i*o===r)return[i,o];for(var s=Math.sqrt(r),u=Math.ceil(s),c=Math.floor(s);r<u*c;)u--,c=Math.ceil(r/u);return[i=c,o=Math.ceil(r/i)]}},{key:"getDimensions",value:function(t,n){var r=void 0;if(e.isArray(t)){for(var i=[],o=t;e.isArray(o);)i.push(o.length),o=o[0];r=i.reverse()}else if(t instanceof u)r=t.output;else{if(!(t instanceof s))throw"Unknown dimensions of "+t;r=t.size}if(n)for(r=e.clone(r);r.length<3;)r.push(1);return new Int32Array(r)}},{key:"pad",value:function(t,e){function n(t){return Array.apply(null,new Array(t)).map(Number.prototype.valueOf,0)}for(var r=t.length+2*e,i=t.map(function(t){return[].concat(n(e),t,n(e))}),o=0;o<e;o++)i=[].concat([n(r)],i,[n(r)]);return i}},{key:"flatten2dArrayTo",value:function(t,e){for(var n=0,r=0;r<t.length;r++)e.set(t[r],n),n+=t[r].length}},{key:"flatten3dArrayTo",value:function(t,e){for(var n=0,r=0;r<t.length;r++)for(var i=0;i<t[r].length;i++)e.set(t[r][i],n),n+=t[r][i].length}},{key:"flattenTo",value:function(t,n){e.isArray(t[0])?e.isArray(t[0][0])?e.flatten3dArrayTo(t,n):e.flatten2dArrayTo(t,n):n.set(t)}},{key:"splitArray",value:function(t,e){for(var n=[],r=0;r<t.length;r+=e)n.push(new t.constructor(t.buffer,4*r+t.byteOffset,e));return n}},{key:"getAstString",value:function(t,e){var n=Array.isArray(t)?t:t.split(/\r?\n/g),r=e.loc.start,i=e.loc.end,o=[];o.push(n[r.line-1].slice(r.column));for(var a=r.line;a<i.line-1;a++)o.push(n[a]);return o.push(n[i.line-1].slice(0,i.column)),o.join("\n")}},{key:"allPropertiesOf",value:function(t){for(var e=[];e.push.apply(e,Object.getOwnPropertyNames(t)),t=Object.getPrototypeOf(t););return e}}]),e}();Object.assign(g,a),t.exports=g},function(t,e){t.exports=function(t){if("function"!=typeof t)throw TypeError(t+" is not a function!");return t}},function(t,e,n){var r=n(8),i=n(40);t.exports=n(7)?function(t,e,n){return r.f(t,e,i(1,n))}:function(t,e,n){return t[e]=n,t}},function(t,e,n){var r=n(2),i=n(12),o=n(16),a=n(41)("src"),s="toString",u=Function[s],c=(""+u).split(s);n(20).inspectSource=function(t){return u.call(t)},(t.exports=function(t,e,n,s){var u="function"==typeof n;u&&(o(n,"name")||i(n,"name",e)),t[e]!==n&&(u&&(o(n,a)||i(n,a,t[e]?""+t[e]:c.join(String(e)))),t===r?t[e]=n:s?t[e]?t[e]=n:i(t,e,n):(delete t[e],i(t,e,n)))})(Function.prototype,s,function(){return"function"==typeof this&&this[a]||u.call(this)})},function(t,e,n){var r=n(0),i=n(3),o=n(28),a=/"/g,s=function(t,e,n,r){var i=String(o(t)),s="<"+e;return""!==n&&(s+=" "+n+'="'+String(r).replace(a,"&quot;")+'"'),s+">"+i+"</"+e+">"};t.exports=function(t,e){var n={};n[t]=e(s),r(r.P+r.F*i(function(){var e=""[t]('"');return e!==e.toLowerCase()||3<e.split('"').length}),"String",n)}},function(t,e){function n(t){return(n="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t})(t)}var r;r=function(){return this}();try{r=r||new Function("return this")()}catch(t){"object"===("undefined"==typeof window?"undefined":n(window))&&(r=window)}t.exports=r},function(t,e){var n={}.hasOwnProperty;t.exports=function(t,e){return n.call(t,e)}},function(t,e,n){var r=n(63),i=n(28);t.exports=function(t){return r(i(t))}},function(t,e,n){var r=n(64),i=n(40),o=n(17),a=n(27),s=n(16),u=n(167),c=Object.getOwnPropertyDescriptor;e.f=n(7)?c:function(t,e){if(t=o(t),e=a(e,!0),u)try{return c(t,e)}catch(t){}if(s(t,e))return i(!r.f.call(t,e),t[e])}},function(t,e,n){var r=n(16),i=n(9),o=n(109)("IE_PROTO"),a=Object.prototype;t.exports=Object.getPrototypeOf||function(t){return t=i(t),r(t,o)?t[o]:"function"==typeof t.constructor&&t instanceof t.constructor?t.constructor.prototype:t instanceof Object?a:null}},function(t,e){var n=t.exports={version:"2.6.1"};"number"==typeof __e&&(__e=n)},function(t,e,n){var r=n(11);t.exports=function(t,e,n){if(r(t),void 0===e)return t;switch(n){case 1:return function(n){return t.call(e,n)};case 2:return function(n,r){return t.call(e,n,r)};case 3:return function(n,r,i){return t.call(e,n,r,i)}}return function(){return t.apply(e,arguments)}}},function(t,e){var n={}.toString;t.exports=function(t){return n.call(t).slice(8,-1)}},function(t,e){var n=Math.ceil,r=Math.floor;t.exports=function(t){return isNaN(t=+t)?0:(0<t?r:n)(t)}},function(t,e,n){"use strict";var r=n(3);t.exports=function(t,e){return!!t&&r(function(){e?t.call(null,function(){},1):t.call(null)})}},function(t,e,n){function r(t){return(r="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t})(t)}var i=n(212),o="object"==("undefined"==typeof self?"undefined":r(self))&&self&&self.Object===Object&&self,a=i||o||Function("return this")();t.exports=a},function(t,e){var n=Array.isArray;t.exports=n},function(t,e,n){var r=n(4);t.exports=function(t,e){if(!r(t))return t;var n,i;if(e&&"function"==typeof(n=t.toString)&&!r(i=n.call(t)))return i;if("function"==typeof(n=t.valueOf)&&!r(i=n.call(t)))return i;if(!e&&"function"==typeof(n=t.toString)&&!r(i=n.call(t)))return i;throw TypeError("Can't convert object to primitive value")}},function(t,e){t.exports=function(t){if(null==t)throw TypeError("Can't call method on  "+t);return t}},function(t,e,n){var r=n(0),i=n(20),o=n(3);t.exports=function(t,e){var n=(i.Object||{})[t]||Object[t],a={};a[t]=e(n),r(r.S+r.F*o(function(){n(1)}),"Object",a)}},function(t,e,n){var r=n(21),i=n(63),o=n(9),a=n(6),s=n(125);t.exports=function(t,e){var n=1==t,u=2==t,c=3==t,l=4==t,f=6==t,h=5==t||f,p=e||s;return function(e,s,d){for(var y,v,g=o(e),m=i(g),b=r(s,d,3),x=a(m.length),_=0,w=n?p(e,x):u?p(e,0):void 0;_<x;_++)if((h||_ in m)&&(v=b(y=m[_],_,g),t))if(n)w[_]=v;else if(v)switch(t){case 3:return!0;case 5:return y;case 6:return _;case 2:w.push(y)}else if(l)return!1;return f?-1:c||l?l:w}}},function(t,e,n){"use strict";Object.defineProperty(e,"__esModule",{value:!0});var r,i=function(){function t(t,e){for(var n=0;n<e.length;n++){var r=e[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(t,r.key,r)}}return function(e,n,r){return n&&t(e.prototype,n),r&&t(e,r),e}}(),o=(r=n(72))&&r.__esModule?r:{default:r},a=function(){function t(e,n){!function(e,n){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this),void 0!==e&&void 0!==n&&(this.rows=e,this.columns=n,this.weights=(0,o.default)(e*n),this.deltas=(0,o.default)(e*n))}return i(t,[{key:"getWeights",value:function(t,e){var n=this.columns*t+e;if(n<0&&n>=this.weights.length)throw new Error("get accessor is skewed");return this.weights[n]}},{key:"setWeight",value:function(t,e,n){var r=this.columns*t+e;if(r<0&&r>=this.weights.length)throw new Error("set accessor is skewed");this.weights[r]=n}},{key:"setDeltas",value:function(t,e,n){var r=this.columns*t+e;if(r<0&&r>=this.weights.length)throw new Error("set accessor is skewed");this.deltas[r]=n}},{key:"toJSON",value:function(){return{rows:this.rows,columns:this.columns,weights:this.weights.slice(0)}}},{key:"weightsToArray",value:function(){for(var t=[],e=0,n=0,r=0;r<this.weights.length;r++)0===n&&t.push([]),t[e].push(this.weights[r]),++n>=this.columns&&(n=0,e++);return t}},{key:"deltasToArray",value:function(){for(var t=[],e=0,n=0,r=0;r<this.deltas.length;r++)0===n&&t.push([]),t[e].push(this.deltas[r]),++n>=this.columns&&(n=0,e++);return t}}],[{key:"fromJSON",value:function(e){for(var n=new t(e.rows,e.columns),r=0,i=e.rows*e.columns;r<i;r++)n.weights[r]=e.weights[r];return n}},{key:"fromArray",value:function(e,n){var r=e.length,i=e[0].length,o=new t(r,i);n=n||e;for(var a=0;a<r;a++)for(var s=e[a],u=n[a],c=0;c<i;c++)o.setWeight(a,c,s[c]),o.setDeltas(a,c,u[c]);return o}}]),t}();e.default=a},function(t,e,n){"use strict";function r(t){return(r="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t})(t)}if(n(7)){var i=n(36),o=n(2),a=n(3),s=n(0),u=n(87),c=n(133),l=n(21),f=n(47),h=n(40),p=n(12),d=n(49),y=n(23),v=n(6),g=n(195),m=n(43),b=n(27),x=n(16),_=n(56),w=n(4),S=n(9),E=n(122),T=n(44),k=n(19),O=n(45).f,A=n(124),j=n(41),P=n(5),R=n(30),C=n(77),I=n(66),L=n(127),N=n(58),F=n(82),M=n(46),D=n(126),U=n(184),G=n(8),z=n(18),B=G.f,V=z.f,W=o.RangeError,X=o.TypeError,K=o.Uint8Array,q="ArrayBuffer",H="Shared"+q,$="BYTES_PER_ELEMENT",Y="prototype",J=Array[Y],Q=c.ArrayBuffer,Z=c.DataView,tt=R(0),et=R(2),nt=R(3),rt=R(4),it=R(5),ot=R(6),at=C(!0),st=C(!1),ut=L.values,ct=L.keys,lt=L.entries,ft=J.lastIndexOf,ht=J.reduce,pt=J.reduceRight,dt=J.join,yt=J.sort,vt=J.slice,gt=J.toString,mt=J.toLocaleString,bt=P("iterator"),xt=P("toStringTag"),_t=j("typed_constructor"),wt=j("def_constructor"),St=u.CONSTR,Et=u.TYPED,Tt=u.VIEW,kt="Wrong length!",Ot=R(1,function(t,e){return Ct(I(t,t[wt]),e)}),At=a(function(){return 1===new K(new Uint16Array([1]).buffer)[0]}),jt=!!K&&!!K[Y].set&&a(function(){new K(1).set({})}),Pt=function(t,e){var n=y(t);if(n<0||n%e)throw W("Wrong offset!");return n},Rt=function(t){if(w(t)&&Et in t)return t;throw X(t+" is not a typed array!")},Ct=function(t,e){if(!(w(t)&&_t in t))throw X("It is not a typed array constructor!");return new t(e)},It=function(t,e){return Lt(I(t,t[wt]),e)},Lt=function(t,e){for(var n=0,r=e.length,i=Ct(t,r);n<r;)i[n]=e[n++];return i},Nt=function(t,e,n){B(t,e,{get:function(){return this._d[n]}})},Ft=function(t){var e,n,r,i,o,a,s=S(t),u=arguments.length,c=1<u?arguments[1]:void 0,f=void 0!==c,h=A(s);if(null!=h&&!E(h)){for(a=h.call(s),r=[],e=0;!(o=a.next()).done;e++)r.push(o.value);s=r}for(f&&2<u&&(c=l(c,arguments[2],2)),e=0,n=v(s.length),i=Ct(this,n);e<n;e++)i[e]=f?c(s[e],e):s[e];return i},Mt=function(){for(var t=0,e=arguments.length,n=Ct(this,e);t<e;)n[t]=arguments[t++];return n},Dt=!!K&&a(function(){mt.call(new K(1))}),Ut=function(){return mt.apply(Dt?vt.call(Rt(this)):Rt(this),arguments)},Gt={copyWithin:function(t,e){return U.call(Rt(this),t,e,2<arguments.length?arguments[2]:void 0)},every:function(t){return rt(Rt(this),t,1<arguments.length?arguments[1]:void 0)},fill:function(t){return D.apply(Rt(this),arguments)},filter:function(t){return It(this,et(Rt(this),t,1<arguments.length?arguments[1]:void 0))},find:function(t){return it(Rt(this),t,1<arguments.length?arguments[1]:void 0)},findIndex:function(t){return ot(Rt(this),t,1<arguments.length?arguments[1]:void 0)},forEach:function(t){tt(Rt(this),t,1<arguments.length?arguments[1]:void 0)},indexOf:function(t){return st(Rt(this),t,1<arguments.length?arguments[1]:void 0)},includes:function(t){return at(Rt(this),t,1<arguments.length?arguments[1]:void 0)},join:function(t){return dt.apply(Rt(this),arguments)},lastIndexOf:function(t){return ft.apply(Rt(this),arguments)},map:function(t){return Ot(Rt(this),t,1<arguments.length?arguments[1]:void 0)},reduce:function(t){return ht.apply(Rt(this),arguments)},reduceRight:function(t){return pt.apply(Rt(this),arguments)},reverse:function(){for(var t,e=this,n=Rt(e).length,r=Math.floor(n/2),i=0;i<r;)t=e[i],e[i++]=e[--n],e[n]=t;return e},some:function(t){return nt(Rt(this),t,1<arguments.length?arguments[1]:void 0)},sort:function(t){return yt.call(Rt(this),t)},subarray:function(t,e){var n=Rt(this),r=n.length,i=m(t,r);return new(I(n,n[wt]))(n.buffer,n.byteOffset+i*n.BYTES_PER_ELEMENT,v((void 0===e?r:m(e,r))-i))}},zt=function(t,e){return It(this,vt.call(Rt(this),t,e))},Bt=function(t){Rt(this);var e=Pt(arguments[1],1),n=this.length,r=S(t),i=v(r.length),o=0;if(n<i+e)throw W(kt);for(;o<i;)this[e+o]=r[o++]},Vt={entries:function(){return lt.call(Rt(this))},keys:function(){return ct.call(Rt(this))},values:function(){return ut.call(Rt(this))}},Wt=function(t,e){return w(t)&&t[Et]&&"symbol"!=r(e)&&e in t&&String(+e)==String(e)},Xt=function(t,e){return Wt(t,e=b(e,!0))?h(2,t[e]):V(t,e)},Kt=function(t,e,n){return!(Wt(t,e=b(e,!0))&&w(n)&&x(n,"value"))||x(n,"get")||x(n,"set")||n.configurable||x(n,"writable")&&!n.writable||x(n,"enumerable")&&!n.enumerable?B(t,e,n):(t[e]=n.value,t)};St||(z.f=Xt,G.f=Kt),s(s.S+s.F*!St,"Object",{getOwnPropertyDescriptor:Xt,defineProperty:Kt}),a(function(){gt.call({})})&&(gt=mt=function(){return dt.call(this)});var qt=d({},Gt);d(qt,Vt),p(qt,bt,Vt.values),d(qt,{slice:zt,set:Bt,constructor:function(){},toString:gt,toLocaleString:Ut}),Nt(qt,"buffer","b"),Nt(qt,"byteOffset","o"),Nt(qt,"byteLength","l"),Nt(qt,"length","e"),B(qt,xt,{get:function(){return this[Et]}}),t.exports=function(t,e,n,r){var c=t+((r=!!r)?"Clamped":"")+"Array",l="get"+t,h="set"+t,d=o[c],y=d||{},m=d&&k(d),b=!d||!u.ABV,x={},S=d&&d[Y],E=function(t,n){B(t,n,{get:function(){return t=n,(r=this._d).v[l](t*e+r.o,At);var t,r},set:function(t){return i=n,o=t,a=this._d,r&&(o=(o=Math.round(o))<0?0:255<o?255:255&o),void a.v[h](i*e+a.o,o,At);var i,o,a},enumerable:!0})};b?(d=n(function(t,n,r,i){f(t,d,c,"_d");var o,a,s,u,l=0,h=0;if(w(n)){if(!(n instanceof Q||(u=_(n))==q||u==H))return Et in n?Lt(d,n):Ft.call(d,n);o=n,h=Pt(r,e);var y=n.byteLength;if(void 0===i){if(y%e)throw W(kt);if((a=y-h)<0)throw W(kt)}else if(y<(a=v(i)*e)+h)throw W(kt);s=a/e}else s=g(n),o=new Q(a=s*e);for(p(t,"_d",{b:o,o:h,l:a,e:s,v:new Z(o)});l<s;)E(t,l++)}),S=d[Y]=T(qt),p(S,"constructor",d)):a(function(){d(1)})&&a(function(){new d(-1)})&&F(function(t){new d,new d(null),new d(1.5),new d(t)},!0)||(d=n(function(t,n,r,i){var o;return f(t,d,c),w(n)?n instanceof Q||(o=_(n))==q||o==H?void 0!==i?new y(n,Pt(r,e),i):void 0!==r?new y(n,Pt(r,e)):new y(n):Et in n?Lt(d,n):Ft.call(d,n):new y(g(n))}),tt(m!==Function.prototype?O(y).concat(O(m)):O(y),function(t){t in d||p(d,t,y[t])}),d[Y]=S,i||(S.constructor=d));var A=S[bt],j=!!A&&("values"==A.name||null==A.name),P=Vt.values;p(d,_t,!0),p(S,Et,c),p(S,Tt,!0),p(S,wt,d),(r?new d(1)[xt]==c:xt in S)||B(S,xt,{get:function(){return c}}),x[c]=d,s(s.G+s.W+s.F*(d!=y),x),s(s.S,c,{BYTES_PER_ELEMENT:e}),s(s.S+s.F*a(function(){y.of.call(d,1)}),c,{from:Ft,of:Mt}),$ in S||p(S,$,e),s(s.P,c,Gt),M(c),s(s.P+s.F*jt,c,{set:Bt}),s(s.P+s.F*!j,c,Vt),i||S.toString==gt||(S.toString=gt),s(s.P+s.F*a(function(){new d(1).slice()}),c,{slice:zt}),s(s.P+s.F*(a(function(){return[1,2].toLocaleString()!=new d([1,2]).toLocaleString()})||!a(function(){S.toLocaleString.call([1,2])})),c,{toLocaleString:Ut}),N[c]=j?A:P,i||j||p(S,bt,P)}}else t.exports=function(){}},function(t,e,n){function r(t){return(r="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t})(t)}var i=n(190),o=n(0),a=n(76)("metadata"),s=a.store||(a.store=new(n(193))),u=function(t,e,n){var r=s.get(t);if(!r){if(!n)return;s.set(t,r=new i)}var o=r.get(e);if(!o){if(!n)return;r.set(e,o=new i)}return o};t.exports={store:s,map:u,has:function(t,e,n){var r=u(e,n,!1);return void 0!==r&&r.has(t)},get:function(t,e,n){var r=u(e,n,!1);return void 0===r?void 0:r.get(t)},set:function(t,e,n,r){u(n,r,!0).set(t,e)},keys:function(t,e){var n=u(t,e,!1),r=[];return n&&n.forEach(function(t,e){r.push(e)}),r},key:function(t){return void 0===t||"symbol"==r(t)?t:String(t)},exp:function(t){o(o.S,"Reflect",t)}}},function(t,e,n){(function(r){function i(t){return(i="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t})(t)}e.log=function(){var t;return"object"===("undefined"==typeof console?"undefined":i(console))&&console.log&&(t=console).log.apply(t,arguments)},e.formatArgs=function(e){if(e[0]=(this.useColors?"%c":"")+this.namespace+(this.useColors?" %c":" ")+e[0]+(this.useColors?"%c ":" ")+"+"+t.exports.humanize(this.diff),this.useColors){var n="color: "+this.color;e.splice(1,0,n,"color: inherit");var r=0,i=0;e[0].replace(/%[a-zA-Z%]/g,function(t){"%%"!==t&&(r++,"%c"===t&&(i=r))}),e.splice(i,0,n)}},e.save=function(t){try{t?e.storage.setItem("debug",t):e.storage.removeItem("debug")}catch(t){}},e.load=function(){var t;try{t=e.storage.getItem("debug")}catch(t){}return!t&&void 0!==r&&"env"in r&&(t=r.env.DEBUG),t},e.useColors=function(){return!("undefined"==typeof window||!window.process||"renderer"!==window.process.type&&!window.process.__nwjs)||("undefined"==typeof navigator||!navigator.userAgent||!navigator.userAgent.toLowerCase().match(/(edge|trident)\/(\d+)/))&&("undefined"!=typeof document&&document.documentElement&&document.documentElement.style&&document.documentElement.style.WebkitAppearance||"undefined"!=typeof window&&window.console&&(window.console.firebug||window.console.exception&&window.console.table)||"undefined"!=typeof navigator&&navigator.userAgent&&navigator.userAgent.toLowerCase().match(/firefox\/(\d+)/)&&31<=parseInt(RegExp.$1,10)||"undefined"!=typeof navigator&&navigator.userAgent&&navigator.userAgent.toLowerCase().match(/applewebkit\/(\d+)/))},e.storage=function(){try{return localStorage}catch(t){}}(),e.colors=["#0000CC","#0000FF","#0033CC","#0033FF","#0066CC","#0066FF","#0099CC","#0099FF","#00CC00","#00CC33","#00CC66","#00CC99","#00CCCC","#00CCFF","#3300CC","#3300FF","#3333CC","#3333FF","#3366CC","#3366FF","#3399CC","#3399FF","#33CC00","#33CC33","#33CC66","#33CC99","#33CCCC","#33CCFF","#6600CC","#6600FF","#6633CC","#6633FF","#66CC00","#66CC33","#9900CC","#9900FF","#9933CC","#9933FF","#99CC00","#99CC33","#CC0000","#CC0033","#CC0066","#CC0099","#CC00CC","#CC00FF","#CC3300","#CC3333","#CC3366","#CC3399","#CC33CC","#CC33FF","#CC6600","#CC6633","#CC9900","#CC9933","#CCCC00","#CCCC33","#FF0000","#FF0033","#FF0066","#FF0099","#FF00CC","#FF00FF","#FF3300","#FF3333","#FF3366","#FF3399","#FF33CC","#FF33FF","#FF6600","#FF6633","#FF9900","#FF9933","#FFCC00","#FFCC33"],t.exports=n(477)(e),t.exports.formatters.j=function(t){try{return JSON.stringify(t)}catch(t){return"[UnexpectedJSONParseError]: "+t.message}}}).call(this,n(50))},function(t,e,n){function r(t){return(r="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t})(t)}var i=n(41)("meta"),o=n(4),a=n(16),s=n(8).f,u=0,c=Object.isExtensible||function(){return!0},l=!n(3)(function(){return c(Object.preventExtensions({}))}),f=function(t){s(t,i,{value:{i:"O"+ ++u,w:{}}})},h=t.exports={KEY:i,NEED:!1,fastKey:function(t,e){if(!o(t))return"symbol"==r(t)?t:("string"==typeof t?"S":"P")+t;if(!a(t,i)){if(!c(t))return"F";if(!e)return"E";f(t)}return t[i].i},getWeak:function(t,e){if(!a(t,i)){if(!c(t))return!0;if(!e)return!1;f(t)}return t[i].w},onFreeze:function(t){return l&&h.NEED&&c(t)&&!a(t,i)&&f(t),t}}},function(t,e){t.exports=!1},function(t,e,n){var r=n(5)("unscopables"),i=Array.prototype;null==i[r]&&n(12)(i,r,{}),t.exports=function(t){i[r][t]=!0}},function(t,e){function n(t){return(n="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t})(t)}t.exports=function(t){var e=n(t);return null!=t&&("object"==e||"function"==e)}},function(t,e){function n(t){return(n="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t})(t)}t.exports=function(t){return null!=t&&"object"==n(t)}},function(t,e){t.exports=function(t,e){return{enumerable:!(1&t),configurable:!(2&t),writable:!(4&t),value:e}}},function(t,e){var n=0,r=Math.random();t.exports=function(t){return"Symbol(".concat(void 0===t?"":t,")_",(++n+r).toString(36))}},function(t,e,n){var r=n(169),i=n(110);t.exports=Object.keys||function(t){return r(t,i)}},function(t,e,n){var r=n(23),i=Math.max,o=Math.min;t.exports=function(t,e){return(t=r(t))<0?i(t+e,0):o(t,e)}},function(t,e,n){var r=n(1),i=n(170),o=n(110),a=n(109)("IE_PROTO"),s=function(){},u="prototype",c=function(){var t,e=n(107)("iframe"),r=o.length;for(e.style.display="none",n(111).appendChild(e),e.src="javascript:",(t=e.contentWindow.document).open(),t.write("<script>document.F=Object<\/script>"),t.close(),c=t.F;r--;)delete c[u][o[r]];return c()};t.exports=Object.create||function(t,e){var n;return null!==t?(s[u]=r(t),n=new s,s[u]=null,n[a]=t):n=c(),void 0===e?n:i(n,e)}},function(t,e,n){var r=n(169),i=n(110).concat("length","prototype");e.f=Object.getOwnPropertyNames||function(t){return r(t,i)}},function(t,e,n){"use strict";var r=n(2),i=n(8),o=n(7),a=n(5)("species");t.exports=function(t){var e=r[t];o&&e&&!e[a]&&i.f(e,a,{configurable:!0,get:function(){return this}})}},function(t,e){t.exports=function(t,e,n,r){if(!(t instanceof e)||void 0!==r&&r in t)throw TypeError(n+": incorrect invocation!");return t}},function(t,e,n){var r=n(21),i=n(182),o=n(122),a=n(1),s=n(6),u=n(124),c={},l={};(e=t.exports=function(t,e,n,f,h){var p,d,y,v,g=h?function(){return t}:u(t),m=r(n,f,e?2:1),b=0;if("function"!=typeof g)throw TypeError(t+" is not iterable!");if(o(g)){for(p=s(t.length);b<p;b++)if((v=e?m(a(d=t[b])[0],d[1]):m(t[b]))===c||v===l)return v}else for(y=g.call(t);!(d=y.next()).done;)if((v=i(y,m,d.value,e))===c||v===l)return v}).BREAK=c,e.RETURN=l},function(t,e,n){var r=n(13);t.exports=function(t,e,n){for(var i in e)r(t,i,e[i],n);return t}},function(t,e){var n,r,i=t.exports={};function o(){throw new Error("setTimeout has not been defined")}function a(){throw new Error("clearTimeout has not been defined")}function s(t){if(n===setTimeout)return setTimeout(t,0);if((n===o||!n)&&setTimeout)return n=setTimeout,setTimeout(t,0);try{return n(t,0)}catch(e){try{return n.call(null,t,0)}catch(e){return n.call(this,t,0)}}}!function(){try{n="function"==typeof setTimeout?setTimeout:o}catch(t){n=o}try{r="function"==typeof clearTimeout?clearTimeout:a}catch(t){r=a}}();var u,c=[],l=!1,f=-1;function h(){l&&u&&(l=!1,u.length?c=u.concat(c):f=-1,c.length&&p())}function p(){if(!l){var t=s(h);l=!0;for(var e=c.length;e;){for(u=c,c=[];++f<e;)u&&u[f].run();f=-1,e=c.length}u=null,l=!1,function(t){if(r===clearTimeout)return clearTimeout(t);if((r===a||!r)&&clearTimeout)return r=clearTimeout,clearTimeout(t);try{r(t)}catch(e){try{return r.call(null,t)}catch(e){return r.call(this,t)}}}(t)}}function d(t,e){this.fun=t,this.array=e}function y(){}i.nextTick=function(t){var e=new Array(arguments.length-1);if(1<arguments.length)for(var n=1;n<arguments.length;n++)e[n-1]=arguments[n];c.push(new d(t,e)),1!==c.length||l||s(p)},d.prototype.run=function(){this.fun.apply(null,this.array)},i.title="browser",i.browser=!0,i.env={},i.argv=[],i.version="",i.versions={},i.on=y,i.addListener=y,i.once=y,i.off=y,i.removeListener=y,i.removeAllListeners=y,i.emit=y,i.prependListener=y,i.prependOnceListener=y,i.listeners=function(t){return[]},i.binding=function(t){throw new Error("process.binding is not supported")},i.cwd=function(){return"/"},i.chdir=function(t){throw new Error("process.chdir is not supported")},i.umask=function(){return 0}},function(t,e,n){var r=n(204),i=n(479);t.exports=Object.assign({},r,{hooks:i})},function(t,e,n){var r=n(503),i=n(508);t.exports=function(t,e){var n=i(t,e);return r(n)?n:void 0}},function(t,e){"function"==typeof Object.create?t.exports=function(t,e){t.super_=e,t.prototype=Object.create(e.prototype,{constructor:{value:t,enumerable:!1,writable:!0,configurable:!0}})}:t.exports=function(t,e){t.super_=e;var n=function(){};n.prototype=e.prototype,t.prototype=new n,t.prototype.constructor=t}},function(t,e,n){"use strict";var r=n(103),i=Object.keys||function(t){var e=[];for(var n in t)e.push(n);return e};t.exports=f;var o=n(74);o.inherits=n(53);var a=n(258),s=n(164);o.inherits(f,a);for(var u=i(s.prototype),c=0;c<u.length;c++){var l=u[c];f.prototype[l]||(f.prototype[l]=s.prototype[l])}function f(t){if(!(this instanceof f))return new f(t);a.call(this,t),s.call(this,t),t&&!1===t.readable&&(this.readable=!1),t&&!1===t.writable&&(this.writable=!1),this.allowHalfOpen=!0,t&&!1===t.allowHalfOpen&&(this.allowHalfOpen=!1),this.once("end",h)}function h(){this.allowHalfOpen||this._writableState.ended||r.nextTick(p,this)}function p(t){t.end()}Object.defineProperty(f.prototype,"writableHighWaterMark",{enumerable:!1,get:function(){return this._writableState.highWaterMark}}),Object.defineProperty(f.prototype,"destroyed",{get:function(){return void 0!==this._readableState&&void 0!==this._writableState&&this._readableState.destroyed&&this._writableState.destroyed},set:function(t){void 0!==this._readableState&&void 0!==this._writableState&&(this._readableState.destroyed=t,this._writableState.destroyed=t)}}),f.prototype._destroy=function(t,e){this.push(null),this.end(),r.nextTick(e,t)}},function(t,e,n){var r=n(8).f,i=n(16),o=n(5)("toStringTag");t.exports=function(t,e,n){t&&!i(t=n?t:t.prototype,o)&&r(t,o,{configurable:!0,value:e})}},function(t,e,n){var r=n(22),i=n(5)("toStringTag"),o="Arguments"==r(function(){return arguments}());t.exports=function(t){var e,n,a;return void 0===t?"Undefined":null===t?"Null":"string"==typeof(n=function(t,e){try{return t[e]}catch(t){}}(e=Object(t),i))?n:o?r(e):"Object"==(a=r(e))&&"function"==typeof e.callee?"Arguments":a}},function(t,e,n){var r=n(0),i=n(28),o=n(3),a=n(113),s="["+a+"]",u=RegExp("^"+s+s+"*"),c=RegExp(s+s+"*$"),l=function(t,e,n){var i={},s=o(function(){return!!a[t]()||"â€‹Â…"!="â€‹Â…"[t]()}),u=i[t]=s?e(f):a[t];n&&(i[n]=u),r(r.P+r.F*s,"String",i)},f=l.trim=function(t,e){return t=String(i(t)),1&e&&(t=t.replace(u,"")),2&e&&(t=t.replace(c,"")),t};t.exports=l},function(t,e){t.exports={}},function(t,e,n){var r=n(4);t.exports=function(t,e){if(!r(t)||t._t!==e)throw TypeError("Incompatible receiver, "+e+" required!");return t}},function(t,e){t.exports=function(t){return t.webpackPolyfill||(t.deprecate=function(){},t.paths=[],t.children||(t.children=[]),Object.defineProperty(t,"loaded",{enumerable:!0,get:function(){return t.l}}),Object.defineProperty(t,"id",{enumerable:!0,get:function(){return t.i}}),t.webpackPolyfill=1),t}},function(t,e,n){var r=n(62),i=n(504),o=n(505),a=r?r.toStringTag:void 0;t.exports=function(t){return null==t?void 0===t?"[object Undefined]":"[object Null]":a&&a in Object(t)?i(t):o(t)}},function(t,e,n){var r=n(25).Symbol;t.exports=r},function(t,e,n){var r=n(22);t.exports=Object("z").propertyIsEnumerable(0)?Object:function(t){return"String"==r(t)?t.split(""):Object(t)}},function(t,e){e.f={}.propertyIsEnumerable},function(t,e,n){"use strict";var r=n(1);t.exports=function(){var t=r(this),e="";return t.global&&(e+="g"),t.ignoreCase&&(e+="i"),t.multiline&&(e+="m"),t.unicode&&(e+="u"),t.sticky&&(e+="y"),e}},function(t,e,n){var r=n(1),i=n(11),o=n(5)("species");t.exports=function(t,e){var n,a=r(t).constructor;return void 0===a||null==(n=r(a)[o])?e:i(n)}},function(t,e){function n(t){return(n="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t})(t)}function r(){this._events=this._events||{},this._maxListeners=this._maxListeners||void 0}function i(t){return"function"==typeof t}function o(t){return"object"===n(t)&&null!==t}function a(t){return void 0===t}((t.exports=r).EventEmitter=r).prototype._events=void 0,r.prototype._maxListeners=void 0,r.defaultMaxListeners=10,r.prototype.setMaxListeners=function(t){if("number"!=typeof t||t<0||isNaN(t))throw TypeError("n must be a positive number");return this._maxListeners=t,this},r.prototype.emit=function(t){var e,n,r,s,u,c;if(this._events||(this._events={}),"error"===t&&(!this._events.error||o(this._events.error)&&!this._events.error.length)){if((e=arguments[1])instanceof Error)throw e;var l=new Error('Uncaught, unspecified "error" event. ('+e+")");throw l.context=e,l}if(a(n=this._events[t]))return!1;if(i(n))switch(arguments.length){case 1:n.call(this);break;case 2:n.call(this,arguments[1]);break;case 3:n.call(this,arguments[1],arguments[2]);break;default:s=Array.prototype.slice.call(arguments,1),n.apply(this,s)}else if(o(n))for(s=Array.prototype.slice.call(arguments,1),r=(c=n.slice()).length,u=0;u<r;u++)c[u].apply(this,s);return!0},r.prototype.on=r.prototype.addListener=function(t,e){var n;if(!i(e))throw TypeError("listener must be a function");return this._events||(this._events={}),this._events.newListener&&this.emit("newListener",t,i(e.listener)?e.listener:e),this._events[t]?o(this._events[t])?this._events[t].push(e):this._events[t]=[this._events[t],e]:this._events[t]=e,o(this._events[t])&&!this._events[t].warned&&(n=a(this._maxListeners)?r.defaultMaxListeners:this._maxListeners)&&0<n&&this._events[t].length>n&&(this._events[t].warned=!0,console.error("(node) warning: possible EventEmitter memory leak detected. %d listeners added. Use emitter.setMaxListeners() to increase limit.",this._events[t].length),"function"==typeof console.trace&&console.trace()),this},r.prototype.once=function(t,e){if(!i(e))throw TypeError("listener must be a function");var n=!1;function r(){this.removeListener(t,r),n||(n=!0,e.apply(this,arguments))}return r.listener=e,this.on(t,r),this},r.prototype.removeListener=function(t,e){var n,r,a,s;if(!i(e))throw TypeError("listener must be a function");if(!this._events||!this._events[t])return this;if(a=(n=this._events[t]).length,r=-1,n===e||i(n.listener)&&n.listener===e)delete this._events[t],this._events.removeListener&&this.emit("removeListener",t,e);else if(o(n)){for(s=a;0<s--;)if(n[s]===e||n[s].listener&&n[s].listener===e){r=s;break}if(r<0)return this;1===n.length?(n.length=0,delete this._events[t]):n.splice(r,1),this._events.removeListener&&this.emit("removeListener",t,e)}return this},r.prototype.removeAllListeners=function(t){var e,n;if(!this._events)return this;if(!this._events.removeListener)return 0===arguments.length?this._events={}:this._events[t]&&delete this._events[t],this;if(0===arguments.length){for(e in this._events)"removeListener"!==e&&this.removeAllListeners(e);return this.removeAllListeners("removeListener"),this._events={},this}if(i(n=this._events[t]))this.removeListener(t,n);else if(n)for(;n.length;)this.removeListener(t,n[n.length-1]);return delete this._events[t],this},r.prototype.listeners=function(t){return this._events&&this._events[t]?i(this._events[t])?[this._events[t]]:this._events[t].slice():[]},r.prototype.listenerCount=function(t){if(this._events){var e=this._events[t];if(i(e))return 1;if(e)return e.length}return 0},r.listenerCount=function(t,e){return t.listenerCount(e)}},function(t,e,n){var r=n(215),i=n(216);t.exports=function(t,e,n,o){var a=!n;n||(n={});for(var s=-1,u=e.length;++s<u;){var c=e[s],l=o?o(n[c],t[c],c,n,t):void 0;void 0===l&&(l=t[c]),a?i(n,c,l):r(n,c,l)}return n}},function(t,e,n){var r=n(218),i=n(526),o=n(146);t.exports=function(t){return o(t)?r(t):i(t)}},function(t,e,n){function r(t){return(r="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t})(t)}var i=n(61),o=n(39);t.exports=function(t){return"symbol"==r(t)||o(t)&&"[object Symbol]"==i(t)}},function(t,e,n){var r=n(70);t.exports=function(t){if("string"==typeof t||r(t))return t;var e=t+"";return"0"==e&&1/t==-1/0?"-0":e}},function(t,e,n){"use strict";Object.defineProperty(e,"__esModule",{value:!0}),e.default=function(t){return new Float32Array(t)}},function(t,e,n){"use strict";var r=function(){function t(t,e){for(var n=0;n<e.length;n++){var r=e[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(t,r.key,r)}}return function(e,n,r){return n&&t(e.prototype,n),r&&t(e,r),e}}();t.exports=function(){function t(e,n,r,i,o){var a=5<arguments.length&&void 0!==arguments[5]?arguments[5]:"NumberTexture";!function(e,n){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this),this.texture=e,this.size=n,this.dimensions=r,this.output=i,this.webGl=o,this.kernel=null,this.type=a}return r(t,[{key:"toArray",value:function(t){if(!t)throw new Error("You need to pass the GPU object for toArray to work.");return this.kernel||(this.kernel=t.createKernel(function(t){return t[this.thread.z][this.thread.y][this.thread.x]}).setOutput(this.output)),this.kernel(this)}},{key:"delete",value:function(){return this.webGl.deleteTexture(this.texture)}}]),t}()},function(t,e,n){(function(t){function n(t){return(n="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t})(t)}function r(t){return Object.prototype.toString.call(t)}e.isArray=function(t){return Array.isArray?Array.isArray(t):"[object Array]"===r(t)},e.isBoolean=function(t){return"boolean"==typeof t},e.isNull=function(t){return null===t},e.isNullOrUndefined=function(t){return null==t},e.isNumber=function(t){return"number"==typeof t},e.isString=function(t){return"string"==typeof t},e.isSymbol=function(t){return"symbol"===n(t)},e.isUndefined=function(t){return void 0===t},e.isRegExp=function(t){return"[object RegExp]"===r(t)},e.isObject=function(t){return"object"===n(t)&&null!==t},e.isDate=function(t){return"[object Date]"===r(t)},e.isError=function(t){return"[object Error]"===r(t)||t instanceof Error},e.isFunction=function(t){return"function"==typeof t},e.isPrimitive=function(t){return null===t||"boolean"==typeof t||"number"==typeof t||"string"==typeof t||"symbol"===n(t)||void 0===t},e.isBuffer=t.isBuffer}).call(this,n(261).Buffer)},function(t,e,n){"use strict";function r(){if(r.returnV)return r.returnV=!1,r.vVal;var t=2*Math.random()-1,e=2*Math.random()-1,n=t*t+e*e;if(0==n||1<n)return r();var i=Math.sqrt(-2*Math.log(n)/n);return r.vVal=e*i,r.returnV=!0,t*i}Object.defineProperty(e,"__esModule",{value:!0}),e.randomF=function(t,e){return Math.random()*(e-t)+t},e.randomI=function(t,e){return Math.floor(Math.random()*(e-t)+t)},e.randomN=function(t,e){return t+r()*e},r.returnV=!1,r.vVal=0},function(t,e,n){var r=n(20),i=n(2),o="__core-js_shared__",a=i[o]||(i[o]={});(t.exports=function(t,e){return a[t]||(a[t]=void 0!==e?e:{})})("versions",[]).push({version:r.version,mode:n(36)?"pure":"global",copyright:"Â© 2018 Denis Pushkarev (zloirock.ru)"})},function(t,e,n){var r=n(17),i=n(6),o=n(43);t.exports=function(t){return function(e,n,a){var s,u=r(e),c=i(u.length),l=o(a,c);if(t&&n!=n){for(;l<c;)if((s=u[l++])!=s)return!0}else for(;l<c;l++)if((t||l in u)&&u[l]===n)return t||l||0;return!t&&-1}}},function(t,e){e.f=Object.getOwnPropertySymbols},function(t,e,n){var r=n(22);t.exports=Array.isArray||function(t){return"Array"==r(t)}},function(t,e,n){var r=n(23),i=n(28);t.exports=function(t){return function(e,n){var o,a,s=String(i(e)),u=r(n),c=s.length;return u<0||c<=u?t?"":void 0:(o=s.charCodeAt(u))<55296||56319<o||u+1===c||(a=s.charCodeAt(u+1))<56320||57343<a?t?s.charAt(u):o:t?s.slice(u,u+2):a-56320+(o-55296<<10)+65536}}},function(t,e,n){var r=n(4),i=n(22),o=n(5)("match");t.exports=function(t){var e;return r(t)&&(void 0!==(e=t[o])?!!e:"RegExp"==i(t))}},function(t,e,n){var r=n(5)("iterator"),i=!1;try{var o=[7][r]();o.return=function(){i=!0},Array.from(o,function(){throw 2})}catch(t){}t.exports=function(t,e){if(!e&&!i)return!1;var n=!1;try{var o=[7],a=o[r]();a.next=function(){return{done:n=!0}},o[r]=function(){return a},t(o)}catch(t){}return n}},function(t,e,n){"use strict";function r(t){return(r="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t})(t)}var i=n(56),o=RegExp.prototype.exec;t.exports=function(t,e){var n=t.exec;if("function"==typeof n){var a=n.call(t,e);if("object"!==r(a))throw new TypeError("RegExp exec method returned something other than an Object or null");return a}if("RegExp"!==i(t))throw new TypeError("RegExp#exec called on incompatible receiver");return o.call(t,e)}},function(t,e,n){"use strict";n(186);var r=n(13),i=n(12),o=n(3),a=n(28),s=n(5),u=n(128),c=s("species"),l=!o(function(){var t=/./;return t.exec=function(){var t=[];return t.groups={a:"7"},t},"7"!=="".replace(t,"$<a>")}),f=function(){var t=/(?:)/,e=t.exec;t.exec=function(){return e.apply(this,arguments)};var n="ab".split(t);return 2===n.length&&"a"===n[0]&&"b"===n[1]}();t.exports=function(t,e,n){var h=s(t),p=!o(function(){var e={};return e[h]=function(){return 7},7!=""[t](e)}),d=p?!o(function(){var e=!1,n=/a/;return n.exec=function(){return e=!0,null},"split"===t&&(n.constructor={},n.constructor[c]=function(){return n}),n[h](""),!e}):void 0;if(!p||!d||"replace"===t&&!l||"split"===t&&!f){var y=/./[h],v=n(a,h,""[t],function(t,e,n,r,i){return e.exec===u?p&&!i?{done:!0,value:y.call(e,n,r)}:{done:!0,value:t.call(n,e,r)}:{done:!1}}),g=v[0],m=v[1];r(String.prototype,t,g),i(RegExp.prototype,h,2==e?function(t,e){return m.call(t,this,e)}:function(t){return m.call(t,this)})}}},function(t,e,n){var r=n(2).navigator;t.exports=r&&r.userAgent||""},function(t,e,n){"use strict";var r=n(2),i=n(0),o=n(13),a=n(49),s=n(35),u=n(48),c=n(47),l=n(4),f=n(3),h=n(82),p=n(55),d=n(114);t.exports=function(t,e,n,y,v,g){var m=r[t],b=m,x=v?"set":"add",_=b&&b.prototype,w={},S=function(t){var e=_[t];o(_,t,"delete"==t?function(t){return!(g&&!l(t))&&e.call(this,0===t?0:t)}:"has"==t?function(t){return!(g&&!l(t))&&e.call(this,0===t?0:t)}:"get"==t?function(t){return g&&!l(t)?void 0:e.call(this,0===t?0:t)}:"add"==t?function(t){return e.call(this,0===t?0:t),this}:function(t,n){return e.call(this,0===t?0:t,n),this})};if("function"==typeof b&&(g||_.forEach&&!f(function(){(new b).entries().next()}))){var E=new b,T=E[x](g?{}:-0,1)!=E,k=f(function(){E.has(1)}),O=h(function(t){new b(t)}),A=!g&&f(function(){for(var t=new b,e=5;e--;)t[x](e,e);return!t.has(-0)});O||(((b=e(function(e,n){c(e,b,t);var r=d(new m,e,b);return null!=n&&u(n,v,r[x],r),r})).prototype=_).constructor=b),(k||A)&&(S("delete"),S("has"),v&&S("get")),(A||T)&&S(x),g&&_.clear&&delete _.clear}else b=y.getConstructor(e,t,v,x),a(b.prototype,n),s.NEED=!0;return p(b,t),w[t]=b,i(i.G+i.W+i.F*(b!=m),w),g||y.setStrong(b,t,v),b}},function(t,e,n){for(var r,i=n(2),o=n(12),a=n(41),s=a("typed_array"),u=a("view"),c=!(!i.ArrayBuffer||!i.DataView),l=c,f=0,h="Int8Array,Uint8Array,Uint8ClampedArray,Int16Array,Uint16Array,Int32Array,Uint32Array,Float32Array,Float64Array".split(",");f<9;)(r=i[h[f++]])?(o(r.prototype,s,!0),o(r.prototype,u,!0)):l=!1;t.exports={ABV:c,CONSTR:l,TYPED:s,VIEW:u}},function(t,e,n){"use strict";t.exports=n(36)||!n(3)(function(){var t=Math.random();__defineSetter__.call(null,t,function(){}),delete n(2)[t]})},function(t,e,n){"use strict";var r=n(0);t.exports=function(t){r(r.S,t,{of:function(){for(var t=arguments.length,e=new Array(t);t--;)e[t]=arguments[t];return new this(e)}})}},function(t,e,n){"use strict";var r=n(0),i=n(11),o=n(21),a=n(48);t.exports=function(t){r(r.S,t,{from:function(t){var e,n,r,s,u=arguments[1];return i(this),(e=void 0!==u)&&i(u),null==t?new this:(n=[],e?(r=0,s=o(u,arguments[2],2),a(t,!1,function(t){n.push(s(t,r++))})):a(t,!1,n.push,n),new this(n))}})}},function(t,e,n){var r=n(492);t.exports=function(){return function(t){t.data&&(t.data=r(t.data))}}},function(t,e,n){var r=n(493),i=n(494),o=n(495),a=n(496),s=n(497);function u(t){var e=-1,n=null==t?0:t.length;for(this.clear();++e<n;){var r=t[e];this.set(r[0],r[1])}}u.prototype.clear=r,u.prototype.delete=i,u.prototype.get=o,u.prototype.has=a,u.prototype.set=s,t.exports=u},function(t,e,n){var r=n(137);t.exports=function(t,e){for(var n=t.length;n--;)if(r(t[n][0],e))return n;return-1}},function(t,e,n){var r=n(52)(Object,"create");t.exports=r},function(t,e,n){var r=n(517);t.exports=function(t,e){var n=t.__data__;return r(e)?n["string"==typeof e?"string":"hash"]:n.map}},function(t,e,n){var r=n(536),i=n(138),o=n(537),a=n(538),s=n(539),u=n(61),c=n(213),l="[object Map]",f="[object Promise]",h="[object Set]",p="[object WeakMap]",d="[object DataView]",y=c(r),v=c(i),g=c(o),m=c(a),b=c(s),x=u;(r&&x(new r(new ArrayBuffer(1)))!=d||i&&x(new i)!=l||o&&x(o.resolve())!=f||a&&x(new a)!=h||s&&x(new s)!=p)&&(x=function(t){var e=u(t),n="[object Object]"==e?t.constructor:void 0,r=n?c(n):"";if(r)switch(r){case y:return d;case v:return l;case g:return f;case m:return h;case b:return p}return e}),t.exports=x},function(t,e,n){var r=n(26),i=n(155),o=n(581),a=n(584);t.exports=function(t,e){return r(t)?t:i(t,e)?[t]:o(a(t))}},function(t,e,n){(function(t,r){function i(t){return(i="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t})(t)}var o=/%[sdj%]/g;e.format=function(t){if(!m(t)){for(var e=[],n=0;n<arguments.length;n++)e.push(u(arguments[n]));return e.join(" ")}n=1;for(var r=arguments,i=r.length,a=String(t).replace(o,function(t){if("%%"===t)return"%";if(i<=n)return t;switch(t){case"%s":return String(r[n++]);case"%d":return Number(r[n++]);case"%j":try{return JSON.stringify(r[n++])}catch(t){return"[Circular]"}default:return t}}),s=r[n];n<i;s=r[++n])v(s)||!_(s)?a+=" "+s:a+=" "+u(s);return a},e.deprecate=function(n,i){if(b(t.process))return function(){return e.deprecate(n,i).apply(this,arguments)};if(!0===r.noDeprecation)return n;var o=!1;return function(){if(!o){if(r.throwDeprecation)throw new Error(i);r.traceDeprecation?console.trace(i):console.error(i),o=!0}return n.apply(this,arguments)}};var a,s={};function u(t,n){var r={seen:[],stylize:l};return 3<=arguments.length&&(r.depth=arguments[2]),4<=arguments.length&&(r.colors=arguments[3]),y(n)?r.showHidden=n:n&&e._extend(r,n),b(r.showHidden)&&(r.showHidden=!1),b(r.depth)&&(r.depth=2),b(r.colors)&&(r.colors=!1),b(r.customInspect)&&(r.customInspect=!0),r.colors&&(r.stylize=c),f(r,t,r.depth)}function c(t,e){var n=u.styles[e];return n?"["+u.colors[n][0]+"m"+t+"["+u.colors[n][1]+"m":t}function l(t,e){return t}function f(t,n,r){if(t.customInspect&&n&&E(n.inspect)&&n.inspect!==e.inspect&&(!n.constructor||n.constructor.prototype!==n)){var i=n.inspect(r,t);return m(i)||(i=f(t,i,r)),i}var o=function(t,e){if(b(e))return t.stylize("undefined","undefined");if(m(e)){var n="'"+JSON.stringify(e).replace(/^"|"$/g,"").replace(/'/g,"\\'").replace(/\\"/g,'"')+"'";return t.stylize(n,"string")}return g(e)?t.stylize(""+e,"number"):y(e)?t.stylize(""+e,"boolean"):v(e)?t.stylize("null","null"):void 0}(t,n);if(o)return o;var a,s=Object.keys(n),u=(a={},s.forEach(function(t,e){a[t]=!0}),a);if(t.showHidden&&(s=Object.getOwnPropertyNames(n)),S(n)&&(0<=s.indexOf("message")||0<=s.indexOf("description")))return h(n);if(0===s.length){if(E(n)){var c=n.name?": "+n.name:"";return t.stylize("[Function"+c+"]","special")}if(x(n))return t.stylize(RegExp.prototype.toString.call(n),"regexp");if(w(n))return t.stylize(Date.prototype.toString.call(n),"date");if(S(n))return h(n)}var l,_="",T=!1,k=["{","}"];return d(n)&&(T=!0,k=["[","]"]),E(n)&&(_=" [Function"+(n.name?": "+n.name:"")+"]"),x(n)&&(_=" "+RegExp.prototype.toString.call(n)),w(n)&&(_=" "+Date.prototype.toUTCString.call(n)),S(n)&&(_=" "+h(n)),0!==s.length||T&&0!=n.length?r<0?x(n)?t.stylize(RegExp.prototype.toString.call(n),"regexp"):t.stylize("[Object]","special"):(t.seen.push(n),l=T?function(t,e,n,r,i){for(var o=[],a=0,s=e.length;a<s;++a)A(e,String(a))?o.push(p(t,e,n,r,String(a),!0)):o.push("");return i.forEach(function(i){i.match(/^\d+$/)||o.push(p(t,e,n,r,i,!0))}),o}(t,n,r,u,s):s.map(function(e){return p(t,n,r,u,e,T)}),t.seen.pop(),function(t,e,n){return 60<t.reduce(function(t,e){return e.indexOf("\n"),t+e.replace(/\u001b\[\d\d?m/g,"").length+1},0)?n[0]+(""===e?"":e+"\n ")+" "+t.join(",\n  ")+" "+n[1]:n[0]+e+" "+t.join(", ")+" "+n[1]}(l,_,k)):k[0]+_+k[1]}function h(t){return"["+Error.prototype.toString.call(t)+"]"}function p(t,e,n,r,i,o){var a,s,u;if((u=Object.getOwnPropertyDescriptor(e,i)||{value:e[i]}).get?s=u.set?t.stylize("[Getter/Setter]","special"):t.stylize("[Getter]","special"):u.set&&(s=t.stylize("[Setter]","special")),A(r,i)||(a="["+i+"]"),s||(t.seen.indexOf(u.value)<0?-1<(s=v(n)?f(t,u.value,null):f(t,u.value,n-1)).indexOf("\n")&&(s=o?s.split("\n").map(function(t){return"  "+t}).join("\n").substr(2):"\n"+s.split("\n").map(function(t){return"   "+t}).join("\n")):s=t.stylize("[Circular]","special")),b(a)){if(o&&i.match(/^\d+$/))return s;a=(a=JSON.stringify(""+i)).match(/^"([a-zA-Z_][a-zA-Z_0-9]*)"$/)?(a=a.substr(1,a.length-2),t.stylize(a,"name")):(a=a.replace(/'/g,"\\'").replace(/\\"/g,'"').replace(/(^"|"$)/g,"'"),t.stylize(a,"string"))}return a+": "+s}function d(t){return Array.isArray(t)}function y(t){return"boolean"==typeof t}function v(t){return null===t}function g(t){return"number"==typeof t}function m(t){return"string"==typeof t}function b(t){return void 0===t}function x(t){return _(t)&&"[object RegExp]"===T(t)}function _(t){return"object"===i(t)&&null!==t}function w(t){return _(t)&&"[object Date]"===T(t)}function S(t){return _(t)&&("[object Error]"===T(t)||t instanceof Error)}function E(t){return"function"==typeof t}function T(t){return Object.prototype.toString.call(t)}function k(t){return t<10?"0"+t.toString(10):t.toString(10)}e.debuglog=function(t){if(b(a)&&(a=r.env.NODE_DEBUG||""),t=t.toUpperCase(),!s[t])if(new RegExp("\\b"+t+"\\b","i").test(a)){var n=r.pid;s[t]=function(){var r=e.format.apply(e,arguments);console.error("%s %d: %s",t,n,r)}}else s[t]=function(){};return s[t]},(e.inspect=u).colors={bold:[1,22],italic:[3,23],underline:[4,24],inverse:[7,27],white:[37,39],grey:[90,39],black:[30,39],blue:[34,39],cyan:[36,39],green:[32,39],magenta:[35,39],red:[31,39],yellow:[33,39]},u.styles={special:"cyan",number:"yellow",boolean:"yellow",undefined:"grey",null:"bold",string:"green",date:"magenta",regexp:"red"},e.isArray=d,e.isBoolean=y,e.isNull=v,e.isNullOrUndefined=function(t){return null==t},e.isNumber=g,e.isString=m,e.isSymbol=function(t){return"symbol"===i(t)},e.isUndefined=b,e.isRegExp=x,e.isObject=_,e.isDate=w,e.isError=S,e.isFunction=E,e.isPrimitive=function(t){return null===t||"boolean"==typeof t||"number"==typeof t||"string"==typeof t||"symbol"===i(t)||void 0===t},e.isBuffer=n(593);var O=["Jan","Feb","Mar","Apr","May","Jun","Jul","Aug","Sep","Oct","Nov","Dec"];function A(t,e){return Object.prototype.hasOwnProperty.call(t,e)}e.log=function(){var t,n;console.log("%s - %s",(n=[k((t=new Date).getHours()),k(t.getMinutes()),k(t.getSeconds())].join(":"),[t.getDate(),O[t.getMonth()],n].join(" ")),e.format.apply(e,arguments))},e.inherits=n(53),e._extend=function(t,e){if(!e||!_(e))return t;for(var n=Object.keys(e),r=n.length;r--;)t[n[r]]=e[n[r]];return t}}).call(this,n(15),n(50))},function(t,e,n){"use strict";function r(t){return(r="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t})(t)}Object.defineProperty(e,"__esModule",{value:!0});var i="function"==typeof Symbol&&"symbol"===r(Symbol.iterator)?function(t){return r(t)}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":r(t)},o=function(){function t(t,e){for(var n=0;n<e.length;n++){var r=e[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(t,r.key,r)}}return function(e,n,r){return n&&t(e.prototype,n),r&&t(e,r),e}}(),a=function(){function t(){!function(e,n){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this)}return o(t,null,[{key:"toTable",value:function(e){var n=e.reduce(function(t,e){return Object.assign(t,e)},{});return t.toHash(n)}},{key:"toTable2D",value:function(t){for(var e={},n=0,r=0;r<t.length;r++)for(var i=t[r],o=0;o<i.length;o++){var a=i[o];for(var s in a)a.hasOwnProperty(s)&&!e.hasOwnProperty(s)&&(e[s]=n++)}return e}},{key:"toInputTable",value:function(t){for(var e={},n=0,r=0;r<t.length;r++)for(var i in t[r].input)e.hasOwnProperty(i)||(e[i]=n++);return e}},{key:"toInputTable2D",value:function(t){for(var e={},n=0,r=0;r<t.length;r++)for(var i=t[r].input,o=0;o<i.length;o++){var a=i[o];for(var s in a)e.hasOwnProperty(s)||(e[s]=n++)}return e}},{key:"toOutputTable",value:function(t){for(var e={},n=0,r=0;r<t.length;r++)for(var i in t[r].output)e.hasOwnProperty(i)||(e[i]=n++);return e}},{key:"toOutputTable2D",value:function(t){for(var e={},n=0,r=0;r<t.length;r++)for(var i=t[r].output,o=0;o<i.length;o++){var a=i[o];for(var s in a)e.hasOwnProperty(s)||(e[s]=n++)}return e}},{key:"toHash",value:function(t){var e={},n=0;for(var r in t)e[r]=n++;return e}},{key:"toArray",value:function(t,e,n){var r=new Float32Array(n);for(var i in t)r[t[i]]=e.hasOwnProperty(i)?e[i]:0;return r}},{key:"toArrayShort",value:function(t,e){var n=[];for(var r in t){if(!e.hasOwnProperty(r))break;n[t[r]]=e[r]}return Float32Array.from(n)}},{key:"toArrays",value:function(t,e,n){for(var r=[],i=0;i<e.length;i++)r.push(this.toArray(t,e[i],n));return r}},{key:"toObject",value:function(t,e){var n={};for(var r in t)n[r]=e[t[r]];return n}},{key:"toObjectPartial",value:function(t,e){var n=2<arguments.length&&void 0!==arguments[2]?arguments[2]:0,r=3<arguments.length&&void 0!==arguments[3]?arguments[3]:0,i={},o=0;for(var a in t)0<n&&o++<n||0<r&&o++>=r||(i[a]=e[t[a]-n]);return i}},{key:"lookupFromArray",value:function(t){for(var e={},n=0,r=t.length;0<r--;)e[t[r]]=n++;return e}},{key:"dataShape",value:function(t){var e=[];t.input?(e.push("datum"),t=t.input):Array.isArray(t)&&(t=t[0].input?(e.push("array","datum"),t[0].input):(e.push("array"),t[0]));for(var n=void 0;t;){for(n in t)break;if(!t.hasOwnProperty(n))break;if(Array.isArray(t)||t.buffer instanceof ArrayBuffer)e.push("array"),t=t[n];else{if("object"!==(void 0===t?"undefined":i(t)))throw new Error("unhandled signature");e.push("object"),t=t[n]}}return e.push(void 0===t?"undefined":i(t)),e}},{key:"addKeys",value:function(t,e){if(!Array.isArray(t)){e=e||{};var n=Object.keys(e).length;for(var r in t)t.hasOwnProperty(r)&&(e.hasOwnProperty(r)||(e[r]=n++));return e}}}]),t}();e.default=a},function(t,e,n){"use strict";var r=n(617),i=n(628),o=n(10),a=n(101),s=n(73),u=n(256),c=n(257),l=n(255),f=n(254),h=n(249),p=n(161),d=n(102),y=n(247),v=n(252),g=n(253),m=n(162),b=n(251);r.alias=i,r.utils=o,r.Texture=s,r.Input=a,r.input=function(t,e){return new a(t,e)},r.CPUFunctionBuilder=u,r.CPUFunctionNode=c,r.CPUKernel=l,r.CPURunner=f,r.WebGLFunctionBuilder=h,r.WebGLFunctionNode=p,r.WebGLKernel=d,r.WebGLRunner=y,r.WebGL2FunctionBuilder=v,r.WebGL2FunctionNode=g,r.WebGL2Kernel=m,r.WebGL2Runner=b,t.exports=r,"undefined"!=typeof window&&(window.GPU=r),"undefined"!=typeof self&&(self.GPU=r)},function(t,e,n){"use strict";t.exports=function t(e,n){if(function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,t),this.value=e,Array.isArray(n)){this.size=[];for(var r=0;r<n.length;r++)this.size[r]=n[r];for(;this.size.length<3;)this.size.push(1)}else n.z?this.size=[n.x,n.y,n.z]:n.y?this.size=[n.x,n.y,1]:this.size=[n.x,1,1]}},function(t,e,n){"use strict";function r(t){return(r="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t})(t)}var i=function(){function t(t,e){for(var n=0;n<e.length;n++){var r=e[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(t,r.key,r)}}return function(e,n,r){return n&&t(e.prototype,n),r&&t(e,r),e}}(),o=n(248),a=n(10),s=n(73),u=n(618),c=n(619),l=n(620),f=[],h={};t.exports=function(t){function e(t,n){!function(t,n){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this);var i=function(t,e){if(!t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!e||"object"!==r(e)&&"function"!=typeof e?t:e}(this,(e.__proto__||Object.getPrototypeOf(e)).call(this,t,n));return i.textureCache={},i.threadDim={},i.programUniformLocationCache={},i.framebuffer=null,i.buffer=null,i.program=null,i.outputToTexture=n.outputToTexture,i.endianness=a.systemEndianness(),i.subKernelOutputTextures=null,i.subKernelOutputVariableNames=null,i.argumentsLength=0,i.constantsLength=0,i.compiledFragShaderString=null,i.compiledVertShaderString=null,i.fragShader=null,i.vertShader=null,i.drawBuffersMap=null,i.outputTexture=null,i.maxTexSize=null,i.uniform1fCache={},i.uniform1iCache={},i.uniform2fCache={},i.uniform2fvCache={},i.uniform2ivCache={},i.uniform3fvCache={},i.uniform3ivCache={},i._webGl||(i._webGl=i.initWebGl()),i}return function(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function, not "+r(e));t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,enumerable:!1,writable:!0,configurable:!0}}),e&&(Object.setPrototypeOf?Object.setPrototypeOf(t,e):t.__proto__=e)}(e,o),i(e,null,[{key:"fragShaderString",get:function(){return u}},{key:"vertShaderString",get:function(){return c}}]),i(e,[{key:"initWebGl",value:function(){return a.initWebGl(this.getCanvas())}},{key:"validateOptions",value:function(){var t=a.isFloatReadPixelsSupported();if(!0===this.floatTextures&&!a.OES_texture_float)throw new Error("Float textures are not supported on this browser");if(!0===this.floatOutput&&!0!==this.floatOutputForce&&!t)throw new Error("Float texture outputs are not supported on this browser");void 0===this.floatTextures&&a.OES_texture_float&&(this.floatTextures=!0,this.floatOutput=t);var e=a.hasIntegerDivisionAccuracyBug();if(null===this.fixIntegerDivisionAccuracy?this.fixIntegerDivisionAccuracy=e:this.fixIntegerDivisionAccuracy&&!e&&(this.fixIntegerDivisionAccuracy=!1),a.checkOutput(this.output),!this.output||0===this.output.length){if(1!==arguments.length)throw new Error("Auto output only supported for kernels with only one input");var n=a.getArgumentType(arguments[0]);if("Array"===n)this.output=a.getDimensions(n);else{if("NumberTexture"!==n&&"ArrayTexture(4)"!==n)throw new Error("Auto output not supported for input type: "+n);this.output=arguments[0].output}}if(this.texSize=a.dimToTexSize({floatTextures:this.floatTextures,floatOutput:this.floatOutput},this.output,!0),this.graphical){if(2!==this.output.length)throw new Error("Output must have 2 dimensions on graphical mode");this.floatOutput&&(this.floatOutput=!1,console.warn("Cannot use graphical mode and float output at the same time")),this.texSize=a.clone(this.output)}else void 0===this.floatOutput&&a.OES_texture_float&&(this.floatOutput=!0)}},{key:"updateMaxTexSize",value:function(){var t=this.texSize,e=this._canvas;if(null===this.maxTexSize){var n=f.indexOf(e);-1===n&&(n=f.length,f.push(e),h[n]=[t[0],t[1]]),this.maxTexSize=h[n]}this.maxTexSize[0]<t[0]&&(this.maxTexSize[0]=t[0]),this.maxTexSize[1]<t[1]&&(this.maxTexSize[1]=t[1])}},{key:"build",value:function(){this.validateOptions(),this.setupConstants(),this.setupParams(arguments),this.updateMaxTexSize();var t=this.texSize,e=this._webGl,n=this._canvas;e.enable(e.SCISSOR_TEST),e.viewport(0,0,this.maxTexSize[0],this.maxTexSize[1]),n.width=this.maxTexSize[0],n.height=this.maxTexSize[1];for(var r=this.threadDim=a.clone(this.output);r.length<3;)r.push(1);this.functionBuilder&&this._addKernels();var i=this._getVertShaderString(arguments),o=e.createShader(e.VERTEX_SHADER);e.shaderSource(o,i),e.compileShader(o),this.vertShader=o;var s=this._getFragShaderString(arguments),u=e.createShader(e.FRAGMENT_SHADER);if(e.shaderSource(u,s),e.compileShader(u),this.fragShader=u,!e.getShaderParameter(o,e.COMPILE_STATUS))throw console.log(i),console.error("An error occurred compiling the shaders: "+e.getShaderInfoLog(o)),new Error("Error compiling vertex shader");if(!e.getShaderParameter(u,e.COMPILE_STATUS))throw console.log(s),console.error("An error occurred compiling the shaders: "+e.getShaderInfoLog(u)),new Error("Error compiling fragment shader");this.debug&&(console.log("Options:"),console.dir(this),console.log("GLSL Shader Output:"),console.log(s));var c=this.program=e.createProgram();e.attachShader(c,o),e.attachShader(c,u),e.linkProgram(c),this.framebuffer=e.createFramebuffer(),this.framebuffer.width=t[0],this.framebuffer.height=t[1];var l=new Float32Array([-1,-1,1,-1,-1,1,1,1]),f=new Float32Array([0,0,1,0,0,1,1,1]),h=l.byteLength,p=this.buffer;p?e.bindBuffer(e.ARRAY_BUFFER,p):(p=this.buffer=e.createBuffer(),e.bindBuffer(e.ARRAY_BUFFER,p),e.bufferData(e.ARRAY_BUFFER,l.byteLength+f.byteLength,e.STATIC_DRAW)),e.bufferSubData(e.ARRAY_BUFFER,0,l),e.bufferSubData(e.ARRAY_BUFFER,h,f);var d=e.getAttribLocation(this.program,"aPos");e.enableVertexAttribArray(d),e.vertexAttribPointer(d,2,e.FLOAT,e.FALSE,0,0);var y=e.getAttribLocation(this.program,"aTexCoord");for(var v in e.enableVertexAttribArray(y),e.vertexAttribPointer(y,2,e.FLOAT,e.FALSE,0,h),e.bindFramebuffer(e.FRAMEBUFFER,this.framebuffer),this.constants){var g=this.constants[v],m=a.getArgumentType(g);"Float"!==m&&"Integer"!==m&&(e.useProgram(this.program),this._addConstant(this.constants[v],m,v),this.constantsLength++)}this.outputImmutable||(this._setupOutputTexture(),null!==this.subKernelOutputVariableNames&&0<this.subKernelOutputVariableNames.length&&this._setupSubOutputTextures(this.subKernelOutputVariableNames.length))}},{key:"run",value:function(){null===this.program&&this.build.apply(this,arguments);var t=this.paramNames,e=this.paramTypes,n=this.texSize,r=this._webGl;r.useProgram(this.program),r.scissor(0,0,n[0],n[1]),this.hardcodeConstants||(this.setUniform3iv("uOutputDim",this.threadDim),this.setUniform2iv("uTexSize",n)),this.setUniform2f("ratio",n[0]/this.maxTexSize[0],n[1]/this.maxTexSize[1]);for(var i=this.argumentsLength=0;i<t.length;i++)this._addArgument(arguments[i],e[i],t[i]);if(this.graphical)return this.outputToTexture?(r.bindRenderbuffer(r.RENDERBUFFER,null),r.bindFramebuffer(r.FRAMEBUFFER,this.framebuffer),this.outputTexture&&!this.outputImmutable||this._setupOutputTexture(),r.drawArrays(r.TRIANGLE_STRIP,0,4),new s(this.outputTexture,n,this.threadDim,this.output,this._webGl,"ArrayTexture(4)")):(r.bindRenderbuffer(r.RENDERBUFFER,null),r.bindFramebuffer(r.FRAMEBUFFER,null),void r.drawArrays(r.TRIANGLE_STRIP,0,4));r.bindFramebuffer(r.FRAMEBUFFER,this.framebuffer),this.outputImmutable&&this._setupOutputTexture();var o=this.outputTexture;if(null!==this.subKernelOutputVariableNames&&(this.outputImmutable&&(this.subKernelOutputTextures=[],this._setupSubOutputTextures(this.subKernelOutputVariableNames.length)),this.drawBuffers.drawBuffersWEBGL(this.drawBuffersMap)),r.drawArrays(r.TRIANGLE_STRIP,0,4),null!==this.subKernelOutputTextures){if(null!==this.subKernels){var a=[];a.result=this.renderOutput(o);for(var u=0;u<this.subKernels.length;u++)a.push(new s(this.subKernelOutputTextures[u],n,this.threadDim,this.output,this._webGl));return a}if(null!==this.subKernelProperties){var c={result:this.renderOutput(o)},l=0;for(var f in this.subKernelProperties)this.subKernelProperties.hasOwnProperty(f)&&(c[f]=new s(this.subKernelOutputTextures[l],n,this.threadDim,this.output,this._webGl),l++);return c}}return this.renderOutput(o)}},{key:"renderOutput",value:function(t){var e=this.texSize,n=this._webGl,r=this.threadDim,i=this.output;if(this.outputToTexture)return new s(t,e,this.threadDim,i,this._webGl);var o=void 0;if(this.floatOutput){var u=e[0],c=Math.ceil(e[1]/4);o=new Float32Array(u*c*4),n.readPixels(0,0,u,c,n.RGBA,n.FLOAT,o)}else{var l=new Uint8Array(e[0]*e[1]*4);n.readPixels(0,0,e[0],e[1],n.RGBA,n.UNSIGNED_BYTE,l),o=new Float32Array(l.buffer)}return o=o.subarray(0,r[0]*r[1]*r[2]),1===i.length?o:2===i.length?a.splitArray(o,i[0]):3===i.length?a.splitArray(o,i[0]*i[1]).map(function(t){return a.splitArray(t,i[0])}):void 0}},{key:"getOutputTexture",value:function(){return this.outputTexture}},{key:"_setupOutputTexture",value:function(){var t=this._webGl,e=this.texSize,n=this.outputTexture=this._webGl.createTexture();t.activeTexture(t.TEXTURE0+this.constantsLength+this.paramNames.length),t.bindTexture(t.TEXTURE_2D,n),t.texParameteri(t.TEXTURE_2D,t.TEXTURE_WRAP_S,t.CLAMP_TO_EDGE),t.texParameteri(t.TEXTURE_2D,t.TEXTURE_WRAP_T,t.CLAMP_TO_EDGE),t.texParameteri(t.TEXTURE_2D,t.TEXTURE_MIN_FILTER,t.NEAREST),t.texParameteri(t.TEXTURE_2D,t.TEXTURE_MAG_FILTER,t.NEAREST),this.floatOutput?t.texImage2D(t.TEXTURE_2D,0,t.RGBA,e[0],e[1],0,t.RGBA,t.FLOAT,null):t.texImage2D(t.TEXTURE_2D,0,t.RGBA,e[0],e[1],0,t.RGBA,t.UNSIGNED_BYTE,null),t.framebufferTexture2D(t.FRAMEBUFFER,t.COLOR_ATTACHMENT0,t.TEXTURE_2D,n,0)}},{key:"_setupSubOutputTextures",value:function(t){for(var e=this._webGl,n=this.texSize,r=this.drawBuffersMap=[e.COLOR_ATTACHMENT0],i=this.subKernelOutputTextures=[],o=0;o<t;o++){var a=this._webGl.createTexture();i.push(a),r.push(e.COLOR_ATTACHMENT0+o+1),e.activeTexture(e.TEXTURE0+this.constantsLength+this.paramNames.length+o),e.bindTexture(e.TEXTURE_2D,a),e.texParameteri(e.TEXTURE_2D,e.TEXTURE_WRAP_S,e.CLAMP_TO_EDGE),e.texParameteri(e.TEXTURE_2D,e.TEXTURE_WRAP_T,e.CLAMP_TO_EDGE),e.texParameteri(e.TEXTURE_2D,e.TEXTURE_MIN_FILTER,e.NEAREST),e.texParameteri(e.TEXTURE_2D,e.TEXTURE_MAG_FILTER,e.NEAREST),this.floatOutput?e.texImage2D(e.TEXTURE_2D,0,e.RGBA,n[0],n[1],0,e.RGBA,e.FLOAT,null):e.texImage2D(e.TEXTURE_2D,0,e.RGBA,n[0],n[1],0,e.RGBA,e.UNSIGNED_BYTE,null),e.framebufferTexture2D(e.FRAMEBUFFER,e.COLOR_ATTACHMENT0+o+1,e.TEXTURE_2D,a,0)}}},{key:"getArgumentTexture",value:function(t){return this.getTextureCache("ARGUMENT_"+t)}},{key:"getTextureCache",value:function(t){return this.textureCache.hasOwnProperty(t)?this.textureCache[t]:this.textureCache[t]=this._webGl.createTexture()}},{key:"detachTextureCache",value:function(t){delete this.textureCache[t]}},{key:"setUniform1f",value:function(t,e){if(!this.uniform1fCache.hasOwnProperty(t)||e!==this.uniform1fCache[t]){this.uniform1fCache[t]=e;var n=this.getUniformLocation(t);this._webGl.uniform1f(n,e)}}},{key:"setUniform1i",value:function(t,e){if(!this.uniform1iCache.hasOwnProperty(t)||e!==this.uniform1iCache[t]){this.uniform1iCache[t]=e;var n=this.getUniformLocation(t);this._webGl.uniform1i(n,e)}}},{key:"setUniform2f",value:function(t,e,n){if(this.uniform2fCache.hasOwnProperty(t)){var r=this.uniform2fCache[t];if(e===r[0]&&n===r[1])return}this.uniform2fCache[t]=[e,n];var i=this.getUniformLocation(t);this._webGl.uniform2f(i,e,n)}},{key:"setUniform2fv",value:function(t,e){if(this.uniform2fvCache.hasOwnProperty(t)){var n=this.uniform2fvCache[t];if(e[0]===n[0]&&e[1]===n[1])return}this.uniform2fvCache[t]=e;var r=this.getUniformLocation(t);this._webGl.uniform2fv(r,e)}},{key:"setUniform2iv",value:function(t,e){if(this.uniform2ivCache.hasOwnProperty(t)){var n=this.uniform2ivCache[t];if(e[0]===n[0]&&e[1]===n[1])return}this.uniform2ivCache[t]=e;var r=this.getUniformLocation(t);this._webGl.uniform2iv(r,e)}},{key:"setUniform3fv",value:function(t,e){if(this.uniform3fvCache.hasOwnProperty(t)){var n=this.uniform3fvCache[t];if(e[0]===n[0]&&e[1]===n[1]&&e[2]===n[2])return}this.uniform3fvCache[t]=e;var r=this.getUniformLocation(t);this._webGl.uniform3fv(r,e)}},{key:"setUniform3iv",value:function(t,e){if(this.uniform3ivCache.hasOwnProperty(t)){var n=this.uniform3ivCache[t];if(e[0]===n[0]&&e[1]===n[1]&&e[2]===n[2])return}this.uniform3ivCache[t]=e;var r=this.getUniformLocation(t);this._webGl.uniform3iv(r,e)}},{key:"getUniformLocation",value:function(t){return this.programUniformLocationCache.hasOwnProperty(t)?this.programUniformLocationCache[t]:this.programUniformLocationCache[t]=this._webGl.getUniformLocation(this.program,t)}},{key:"_getFragShaderArtifactMap",value:function(t){return{HEADER:this._getHeaderString(),LOOP_MAX:this._getLoopMaxString(),CONSTANTS:this._getConstantsString(),DECODE32_ENDIANNESS:this._getDecode32EndiannessString(),ENCODE32_ENDIANNESS:this._getEncode32EndiannessString(),DIVIDE_WITH_INTEGER_CHECK:this._getDivideWithIntegerCheckString(),GET_WRAPAROUND:this._getGetWraparoundString(),GET_TEXTURE_CHANNEL:this._getGetTextureChannelString(),GET_TEXTURE_INDEX:this._getGetTextureIndexString(),GET_RESULT:this._getGetResultString(),MAIN_PARAMS:this._getMainParamsString(t),MAIN_CONSTANTS:this._getMainConstantsString(),KERNEL:this._getKernelString(),MAIN_RESULT:this._getMainResultString()}}},{key:"_addArgument",value:function(t,e,n){var r=this._webGl,i=this.getArgumentTexture(n);switch(t instanceof s&&(e=t.type),e){case"Array":case"Array(2)":case"Array(3)":case"Array(4)":case"Array2D":case"Array3D":var o=a.getDimensions(t,!0),u=a.dimToTexSize({floatTextures:this.floatTextures,floatOutput:this.floatOutput},o);r.activeTexture(r.TEXTURE0+this.constantsLength+this.argumentsLength),r.bindTexture(r.TEXTURE_2D,i),r.texParameteri(r.TEXTURE_2D,r.TEXTURE_WRAP_S,r.CLAMP_TO_EDGE),r.texParameteri(r.TEXTURE_2D,r.TEXTURE_WRAP_T,r.CLAMP_TO_EDGE),r.texParameteri(r.TEXTURE_2D,r.TEXTURE_MIN_FILTER,r.NEAREST),r.texParameteri(r.TEXTURE_2D,r.TEXTURE_MAG_FILTER,r.NEAREST);var c=u[0]*u[1],l=this._formatArrayTransfer(t,c),f=l.valuesFlat,h=l.bitRatio,p=void 0;this.floatTextures?r.texImage2D(r.TEXTURE_2D,0,r.RGBA,u[0],u[1],0,r.RGBA,r.FLOAT,f):(p=new Uint8Array(f.buffer),r.texImage2D(r.TEXTURE_2D,0,r.RGBA,u[0]/h,u[1],0,r.RGBA,r.UNSIGNED_BYTE,p)),this.hardcodeConstants||(this.setUniform3iv("user_"+n+"Dim",o),this.setUniform2iv("user_"+n+"Size",u)),this.setUniform1i("user_"+n+"BitRatio",h),this.setUniform1i("user_"+n,this.argumentsLength);break;case"Integer":case"Float":case"Number":this.setUniform1f("user_"+n,t);break;case"Input":var d=t.size,y=a.dimToTexSize({floatTextures:this.floatTextures,floatOutput:this.floatOutput},d);r.activeTexture(r.TEXTURE0+this.constantsLength+this.argumentsLength),r.bindTexture(r.TEXTURE_2D,i),r.texParameteri(r.TEXTURE_2D,r.TEXTURE_WRAP_S,r.CLAMP_TO_EDGE),r.texParameteri(r.TEXTURE_2D,r.TEXTURE_WRAP_T,r.CLAMP_TO_EDGE),r.texParameteri(r.TEXTURE_2D,r.TEXTURE_MIN_FILTER,r.NEAREST),r.texParameteri(r.TEXTURE_2D,r.TEXTURE_MAG_FILTER,r.NEAREST);var v=y[0]*y[1],g=this._formatArrayTransfer(t.value,v),m=g.valuesFlat,b=g.bitRatio;if(this.floatTextures)r.texImage2D(r.TEXTURE_2D,0,r.RGBA,y[0],y[1],0,r.RGBA,r.FLOAT,inputArray);else{var x=new Uint8Array(m.buffer);r.texImage2D(r.TEXTURE_2D,0,r.RGBA,y[0]/b,y[1],0,r.RGBA,r.UNSIGNED_BYTE,x)}this.hardcodeConstants||(this.setUniform3iv("user_"+n+"Dim",d),this.setUniform2iv("user_"+n+"Size",y)),this.setUniform1i("user_"+n+"BitRatio",b),this.setUniform1i("user_"+n,this.argumentsLength);break;case"HTMLImage":var _=t,w=[_.width,_.height,1],S=[_.width,_.height];r.activeTexture(r.TEXTURE0+this.constantsLength+this.argumentsLength),r.bindTexture(r.TEXTURE_2D,i),r.texParameteri(r.TEXTURE_2D,r.TEXTURE_WRAP_S,r.CLAMP_TO_EDGE),r.texParameteri(r.TEXTURE_2D,r.TEXTURE_WRAP_T,r.CLAMP_TO_EDGE),r.texParameteri(r.TEXTURE_2D,r.TEXTURE_MIN_FILTER,r.NEAREST),r.texParameteri(r.TEXTURE_2D,r.TEXTURE_MAG_FILTER,r.NEAREST),r.pixelStorei(r.UNPACK_FLIP_Y_WEBGL,!0);var E=r.RGBA,T=r.RGBA,k=r.UNSIGNED_BYTE;r.texImage2D(r.TEXTURE_2D,0,E,T,k,_),this.setUniform3iv("user_"+n+"Dim",w),this.setUniform2iv("user_"+n+"Size",S),this.setUniform1i("user_"+n,this.argumentsLength);break;case"ArrayTexture(4)":case"NumberTexture":var O=t,A=O.dimensions,j=O.size;r.activeTexture(r.TEXTURE0+this.constantsLength+this.argumentsLength),r.bindTexture(r.TEXTURE_2D,O.texture),this.setUniform3iv("user_"+n+"Dim",A),this.setUniform2iv("user_"+n+"Size",j),this.setUniform1i("user_"+n+"BitRatio",1),this.setUniform1i("user_"+n,this.argumentsLength);break;default:throw new Error("Input type not supported (WebGL): "+t)}this.argumentsLength++}},{key:"_addConstant",value:function(t,e,n){var r=this._webGl,i=this.getArgumentTexture(n);switch(t instanceof s&&(e=t.type),e){case"Array":var o=a.getDimensions(t,!0),u=a.dimToTexSize({floatTextures:this.floatTextures,floatOutput:this.floatOutput},o);r.activeTexture(r.TEXTURE0+this.constantsLength),r.bindTexture(r.TEXTURE_2D,i),r.texParameteri(r.TEXTURE_2D,r.TEXTURE_WRAP_S,r.CLAMP_TO_EDGE),r.texParameteri(r.TEXTURE_2D,r.TEXTURE_WRAP_T,r.CLAMP_TO_EDGE),r.texParameteri(r.TEXTURE_2D,r.TEXTURE_MIN_FILTER,r.NEAREST),r.texParameteri(r.TEXTURE_2D,r.TEXTURE_MAG_FILTER,r.NEAREST);var c=u[0]*u[1],l=this._formatArrayTransfer(t,c),f=l.valuesFlat,h=l.bitRatio,p=void 0;this.floatTextures?r.texImage2D(r.TEXTURE_2D,0,r.RGBA,u[0],u[1],0,r.RGBA,r.FLOAT,f):(p=new Uint8Array(f.buffer),r.texImage2D(r.TEXTURE_2D,0,r.RGBA,u[0]/h,u[1],0,r.RGBA,r.UNSIGNED_BYTE,p)),this.hardcodeConstants||(this.setUniform3iv("constants_"+n+"Dim",o),this.setUniform2iv("constants_"+n+"Size",u)),this.setUniform1i("constants_"+n+"BitRatio",h),this.setUniform1i("constants_"+n,this.constantsLength);break;case"Input":var d=t.size,y=a.dimToTexSize({floatTextures:this.floatTextures,floatOutput:this.floatOutput},d);r.activeTexture(r.TEXTURE0+this.constantsLength),r.bindTexture(r.TEXTURE_2D,i),r.texParameteri(r.TEXTURE_2D,r.TEXTURE_WRAP_S,r.CLAMP_TO_EDGE),r.texParameteri(r.TEXTURE_2D,r.TEXTURE_WRAP_T,r.CLAMP_TO_EDGE),r.texParameteri(r.TEXTURE_2D,r.TEXTURE_MIN_FILTER,r.NEAREST),r.texParameteri(r.TEXTURE_2D,r.TEXTURE_MAG_FILTER,r.NEAREST);var v=y[0]*y[1],g=this._formatArrayTransfer(t.value,v),m=g.valuesFlat,b=g.bitRatio;if(this.floatTextures)r.texImage2D(r.TEXTURE_2D,0,r.RGBA,y[0],y[1],0,r.RGBA,r.FLOAT,inputArray);else{var x=new Uint8Array(m.buffer);r.texImage2D(r.TEXTURE_2D,0,r.RGBA,y[0]/b,y[1],0,r.RGBA,r.UNSIGNED_BYTE,x)}this.hardcodeConstants||(this.setUniform3iv("constants_"+n+"Dim",d),this.setUniform2iv("constants_"+n+"Size",y)),this.setUniform1i("constants_"+n+"BitRatio",b),this.setUniform1i("constants_"+n,this.constantsLength);break;case"HTMLImage":var _=t,w=[_.width,_.height,1],S=[_.width,_.height];r.activeTexture(r.TEXTURE0+this.constantsLength),r.bindTexture(r.TEXTURE_2D,i),r.texParameteri(r.TEXTURE_2D,r.TEXTURE_WRAP_S,r.CLAMP_TO_EDGE),r.texParameteri(r.TEXTURE_2D,r.TEXTURE_WRAP_T,r.CLAMP_TO_EDGE),r.texParameteri(r.TEXTURE_2D,r.TEXTURE_MIN_FILTER,r.NEAREST),r.texParameteri(r.TEXTURE_2D,r.TEXTURE_MAG_FILTER,r.NEAREST),r.pixelStorei(r.UNPACK_FLIP_Y_WEBGL,!0);var E=r.RGBA,T=r.RGBA,k=r.UNSIGNED_BYTE;r.texImage2D(r.TEXTURE_2D,0,E,T,k,_),this.setUniform3iv("constants_"+n+"Dim",w),this.setUniform2iv("constants_"+n+"Size",S),this.setUniform1i("constants_"+n,this.constantsLength);break;case"ArrayTexture(4)":case"NumberTexture":var O=t,A=O.dimensions,j=O.size;r.activeTexture(r.TEXTURE0+this.constantsLength),r.bindTexture(r.TEXTURE_2D,O.texture),this.setUniform3iv("constants_"+n+"Dim",A),this.setUniform2iv("constants_"+n+"Size",j),this.setUniform1i("constants_"+n+"BitRatio",1),this.setUniform1i("constants_"+n,this.constantsLength);break;case"Integer":case"Float":default:throw new Error("Input type not supported (WebGL): "+t)}}},{key:"_formatArrayTransfer",value:function(t,e){var n=1,r=t;if(a.isArray(t[0])||this.floatTextures)r=new Float32Array(e),a.flattenTo(t,r);else switch(t.constructor){case Uint8Array:case Int8Array:n=4;break;case Uint16Array:case Int16Array:n=2;case Float32Array:case Int32Array:break;default:r=new Float32Array(e),a.flattenTo(t,r)}return{bitRatio:n,valuesFlat:r}}},{key:"_getHeaderString",value:function(){return null!==this.subKernels||null!==this.subKernelProperties?"#extension GL_EXT_draw_buffers : require\n":""}},{key:"_getLoopMaxString",value:function(){return this.loopMaxIterations?" "+parseInt(this.loopMaxIterations)+".0;\n":" 1000.0;\n"}},{key:"_getConstantsString",value:function(){var t=[],e=this.threadDim,n=this.texSize;return this.hardcodeConstants?t.push("ivec3 uOutputDim = ivec3("+e[0]+","+e[1]+", "+e[2]+")","ivec2 uTexSize = ivec2("+n[0]+", "+n[1]+")"):t.push("uniform ivec3 uOutputDim","uniform ivec2 uTexSize"),this._linesToString(t)}},{key:"_getTextureCoordinate",value:function(){var t=this.subKernelOutputVariableNames;return null===t||t.length<1?"varying vec2 vTexCoord;\n":"out vec2 vTexCoord;\n"}},{key:"_getDecode32EndiannessString",value:function(){return"LE"===this.endianness?"":"  rgba.rgba = rgba.abgr;\n"}},{key:"_getEncode32EndiannessString",value:function(){return"LE"===this.endianness?"":"  rgba.rgba = rgba.abgr;\n"}},{key:"_getDivideWithIntegerCheckString",value:function(){return this.fixIntegerDivisionAccuracy?"\n\t\t\t  float div_with_int_check(float x, float y) {\n\t\t\t  if (floor(x) == x && floor(y) == y && integerMod(x, y) == 0.0) {\n\t\t\t    return float(int(x)/int(y));\n\t\t\t  }\n\t\t\t  return x / y;\n\t\t\t}\n\t\t\t":""}},{key:"_getGetWraparoundString",value:function(){return this.wraparound?"  xyz = mod(xyz, texDim);\n":""}},{key:"_getGetTextureChannelString",value:function(){return this.floatTextures?this._linesToString(["  int channel = integerMod(index, 4)","  index = index / 4"]):""}},{key:"_getGetTextureIndexString",value:function(){return this.floatTextures?"  index = index / 4;\n":""}},{key:"_getGetResultString",value:function(){return this.floatTextures?this._linesToString(["  if (channel == 0) return texel.r","  if (channel == 1) return texel.g","  if (channel == 2) return texel.b","  if (channel == 3) return texel.a"]):"  return decode(texel, x, bitRatio);"}},{key:"_getMainParamsString",value:function(t){for(var e=[],n=this.paramTypes,r=this.paramNames,i=0;i<r.length;i++){var o=t[i],s=r[i],u=n[i];if(this.hardcodeConstants)if("Array"===u||"NumberTexture"===u||"ArrayTexture(4)"===u){var c=a.getDimensions(o,!0),l=a.dimToTexSize({floatTextures:this.floatTextures,floatOutput:this.floatOutput},c);e.push("uniform sampler2D user_"+s,"ivec2 user_"+s+"Size = ivec2("+l[0]+", "+l[1]+")","ivec3 user_"+s+"Dim = ivec3("+c[0]+", "+c[1]+", "+c[2]+")","uniform int user_"+s+"BitRatio")}else"Integer"===u?e.push("float user_"+s+" = "+o+".0"):"Float"===u&&e.push("float user_"+s+" = "+o);else if("Array"===u||"NumberTexture"===u||"ArrayTexture(4)"===u||"Input"===u||"HTMLImage"===u)e.push("uniform sampler2D user_"+s,"uniform ivec2 user_"+s+"Size","uniform ivec3 user_"+s+"Dim"),"HTMLImage"!==u&&e.push("uniform int user_"+s+"BitRatio");else{if("Integer"!==u&&"Float"!==u)throw new Error("Param type "+u+" not supported in WebGL, only WebGL2");e.push("uniform float user_"+s)}}return this._linesToString(e)}},{key:"_getMainConstantsString",value:function(){var t=[];if(this.constants)for(var e in this.constants)if(this.constants.hasOwnProperty(e)){var n=this.constants[e],r=a.getArgumentType(n);switch(r){case"Integer":t.push("const float constants_"+e+" = "+parseInt(n)+".0");break;case"Float":t.push("const float constants_"+e+" = "+parseFloat(n));break;case"Array":case"Input":case"HTMLImage":case"NumberTexture":case"ArrayTexture(4)":t.push("uniform sampler2D constants_"+e,"uniform ivec2 constants_"+e+"Size","uniform ivec3 constants_"+e+"Dim","uniform int constants_"+e+"BitRatio");break;default:throw new Error("Unsupported constant "+e+" type "+r)}}return this._linesToString(t)}},{key:"_getKernelString",value:function(){var t=[],e=this.subKernelOutputVariableNames;if(null!==e){t.push("float kernelResult = 0.0");for(var n=0;n<e.length;n++)t.push("float "+e[n]+" = 0.0")}else t.push("float kernelResult = 0.0");return this._linesToString(t)+this.functionBuilder.getPrototypeString("kernel")}},{key:"_getMainResultString",value:function(){var t=this.subKernelOutputVariableNames,e=[];if(this.floatOutput&&e.push("  index *= 4"),this.graphical)e.push("  threadId = indexTo3D(index, uOutputDim)","  kernel()","  gl_FragColor = actualColor");else if(this.floatOutput)for(var n=["r","g","b","a"],r=0;r<n.length;++r){if(e.push("  threadId = indexTo3D(index, uOutputDim)"),e.push("  kernel()"),t){e.push("  gl_FragData[0]."+n[r]+" = kernelResult");for(var i=0;i<t.length;++i)e.push("  gl_FragData["+(i+1)+"]."+n[r]+" = "+t[i])}else e.push("  gl_FragColor."+n[r]+" = kernelResult");r<n.length-1&&e.push("  index += 1")}else if(null!==t){e.push("  threadId = indexTo3D(index, uOutputDim)"),e.push("  kernel()"),e.push("  gl_FragData[0] = encode32(kernelResult)");for(var o=0;o<t.length;o++)e.push("  gl_FragData["+(o+1)+"] = encode32("+t[o]+")")}else e.push("  threadId = indexTo3D(index, uOutputDim)","  kernel()","  gl_FragColor = encode32(kernelResult)");return this._linesToString(e)}},{key:"_linesToString",value:function(t){return 0<t.length?t.join(";\n")+";\n":"\n"}},{key:"_replaceArtifacts",value:function(t,e){return t.replace(/[ ]*__([A-Z]+[0-9]*([_]?[A-Z])*)__;\n/g,function(t,n){if(e.hasOwnProperty(n))return e[n];throw"unhandled artifact "+n})}},{key:"_addKernels",value:function(){var t=this,e=this.functionBuilder,n=this._webGl;if(e.addFunctions(this.functions,{constants:this.constants,output:this.output}),e.addNativeFunctions(this.nativeFunctions),e.addKernel(this.fnString,{prototypeOnly:!1,constants:this.constants,output:this.output,debug:this.debug,loopMaxIterations:this.loopMaxIterations,paramNames:this.paramNames,paramTypes:this.paramTypes,constantTypes:this.constantTypes,fixIntegerDivisionAccuracy:this.fixIntegerDivisionAccuracy}),null!==this.subKernels){if(!(this.drawBuffers=n.getExtension("WEBGL_draw_buffers")))throw new Error("could not instantiate draw buffers extension");this.subKernelOutputVariableNames=[],this.subKernels.forEach(function(e){return t._addSubKernel(e)})}else if(null!==this.subKernelProperties){if(!(this.drawBuffers=n.getExtension("WEBGL_draw_buffers")))throw new Error("could not instantiate draw buffers extension");this.subKernelOutputVariableNames=[],Object.keys(this.subKernelProperties).forEach(function(e){return t._addSubKernel(t.subKernelProperties[e])})}}},{key:"_addSubKernel",value:function(t){this.functionBuilder.addSubKernel(t,{prototypeOnly:!1,constants:this.constants,output:this.output,debug:this.debug,loopMaxIterations:this.loopMaxIterations,fixIntegerDivisionAccuracy:this.fixIntegerDivisionAccuracy}),this.subKernelOutputVariableNames.push(t.name+"Result")}},{key:"_getFragShaderString",value:function(t){return null!==this.compiledFragShaderString?this.compiledFragShaderString:this.compiledFragShaderString=this._replaceArtifacts(this.constructor.fragShaderString,this._getFragShaderArtifactMap(t))}},{key:"_getVertShaderString",value:function(t){return null!==this.compiledVertShaderString?this.compiledVertShaderString:this.compiledVertShaderString=this.constructor.vertShaderString}},{key:"toString",value:function(){return l(this)}},{key:"addFunction",value:function(t){this.functionBuilder.addFunction(null,t)}},{key:"destroy",value:function(t){(function t(e,n,r){null===e&&(e=Function.prototype);var i=Object.getOwnPropertyDescriptor(e,n);if(void 0===i){var o=Object.getPrototypeOf(e);return null===o?void 0:t(o,n,r)}if("value"in i)return i.value;var a=i.get;return void 0!==a?a.call(r):void 0})(e.prototype.__proto__||Object.getPrototypeOf(e.prototype),"destroy",this).call(this),this.outputTexture&&this._webGl.deleteTexture(this.outputTexture),this.buffer&&this._webGl.deleteBuffer(this.buffer),this.framebuffer&&this._webGl.deleteFramebuffer(this.framebuffer),this.vertShader&&this._webGl.deleteShader(this.vertShader),this.fragShader&&this._webGl.deleteShader(this.fragShader),this.program&&this._webGl.deleteProgram(this.program);for(var n=Object.keys(this.textureCache),r=0;r<n.length;r++){var i=n[r];this._webGl.deleteTexture(this.textureCache[i])}if(this.subKernelOutputTextures)for(var o=0;o<this.subKernelOutputTextures.length;o++)this._webGl.deleteTexture(this.subKernelOutputTextures[o]);if(t){var a=f.indexOf(this._canvas);0<=a&&(f[a]=null,h[a]=null)}delete this._webGl}}]),e}()},function(t,e,n){"use strict";(function(e){!e.version||0===e.version.indexOf("v0.")||0===e.version.indexOf("v1.")&&0!==e.version.indexOf("v1.8.")?t.exports={nextTick:function(t,n,r,i){if("function"!=typeof t)throw new TypeError('"callback" argument must be a function');var o,a,s=arguments.length;switch(s){case 0:case 1:return e.nextTick(t);case 2:return e.nextTick(function(){t.call(null,n)});case 3:return e.nextTick(function(){t.call(null,n,r)});case 4:return e.nextTick(function(){t.call(null,n,r,i)});default:for(o=new Array(s-1),a=0;a<o.length;)o[a++]=arguments[a];return e.nextTick(function(){t.apply(null,o)})}}}:t.exports=e}).call(this,n(50))},function(t,e,n){var r=n(261),i=r.Buffer;function o(t,e){for(var n in t)e[n]=t[n]}function a(t,e,n){return i(t,e,n)}i.from&&i.alloc&&i.allocUnsafe&&i.allocUnsafeSlow?t.exports=r:(o(r,e),e.Buffer=a),o(i,a),a.from=function(t,e,n){if("number"==typeof t)throw new TypeError("Argument must not be a number");return i(t,e,n)},a.alloc=function(t,e,n){if("number"!=typeof t)throw new TypeError("Argument must be a number");var r=i(t);return void 0!==e?"string"==typeof n?r.fill(e,n):r.fill(e):r.fill(0),r},a.allocUnsafe=function(t){if("number"!=typeof t)throw new TypeError("Argument must be a number");return i(t)},a.allocUnsafeSlow=function(t){if("number"!=typeof t)throw new TypeError("Argument must be a number");return r.SlowBuffer(t)}},function(t,e,n){"use strict";function r(t){return(r="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t})(t)}Object.defineProperty(e,"__esModule",{value:!0});var i,o=(i=n(31))&&i.__esModule?i:{default:i},a=n(75),s=function(t){function e(t,n,i){!function(t,n){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this);var o=function(t,e){if(!t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!e||"object"!==r(e)&&"function"!=typeof e?t:e}(this,(e.__proto__||Object.getPrototypeOf(e)).call(this,t,n));o.rows=t,o.columns=n,o.std=i;for(var s=0,u=o.weights.length;s<u;s++)o.weights[s]=(0,a.randomF)(-i,i);return o}return function(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function, not "+r(e));t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,enumerable:!1,writable:!0,configurable:!0}}),e&&(Object.setPrototypeOf?Object.setPrototypeOf(t,e):t.__proto__=e)}(e,o.default),e}();e.default=s},function(t,e,n){"use strict";Object.defineProperty(e,"__esModule",{value:!0});var r=function(){function t(t,e){for(var n=0;n<e.length;n++){var r=e[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(t,r.key,r)}}return function(e,n,r){return n&&t(e.prototype,n),r&&t(e,r),e}}(),i=y(n(31)),o=y(n(105)),a=y(n(265)),s=y(n(268)),u=y(n(269)),c=y(n(166)),l=y(n(267)),f=n(75),h=y(n(72)),p=y(n(270)),d=y(n(156));function y(t){return t&&t.__esModule?t:{default:t}}var v=function(){function t(){var e=0<arguments.length&&void 0!==arguments[0]?arguments[0]:{};!function(e,n){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this);var n=this.constructor.defaults;Object.assign(this,n,e),this.trainOpts={},this.updateTrainingOptions(Object.assign({},this.constructor.trainDefaults,e)),this.stepCache={},this.runs=0,this.ratioClipped=null,this.model=null,this.inputLookup=null,this.inputLookupLength=null,this.outputLookup=null,this.outputLookupLength=null,e.json&&this.fromJSON(e.json)}return r(t,[{key:"initialize",value:function(){this.model={input:null,hiddenLayers:[],output:null,equations:[],allMatrices:[],equationConnections:[],outputConnector:null},this.dataFormatter&&(this.inputSize=this.inputRange=this.outputSize=this.dataFormatter.characters.length),this.mapModel()}},{key:"createHiddenLayers",value:function(){this.model.hiddenLayers.push(this.getModel(this.hiddenLayers[0],this.inputSize));for(var t=this.hiddenLayers[0],e=1;e<this.hiddenLayers.length;e++){var n=this.hiddenLayers[e];this.model.hiddenLayers.push(this.getModel(n,t)),t=n}}},{key:"getModel",value:function(t,e){return{weight:new o.default(t,e,.08),transition:new o.default(t,t,.08),bias:new i.default(t,1)}}},{key:"getEquation",value:function(t,e,n,r){var i=t.relu.bind(t),o=t.add.bind(t),a=t.multiply.bind(t);return i(o(o(a(r.weight,e),a(r.transition,n)),r.bias))}},{key:"createInputMatrix",value:function(){this.model.input=new o.default(this.inputRange+1,this.inputSize,.08)}},{key:"createOutputMatrix",value:function(){var t=this.model,e=this.outputSize,n=this.hiddenLayers[this.hiddenLayers.length-1];t.outputConnector=new o.default(e+1,n,.08),t.output=new i.default(e+1,1)}},{key:"bindEquation",value:function(){var t=this.model,e=new a.default,n=[],r=0<t.equationConnections.length?t.equationConnections[t.equationConnections.length-1]:this.initialLayerInputs,i=this.getEquation(e,e.inputMatrixToRow(t.input),r[0],t.hiddenLayers[0]);n.push(i);for(var o=1,s=this.hiddenLayers.length;o<s;o++)i=this.getEquation(e,i,r[o],t.hiddenLayers[o]),n.push(i);t.equationConnections.push(n),e.add(e.multiply(t.outputConnector,i),t.output),t.equations.push(e)}},{key:"mapModel",value:function(){var t=this.model,e=t.hiddenLayers,n=t.allMatrices;if(this.initialLayerInputs=this.hiddenLayers.map(function(t){return new i.default(t,1)}),this.createInputMatrix(),!t.input)throw new Error("net.model.input not set");if(n.push(t.input),this.createHiddenLayers(),!t.hiddenLayers.length)throw new Error("net.hiddenLayers not set");for(var r=0,o=e.length;r<o;r++){var a=e[r];for(var s in a)a.hasOwnProperty(s)&&n.push(a[s])}if(this.createOutputMatrix(),!t.outputConnector)throw new Error("net.model.outputConnector not set");if(!t.output)throw new Error("net.model.output not set");n.push(t.outputConnector),n.push(t.output)}},{key:"trainPattern",value:function(t,e){var n=this.trainInput(t);if(this.backpropagate(t),this.adjustWeights(),e)return n}},{key:"trainInput",value:function(t){this.runs++;for(var e=this.model,n=t.length,r=0,i=void 0;e.equations.length<=t.length+1;)this.bindEquation();for(var o=-1,a=t.length;o<a;o++){var s=o+1;i=e.equations[s];var u=-1===o?0:t[o]+1,c=o===n-1?0:t[o+1]+1;r+=i.predictTargetIndex(u,c)}return Math.pow(2,r/(n-1))/100}},{key:"backpropagate",value:function(t){for(var e=t.length,n=this.model.equations;0<e;)n[e].backpropagateIndex(t[e-1]+1),e--;n[0].backpropagateIndex(0)}},{key:"adjustWeights",value:function(){for(var t=this.regc,e=this.clipval,n=this.model,r=this.decayRate,i=this.stepCache,o=this.smoothEps,a=this.trainOpts.learningRate,s=n.allMatrices,u=0,c=0,l=0;l<s.length;l++){var f=s[l],p=f.weights,d=f.deltas;l in i||(i[l]=(0,h.default)(f.rows*f.columns));for(var y=i[l],v=0;v<p.length;v++){var g=d[v],m=p[v];y[v]=y[v]*r+(1-r)*g*g,e<g&&(g=e,u++),g<-e&&(g=-e,u++),c++,p[v]=m+-a*g/Math.sqrt(y[v]+o)-t*m}}this.ratioClipped=u/c}},{key:"run",value:function(){var t=0<arguments.length&&void 0!==arguments[0]?arguments[0]:[],e=1<arguments.length&&void 0!==arguments[1]&&arguments[1],n=2<arguments.length&&void 0!==arguments[2]?arguments[2]:1,r=this.maxPredictionLength+t.length+(this.dataFormatter?this.dataFormatter.specialIndexes.length:0);if(!this.isRunnable)return null;for(var o=this.formatDataIn(t),a=this.model,f=[],h=0;;){for(var p=0===h?0:h<o.length?o[h-1]+1:f[h-1];a.equations.length<=h;)this.bindEquation();var d=a.equations[h].runIndex(p),y=new i.default(a.output.rows,a.output.columns);if((0,l.default)(y,d),1!==n&&e)for(var v=0,g=y.weights.length;v<g;v++)y.weights[v]/=n;var m=(0,c.default)(y),b=e?(0,s.default)(m):(0,u.default)(m);if(h++,0===b)break;if(r<=h)break;f.push(b)}return this.formatDataOut(o,f.slice(o.length).map(function(t){return t-1}))}},{key:"verifyIsInitialized",value:function(t){this.model||this.initialize()}},{key:"updateTrainingOptions",value:function(t){var e=this;Object.keys(this.constructor.trainDefaults).forEach(function(n){return e.trainOpts[n]=t.hasOwnProperty(n)?t[n]:e.trainOpts[n]}),this.validateTrainingOptions(this.trainOpts),this.setLogMethod(t.log||this.trainOpts.log),this.activation=t.activation||this.activation}},{key:"validateTrainingOptions",value:function(t){d.default.prototype.validateTrainingOptions.call(this,t)}},{key:"setLogMethod",value:function(t){this.trainOpts.log="function"==typeof t?t:!!t&&console.log}},{key:"prepTraining",value:function(t,e){this.updateTrainingOptions(e),t=this.formatData(t);var n=Date.now()+this.trainOpts.timeout;return this.verifyIsInitialized(t),{data:t,status:{error:1,iterations:0},endTime:n}}},{key:"train",value:function(t){var e=1<arguments.length&&void 0!==arguments[1]?arguments[1]:{};this.trainOpts=e=Object.assign({},this.constructor.trainDefaults,e);var n=e.iterations,r=e.errorThresh,i=!0===e.log?console.log:e.log,o=e.logPeriod,a=e.callback,s=e.callbackPeriod,u=1/0,c=void 0;for(this.hasOwnProperty("setupData")&&(t=this.setupData(t)),this.verifyIsInitialized(),c=0;c<n&&r<u;c++){for(var l=0,f=0;f<t.length;f++)l+=this.trainPattern(t[f],!0);if(u=l/t.length,isNaN(u))throw new Error("network error rate is unexpected NaN, check network configurations and try again");i&&c%o==0&&i("iterations: "+c+", training error: "+u),a&&c%s==0&&a({error:u,iterations:c})}return{error:u,iterations:c}}},{key:"addFormat",value:function(){throw new Error("not yet implemented")}},{key:"toJSON",value:function(){var t=this.constructor.defaults;this.model||this.initialize();var e=this.model,n={};for(var r in t)t.hasOwnProperty(r)&&(n[r]=this[r]);return{type:this.constructor.name,options:n,input:e.input.toJSON(),hiddenLayers:e.hiddenLayers.map(function(t){var e={};for(var n in t)e[n]=t[n].toJSON();return e}),outputConnector:this.model.outputConnector.toJSON(),output:this.model.output.toJSON()}}},{key:"fromJSON",value:function(t){var e=this.constructor.defaults,n=t.options;this.model=null,this.hiddenLayers=null;var r=[],o=i.default.fromJSON(t.input);r.push(o);var a=[];(t.hiddenLayers||t.hiddenSizes).forEach(function(t){var e={};for(var n in t)e[n]=i.default.fromJSON(t[n]),r.push(e[n]);a.push(e)});var s=i.default.fromJSON(t.outputConnector);r.push(s);var u=i.default.fromJSON(t.output);r.push(u),Object.assign(this,e,n),n.hiddenSizes&&(this.hiddenLayers=n.hiddenSizes),n.dataFormatter&&(this.dataFormatter=p.default.fromJSON(n.dataFormatter)),this.model={input:o,hiddenLayers:a,output:u,allMatrices:r,outputConnector:s,equations:[],equationConnections:[]},this.initialLayerInputs=this.hiddenLayers.map(function(t){return new i.default(t,1)}),this.bindEquation()}},{key:"toFunction",value:function(){var t=this.model,e=this.model.equations,n=e[1].states,r=JSON.stringify(this.toJSON());function i(n){for(var r=t.equationConnections[0],i=e[0].states,o=0,a=i.length;o<a;o++)if(i[o].product===n)return o;return r.indexOf(n)}function o(e,r){if(!e||!e.rows||!e.columns)return"null";if(e===t.input)return"json.input";if(e===t.outputConnector)return"json.outputConnector";if(e===t.output)return"json.output";for(var o=0,a=t.hiddenLayers.length;o<a;o++){var s=t.hiddenLayers[o];for(var u in s)if(s.hasOwnProperty(u)&&s[u]===e)return"json.hiddenLayers["+o+"]."+u}return function(t,e){for(var r=0,o=n.length;r<o;r++){var a=n[r];if(r===e){var s=i(t);switch(t){case a.left:if(-1<s)return"typeof prevStates["+s+"] === 'object' ? prevStates["+s+"].product : new Matrix("+t.rows+", "+t.columns+")";case a.right:if(-1<s)return"typeof prevStates["+s+"] === 'object' ? prevStates["+s+"].product : new Matrix("+t.rows+", "+t.columns+")";case a.product:return"new Matrix("+t.rows+", "+t.columns+")";default:throw Error("unknown state")}}if(t===a.product)return"states["+r+"].product";if(t===a.right)return"states["+r+"].right";if(t===a.left)return"states["+r+"].left"}}(e,r)}function a(t){return(t=t.toString().split("{")).shift(),(t=(t=t.join("{")).split("}")).pop(),t.join("}").split("\n").join("\n        ").replace("product.deltas[i] = 0;","").replace("product.deltas[column] = 0;","").replace("left.deltas[leftIndex] = 0;","").replace("right.deltas[rightIndex] = 0;","").replace("product.deltas = left.deltas.slice(0);","")}for(var l=[],p={},d=[],y=0,v=n.length;y<v;y++){var g=n[y];l.push("states["+y+"] = {\n      name: '"+g.forwardFn.name+"',\n      left: "+o(g.left,y)+",\n      right: "+o(g.right,y)+",\n      product: "+o(g.product,y)+"\n    }");var m=g.forwardFn.name;p[m]||(p[m]=!0,d.push("        case '"+m+"': //compiled from src/recurrent/matrix/"+m.replace(/[A-Z]/g,function(t){return"-"+t.toLowerCase()})+".js\n          "+a(g.forwardFn.toString())+"\n          break;"))}var b="\n  if (typeof rawInput === 'undefined') rawInput = [];\n  if (typeof isSampleI === 'undefined') isSampleI = false;\n  if (typeof temperature === 'undefined') temperature = 1;\n  "+(this.dataFormatter?this.dataFormatter.toFunctionString():"")+"\n  \n  var input = "+(this.dataFormatter&&"function"==typeof this.formatDataIn?"formatDataIn(rawInput)":"rawInput")+";\n  var json = "+r+";\n  var maxPredictionLength = input.length + "+this.maxPredictionLength+";\n  var _i = 0;\n  var output = [];\n  var states = [];\n  var prevStates;\n  while (true) {\n    var previousIndex = (_i === 0\n        ? 0\n        : _i < input.length\n          ? input[_i - 1] + 1\n          : output[_i - 1])\n          ;\n    var rowPluckIndex = previousIndex;\n    var state;\n    prevStates = states;\n    states = [];\n    "+l.join(";\n    ")+";\n    for (var stateIndex = 0, stateMax = "+l.length+"; stateIndex < stateMax; stateIndex++) {\n      state = states[stateIndex];\n      var product = state.product;\n      var left = state.left;\n      var right = state.right;\n      \n      switch (state.name) {\n"+d.join("\n")+"\n      }\n    }\n    \n    var logProbabilities = state.product;\n    if (temperature !== 1 && isSampleI) {\n      for (var q = 0, nq = logProbabilities.weights.length; q < nq; q++) {\n        logProbabilities.weights[q] /= temperature;\n      }\n    }\n\n    var probs = softmax(logProbabilities);\n    var nextIndex = isSampleI ? sampleI(probs) : maxI(probs);\n    \n    _i++;\n    if (nextIndex === 0) {\n      break;\n    }\n    if (_i >= maxPredictionLength) {\n      break;\n    }\n\n    output.push(nextIndex);\n  }\n  "+(this.dataFormatter&&"function"==typeof this.formatDataOut?"return formatDataOut(input, output.slice(input.length).map(function(value) { return value - 1; }))":"return output.slice(input.length).map(function(value) { return value - 1; })")+";\n  function Matrix(rows, columns) {\n    this.rows = rows;\n    this.columns = columns;\n    this.weights = zeros(rows * columns);\n  }\n  "+(this.dataFormatter&&"function"==typeof this.formatDataIn?"function formatDataIn(input, output) { "+a(this.formatDataIn.toString()).replace(/this[.]dataFormatter[\n\s]+[.]/g,"").replace(/this[.]dataFormatter[.]/g,"").replace(/this[.]dataFormatter/g,"true")+" }":"")+"\n  "+(null!==this.dataFormatter&&"function"==typeof this.formatDataOut?"function formatDataOut(input, output) { "+a(this.formatDataOut.toString()).replace(/this[.]dataFormatter[\n\s]+[.]/g,"").replace(/this[.]dataFormatter[.]/g,"").replace(/this[.]dataFormatter/g,"true")+" }":"")+"\n  "+h.default.toString()+"\n  "+c.default.toString().replace("_2.default","Matrix")+"\n  "+f.randomF.toString()+"\n  "+s.default.toString()+"\n  "+u.default.toString();return new Function("rawInput","isSampleI","temperature",b)}},{key:"isRunnable",get:function(){return 0!==this.model.equations.length||(console.error("No equations bound, did you run train()?"),!1)}}]),t}();(e.default=v).defaults={inputSize:20,inputRange:20,hiddenLayers:[20,20],outputSize:20,decayRate:.999,smoothEps:1e-8,regc:1e-6,clipval:5,maxPredictionLength:100,setupData:function(t){if(!("string"==typeof t[0]||Array.isArray(t[0])||t[0].hasOwnProperty("input")&&t[0].hasOwnProperty("output")))return t;var e=[],n=[];if("string"==typeof t[0]||Array.isArray(t[0])){if(!this.dataFormatter){for(var r=0;r<t.length;r++)e.push(t[r]);this.dataFormatter=new p.default(e)}for(var i=0,o=t.length;i<o;i++)n.push(this.formatDataIn(t[i]))}else{if(!this.dataFormatter){for(var a=0;a<t.length;a++)e.push(t[a].input),e.push(t[a].output);this.dataFormatter=p.default.fromArrayInputOutput(e),this.dataFormatter.addUnrecognized()}for(var s=0,u=t.length;s<u;s++)n.push(this.formatDataIn(t[s].input,t[s].output))}return n},formatDataIn:function(t){var e=1<arguments.length&&void 0!==arguments[1]?arguments[1]:null;return this.dataFormatter?this.dataFormatter.indexTable.hasOwnProperty("stop-input")?this.dataFormatter.toIndexesInputOutput(t,e):this.dataFormatter.toIndexes(t):t},formatDataOut:function(t,e){return this.dataFormatter?this.dataFormatter.toCharacters(e).join(""):e},dataFormatter:null},v.trainDefaults={iterations:2e4,errorThresh:.005,log:!1,logPeriod:10,learningRate:.01,callback:null,callbackPeriod:10}},function(t,e,n){var r=n(4),i=n(2).document,o=r(i)&&r(i.createElement);t.exports=function(t){return o?i.createElement(t):{}}},function(t,e,n){var r=n(2),i=n(20),o=n(36),a=n(168),s=n(8).f;t.exports=function(t){var e=i.Symbol||(i.Symbol=o?{}:r.Symbol||{});"_"==t.charAt(0)||t in e||s(e,t,{value:a.f(t)})}},function(t,e,n){var r=n(76)("keys"),i=n(41);t.exports=function(t){return r[t]||(r[t]=i(t))}},function(t,e){t.exports="constructor,hasOwnProperty,isPrototypeOf,propertyIsEnumerable,toLocaleString,toString,valueOf".split(",")},function(t,e,n){var r=n(2).document;t.exports=r&&r.documentElement},function(t,e,n){var r=n(4),i=n(1),o=function(t,e){if(i(t),!r(e)&&null!==e)throw TypeError(e+": can't set as prototype!")};t.exports={set:Object.setPrototypeOf||("__proto__"in{}?function(t,e,r){try{(r=n(21)(Function.call,n(18).f(Object.prototype,"__proto__").set,2))(t,[]),e=!(t instanceof Array)}catch(t){e=!0}return function(t,n){return o(t,n),e?t.__proto__=n:r(t,n),t}}({},!1):void 0),check:o}},function(t,e){t.exports="\t\n\v\f\r Â áš€á Žâ€€â€â€‚â€ƒâ€„â€…â€†â€‡â€ˆâ€‰â€Šâ€¯âŸã€€\u2028\u2029\ufeff"},function(t,e,n){var r=n(4),i=n(112).set;t.exports=function(t,e,n){var o,a=e.constructor;return a!==n&&"function"==typeof a&&(o=a.prototype)!==n.prototype&&r(o)&&i&&i(t,o),t}},function(t,e,n){"use strict";var r=n(23),i=n(28);t.exports=function(t){var e=String(i(this)),n="",o=r(t);if(o<0||o==1/0)throw RangeError("Count can't be negative");for(;0<o;(o>>>=1)&&(e+=e))1&o&&(n+=e);return n}},function(t,e){t.exports=Math.sign||function(t){return 0==(t=+t)||t!=t?t:t<0?-1:1}},function(t,e){var n=Math.expm1;t.exports=!n||22025.465794806718<n(10)||n(10)<22025.465794806718||-2e-17!=n(-2e-17)?function(t){return 0==(t=+t)?t:-1e-6<t&&t<1e-6?t+t*t/2:Math.exp(t)-1}:n},function(t,e,n){"use strict";var r=n(36),i=n(0),o=n(13),a=n(12),s=n(58),u=n(119),c=n(55),l=n(19),f=n(5)("iterator"),h=!([].keys&&"next"in[].keys()),p="values",d=function(){return this};t.exports=function(t,e,n,y,v,g,m){u(n,e,y);var b,x,_,w=function(t){if(!h&&t in k)return k[t];switch(t){case"keys":case p:return function(){return new n(this,t)}}return function(){return new n(this,t)}},S=e+" Iterator",E=v==p,T=!1,k=t.prototype,O=k[f]||k["@@iterator"]||v&&k[v],A=O||w(v),j=v?E?w("entries"):A:void 0,P="Array"==e&&k.entries||O;if(P&&(_=l(P.call(new t)))!==Object.prototype&&_.next&&(c(_,S,!0),r||"function"==typeof _[f]||a(_,f,d)),E&&O&&O.name!==p&&(T=!0,A=function(){return O.call(this)}),r&&!m||!h&&!T&&k[f]||a(k,f,A),s[e]=A,s[S]=d,v)if(b={values:E?A:w(p),keys:g?A:w("keys"),entries:j},m)for(x in b)x in k||o(k,x,b[x]);else i(i.P+i.F*(h||T),e,b);return b}},function(t,e,n){"use strict";var r=n(44),i=n(40),o=n(55),a={};n(12)(a,n(5)("iterator"),function(){return this}),t.exports=function(t,e,n){t.prototype=r(a,{next:i(1,n)}),o(t,e+" Iterator")}},function(t,e,n){var r=n(81),i=n(28);t.exports=function(t,e,n){if(r(e))throw TypeError("String#"+n+" doesn't accept regex!");return String(i(t))}},function(t,e,n){var r=n(5)("match");t.exports=function(t){var e=/./;try{"/./"[t](e)}catch(n){try{return e[r]=!1,!"/./"[t](e)}catch(t){}}return!0}},function(t,e,n){var r=n(58),i=n(5)("iterator"),o=Array.prototype;t.exports=function(t){return void 0!==t&&(r.Array===t||o[i]===t)}},function(t,e,n){"use strict";var r=n(8),i=n(40);t.exports=function(t,e,n){e in t?r.f(t,e,i(0,n)):t[e]=n}},function(t,e,n){var r=n(56),i=n(5)("iterator"),o=n(58);t.exports=n(20).getIteratorMethod=function(t){if(null!=t)return t[i]||t["@@iterator"]||o[r(t)]}},function(t,e,n){var r=n(366);t.exports=function(t,e){return new(r(t))(e)}},function(t,e,n){"use strict";var r=n(9),i=n(43),o=n(6);t.exports=function(t){for(var e=r(this),n=o(e.length),a=arguments.length,s=i(1<a?arguments[1]:void 0,n),u=2<a?arguments[2]:void 0,c=void 0===u?n:i(u,n);s<c;)e[s++]=t;return e}},function(t,e,n){"use strict";var r=n(37),i=n(185),o=n(58),a=n(17);t.exports=n(118)(Array,"Array",function(t,e){this._t=a(t),this._i=0,this._k=e},function(){var t=this._t,e=this._k,n=this._i++;return!t||n>=t.length?(this._t=void 0,i(1)):i(0,"keys"==e?n:"values"==e?t[n]:[n,t[n]])},"values"),o.Arguments=o.Array,r("keys"),r("values"),r("entries")},function(t,e,n){"use strict";var r,i,o=n(65),a=RegExp.prototype.exec,s=String.prototype.replace,u=a,c="lastIndex",l=(r=/a/,i=/b*/g,a.call(r,"a"),a.call(i,"a"),0!==r[c]||0!==i[c]),f=void 0!==/()??/.exec("")[1];(l||f)&&(u=function(t){var e,n,r,i,u=this;return f&&(n=new RegExp("^"+u.source+"$(?!\\s)",o.call(u))),l&&(e=u[c]),r=a.call(u,t),l&&r&&(u[c]=u.global?r.index+r[0].length:e),f&&r&&1<r.length&&s.call(r[0],n,function(){for(i=1;i<arguments.length-2;i++)void 0===arguments[i]&&(r[i]=void 0)}),r}),t.exports=u},function(t,e,n){"use strict";var r=n(80)(!0);t.exports=function(t,e,n){return e+(n?r(t,e).length:1)}},function(t,e,n){var r,i,o,a=n(21),s=n(175),u=n(111),c=n(107),l=n(2),f=l.process,h=l.setImmediate,p=l.clearImmediate,d=l.MessageChannel,y=l.Dispatch,v=0,g={},m="onreadystatechange",b=function(){var t=+this;if(g.hasOwnProperty(t)){var e=g[t];delete g[t],e()}},x=function(t){b.call(t.data)};h&&p||(h=function(t){for(var e=[],n=1;arguments.length>n;)e.push(arguments[n++]);return g[++v]=function(){s("function"==typeof t?t:Function(t),e)},r(v),v},p=function(t){delete g[t]},"process"==n(22)(f)?r=function(t){f.nextTick(a(b,t,1))}:y&&y.now?r=function(t){y.now(a(b,t,1))}:d?(o=(i=new d).port2,i.port1.onmessage=x,r=a(o.postMessage,o,1)):l.addEventListener&&"function"==typeof postMessage&&!l.importScripts?(r=function(t){l.postMessage(t+"","*")},l.addEventListener("message",x,!1)):r=m in c("script")?function(t){u.appendChild(c("script"))[m]=function(){u.removeChild(this),b.call(t)}}:function(t){setTimeout(a(b,t,1),0)}),t.exports={set:h,clear:p}},function(t,e,n){var r=n(2),i=n(130).set,o=r.MutationObserver||r.WebKitMutationObserver,a=r.process,s=r.Promise,u="process"==n(22)(a);t.exports=function(){var t,e,n,c=function(){var r,i;for(u&&(r=a.domain)&&r.exit();t;){i=t.fn,t=t.next;try{i()}catch(r){throw t?n():e=void 0,r}}e=void 0,r&&r.enter()};if(u)n=function(){a.nextTick(c)};else if(!o||r.navigator&&r.navigator.standalone)if(s&&s.resolve){var l=s.resolve(void 0);n=function(){l.then(c)}}else n=function(){i.call(r,c)};else{var f=!0,h=document.createTextNode("");new o(c).observe(h,{characterData:!0}),n=function(){h.data=f=!f}}return function(r){var i={fn:r,next:void 0};e&&(e.next=i),t||(t=i,n()),e=i}}},function(t,e,n){"use strict";var r=n(11);function i(t){var e,n;this.promise=new t(function(t,r){if(void 0!==e||void 0!==n)throw TypeError("Bad Promise constructor");e=t,n=r}),this.resolve=r(e),this.reject=r(n)}t.exports.f=function(t){return new i(t)}},function(t,e,n){"use strict";var r=n(2),i=n(7),o=n(36),a=n(87),s=n(12),u=n(49),c=n(3),l=n(47),f=n(23),h=n(6),p=n(195),d=n(45).f,y=n(8).f,v=n(126),g=n(55),m="ArrayBuffer",b="DataView",x="prototype",_="Wrong index!",w=r[m],S=r[b],E=r.Math,T=r.RangeError,k=r.Infinity,O=w,A=E.abs,j=E.pow,P=E.floor,R=E.log,C=E.LN2,I="byteLength",L="byteOffset",N=i?"_b":"buffer",F=i?"_l":I,M=i?"_o":L;function D(t,e,n){var r,i,o,a=new Array(n),s=8*n-e-1,u=(1<<s)-1,c=u>>1,l=23===e?j(2,-24)-j(2,-77):0,f=0,h=t<0||0===t&&1/t<0?1:0;for((t=A(t))!=t||t===k?(i=t!=t?1:0,r=u):(r=P(R(t)/C),t*(o=j(2,-r))<1&&(r--,o*=2),2<=(t+=1<=r+c?l/o:l*j(2,1-c))*o&&(r++,o/=2),u<=r+c?(i=0,r=u):1<=r+c?(i=(t*o-1)*j(2,e),r+=c):(i=t*j(2,c-1)*j(2,e),r=0));8<=e;a[f++]=255&i,i/=256,e-=8);for(r=r<<e|i,s+=e;0<s;a[f++]=255&r,r/=256,s-=8);return a[--f]|=128*h,a}function U(t,e,n){var r,i=8*n-e-1,o=(1<<i)-1,a=o>>1,s=i-7,u=n-1,c=t[u--],l=127&c;for(c>>=7;0<s;l=256*l+t[u],u--,s-=8);for(r=l&(1<<-s)-1,l>>=-s,s+=e;0<s;r=256*r+t[u],u--,s-=8);if(0===l)l=1-a;else{if(l===o)return r?NaN:c?-k:k;r+=j(2,e),l-=a}return(c?-1:1)*r*j(2,l-e)}function G(t){return t[3]<<24|t[2]<<16|t[1]<<8|t[0]}function z(t){return[255&t]}function B(t){return[255&t,t>>8&255]}function V(t){return[255&t,t>>8&255,t>>16&255,t>>24&255]}function W(t){return D(t,52,8)}function X(t){return D(t,23,4)}function K(t,e,n){y(t[x],e,{get:function(){return this[n]}})}function q(t,e,n,r){var i=p(+n);if(i+e>t[F])throw T(_);var o=t[N]._b,a=i+t[M],s=o.slice(a,a+e);return r?s:s.reverse()}function H(t,e,n,r,i,o){var a=p(+n);if(a+e>t[F])throw T(_);for(var s=t[N]._b,u=a+t[M],c=r(+i),l=0;l<e;l++)s[u+l]=c[o?l:e-l-1]}if(a.ABV){if(!c(function(){w(1)})||!c(function(){new w(-1)})||c(function(){return new w,new w(1.5),new w(NaN),w.name!=m})){for(var $,Y=(w=function(t){return l(this,w),new O(p(t))})[x]=O[x],J=d(O),Q=0;J.length>Q;)($=J[Q++])in w||s(w,$,O[$]);o||(Y.constructor=w)}var Z=new S(new w(2)),tt=S[x].setInt8;Z.setInt8(0,2147483648),Z.setInt8(1,2147483649),!Z.getInt8(0)&&Z.getInt8(1)||u(S[x],{setInt8:function(t,e){tt.call(this,t,e<<24>>24)},setUint8:function(t,e){tt.call(this,t,e<<24>>24)}},!0)}else w=function(t){l(this,w,m);var e=p(t);this._b=v.call(new Array(e),0),this[F]=e},S=function(t,e,n){l(this,S,b),l(t,w,b);var r=t[F],i=f(e);if(i<0||r<i)throw T("Wrong offset!");if(r<i+(n=void 0===n?r-i:h(n)))throw T("Wrong length!");this[N]=t,this[M]=i,this[F]=n},i&&(K(w,I,"_l"),K(S,"buffer","_b"),K(S,I,"_l"),K(S,L,"_o")),u(S[x],{getInt8:function(t){return q(this,1,t)[0]<<24>>24},getUint8:function(t){return q(this,1,t)[0]},getInt16:function(t){var e=q(this,2,t,arguments[1]);return(e[1]<<8|e[0])<<16>>16},getUint16:function(t){var e=q(this,2,t,arguments[1]);return e[1]<<8|e[0]},getInt32:function(t){return G(q(this,4,t,arguments[1]))},getUint32:function(t){return G(q(this,4,t,arguments[1]))>>>0},getFloat32:function(t){return U(q(this,4,t,arguments[1]),23,4)},getFloat64:function(t){return U(q(this,8,t,arguments[1]),52,8)},setInt8:function(t,e){H(this,1,t,z,e)},setUint8:function(t,e){H(this,1,t,z,e)},setInt16:function(t,e){H(this,2,t,B,e,arguments[2])},setUint16:function(t,e){H(this,2,t,B,e,arguments[2])},setInt32:function(t,e){H(this,4,t,V,e,arguments[2])},setUint32:function(t,e){H(this,4,t,V,e,arguments[2])},setFloat32:function(t,e){H(this,4,t,X,e,arguments[2])},setFloat64:function(t,e){H(this,8,t,W,e,arguments[2])}});g(w,m),g(S,b),s(S[x],a.VIEW,!0),e[m]=w,e[b]=S},function(t,e,n){function r(t){return(r="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t})(t)}var i=n(34)("@feathersjs/errors");function o(t,e,n,a,s){var u,c,l;(t=t||"Error")instanceof Error?(c=t.message||"Error",t.errors&&(u=t.errors)):"object"===r(t)?(c=t.message||"Error",s=t):c=t,s&&((l=JSON.parse(JSON.stringify(s))).errors?(u=l.errors,delete l.errors):s.errors&&(u=JSON.parse(JSON.stringify(s.errors)))),this.type="FeathersError",this.name=e,this.message=c,this.code=n,this.className=a,this.data=l,this.errors=u||{},i("".concat(this.name,"(").concat(this.code,"): ").concat(this.message)),i(this.errors),Error.captureStackTrace?Error.captureStackTrace(this,o):this.stack=(new Error).stack}function a(t,e){t.prototype=Object.create(e.prototype),t.prototype.constructor=t}function s(t,e){o.call(this,t,"BadRequest",400,"bad-request",e)}function u(t,e){o.call(this,t,"NotAuthenticated",401,"not-authenticated",e)}function c(t,e){o.call(this,t,"PaymentError",402,"payment-error",e)}function l(t,e){o.call(this,t,"Forbidden",403,"forbidden",e)}function f(t,e){o.call(this,t,"NotFound",404,"not-found",e)}function h(t,e){o.call(this,t,"MethodNotAllowed",405,"method-not-allowed",e)}function p(t,e){o.call(this,t,"NotAcceptable",406,"not-acceptable",e)}function d(t,e){o.call(this,t,"Timeout",408,"timeout",e)}function y(t,e){o.call(this,t,"Conflict",409,"conflict",e)}function v(t,e){o.call(this,t,"LengthRequired",411,"length-required",e)}function g(t,e){o.call(this,t,"Unprocessable",422,"unprocessable",e)}function m(t,e){o.call(this,t,"TooManyRequests",429,"too-many-requests",e)}function b(t,e){o.call(this,t,"GeneralError",500,"general-error",e)}function x(t,e){o.call(this,t,"NotImplemented",501,"not-implemented",e)}function _(t,e){o.call(this,t,"BadGateway",502,"bad-gateway",e)}function w(t,e){o.call(this,t,"Unavailable",503,"unavailable",e)}a(o,Error),Object.defineProperty(o.prototype,"toJSON",{value:function(){return{name:this.name,message:this.message,code:this.code,className:this.className,data:this.data,errors:this.errors}}}),a(s,o),a(u,o),a(c,o),a(l,o),a(f,o),a(h,o),a(p,o),a(d,o),a(y,o),a(v,o),a(g,o),a(m,o),a(b,o),a(x,o),a(_,o),a(w,o);var S={FeathersError:o,BadRequest:s,NotAuthenticated:u,PaymentError:c,Forbidden:l,NotFound:f,MethodNotAllowed:h,NotAcceptable:p,Timeout:d,Conflict:y,LengthRequired:v,Unprocessable:g,TooManyRequests:m,GeneralError:b,NotImplemented:x,BadGateway:_,Unavailable:w,400:s,401:u,402:c,403:l,404:f,405:h,406:p,408:d,409:y,411:v,422:g,429:m,500:b,501:x,502:_,503:w};t.exports=Object.assign({convert:function(t){if(!t)return t;var e=S[t.name],n=e?new e(t.message,t.data):new Error(t.message||t);return"object"===r(t)&&Object.assign(n,t),n}},S)},function(t,e,n){var r,i;void 0===(i="function"==typeof(r=function(){var t="function"==typeof Object.getOwnPropertySymbols;return{create:function(){var t=Object.create(this),e="string"==typeof t.__init?t.__init:"init";return"function"==typeof t[e]&&t[e].apply(t,arguments),t},mixin:function(e,n){for(var r=n||this,i=/\b_super\b/,o=Object.getPrototypeOf(r)||r.prototype,a={},s=e,u=function(t){var e=Object.getOwnPropertyDescriptor(s,t);!a[t]&&e&&(a[t]=e)};Object.getOwnPropertyNames(s).forEach(u),t&&Object.getOwnPropertySymbols(s).forEach(u),(s=Object.getPrototypeOf(s))&&Object.getPrototypeOf(s););var c=function(e){var n,s,u,c,l,f,h=a[e];"function"==typeof h.value&&i.test(h.value)&&(h.value=(n=o,s=r[e],u=e,c=h.value,f=function(){var t=this._super;this._super=l?s:n[u];var e=c.apply(this,arguments);return this._super=t,e},(l="function"==typeof s)&&t&&Object.getOwnPropertySymbols(s).forEach(function(t){f[t]=s[t]}),f)),Object.defineProperty(r,e,h)};return Object.keys(a).forEach(c),t&&Object.getOwnPropertySymbols(a).forEach(c),r},extend:function(t,e){return this.mixin(t,Object.create(e||this))},proxy:function(t){var e=this[t],n=Array.prototype.slice.call(arguments,1);return n.unshift(this),e.bind.apply(e,n)}}})?r.apply(e,[]):r)||(t.exports=i)},function(t,e,n){var r=n(92),i=n(498),o=n(499),a=n(500),s=n(501),u=n(502);function c(t){var e=this.__data__=new r(t);this.size=e.size}c.prototype.clear=i,c.prototype.delete=o,c.prototype.get=a,c.prototype.has=s,c.prototype.set=u,t.exports=c},function(t,e){t.exports=function(t,e){return t===e||t!=t&&e!=e}},function(t,e,n){var r=n(52)(n(25),"Map");t.exports=r},function(t,e,n){var r=n(509),i=n(516),o=n(518),a=n(519),s=n(520);function u(t){var e=-1,n=null==t?0:t.length;for(this.clear();++e<n;){var r=t[e];this.set(r[0],r[1])}}u.prototype.clear=r,u.prototype.delete=i,u.prototype.get=o,u.prototype.has=a,u.prototype.set=s,t.exports=u},function(t,e,n){var r=n(523),i=n(39),o=Object.prototype,a=o.hasOwnProperty,s=o.propertyIsEnumerable,u=r(function(){return arguments}())?r:function(t){return i(t)&&a.call(t,"callee")&&!s.call(t,"callee")};t.exports=u},function(t,e,n){(function(t){function r(t){return(r="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t})(t)}var i=n(25),o=n(524),a="object"==r(e)&&e&&!e.nodeType&&e,s=a&&"object"==r(t)&&t&&!t.nodeType&&t,u=s&&s.exports===a?i.Buffer:void 0,c=(u?u.isBuffer:void 0)||o;t.exports=c}).call(this,n(60)(t))},function(t,e){t.exports=function(t){return"number"==typeof t&&-1<t&&t%1==0&&t<=9007199254740991}},function(t,e){t.exports=function(t){return function(e){return t(e)}}},function(t,e,n){(function(t){function r(t){return(r="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t})(t)}var i=n(212),o="object"==r(e)&&e&&!e.nodeType&&e,a=o&&"object"==r(t)&&t&&!t.nodeType&&t,s=a&&a.exports===o&&i.process,u=function(){try{return a&&a.require&&a.require("util").types||s&&s.binding&&s.binding("util")}catch(t){}}();t.exports=u}).call(this,n(60)(t))},function(t,e){var n=Object.prototype;t.exports=function(t){var e=t&&t.constructor;return t===("function"==typeof e&&e.prototype||n)}},function(t,e,n){var r=n(211),i=n(142);t.exports=function(t){return null!=t&&i(t.length)&&!r(t)}},function(t,e,n){var r=n(534),i=n(223),o=Object.prototype.propertyIsEnumerable,a=Object.getOwnPropertySymbols,s=a?function(t){return null==t?[]:(t=Object(t),r(a(t),function(e){return o.call(t,e)}))}:i;t.exports=s},function(t,e){t.exports=function(t,e){for(var n=-1,r=e.length,i=t.length;++n<r;)t[i+n]=e[n];return t}},function(t,e,n){var r=n(221)(Object.getPrototypeOf,Object);t.exports=r},function(t,e,n){var r=n(228);t.exports=function(t){var e=new t.constructor(t.byteLength);return new r(e).set(new r(t)),e}},function(t,e,n){var r=n(553),i=n(234),o=i.tokenize;t.exports={tokenize:o,stem:i,Extractor:r,extractor:function(t){return new r(t)}}},function(t,e){t.exports=function(t){return t}},function(t,e,n){var r=n(563),i=n(39);t.exports=function t(e,n,o,a,s){return e===n||(null==e||null==n||!i(e)&&!i(n)?e!=e&&n!=n:r(e,n,o,a,t,s))}},function(t,e,n){var r=n(97),i=n(71);t.exports=function(t,e){for(var n=0,o=(e=r(e,t)).length;null!=t&&n<o;)t=t[i(e[n++])];return n&&n==o?t:void 0}},function(t,e,n){function r(t){return(r="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t})(t)}var i=n(26),o=n(70),a=/\.|\[(?:[^[\]]*|(["'])(?:(?!\1)[^\\]|\\.)*?\1)\]/,s=/^\w*$/;t.exports=function(t,e){if(i(t))return!1;var n=r(t);return!("number"!=n&&"symbol"!=n&&"boolean"!=n&&null!=t&&!o(t))||s.test(t)||!a.test(t)||null!=e&&t in Object(e)}},function(t,e,n){"use strict";Object.defineProperty(e,"__esModule",{value:!0});var r=function(){function t(t,e){for(var n=0;n<e.length;n++){var r=e[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(t,r.key,r)}}return function(e,n,r){return n&&t(e.prototype,n),r&&t(e,r),e}}(),i=d(n(238)),o=d(n(99)),a=d(n(239)),s=d(n(240)),u=d(n(241)),c=d(n(243)),l=d(n(157)),f=d(n(72)),h=d(n(244)),p=n(245);function d(t){return t&&t.__esModule?t:{default:t}}var y=function(){function t(){var e=0<arguments.length&&void 0!==arguments[0]?arguments[0]:{};!function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,t),Object.assign(this,this.constructor.defaults,e),this.trainOpts={},this.updateTrainingOptions(Object.assign({},this.constructor.trainDefaults,e)),this.sizes=null,this.outputLayer=null,this.biases=null,this.weights=null,this.outputs=null,this.deltas=null,this.changes=null,this.errors=null,this.errorCheckInterval=1,this.constructor.prototype.hasOwnProperty("runInput")||(this.runInput=null),this.constructor.prototype.hasOwnProperty("calculateDeltas")||(this.calculateDeltas=null),this.inputLookup=null,this.inputLookupLength=null,this.outputLookup=null,this.outputLookupLength=null}return r(t,null,[{key:"trainDefaults",get:function(){return{iterations:2e4,errorThresh:.005,log:!1,logPeriod:10,learningRate:.3,momentum:.1,callback:null,callbackPeriod:10,timeout:1/0,praxis:null,beta1:.9,beta2:.999,epsilon:1e-8}}},{key:"defaults",get:function(){return{leakyReluAlpha:.01,binaryThresh:.5,hiddenLayers:null,activation:"sigmoid"}}}]),r(t,[{key:"initialize",value:function(){if(!this.sizes)throw new Error("Sizes must be set before initializing");this.outputLayer=this.sizes.length-1,this.biases=[],this.weights=[],this.outputs=[],this.deltas=[],this.changes=[],this.errors=[];for(var t=0;t<=this.outputLayer;t++){var e=this.sizes[t];if(this.deltas[t]=(0,f.default)(e),this.errors[t]=(0,f.default)(e),this.outputs[t]=(0,f.default)(e),0<t){this.biases[t]=(0,u.default)(e),this.weights[t]=new Array(e),this.changes[t]=new Array(e);for(var n=0;n<e;n++){var r=this.sizes[t-1];this.weights[t][n]=(0,u.default)(r),this.changes[t][n]=(0,f.default)(r)}}}this.setActivation(),"adam"===this.trainOpts.praxis&&this._setupAdam()}},{key:"setActivation",value:function(t){switch(this.activation=t||this.activation,this.activation){case"sigmoid":this.runInput=this.runInput||this._runInputSigmoid,this.calculateDeltas=this.calculateDeltas||this._calculateDeltasSigmoid;break;case"relu":this.runInput=this.runInput||this._runInputRelu,this.calculateDeltas=this.calculateDeltas||this._calculateDeltasRelu;break;case"leaky-relu":this.runInput=this.runInput||this._runInputLeakyRelu,this.calculateDeltas=this.calculateDeltas||this._calculateDeltasLeakyRelu;break;case"tanh":this.runInput=this.runInput||this._runInputTanh,this.calculateDeltas=this.calculateDeltas||this._calculateDeltasTanh;break;default:throw new Error("unknown activation "+this.activation+", The activation should be one of ['sigmoid', 'relu', 'leaky-relu', 'tanh']")}}},{key:"run",value:function(t){if(!this.isRunnable)return null;this.inputLookup&&(t=o.default.toArray(this.inputLookup,t,this.inputLookupLength));var e=this.runInput(t).slice(0);return this.outputLookup&&(e=o.default.toObject(this.outputLookup,e)),e}},{key:"_runInputSigmoid",value:function(t){this.outputs[0]=t;for(var e=null,n=1;n<=this.outputLayer;n++){for(var r=0;r<this.sizes[n];r++){for(var i=this.weights[n][r],o=this.biases[n][r],a=0;a<i.length;a++)o+=i[a]*t[a];this.outputs[n][r]=1/(1+Math.exp(-o))}e=t=this.outputs[n]}return e}},{key:"_runInputRelu",value:function(t){this.outputs[0]=t;for(var e=null,n=1;n<=this.outputLayer;n++){for(var r=0;r<this.sizes[n];r++){for(var i=this.weights[n][r],o=this.biases[n][r],a=0;a<i.length;a++)o+=i[a]*t[a];this.outputs[n][r]=o<0?0:o}e=t=this.outputs[n]}return e}},{key:"_runInputLeakyRelu",value:function(t){this.outputs[0]=t;for(var e=this.leakyReluAlpha,n=null,r=1;r<=this.outputLayer;r++){for(var i=0;i<this.sizes[r];i++){for(var o=this.weights[r][i],a=this.biases[r][i],s=0;s<o.length;s++)a+=o[s]*t[s];this.outputs[r][i]=a<0?0:e*a}n=t=this.outputs[r]}return n}},{key:"_runInputTanh",value:function(t){this.outputs[0]=t;for(var e=null,n=1;n<=this.outputLayer;n++){for(var r=0;r<this.sizes[n];r++){for(var i=this.weights[n][r],o=this.biases[n][r],a=0;a<i.length;a++)o+=i[a]*t[a];this.outputs[n][r]=Math.tanh(o)}e=t=this.outputs[n]}return e}},{key:"verifyIsInitialized",value:function(t){var e=this;this.sizes||(this.sizes=[],this.sizes.push(t[0].input.length),this.hiddenLayers?this.hiddenLayers.forEach(function(t){e.sizes.push(t)}):this.sizes.push(Math.max(3,Math.floor(t[0].input.length/2))),this.sizes.push(t[0].output.length),this.initialize())}},{key:"updateTrainingOptions",value:function(t){var e=this.constructor.trainDefaults;for(var n in e)e.hasOwnProperty(n)&&(this.trainOpts[n]=t.hasOwnProperty(n)?t[n]:e[n]);this.validateTrainingOptions(this.trainOpts),this.setLogMethod(t.log||this.trainOpts.log),this.activation=t.activation||this.activation}},{key:"validateTrainingOptions",value:function(t){var e={iterations:function(t){return"number"==typeof t&&0<t},errorThresh:function(t){return"number"==typeof t&&0<t&&t<1},log:function(t){return"function"==typeof t||"boolean"==typeof t},logPeriod:function(t){return"number"==typeof t&&0<t},learningRate:function(t){return"number"==typeof t&&0<t&&t<1},momentum:function(t){return"number"==typeof t&&0<t&&t<1},callback:function(t){return"function"==typeof t||null===t},callbackPeriod:function(t){return"number"==typeof t&&0<t},timeout:function(t){return"number"==typeof t&&0<t}};for(var n in e)if(e.hasOwnProperty(n)&&t.hasOwnProperty(n)&&!e[n](t[n]))throw new Error("["+n+", "+t[n]+"] is out of normal training range, your network will probably not train.")}},{key:"getTrainOptsJSON",value:function(){var t=this;return Object.keys(this.constructor.trainDefaults).reduce(function(e,n){return"timeout"===n&&t.trainOpts[n]===1/0||"callback"===n||(t.trainOpts[n]&&(e[n]=t.trainOpts[n]),"log"===n&&(e.log="function"==typeof e.log)),e},{})}},{key:"setLogMethod",value:function(t){this.trainOpts.log="function"==typeof t?t:!!t&&console.log}},{key:"calculateTrainingError",value:function(t){for(var e=0,n=0;n<t.length;++n)e+=this.trainPattern(t[n],!0);return e/t.length}},{key:"trainPatterns",value:function(t){for(var e=0;e<t.length;++e)this.trainPattern(t[e])}},{key:"trainingTick",value:function(t,e,n){return!(e.iterations>=this.trainOpts.iterations||e.error<=this.trainOpts.errorThresh||Date.now()>=n||(e.iterations++,this.trainOpts.log&&e.iterations%this.trainOpts.logPeriod==0?(e.error=this.calculateTrainingError(t),this.trainOpts.log("iterations: "+e.iterations+", training error: "+e.error)):e.iterations%this.errorCheckInterval==0?e.error=this.calculateTrainingError(t):this.trainPatterns(t),this.trainOpts.callback&&e.iterations%this.trainOpts.callbackPeriod==0&&this.trainOpts.callback({iterations:e.iterations,error:e.error}),0))}},{key:"prepTraining",value:function(t,e){this.updateTrainingOptions(e),t=this.formatData(t);var n=Date.now()+this.trainOpts.timeout;return this.verifyIsInitialized(t),{data:t,status:{error:1,iterations:0},endTime:n}}},{key:"train",value:function(t){var e,n,r=1<arguments.length&&void 0!==arguments[1]?arguments[1]:{},i=this.prepTraining(t,r);for(t=i.data,e=i.status,n=i.endTime;this.trainingTick(t,e,n););return e}},{key:"trainAsync",value:function(t){var e,n,r=this,o=1<arguments.length&&void 0!==arguments[1]?arguments[1]:{},a=this.prepTraining(t,o);return t=a.data,e=a.status,n=a.endTime,new Promise(function(o,a){try{var s=new i.default(new Array(r.trainOpts.iterations),{delay:!0,each:function(){return r.trainingTick(t,e,n)||s.stop()},done:function(){return o(e)}});s.tick()}catch(o){a({trainError:o,status:e})}})}},{key:"trainPattern",value:function(t,e){return this.runInput(t.input),this.calculateDeltas(t.output),this.adjustWeights(),e?(0,s.default)(this.errors[this.outputLayer]):null}},{key:"_calculateDeltasSigmoid",value:function(t){for(var e=this.outputLayer;0<=e;e--)for(var n=0;n<this.sizes[e];n++){var r=this.outputs[e][n],i=0;if(e===this.outputLayer)i=t[n]-r;else for(var o=this.deltas[e+1],a=0;a<o.length;a++)i+=o[a]*this.weights[e+1][a][n];this.errors[e][n]=i,this.deltas[e][n]=i*r*(1-r)}}},{key:"_calculateDeltasRelu",value:function(t){for(var e=this.outputLayer;0<=e;e--)for(var n=0;n<this.sizes[e];n++){var r=this.outputs[e][n],i=0;if(e===this.outputLayer)i=t[n]-r;else for(var o=this.deltas[e+1],a=0;a<o.length;a++)i+=o[a]*this.weights[e+1][a][n];this.errors[e][n]=i,this.deltas[e][n]=0<r?i:0}}},{key:"_calculateDeltasLeakyRelu",value:function(t){for(var e=this.leakyReluAlpha,n=this.outputLayer;0<=n;n--)for(var r=0;r<this.sizes[n];r++){var i=this.outputs[n][r],o=0;if(n===this.outputLayer)o=t[r]-i;else for(var a=this.deltas[n+1],s=0;s<a.length;s++)o+=a[s]*this.weights[n+1][s][r];this.errors[n][r]=o,this.deltas[n][r]=0<i?o:e*o}}},{key:"_calculateDeltasTanh",value:function(t){for(var e=this.outputLayer;0<=e;e--)for(var n=0;n<this.sizes[e];n++){var r=this.outputs[e][n],i=0;if(e===this.outputLayer)i=t[n]-r;else for(var o=this.deltas[e+1],a=0;a<o.length;a++)i+=o[a]*this.weights[e+1][a][n];this.errors[e][n]=i,this.deltas[e][n]=(1-r*r)*i}}},{key:"adjustWeights",value:function(){for(var t=1;t<=this.outputLayer;t++)for(var e=this.outputs[t-1],n=0;n<this.sizes[t];n++){for(var r=this.deltas[t][n],i=0;i<e.length;i++){var o=this.changes[t][n][i];o=this.trainOpts.learningRate*r*e[i]+this.trainOpts.momentum*o,this.changes[t][n][i]=o,this.weights[t][n][i]+=o}this.biases[t][n]+=this.trainOpts.learningRate*r}}},{key:"_setupAdam",value:function(){this.biasChangesLow=[],this.biasChangesHigh=[],this.changesLow=[],this.changesHigh=[];for(var t=this.iterations=0;t<=this.outputLayer;t++){var e=this.sizes[t];if(0<t){this.biasChangesLow[t]=(0,f.default)(e),this.biasChangesHigh[t]=(0,f.default)(e),this.changesLow[t]=new Array(e),this.changesHigh[t]=new Array(e);for(var n=0;n<e;n++){var r=this.sizes[t-1];this.changesLow[t][n]=(0,f.default)(r),this.changesHigh[t][n]=(0,f.default)(r)}}}this.adjustWeights=this._adjustWeightsAdam}},{key:"_adjustWeightsAdam",value:function(){var t=this.trainOpts;this.iterations++;for(var e=1;e<=this.outputLayer;e++)for(var n=this.outputs[e-1],r=0;r<this.sizes[e];r++){for(var i=this.deltas[e][r],o=0;o<n.length;o++){var a=i*n[o],s=this.changesLow[e][r][o]*t.beta1+(1-t.beta1)*a,u=this.changesHigh[e][r][o]*t.beta2+(1-t.beta2)*a*a,c=s/(1-Math.pow(t.beta1,this.iterations)),l=u/(1-Math.pow(t.beta2,this.iterations));this.changesLow[e][r][o]=s,this.changesHigh[e][r][o]=u,this.weights[e][r][o]+=this.trainOpts.learningRate*c/(Math.sqrt(l)+t.epsilon)}var f=this.deltas[e][r],h=this.biasChangesLow[e][r]*t.beta1+(1-t.beta1)*f,p=this.biasChangesHigh[e][r]*t.beta2+(1-t.beta2)*f*f,d=this.biasChangesLow[e][r]/(1-Math.pow(t.beta1,this.iterations)),y=this.biasChangesHigh[e][r]/(1-Math.pow(t.beta2,this.iterations));this.biasChangesLow[e][r]=h,this.biasChangesHigh[e][r]=p,this.biases[e][r]+=t.learningRate*d/(Math.sqrt(y)+t.epsilon)}}},{key:"formatData",value:function(t){if(Array.isArray(t)||(t=[t]),!Array.isArray(t[0].input))if(this.inputLookup)this.inputLookupLength=Object.keys(this.inputLookup).length;else{var e=new h.default(t,"input");this.inputLookup=e.table,this.inputLookupLength=e.length}if(!Array.isArray(t[0].output))if(this.outputLookup)this.outputLookupLength=Object.keys(this.outputLookup).length;else{var n=new h.default(t,"output");this.outputLookup=n.table,this.outputLookupLength=n.length}if(void 0===this._formatInput&&(this._formatInput=v(t[0].input,this.inputLookup),this._formatOutput=v(t[0].output,this.outputLookup)),this._formatInput&&this._formatOutput){for(var r=[],i=0;i<t.length;i++)r.push({input:this._formatInput(t[i].input),output:this._formatOutput(t[i].output)});return r}if(this._formatInput){for(var o=[],a=0;a<t.length;a++)o.push({input:this._formatInput(t[a].input),output:t[a].output});return o}if(this._formatOutput){for(var s=[],u=0;u<t.length;u++)s.push({input:t[u].input,output:this._formatOutput(t[u].output)});return s}return t}},{key:"addFormat",value:function(t){this.inputLookup=o.default.addKeys(t.input,this.inputLookup),this.inputLookup&&(this.inputLookupLength=Object.keys(this.inputLookup).length),this.outputLookup=o.default.addKeys(t.output,this.outputLookup),this.outputLookup&&(this.outputLookupLength=Object.keys(this.outputLookup).length)}},{key:"test",value:function(t){var e=this,n=1===(t=this.formatData(t))[0].output.length,r=[],i=0;if(n){for(var o=0,u=0,c=0,l=0,f=function(n){var a=e.runInput(t[n].input),f=t[n].output,h=a[0]>e.binaryThresh?1:0,p=f[0];if(h!==p){var d=t[n];r.push({input:d.input,output:d.output,actual:h,expected:p})}0===h&&0===p?l++:1===h&&1===p?c++:0===h&&1===p?u++:1===h&&0===p&&o++,i+=(0,s.default)(a.map(function(t,e){return f[e]-t}))},h=0;h<t.length;h++)f(h);return{error:i/t.length,misclasses:r,total:t.length,trueNeg:l,truePos:c,falseNeg:u,falsePos:o,precision:0<c?c/(c+o):0,recall:0<c?c/(c+u):0,accuracy:(l+c)/t.length}}var p=function(n){var o=e.runInput(t[n].input),u=t[n].output,c=o.indexOf((0,a.default)(o)),l=u.indexOf((0,a.default)(u));if(c!==l){var f=t[n];r.push({input:f.input,output:f.output,actual:c,expected:l})}i+=(0,s.default)(o.map(function(t,e){return u[e]-t}))};for(h=0;h<t.length;h++)p(h);return{error:i/t.length,misclasses:r,total:t.length}}},{key:"toJSON",value:function(){for(var t=[],e=0;e<=this.outputLayer;e++){t[e]={};var n;n=0===e&&this.inputLookup?Object.keys(this.inputLookup):this.outputLookup&&e===this.outputLayer?Object.keys(this.outputLookup):(0,c.default)(0,this.sizes[e]);for(var r=0;r<n.length;r++){var i=n[r];if(t[e][i]={},0<e)for(var o in t[e][i].bias=this.biases[e][r],t[e][i].weights={},t[e-1]){var a=o;1===e&&this.inputLookup&&(a=this.inputLookup[o]),t[e][i].weights[o]=this.weights[e][r][a]}}}return{sizes:this.sizes.slice(0),layers:t,outputLookup:null!==this.outputLookup,inputLookup:null!==this.inputLookup,activation:this.activation,trainOpts:this.getTrainOptsJSON()}}},{key:"fromJSON",value:function(t){Object.assign(this,this.constructor.defaults,t),this.sizes=t.sizes,this.initialize();for(var e=0;e<=this.outputLayer;e++){var n=t.layers[e];if(0!==e||n[0]&&!t.inputLookup?e!==this.outputLayer||n[0]&&!t.outputLookup||(this.outputLookup=o.default.toHash(n)):(this.inputLookup=o.default.toHash(n),this.inputLookupLength=Object.keys(this.inputLookup).length),0<e){var r=Object.keys(n);for(var i in this.sizes[e]=r.length,r){var a=r[i];this.biases[e][i]=n[a].bias,this.weights[e][i]=(0,l.default)(n[a].weights)}}}return t.hasOwnProperty("trainOpts")&&this.updateTrainingOptions(t.trainOpts),this}},{key:"toFunction",value:function(){var t=this.activation,e=this.leakyReluAlpha,n=!1;function r(i,o,a){if(0===o)return"string"==typeof a?"input['"+a+"']":"input["+a+"]";var s=i[o][a],u=["(",s.bias];for(var c in s.weights)s.weights[c]<0?u.push(s.weights[c]+"*"+r(i,o-1,c)):u.push("+"+s.weights[c]+"*"+r(i,o-1,c));switch(u.push(")"),t){case"sigmoid":return"1/(1+1/Math.exp("+u.join("")+"))";case"relu":return n=!0,"((v="+u.join("")+")<0?0:v)";case"leaky-relu":return n=!0,"((v="+u.join("")+")<0?0:"+e+"*v)";case"tanh":return"Math.tanh("+u.join("")+")";default:throw new Error("unknown activation type "+t)}}var i,o=this.toJSON().layers,a=[];for(var s in o[o.length-1])a.push(r(o,o.length-1,s));return i=this.outputLookup?"{"+Object.keys(this.outputLookup).map(function(t,e){return"'"+t+"':"+a[e]})+"}":"["+a.join(",")+"]",new Function("input",(n?"var v;":"")+"return "+i+";")}},{key:"isRunnable",get:function(){var t=this;if(!this.runInput)return console.error("Activation function has not been initialized, did you run train()?"),!1;var e=["sizes","outputLayer","biases","weights","outputs","deltas","changes","errors"].filter(function(e){return null===t[e]});return!(0<e.length&&(console.error("Some settings have not been initialized correctly, did you run train()? Found issues with: "+e.join(", ")),1))}}]),t}();function v(t,e){if(t.buffer instanceof ArrayBuffer)return null;if(Array.isArray(t))return p.arrayToFloat32Array;var n=Object.keys(e).length;return function(t){var r=new Float32Array(n);for(var i in e)r[e[i]]=t[i]||0;return r}}e.default=y},function(t,e,n){"use strict";Object.defineProperty(e,"__esModule",{value:!0}),e.default=function(t){if(Array.isArray(t))return t;var e=Object.keys(t),n=new Float32Array(e.length);for(var r in e)n[r]=t[e[r]];return n}},function(t,e,n){"use strict";var r=function(){function t(t,e){for(var n=0;n<e.length;n++){var r=e[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(t,r.key,r)}}return function(e,n,r){return n&&t(e.prototype,n),r&&t(e,r),e}}(),i=n(10),o=n(159);t.exports=function(){function t(e,n){!function(e,n){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this),n=n||{},this.kernel=n.kernel,this.canvas=n.canvas,this.webGl=n.webGl,this.fn=null,this.functionBuilder=e,this.fnString=null,this.endianness=i.systemEndianness()}return r(t,[{key:"textureToArray",value:function(t){return this.createKernel(function(t){return t[this.thread.z][this.thread.y][this.thread.x]})(t)}},{key:"deleteTexture",value:function(t){this.webGl.deleteTexture(t.texture)}},{key:"buildPromiseKernel",value:function(){throw new Error("not yet implemented")}},{key:"getMode",value:function(){throw new Error('"mode" not implemented on BaseRunner')}},{key:"buildKernel",value:function(t,e){e=Object.assign({},e||{});var n=t.toString();return e.functionBuilder||(e.functionBuilder=this.functionBuilder),e.canvas||(e.canvas=this.canvas),e.webGl||(e.webGl=this.webgl),o(new this.Kernel(n,e))}}]),t}()},function(t,e,n){"use strict";var r=n(10);t.exports=function(t){var e=function(){return t.run.apply(t,arguments)};return r.allPropertiesOf(t).forEach(function(n){"_"===n[0]&&"_"===n[1]||("function"==typeof t[n]?e[n]="add"===n.substring(0,3)||"set"===n.substring(0,3)?function(){return t[n].apply(t,arguments),e}:t[n].bind(t):(e.__defineGetter__(n,function(){return t[n]}),e.__defineSetter__(n,function(e){t[n]=e})))}),e.kernel=t,e}},function(t,e,n){"use strict";var r=function(){function t(t,e){for(var n=0;n<e.length;n++){var r=e[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(t,r.key,r)}}return function(e,n,r){return n&&t(e.prototype,n),r&&t(e,r),e}}();t.exports=function(){function t(e){!function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,t),this.nodeMap={},this.nativeFunctions={},this.gpu=e,this.rootKernel=null,this.Node=null}return r(t,[{key:"addNativeFunction",value:function(t,e){this.nativeFunctions[t]=e}},{key:"addFunction",value:function(t,e,n){this.addFunctionNode(new this.Node(t,e,n).setBuilder(this))}},{key:"addFunctions",value:function(t,e){if(t)if(Array.isArray(t))for(var n=0;n<t.length;n++)this.addFunction(null,t[n],e);else for(var r in t)this.addFunction(r,t[r],e)}},{key:"addNativeFunctions",value:function(t){for(var e in t)t.hasOwnProperty(e)&&this.addNativeFunction(e,t[e])}},{key:"addFunctionNode",value:function(t){(this.nodeMap[t.functionName]=t).isRootKernel&&(this.rootKernel=t)}},{key:"traceFunctionCalls",value:function(t,e,n){t=t||"kernel",e=e||[];var r=this.nodeMap[t];if(r){var i=e.indexOf(t);if(-1===i){e.push(t),n&&(r.parent=n),r.getFunctionString();for(var o=0;o<r.calledFunctions.length;++o)this.traceFunctionCalls(r.calledFunctions[o],e,r)}else{var a=e.splice(i,1)[0];e.push(a)}}return this.nativeFunctions[t]&&(0<=e.indexOf(t)||e.push(t)),e}},{key:"addKernel",value:function(t,e){var n=new this.Node("kernel",t,e);return n.setBuilder(this),n.isRootKernel=!0,this.addFunctionNode(n),n}},{key:"addSubKernel",value:function(t,e){var n=new this.Node(null,t,e);return n.setBuilder(this),n.isSubKernel=!0,this.addFunctionNode(n),n}},{key:"getPrototypeString",value:function(t){return this.getPrototypes(t).join("\n")}},{key:"getPrototypes",value:function(t){return this.rootKernel.generate(),t?this.getPrototypesFromFunctionNames(this.traceFunctionCalls(t,[]).reverse()):this.getPrototypesFromFunctionNames(Object.keys(this.nodeMap))}},{key:"getStringFromFunctionNames",value:function(t){for(var e=[],n=0;n<t.length;++n)this.nodeMap[t[n]]&&e.push(this.nodeMap[t[n]].getFunctionString());return e.join("\n")}},{key:"getPrototypesFromFunctionNames",value:function(t,e){for(var n=[],r=0;r<t.length;++r){var i=t[r],o=this.nodeMap[i];o?n.push(o.getFunctionPrototypeString(e)):this.nativeFunctions[i]&&n.push(this.nativeFunctions[i])}return n}},{key:"getPrototypeStringFromFunctionNames",value:function(t,e){return this.getPrototypesFromFunctionNames(t,e).toString()}},{key:"getString",value:function(t,e){return void 0===e&&(e={}),t?this.getStringFromFunctionNames(this.traceFunctionCalls(t,[],e).reverse(),e):this.getStringFromFunctionNames(Object.keys(this.nodeMap),e)}}]),t}()},function(t,e,n){"use strict";function r(t){return(r="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t})(t)}var i=function(){function t(t,e){for(var n=0;n<e.length;n++){var r=e[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(t,r.key,r)}}return function(e,n,r){return n&&t(e.prototype,n),r&&t(e,r),e}}(),o=n(250),a=n(10),s="this.constants.",u=/decode32\(\s+encode32\(/g,c=/encode32\(\s+decode32\(/g;t.exports=function(t){function e(){return function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,e),function(t,e){if(!t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!e||"object"!==r(e)&&"function"!=typeof e?t:e}(this,(e.__proto__||Object.getPrototypeOf(e)).apply(this,arguments))}return function(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function, not "+r(e));t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,enumerable:!1,writable:!0,configurable:!0}}),e&&(Object.setPrototypeOf?Object.setPrototypeOf(t,e):t.__proto__=e)}(e,o),i(e,[{key:"generate",value:function(){return this.debug,this.prototypeOnly?this.astFunctionPrototype(this.getJsAST(),[]).join("").trim():(this.functionStringArray=this.astGeneric(this.getJsAST(),[]),this.functionString=this.functionStringArray.join("").trim().replace(u,"((").replace(c,"(("),this.functionString)}},{key:"astFunctionDeclaration",value:function(t,e){return this.builder.addFunction(null,a.getAstString(this.jsFunctionString,t)),e}},{key:"astFunctionPrototype",value:function(t,e){if(this.isRootKernel||this.isSubKernel)return e;var n=this.returnType,r=l[n];if(!r)throw new Error("unknown type "+n);e.push(r),e.push(" "),e.push(this.functionName),e.push("(");for(var i=0;i<this.paramNames.length;++i)0<i&&e.push(", "),e.push(this.paramTypes[i]),e.push(" "),e.push("user_"),e.push(this.paramNames[i]);return e.push(");\n"),e}},{key:"astFunctionExpression",value:function(t,e){if(this.isRootKernel)e.push("void");else{var n=this.returnType,r=l[n];if(!r)throw new Error("unknown type "+n);e.push(r)}if(e.push(" "),e.push(this.functionName),e.push("("),!this.isRootKernel)for(var i=0;i<this.paramNames.length;++i){var o=this.paramNames[i];0<i&&e.push(", ");var a=this.getParamType(o),s=l[a];if(!s)throw new Error("unknown type "+a);e.push(s),e.push(" "),e.push("user_"),e.push(o)}e.push(") {\n");for(var u=0;u<t.body.body.length;++u)this.astGeneric(t.body.body[u],e),e.push("\n");return e.push("}\n"),e}},{key:"astReturnStatement",value:function(t,e){return this.isRootKernel?(e.push("kernelResult = "),this.astGeneric(t.argument,e),e.push(";"),e.push("return;")):this.isSubKernel?(e.push(this.functionName+"Result = "),this.astGeneric(t.argument,e),e.push(";"),e.push("return "+this.functionName+"Result;")):(e.push("return "),this.astGeneric(t.argument,e),e.push(";")),e}},{key:"astLiteral",value:function(t,e){if(isNaN(t.value))throw this.astErrorOutput("Non-numeric literal not supported : "+t.value,t);e.push(t.value);var n=this.isState("in-get-call-parameters");return Number.isInteger(t.value)?n||e.push(".0"):n&&(e.pop(),e.push("int("),e.push(t.value),e.push(")")),e}},{key:"astBinaryExpression",value:function(t,e){var n=this.isState("in-get-call-parameters");return n&&(this.pushState("not-in-get-call-parameters"),e.push("int")),e.push("("),"%"===t.operator?(e.push("mod("),this.astGeneric(t.left,e),e.push(","),this.astGeneric(t.right,e),e.push(")")):"==="===t.operator?(this.astGeneric(t.left,e),e.push("=="),this.astGeneric(t.right,e)):"!=="===t.operator?(this.astGeneric(t.left,e),e.push("!="),this.astGeneric(t.right,e)):this.fixIntegerDivisionAccuracy&&"/"===t.operator?(e.push("div_with_int_check("),this.astGeneric(t.left,e),e.push(", "),this.astGeneric(t.right,e),e.push(")")):(this.astGeneric(t.left,e),e.push(t.operator),this.astGeneric(t.right,e)),e.push(")"),n&&this.popState("not-in-get-call-parameters"),e}},{key:"astIdentifierExpression",value:function(t,e){if("Identifier"!==t.type)throw this.astErrorOutput("IdentifierExpression - not an Identifier",t);var n=!this.isState("in-get-call-parameters");switch(t.name){case"gpu_threadX":n&&e.push("float("),e.push("threadId.x"),n&&e.push(")");break;case"gpu_threadY":n&&e.push("float("),e.push("threadId.y"),n&&e.push(")");break;case"gpu_threadZ":n&&e.push("float("),e.push("threadId.z"),n&&e.push(")");break;case"gpu_outputX":e.push("uOutputDim.x");break;case"gpu_outputY":e.push("uOutputDim.y");break;case"gpu_outputZ":e.push("uOutputDim.z");break;case"Infinity":e.push("3.402823466e+38");break;default:var r=this.getUserParamName(t.name);null!==r?this.pushParameter(e,"user_"+r):this.pushParameter(e,"user_"+t.name)}return e}},{key:"astForStatement",value:function(t,e){if("ForStatement"!==t.type)throw this.astErrorOutput("Invalid for statment",t);if(t.test&&"BinaryExpression"===t.test.type){if("Identifier"===t.test.right.type&&"<"===t.test.operator&&!1===this.isIdentifierConstant(t.test.right.name)){if(this.loopMaxIterations||(console.warn("Warning: loopMaxIterations is not set! Using default of 1000 which may result in unintended behavior."),console.warn("Set loopMaxIterations or use a for loop of fixed length to silence this message.")),e.push("for ("),this.astGeneric(t.init,e),this.astGeneric(t.test.left,e),e.push(t.test.operator),e.push("LOOP_MAX"),e.push(";"),this.astGeneric(t.update,e),e.push(")"),e.push("{\n"),e.push("if ("),this.astGeneric(t.test.left,e),e.push(t.test.operator),this.astGeneric(t.test.right,e),e.push(") {\n"),"BlockStatement"===t.body.type)for(var n=0;n<t.body.body.length;n++)this.astGeneric(t.body.body[n],e);else this.astGeneric(t.body,e);return e.push("\n} else {\n"),e.push("break;\n"),e.push("}\n"),e.push("}\n"),e}var r=JSON.parse(JSON.stringify(t.init.declarations)),i=t.update.argument;if(!Array.isArray(r)||r.length<1)throw this.jsFunctionString,new Error("Error: Incompatible for loop declaration");if(1<r.length){for(var o=null,a=0;a<r.length;a++){var s=r[a];s.id.name===i.name?(o=s,r.splice(a,1)):(e.push("float "),this.astGeneric(s,e),e.push(";"))}e.push("for (float "),this.astGeneric(o,e),e.push(";")}else e.push("for ("),this.astGeneric(t.init,e);return this.astGeneric(t.test,e),e.push(";"),this.astGeneric(t.update,e),e.push(")"),this.astGeneric(t.body,e),e}throw this.astErrorOutput("Invalid for statement",t)}},{key:"astWhileStatement",value:function(t,e){if("WhileStatement"!==t.type)throw this.astErrorOutput("Invalid while statment",t);return e.push("for (float i = 0.0; i < LOOP_MAX; i++) {"),e.push("if ("),this.astGeneric(t.test,e),e.push(") {\n"),this.astGeneric(t.body,e),e.push("} else {\n"),e.push("break;\n"),e.push("}\n"),e.push("}\n"),e}},{key:"astDoWhileStatement",value:function(t,e){if("DoWhileStatement"!==t.type)throw this.astErrorOutput("Invalid while statment",t);return e.push("for (float i = 0.0; i < LOOP_MAX; i++) {"),this.astGeneric(t.body,e),e.push("if (!"),this.astGeneric(t.test,e),e.push(") {\n"),e.push("break;\n"),e.push("}\n"),e.push("}\n"),e}},{key:"astAssignmentExpression",value:function(t,e){if("%="!==t.operator)return this.astGeneric(t.left,e),e.push(t.operator),this.astGeneric(t.right,e),e;this.astGeneric(t.left,e),e.push("="),e.push("mod("),this.astGeneric(t.left,e),e.push(","),this.astGeneric(t.right,e),e.push(")")}},{key:"astEmptyStatement",value:function(t,e){return e}},{key:"astBlockStatement",value:function(t,e){e.push("{\n");for(var n=0;n<t.body.length;n++)this.astGeneric(t.body[n],e);return e.push("}\n"),e}},{key:"astExpressionStatement",value:function(t,e){return this.astGeneric(t.expression,e),e.push(";"),e}},{key:"astVariableDeclaration",value:function(t,e){for(var n=0;n<t.declarations.length;n++){var r=t.declarations[n];0<n&&e.push(",");var i=[];this.astGeneric(r,i);var o="Number";if(0===n){var a=r.init;if(a)if(a.object){if("MemberExpression"===a.object.type&&a.object.object)if("ThisExpression"!==a.object.object.type||!a.object.property||"thread"!==a.object.property.name&&"output"!==a.object.property.name){if("Identifier"===a.object.object.type){var s=this.getParamType(a.object.object.name);o=f[s]}else if(a.object.object.object&&"Identifier"===a.object.object.object.type){var u=this.getParamType(a.object.object.object.name);o=f[u]}else if(a.object.object.object&&a.object.object.object.object&&"ThisExpression"===a.object.object.object.object.type&&"constants"===a.object.object.object.property.name){var c=this.getConstantType(a.object.object.property.name);o=f[c]}else if(a.object.object.object&&a.object.object.object.object&&a.object.object.object.object.object&&"ThisExpression"===a.object.object.object.object.object.type&&"constants"===a.object.object.object.object.property.name){var h=this.getConstantType(a.object.object.object.property.name);o=f[h]}}else o="Integer";if(!o)throw new Error("unknown lookup type "+f)}else if(a.name&&this.declarations[a.name])o=this.declarations[a.name];else if("ArrayExpression"===a.type)o="Array("+a.elements.length+")";else if("CallExpression"===a.type){var p=this.builder.nodeMap[a.callee.name];p&&p.returnType&&(o=p.returnType)}var d=l[o];if(!d)throw new Error("type "+o+" not handled");e.push(d+" ")}this.declarations[r.id.name]=o,e.push.apply(e,i)}return e.push(";"),e}},{key:"astVariableDeclarator",value:function(t,e){return this.astGeneric(t.id,e),null!==t.init&&(e.push("="),this.astGeneric(t.init,e)),e}},{key:"astIfStatement",value:function(t,e){return e.push("if ("),this.astGeneric(t.test,e),e.push(")"),"BlockStatement"===t.consequent.type?this.astGeneric(t.consequent,e):(e.push(" {\n"),this.astGeneric(t.consequent,e),e.push("\n}\n")),t.alternate&&(e.push("else "),"BlockStatement"===t.alternate.type?this.astGeneric(t.alternate,e):(e.push(" {\n"),this.astGeneric(t.alternate,e),e.push("\n}\n"))),e}},{key:"astBreakStatement",value:function(t,e){return e.push("break;\n"),e}},{key:"astContinueStatement",value:function(t,e){return e.push("continue;\n"),e}},{key:"astLogicalExpression",value:function(t,e){return e.push("("),this.astGeneric(t.left,e),e.push(t.operator),this.astGeneric(t.right,e),e.push(")"),e}},{key:"astUpdateExpression",value:function(t,e){return t.prefix?(e.push(t.operator),this.astGeneric(t.argument,e)):(this.astGeneric(t.argument,e),e.push(t.operator)),e}},{key:"astUnaryExpression",value:function(t,e){return t.prefix?(e.push(t.operator),this.astGeneric(t.argument,e)):(this.astGeneric(t.argument,e),e.push(t.operator)),e}},{key:"astThisExpression",value:function(t,e){return e.push("this"),e}},{key:"astMemberExpression",value:function(t,e){if(t.object.type,t.computed)if("Identifier"===t.object.type||"MemberExpression"===t.object.type&&t.object.object.object&&"ThisExpression"===t.object.object.object.type&&"constants"===t.object.object.property.name){var n=t.object.name,r=(this.functionName,!1);if(this.paramNames){var i=this.paramNames.indexOf(n);0<=i&&"Number"===this.paramTypes[i]&&(r=!0)}if(r)this.astGeneric(t.object,e),e.push("[int("),this.astGeneric(t.property,e),e.push(")]");else{var o=this.isState("in-get-call-parameters"),a=this.isState("multi-member-expression");a&&this.popState("multi-member-expression"),this.pushState("not-in-get-call-parameters");var u=null;switch(t.object.name?u=this.declarations[t.object.name]?this.declarations[t.object.name]:this.getParamType(t.object.name):t.object&&t.object.object&&t.object.object.object&&"ThisExpression"===t.object.object.object.type&&(u=this.getConstantType(t.object.property.name)),u){case"Array(2)":case"Array(3)":case"Array(4)":this.astGeneric(t.object,e),e.push("["),e.push(t.property.raw),e.push("]"),a&&this.popState("not-in-get-call-parameters");break;case"HTMLImageArray":e.push("getImage3D("),this.astGeneric(t.object,e),e.push(", ivec2("),this.astGeneric(t.object,e),e.push("Size[0],"),this.astGeneric(t.object,e),e.push("Size[1]), ivec3("),this.astGeneric(t.object,e),e.push("Dim[0],"),this.astGeneric(t.object,e),e.push("Dim[1],"),this.astGeneric(t.object,e),e.push("Dim[2]"),e.push("), "),this.popState("not-in-get-call-parameters"),this.pushState("in-get-call-parameters"),this.astGeneric(t.property,e),a||this.popState("in-get-call-parameters"),e.push(")");break;case"ArrayTexture(4)":case"HTMLImage":e.push("getImage2D("),this.astGeneric(t.object,e),e.push(", ivec2("),this.astGeneric(t.object,e),e.push("Size[0],"),this.astGeneric(t.object,e),e.push("Size[1]), ivec3("),this.astGeneric(t.object,e),e.push("Dim[0],"),this.astGeneric(t.object,e),e.push("Dim[1],"),this.astGeneric(t.object,e),e.push("Dim[2]"),e.push("), "),this.popState("not-in-get-call-parameters"),this.pushState("in-get-call-parameters"),this.astGeneric(t.property,e),a||this.popState("in-get-call-parameters"),e.push(")");break;default:o&&e.push("int("),e.push("get("),this.astGeneric(t.object,e),e.push(", ivec2("),this.astGeneric(t.object,e),e.push("Size[0],"),this.astGeneric(t.object,e),e.push("Size[1]), ivec3("),this.astGeneric(t.object,e),e.push("Dim[0],"),this.astGeneric(t.object,e),e.push("Dim[1],"),this.astGeneric(t.object,e),e.push("Dim[2]"),e.push("), "),this.astGeneric(t.object,e),e.push("BitRatio"),e.push(", "),this.popState("not-in-get-call-parameters"),this.pushState("in-get-call-parameters"),this.astGeneric(t.property,e),a||this.popState("in-get-call-parameters"),e.push(")"),o&&e.push(")")}}}else{t.object,this.states.length;var c=this.isState("in-get-call-parameters");c||this.pushState("multi-member-expression"),this.astGeneric(t.object,e),this.isState("multi-member-expression")&&this.popState("multi-member-expression");var l=!c&&this.isState("in-get-call-parameters"),f=e.pop();e.push(","),t.property;var h=this.isState("should-pop-in-get-call-parameters");h&&this.popState("should-pop-in-get-call-parameters"),this.astGeneric(t.property,e),e.push(f),l?this.pushState("should-pop-in-get-call-parameters"):h&&this.popState("in-get-call-parameters")}else{var p=this.astMemberExpressionUnroll(t),d=p.toLowerCase();0===p.indexOf(s)&&(p="constants_"+p.slice(s.length));var y=!this.isState("in-get-call-parameters");switch(d){case"this.thread.x":y&&e.push("float("),e.push("threadId.x"),y&&e.push(")");break;case"this.thread.y":y&&e.push("float("),e.push("threadId.y"),y&&e.push(")");break;case"this.thread.z":y&&e.push("float("),e.push("threadId.z"),y&&e.push(")");break;case"this.output.x":e.push(this.output[0]+".0");break;case"this.output.y":e.push(this.output[1]+".0");break;case"this.output.z":e.push(this.output[2]+".0");break;default:t.object&&t.object.name&&this.declarations[t.object.name]&&e.push("user_"),e.push(p)}}return t.object.type,e}},{key:"astSequenceExpression",value:function(t,e){for(var n=0;n<t.expressions.length;n++)0<n&&e.push(","),this.astGeneric(t.expressions,e);return e}},{key:"astCallExpression",value:function(t,e){if(t.callee){var n=this.astMemberExpressionUnroll(t.callee);0===n.indexOf("Math.")&&(n=n.slice("Math.".length)),0===n.indexOf("this.")&&(n=n.slice("this.".length)),"atan2"===n&&(n="atan"),this.calledFunctions.indexOf(n)<0&&this.calledFunctions.push(n),this.hasOwnProperty("funcName")||(this.calledFunctionsArguments[n]=[]);var r=[];this.calledFunctionsArguments[n].push(r),e.push(n),e.push("(");for(var i=0;i<t.arguments.length;++i){var o=t.arguments[i];if(0<i&&e.push(", "),this.astGeneric(o,e),"Identifier"===o.type){var a=this.paramNames.indexOf(o.name);-1===a?r.push(null):r.push({name:o.name,type:this.paramTypes[a]||"Number"})}else r.push(null)}return e.push(")"),e}throw this.astErrorOutput("Unknown CallExpression",t)}},{key:"astArrayExpression",value:function(t,e){var n=t.elements.length;e.push("vec"+n+"(");for(var r=0;r<n;++r){0<r&&e.push(", ");var i=t.elements[r];this.astGeneric(i,e)}return e.push(")"),e}},{key:"getFunctionPrototypeString",value:function(){return this.webGlFunctionPrototypeString?this.webGlFunctionPrototypeString:this.webGlFunctionPrototypeString=this.generate()}},{key:"build",value:function(){return 0<this.getFunctionPrototypeString().length}}]),e}();var l={Array:"sampler2D","Array(2)":"vec2","Array(3)":"vec3","Array(4)":"vec4",Array2D:"sampler2D",Array3D:"sampler2D",Float:"float",Input:"sampler2D",Integer:"float",Number:"float",NumberTexture:"sampler2D","ArrayTexture(4)":"sampler2D"},f={Array:"Number",Array2D:"Number",Array3D:"Number",HTMLImage:"Array(4)",HTMLImageArray:"Array(4)",NumberTexture:"Number","ArrayTexture(4)":"Array(4)"}},function(t,e,n){"use strict";function r(t){return(r="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t})(t)}var i=function(){function t(t,e){for(var n=0;n<e.length;n++){var r=e[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(t,r.key,r)}}return function(e,n,r){return n&&t(e.prototype,n),r&&t(e,r),e}}(),o=n(102),a=n(10),s=n(73),u=n(622),c=n(623);t.exports=function(t){function e(){return function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,e),function(t,e){if(!t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!e||"object"!==r(e)&&"function"!=typeof e?t:e}(this,(e.__proto__||Object.getPrototypeOf(e)).apply(this,arguments))}return function(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function, not "+r(e));t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,enumerable:!1,writable:!0,configurable:!0}}),e&&(Object.setPrototypeOf?Object.setPrototypeOf(t,e):t.__proto__=e)}(e,o),i(e,[{key:"initWebGl",value:function(){return a.initWebGl2(this.getCanvas())}},{key:"validateOptions",value:function(){var t=a.isFloatReadPixelsSupportedWebGL2();if(!0===this.floatOutput&&!0!==this.floatOutputForce&&!t)throw new Error("Float texture outputs are not supported on this browser");void 0===this.floatTextures&&(this.floatTextures=!0,this.floatOutput=t);var e=a.hasIntegerDivisionAccuracyBug();if(null===this.fixIntegerDivisionAccuracy?this.fixIntegerDivisionAccuracy=e:this.fixIntegerDivisionAccuracy&&!e&&(this.fixIntegerDivisionAccuracy=!1),a.checkOutput(this.output),!this.output||0===this.output.length){if(1!==arguments.length)throw new Error("Auto output only supported for kernels with only one input");var n=a.getArgumentType(arguments[0]);if("Array"===n)this.output=a.getDimensions(n);else{if("NumberTexture"!==n&&"ArrayTexture(4)"!==n)throw new Error("Auto output not supported for input type: "+n);this.output=arguments[0].output}}if(this.texSize=a.dimToTexSize({floatTextures:this.floatTextures,floatOutput:this.floatOutput},this.output,!0),this.graphical){if(2!==this.output.length)throw new Error("Output must have 2 dimensions on graphical mode");this.floatOutput&&(this.floatOutput=!1,console.warn("Cannot use graphical mode and float output at the same time")),this.texSize=a.clone(this.output)}else void 0===this.floatOutput&&(this.floatOutput=!0);(this.floatOutput||this.floatOutputForce)&&this._webGl.getExtension("EXT_color_buffer_float")}},{key:"run",value:function(){null===this.program&&this.build.apply(this,arguments);var t=this.paramNames,e=this.paramTypes,n=this.texSize,r=this._webGl;r.useProgram(this.program),r.scissor(0,0,n[0],n[1]),this.hardcodeConstants||(this.setUniform3iv("uOutputDim",new Int32Array(this.threadDim)),this.setUniform2iv("uTexSize",n)),this.setUniform2f("ratio",n[0]/this.maxTexSize[0],n[1]/this.maxTexSize[1]);for(var i=this.argumentsLength=0;i<t.length;i++)this._addArgument(arguments[i],e[i],t[i]);if(this.graphical)return this.outputToTexture?(r.bindRenderbuffer(r.RENDERBUFFER,null),r.bindFramebuffer(r.FRAMEBUFFER,this.framebuffer),this.outputTexture&&!this.outputImmutable||this._setupOutputTexture(),r.drawArrays(r.TRIANGLE_STRIP,0,4),new s(this.outputTexture,n,this.threadDim,this.output,this._webGl,"ArrayTexture(4)")):(r.bindRenderbuffer(r.RENDERBUFFER,null),r.bindFramebuffer(r.FRAMEBUFFER,null),void r.drawArrays(r.TRIANGLE_STRIP,0,4));r.bindFramebuffer(r.FRAMEBUFFER,this.framebuffer),this.outputImmutable&&this._setupOutputTexture();var o=this.outputTexture;if(null!==this.subKernelOutputVariableNames&&(this.outputImmutable&&(this.subKernelOutputTextures=[],this._setupSubOutputTextures(this.subKernelOutputVariableNames.length)),r.drawBuffers(this.drawBuffersMap)),r.drawArrays(r.TRIANGLE_STRIP,0,4),null!==this.subKernelOutputTextures){if(null!==this.subKernels){var a=[];a.result=this.renderOutput(o);for(var u=0;u<this.subKernels.length;u++)a.push(new s(this.subKernelOutputTextures[u],n,this.threadDim,this.output,this._webGl));return a}if(null!==this.subKernelProperties){var c={result:this.renderOutput(o)},l=0;for(var f in this.subKernelProperties)this.subKernelProperties.hasOwnProperty(f)&&(c[f]=new s(this.subKernelOutputTextures[l],n,this.threadDim,this.output,this._webGl),l++);return c}}return this.renderOutput(o)}},{key:"getOutputTexture",value:function(){return this.outputTexture}},{key:"_setupOutputTexture",value:function(){var t=this._webGl,e=this.texSize,n=this.outputTexture=this._webGl.createTexture();t.activeTexture(t.TEXTURE0+this.constantsLength+this.paramNames.length),t.bindTexture(t.TEXTURE_2D,n),t.texParameteri(t.TEXTURE_2D,t.TEXTURE_WRAP_S,t.CLAMP_TO_EDGE),t.texParameteri(t.TEXTURE_2D,t.TEXTURE_WRAP_T,t.CLAMP_TO_EDGE),t.texParameteri(t.TEXTURE_2D,t.TEXTURE_MIN_FILTER,t.NEAREST),t.texParameteri(t.TEXTURE_2D,t.TEXTURE_MAG_FILTER,t.NEAREST),this.floatOutput?t.texImage2D(t.TEXTURE_2D,0,t.RGBA32F,e[0],e[1],0,t.RGBA,t.FLOAT,null):t.texImage2D(t.TEXTURE_2D,0,t.RGBA,e[0],e[1],0,t.RGBA,t.UNSIGNED_BYTE,null),t.framebufferTexture2D(t.FRAMEBUFFER,t.COLOR_ATTACHMENT0,t.TEXTURE_2D,n,0)}},{key:"_setupSubOutputTextures",value:function(t){for(var e=this._webGl,n=this.texSize,r=this.drawBuffersMap=[e.COLOR_ATTACHMENT0],i=this.subKernelOutputTextures=[],o=0;o<t;o++){var a=this._webGl.createTexture();i.push(a),r.push(e.COLOR_ATTACHMENT0+o+1),e.activeTexture(e.TEXTURE0+this.constantsLength+this.paramNames.length+o),e.bindTexture(e.TEXTURE_2D,a),e.texParameteri(e.TEXTURE_2D,e.TEXTURE_WRAP_S,e.CLAMP_TO_EDGE),e.texParameteri(e.TEXTURE_2D,e.TEXTURE_WRAP_T,e.CLAMP_TO_EDGE),e.texParameteri(e.TEXTURE_2D,e.TEXTURE_MIN_FILTER,e.NEAREST),e.texParameteri(e.TEXTURE_2D,e.TEXTURE_MAG_FILTER,e.NEAREST),this.floatOutput?e.texImage2D(e.TEXTURE_2D,0,e.RGBA32F,n[0],n[1],0,e.RGBA,e.FLOAT,null):e.texImage2D(e.TEXTURE_2D,0,e.RGBA,n[0],n[1],0,e.RGBA,e.UNSIGNED_BYTE,null),e.framebufferTexture2D(e.FRAMEBUFFER,e.COLOR_ATTACHMENT0+o+1,e.TEXTURE_2D,a,0)}}},{key:"_addArgument",value:function(t,e,n){var r=this._webGl,i=this.getArgumentTexture(n);switch(t instanceof s&&(e=t.type),e){case"Array":var o=a.getDimensions(t,!0),u=a.dimToTexSize({floatTextures:this.floatTextures,floatOutput:this.floatOutput},o);r.activeTexture(r.TEXTURE0+this.constantsLength+this.argumentsLength),r.bindTexture(r.TEXTURE_2D,i),r.texParameteri(r.TEXTURE_2D,r.TEXTURE_WRAP_S,r.CLAMP_TO_EDGE),r.texParameteri(r.TEXTURE_2D,r.TEXTURE_WRAP_T,r.CLAMP_TO_EDGE),r.texParameteri(r.TEXTURE_2D,r.TEXTURE_MIN_FILTER,r.NEAREST),r.texParameteri(r.TEXTURE_2D,r.TEXTURE_MAG_FILTER,r.NEAREST);var c=u[0]*u[1],l=this._formatArrayTransfer(t,c),f=l.valuesFlat,h=l.bitRatio,p=void 0;this.floatTextures?r.texImage2D(r.TEXTURE_2D,0,r.RGBA32F,u[0],u[1],0,r.RGBA,r.FLOAT,f):(p=new Uint8Array(f.buffer),r.texImage2D(r.TEXTURE_2D,0,r.RGBA,u[0]/h,u[1],0,r.RGBA,r.UNSIGNED_BYTE,p)),this.hardcodeConstants||(this.setUniform3iv("user_"+n+"Dim",o),this.setUniform2iv("user_"+n+"Size",u)),this.setUniform1i("user_"+n+"BitRatio",h),this.setUniform1i("user_"+n,this.argumentsLength);break;case"Integer":case"Float":case"Number":this.setUniform1f("user_"+n,t);break;case"Input":var d=t.size,y=a.dimToTexSize({floatTextures:this.floatTextures,floatOutput:this.floatOutput},d);r.activeTexture(r.TEXTURE0+this.constantsLength+this.argumentsLength),r.bindTexture(r.TEXTURE_2D,i),r.texParameteri(r.TEXTURE_2D,r.TEXTURE_WRAP_S,r.CLAMP_TO_EDGE),r.texParameteri(r.TEXTURE_2D,r.TEXTURE_WRAP_T,r.CLAMP_TO_EDGE),r.texParameteri(r.TEXTURE_2D,r.TEXTURE_MIN_FILTER,r.NEAREST),r.texParameteri(r.TEXTURE_2D,r.TEXTURE_MAG_FILTER,r.NEAREST);var v=y[0]*y[1],g=this._formatArrayTransfer(t.value,v),m=g.valuesFlat,b=g.bitRatio;if(this.floatTextures)r.texImage2D(r.TEXTURE_2D,0,r.RGBA32F,y[0],y[1],0,r.RGBA,r.FLOAT,inputArray);else{var x=new Uint8Array(m.buffer);r.texImage2D(r.TEXTURE_2D,0,r.RGBA,y[0]/b,y[1],0,r.RGBA,r.UNSIGNED_BYTE,x)}this.hardcodeConstants||(this.setUniform3iv("user_"+n+"Dim",d),this.setUniform2iv("user_"+n+"Size",y)),this.setUniform1i("user_"+n+"BitRatio",b),this.setUniform1i("user_"+n,this.argumentsLength);break;case"HTMLImage":var _=t,w=[_.width,_.height,1],S=[_.width,_.height];r.activeTexture(r.TEXTURE0+this.constantsLength+this.argumentsLength),r.bindTexture(r.TEXTURE_2D,i),r.texParameteri(r.TEXTURE_2D,r.TEXTURE_WRAP_S,r.CLAMP_TO_EDGE),r.texParameteri(r.TEXTURE_2D,r.TEXTURE_WRAP_T,r.CLAMP_TO_EDGE),r.texParameteri(r.TEXTURE_2D,r.TEXTURE_MIN_FILTER,r.NEAREST),r.texParameteri(r.TEXTURE_2D,r.TEXTURE_MAG_FILTER,r.NEAREST),r.pixelStorei(r.UNPACK_FLIP_Y_WEBGL,!0);var E=r.RGBA,T=r.RGBA,k=r.UNSIGNED_BYTE;r.texImage2D(r.TEXTURE_2D,0,E,T,k,_),this.setUniform3iv("user_"+n+"Dim",w),this.setUniform2iv("user_"+n+"Size",S),this.setUniform1i("user_"+n,this.argumentsLength);break;case"HTMLImageArray":var O=t,A=[O[0].width,O[0].height,O.length],j=[O[0].width,O[0].height];r.activeTexture(r.TEXTURE0+this.constantsLength+this.argumentsLength),r.bindTexture(r.TEXTURE_2D_ARRAY,i),r.texParameteri(r.TEXTURE_2D_ARRAY,r.TEXTURE_MAG_FILTER,r.NEAREST),r.texParameteri(r.TEXTURE_2D_ARRAY,r.TEXTURE_MIN_FILTER,r.NEAREST),r.pixelStorei(r.UNPACK_FLIP_Y_WEBGL,!0);var P=r.RGBA,R=O[0].width,C=O[0].height,I=O.length,L=r.RGBA,N=r.UNSIGNED_BYTE;r.texImage3D(r.TEXTURE_2D_ARRAY,0,P,R,C,I,0,L,N,null);for(var F=0;F<O.length;F++)r.texSubImage3D(r.TEXTURE_2D_ARRAY,0,0,0,F,O[F].width,O[F].height,1,L,N,O[F]);this.setUniform3iv("user_"+n+"Dim",A),this.setUniform2iv("user_"+n+"Size",j),this.setUniform1i("user_"+n,this.argumentsLength);break;case"ArrayTexture(4)":case"NumberTexture":var M=t,D=M.dimensions,U=M.size;r.activeTexture(r.TEXTURE0+this.constantsLength+this.argumentsLength),r.bindTexture(r.TEXTURE_2D,M.texture),this.setUniform3iv("user_"+n+"Dim",D),this.setUniform2iv("user_"+n+"Size",U),this.setUniform1i("user_"+n+"BitRatio",1),this.setUniform1i("user_"+n,this.argumentsLength);break;default:throw new Error("Input type not supported (WebGL): "+t)}this.argumentsLength++}},{key:"_getMainConstantsString",value:function(){var t=[];if(this.constants)for(var e in this.constants)if(this.constants.hasOwnProperty(e)){var n=this.constants[e],r=a.getArgumentType(n);switch(r){case"Integer":t.push("const float constants_"+e+" = "+parseInt(n)+".0");break;case"Float":t.push("const float constants_"+e+" = "+parseFloat(n));break;case"Array":case"Input":case"HTMLImage":case"ArrayTexture(4)":case"NumberTexture":t.push("uniform highp sampler2D constants_"+e,"uniform highp ivec2 constants_"+e+"Size","uniform highp ivec3 constants_"+e+"Dim","uniform highp int constants_"+e+"BitRatio");break;case"HTMLImageArray":t.push("uniform highp sampler2DArray constants_"+e,"uniform highp ivec2 constants_"+e+"Size","uniform highp ivec3 constants_"+e+"Dim","uniform highp int constants_"+e+"BitRatio");break;default:throw new Error("Unsupported constant "+e+" type "+r)}}return this._linesToString(t)}},{key:"_addConstant",value:function(t,e,n){var r=this._webGl,i=this.getArgumentTexture(n);switch(t instanceof s&&(e=t.type),e){case"Array":var o=a.getDimensions(t,!0),u=a.dimToTexSize({floatTextures:this.floatTextures,floatOutput:this.floatOutput},o);r.activeTexture(r.TEXTURE0+this.constantsLength),r.bindTexture(r.TEXTURE_2D,i),r.texParameteri(r.TEXTURE_2D,r.TEXTURE_WRAP_S,r.CLAMP_TO_EDGE),r.texParameteri(r.TEXTURE_2D,r.TEXTURE_WRAP_T,r.CLAMP_TO_EDGE),r.texParameteri(r.TEXTURE_2D,r.TEXTURE_MIN_FILTER,r.NEAREST),r.texParameteri(r.TEXTURE_2D,r.TEXTURE_MAG_FILTER,r.NEAREST);var c=u[0]*u[1],l=this._formatArrayTransfer(t,c),f=l.valuesFlat,h=l.bitRatio,p=void 0;this.floatTextures?r.texImage2D(r.TEXTURE_2D,0,r.RGBA,u[0],u[1],0,r.RGBA,r.FLOAT,f):(p=new Uint8Array(f.buffer),r.texImage2D(r.TEXTURE_2D,0,r.RGBA,u[0]/h,u[1],0,r.RGBA,r.UNSIGNED_BYTE,p)),this.hardcodeConstants||(this.setUniform3iv("constants_"+n+"Dim",o),this.setUniform2iv("constants_"+n+"Size",u)),this.setUniform1i("constants_"+n+"BitRatio",h),this.setUniform1i("constants_"+n,this.constantsLength);break;case"Input":var d=t.size,y=a.dimToTexSize({floatTextures:this.floatTextures,floatOutput:this.floatOutput},d);r.activeTexture(r.TEXTURE0+this.constantsLength),r.bindTexture(r.TEXTURE_2D,i),r.texParameteri(r.TEXTURE_2D,r.TEXTURE_WRAP_S,r.CLAMP_TO_EDGE),r.texParameteri(r.TEXTURE_2D,r.TEXTURE_WRAP_T,r.CLAMP_TO_EDGE),r.texParameteri(r.TEXTURE_2D,r.TEXTURE_MIN_FILTER,r.NEAREST),r.texParameteri(r.TEXTURE_2D,r.TEXTURE_MAG_FILTER,r.NEAREST);var v=y[0]*y[1],g=this._formatArrayTransfer(t.value,v),m=g.valuesFlat,b=g.bitRatio;if(this.floatTextures)r.texImage2D(r.TEXTURE_2D,0,r.RGBA32F,y[0],y[1],0,r.RGBA,r.FLOAT,inputArray);else{var x=new Uint8Array(m.buffer);r.texImage2D(r.TEXTURE_2D,0,r.RGBA,y[0]/b,y[1],0,r.RGBA,r.UNSIGNED_BYTE,x)}this.hardcodeConstants||(this.setUniform3iv("constants_"+n+"Dim",d),this.setUniform2iv("constants_"+n+"Size",y)),this.setUniform1i("constants_"+n+"BitRatio",b),this.setUniform1i("constants_"+n,this.constantsLength);break;case"HTMLImage":var _=t,w=[_.width,_.height,1],S=[_.width,_.height];r.activeTexture(r.TEXTURE0+this.constantsLength),r.bindTexture(r.TEXTURE_2D,i),r.texParameteri(r.TEXTURE_2D,r.TEXTURE_WRAP_S,r.CLAMP_TO_EDGE),r.texParameteri(r.TEXTURE_2D,r.TEXTURE_WRAP_T,r.CLAMP_TO_EDGE),r.texParameteri(r.TEXTURE_2D,r.TEXTURE_MIN_FILTER,r.NEAREST),r.texParameteri(r.TEXTURE_2D,r.TEXTURE_MAG_FILTER,r.NEAREST),r.pixelStorei(r.UNPACK_FLIP_Y_WEBGL,!0);var E=r.RGBA,T=r.RGBA,k=r.UNSIGNED_BYTE;r.texImage2D(r.TEXTURE_2D,0,E,T,k,_),this.setUniform3iv("constants_"+n+"Dim",w),this.setUniform2iv("constants_"+n+"Size",S),this.setUniform1i("constants_"+n,this.constantsLength);break;case"HTMLImageArray":var O=t,A=[O[0].width,O[0].height,O.length],j=[O[0].width,O[0].height];r.activeTexture(r.TEXTURE0+this.constantsLength),r.bindTexture(r.TEXTURE_2D_ARRAY,i),r.texParameteri(r.TEXTURE_2D_ARRAY,r.TEXTURE_MAG_FILTER,r.NEAREST),r.texParameteri(r.TEXTURE_2D_ARRAY,r.TEXTURE_MIN_FILTER,r.NEAREST),r.pixelStorei(r.UNPACK_FLIP_Y_WEBGL,!0);var P=r.RGBA,R=O[0].width,C=O[0].height,I=O.length,L=r.RGBA,N=r.UNSIGNED_BYTE;r.texImage3D(r.TEXTURE_2D_ARRAY,0,P,R,C,I,0,L,N,null);for(var F=0;F<O.length;F++)r.texSubImage3D(r.TEXTURE_2D_ARRAY,0,0,0,F,O[F].width,O[F].height,1,L,N,O[F]);this.setUniform3iv("constants_"+n+"Dim",A),this.setUniform2iv("constants_"+n+"Size",j),this.setUniform1i("constants_"+n,this.constantsLength);break;case"ArrayTexture(4)":case"NumberTexture":var M=t,D=M.dimensions,U=M.size;r.activeTexture(r.TEXTURE0+this.constantsLength),r.bindTexture(r.TEXTURE_2D,M.texture),this.setUniform3iv("constants_"+n+"Dim",D),this.setUniform2iv("constants_"+n+"Size",U),this.setUniform1i("constants_"+n+"BitRatio",1),this.setUniform1i("constants_"+n,this.constantsLength);break;case"Integer":case"Float":default:throw new Error("Input type not supported (WebGL): "+t)}}},{key:"_getGetResultString",value:function(){return this.floatTextures?"  return texel[channel];":"  return decode(texel, x, bitRatio);"}},{key:"_getHeaderString",value:function(){return""}},{key:"_getTextureCoordinate",value:function(){var t=this.subKernelOutputVariableNames;return null===t||t.length<1?"in highp vec2 vTexCoord;\n":"out highp vec2 vTexCoord;\n"}},{key:"_getMainParamsString",value:function(t){for(var e=[],n=this.paramTypes,r=this.paramNames,i=0;i<r.length;i++){var o=t[i],s=r[i],u=n[i];if(this.hardcodeConstants)if("Array"===u||"NumberTexture"===u||"ArrayTexture(4)"===u){var c=a.getDimensions(o,!0),l=a.dimToTexSize({floatTextures:this.floatTextures,floatOutput:this.floatOutput},c);e.push("uniform highp sampler2D user_"+s,"highp ivec2 user_"+s+"Size = ivec2("+l[0]+", "+l[1]+")","highp ivec3 user_"+s+"Dim = ivec3("+c[0]+", "+c[1]+", "+c[2]+")","uniform highp int user_"+s+"BitRatio")}else"Integer"===u?e.push("highp float user_"+s+" = "+o+".0"):"Float"===u&&e.push("highp float user_"+s+" = "+o);else"Array"===u||"NumberTexture"===u||"ArrayTexture(4)"===u||"Input"===u||"HTMLImage"===u?(e.push("uniform highp sampler2D user_"+s,"uniform highp ivec2 user_"+s+"Size","uniform highp ivec3 user_"+s+"Dim"),"HTMLImage"!==u&&e.push("uniform highp int user_"+s+"BitRatio")):"HTMLImageArray"===u?e.push("uniform highp sampler2DArray user_"+s,"uniform highp ivec2 user_"+s+"Size","uniform highp ivec3 user_"+s+"Dim"):"Integer"!==u&&"Float"!==u||e.push("uniform float user_"+s)}return this._linesToString(e)}},{key:"_getKernelString",value:function(){var t=[],e=this.subKernelOutputVariableNames;if(null!==e){t.push("float kernelResult = 0.0"),t.push("layout(location = 0) out vec4 data0");for(var n=0;n<e.length;n++)t.push("float "+e[n]+" = 0.0","layout(location = "+(n+1)+") out vec4 data"+(n+1))}else t.push("out vec4 data0"),t.push("float kernelResult = 0.0");return this._linesToString(t)+this.functionBuilder.getPrototypeString("kernel")}},{key:"_getMainResultString",value:function(){var t=this.subKernelOutputVariableNames,e=[];if(this.floatOutput&&e.push("  index *= 4"),this.graphical)e.push("  threadId = indexTo3D(index, uOutputDim)","  kernel()","  data0 = actualColor");else if(this.floatOutput)for(var n=["r","g","b","a"],r=0;r<n.length;++r){if(e.push("  threadId = indexTo3D(index, uOutputDim)"),e.push("  kernel()"),t){e.push("  data0."+n[r]+" = kernelResult");for(var i=0;i<t.length;++i)e.push("  data"+(i+1)+"."+n[r]+" = "+t[i])}else e.push("  data0."+n[r]+" = kernelResult");r<n.length-1&&e.push("  index += 1")}else if(null!==t){e.push("  threadId = indexTo3D(index, uOutputDim)"),e.push("  kernel()"),e.push("  data0 = encode32(kernelResult)");for(var o=0;o<t.length;o++)e.push("  data"+(o+1)+" = encode32("+t[o]+")")}else e.push("  threadId = indexTo3D(index, uOutputDim)","  kernel()","  data0 = encode32(kernelResult)");return this._linesToString(e)}},{key:"_addKernels",value:function(){var t=this,e=this.functionBuilder;this._webGl,e.addFunctions(this.functions,{constants:this.constants,output:this.output}),e.addNativeFunctions(this.nativeFunctions),e.addKernel(this.fnString,{prototypeOnly:!1,constants:this.constants,output:this.output,debug:this.debug,loopMaxIterations:this.loopMaxIterations,paramNames:this.paramNames,paramTypes:this.paramTypes,constantTypes:this.constantTypes,fixIntegerDivisionAccuracy:this.fixIntegerDivisionAccuracy}),null!==this.subKernels?(this.subKernelOutputTextures=[],this.subKernelOutputVariableNames=[],this.subKernels.forEach(function(e){return t._addSubKernel(e)})):null!==this.subKernelProperties&&(this.subKernelOutputTextures=[],this.subKernelOutputVariableNames=[],Object.keys(this.subKernelProperties).forEach(function(e){return t._addSubKernel(t.subKernelProperties[e])}))}},{key:"_getFragShaderString",value:function(t){return null!==this.compiledFragShaderString?this.compiledFragShaderString:this.compiledFragShaderString=this._replaceArtifacts(this.constructor.fragShaderString,this._getFragShaderArtifactMap(t))}},{key:"_getVertShaderString",value:function(t){return null!==this.compiledVertShaderString?this.compiledVertShaderString:this.compiledVertShaderString=this.constructor.vertShaderString}}],[{key:"fragShaderString",get:function(){return u}},{key:"vertShaderString",get:function(){return c}}]),e}()},function(t,e,n){(((e=t.exports=n(258)).Stream=e).Readable=e).Writable=n(164),e.Duplex=n(54),e.Transform=n(264),e.PassThrough=n(639)},function(t,e,n){"use strict";(function(e,r,i){var o=n(103);function a(t){var e=this;this.next=null,this.entry=null,this.finish=function(){!function(t,e,n){var r=t.entry;for(t.entry=null;r;){var i=r.callback;e.pendingcb--,i(void 0),r=r.next}e.corkedRequestsFree?e.corkedRequestsFree.next=t:e.corkedRequestsFree=t}(e,t)}}t.exports=m;var s,u=!e.browser&&-1<["v0.10","v0.9."].indexOf(e.version.slice(0,5))?r:o.nextTick;m.WritableState=g;var c=n(74);c.inherits=n(53);var l,f={deprecate:n(638)},h=n(260),p=n(104).Buffer,d=i.Uint8Array||function(){},y=n(262);function v(){}function g(t,e){s=s||n(54),t=t||{};var r=e instanceof s;this.objectMode=!!t.objectMode,r&&(this.objectMode=this.objectMode||!!t.writableObjectMode);var i=t.highWaterMark,c=t.writableHighWaterMark,l=this.objectMode?16:16384;this.highWaterMark=i||0===i?i:r&&(c||0===c)?c:l,this.highWaterMark=Math.floor(this.highWaterMark),this.finalCalled=!1,this.needDrain=!1,this.ending=!1,this.ended=!1,this.finished=!1;var f=(this.destroyed=!1)===t.decodeStrings;this.decodeStrings=!f,this.defaultEncoding=t.defaultEncoding||"utf8",this.length=0,this.writing=!1,this.corked=0,this.sync=!0,this.bufferProcessing=!1,this.onwrite=function(t){!function(t,e){var n,r,i,a,s,c,l=t._writableState,f=l.sync,h=l.writecb;if((c=l).writing=!1,c.writecb=null,c.length-=c.writelen,c.writelen=0,e)n=t,i=f,a=e,s=h,--(r=l).pendingcb,i?(o.nextTick(s,a),o.nextTick(E,n,r),n._writableState.errorEmitted=!0,n.emit("error",a)):(s(a),n._writableState.errorEmitted=!0,n.emit("error",a),E(n,r));else{var p=w(l);p||l.corked||l.bufferProcessing||!l.bufferedRequest||_(t,l),f?u(x,t,l,p,h):x(t,l,p,h)}}(e,t)},this.writecb=null,this.writelen=0,this.bufferedRequest=null,this.lastBufferedRequest=null,this.pendingcb=0,this.prefinished=!1,this.errorEmitted=!1,this.bufferedRequestCount=0,this.corkedRequestsFree=new a(this)}function m(t){if(s=s||n(54),!(l.call(m,this)||this instanceof s))return new m(t);this._writableState=new g(t,this),this.writable=!0,t&&("function"==typeof t.write&&(this._write=t.write),"function"==typeof t.writev&&(this._writev=t.writev),"function"==typeof t.destroy&&(this._destroy=t.destroy),"function"==typeof t.final&&(this._final=t.final)),h.call(this)}function b(t,e,n,r,i,o,a){e.writelen=r,e.writecb=a,e.writing=!0,e.sync=!0,n?t._writev(i,e.onwrite):t._write(i,o,e.onwrite),e.sync=!1}function x(t,e,n,r){var i,o;n||(i=t,0===(o=e).length&&o.needDrain&&(o.needDrain=!1,i.emit("drain"))),e.pendingcb--,r(),E(t,e)}function _(t,e){e.bufferProcessing=!0;var n=e.bufferedRequest;if(t._writev&&n&&n.next){var r=e.bufferedRequestCount,i=new Array(r),o=e.corkedRequestsFree;o.entry=n;for(var s=0,u=!0;n;)(i[s]=n).isBuf||(u=!1),n=n.next,s+=1;i.allBuffers=u,b(t,e,!0,e.length,i,"",o.finish),e.pendingcb++,e.lastBufferedRequest=null,o.next?(e.corkedRequestsFree=o.next,o.next=null):e.corkedRequestsFree=new a(e),e.bufferedRequestCount=0}else{for(;n;){var c=n.chunk,l=n.encoding,f=n.callback;if(b(t,e,!1,e.objectMode?1:c.length,c,l,f),n=n.next,e.bufferedRequestCount--,e.writing)break}null===n&&(e.lastBufferedRequest=null)}e.bufferedRequest=n,e.bufferProcessing=!1}function w(t){return t.ending&&0===t.length&&null===t.bufferedRequest&&!t.finished&&!t.writing}function S(t,e){t._final(function(n){e.pendingcb--,n&&t.emit("error",n),e.prefinished=!0,t.emit("prefinish"),E(t,e)})}function E(t,e){var n,r,i=w(e);return i&&(n=t,(r=e).prefinished||r.finalCalled||("function"==typeof n._final?(r.pendingcb++,r.finalCalled=!0,o.nextTick(S,n,r)):(r.prefinished=!0,n.emit("prefinish"))),0===e.pendingcb&&(e.finished=!0,t.emit("finish"))),i}c.inherits(m,h),g.prototype.getBuffer=function(){for(var t=this.bufferedRequest,e=[];t;)e.push(t),t=t.next;return e},function(){try{Object.defineProperty(g.prototype,"buffer",{get:f.deprecate(function(){return this.getBuffer()},"_writableState.buffer is deprecated. Use _writableState.getBuffer instead.","DEP0003")})}catch(t){}}(),"function"==typeof Symbol&&Symbol.hasInstance&&"function"==typeof Function.prototype[Symbol.hasInstance]?(l=Function.prototype[Symbol.hasInstance],Object.defineProperty(m,Symbol.hasInstance,{value:function(t){return!!l.call(this,t)||this===m&&t&&t._writableState instanceof g}})):l=function(t){return t instanceof this},m.prototype.pipe=function(){this.emit("error",new Error("Cannot pipe, not readable"))},m.prototype.write=function(t,e,n){var r,i,a,s,u,c,l,f,h,y=this._writableState,g=!1,m=!y.objectMode&&(r=t,p.isBuffer(r)||r instanceof d);return m&&!p.isBuffer(t)&&(i=t,t=p.from(i)),"function"==typeof e&&(n=e,e=null),m?e="buffer":e||(e=y.defaultEncoding),"function"!=typeof n&&(n=v),y.ended?(this,f=n,h=new Error("write after end"),this.emit("error",h),o.nextTick(f,h)):(m||(this,a=y,u=n,l=!(c=!0),null===(s=t)?l=new TypeError("May not write null values to stream"):"string"==typeof s||void 0===s||a.objectMode||(l=new TypeError("Invalid non-string/buffer chunk")),l&&(this.emit("error",l),o.nextTick(u,l),c=!1),c))&&(y.pendingcb++,g=function(t,e,n,r,i,o){if(!n){var a=function(t,e,n){return t.objectMode||!1===t.decodeStrings||"string"!=typeof e||(e=p.from(e,n)),e}(e,r,i);r!==a&&(n=!0,i="buffer",r=a)}var s=e.objectMode?1:r.length;e.length+=s;var u=e.length<e.highWaterMark;if(u||(e.needDrain=!0),e.writing||e.corked){var c=e.lastBufferedRequest;e.lastBufferedRequest={chunk:r,encoding:i,isBuf:n,callback:o,next:null},c?c.next=e.lastBufferedRequest:e.bufferedRequest=e.lastBufferedRequest,e.bufferedRequestCount+=1}else b(t,e,!1,s,r,i,o);return u}(this,y,m,t,e,n)),g},m.prototype.cork=function(){this._writableState.corked++},m.prototype.uncork=function(){var t=this._writableState;t.corked&&(t.corked--,t.writing||t.corked||t.finished||t.bufferProcessing||!t.bufferedRequest||_(this,t))},m.prototype.setDefaultEncoding=function(t){if("string"==typeof t&&(t=t.toLowerCase()),!(-1<["hex","utf8","utf-8","ascii","binary","base64","ucs2","ucs-2","utf16le","utf-16le","raw"].indexOf((t+"").toLowerCase())))throw new TypeError("Unknown encoding: "+t);return this._writableState.defaultEncoding=t,this},Object.defineProperty(m.prototype,"writableHighWaterMark",{enumerable:!1,get:function(){return this._writableState.highWaterMark}}),m.prototype._write=function(t,e,n){n(new Error("_write() is not implemented"))},m.prototype._writev=null,m.prototype.end=function(t,e,n){var r=this._writableState;"function"==typeof t?(n=t,e=t=null):"function"==typeof e&&(n=e,e=null),null!=t&&this.write(t,e),r.corked&&(r.corked=1,this.uncork()),r.ending||r.finished||function(t,e,n){e.ending=!0,E(t,e),n&&(e.finished?o.nextTick(n):t.once("finish",n)),e.ended=!0,t.writable=!1}(this,r,n)},Object.defineProperty(m.prototype,"destroyed",{get:function(){return void 0!==this._writableState&&this._writableState.destroyed},set:function(t){this._writableState&&(this._writableState.destroyed=t)}}),m.prototype.destroy=y.destroy,m.prototype._undestroy=y.undestroy,m.prototype._destroy=function(t,e){this.end(),e(t)}}).call(this,n(50),n(636).setImmediate,n(15))},function(t,e,n){"use strict";function r(t){return(r="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t})(t)}Object.defineProperty(e,"__esModule",{value:!0});var i=function(){function t(t,e){for(var n=0;n<e.length;n++){var r=e[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(t,r.key,r)}}return function(e,n,r){return n&&t(e.prototype,n),r&&t(e,r),e}}(),o=m(n(31)),a=m(n(105)),s=m(n(265)),u=m(n(106)),c=m(n(72)),l=m(n(166)),f=n(75),h=m(n(268)),p=m(n(269)),d=m(n(99)),y=m(n(244)),v=m(n(661)),g=n(245);function m(t){return t&&t.__esModule?t:{default:t}}var b=function(t){function e(){return function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,e),function(t,e){if(!t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!e||"object"!==r(e)&&"function"!=typeof e?t:e}(this,(e.__proto__||Object.getPrototypeOf(e)).apply(this,arguments))}return function(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function, not "+r(e));t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,enumerable:!1,writable:!0,configurable:!0}}),e&&(Object.setPrototypeOf?Object.setPrototypeOf(t,e):t.__proto__=e)}(e,u.default),i(e,[{key:"createOutputMatrix",value:function(){var t=this.model,e=this.outputSize,n=this.hiddenLayers[this.hiddenLayers.length-1];t.outputConnector=new a.default(e,n,.08),t.output=new a.default(e,1,.08)}},{key:"bindEquation",value:function(){var t=this.model,e=this.hiddenLayers,n=t.hiddenLayers,r=new s.default,i=[],a=0<t.equationConnections.length?t.equationConnections[t.equationConnections.length-1]:this.initialLayerInputs,u=this.getEquation(r,r.input(new o.default(this.inputSize,1)),a[0],n[0]);i.push(u);for(var c=1,l=e.length;c<l;c++)u=this.getEquation(r,u,a[c],n[c]),i.push(u);t.equationConnections.push(i),r.add(r.multiply(t.outputConnector,u),t.output),t.equations.push(r)}},{key:"mapModel",value:function(){var t=this.model,e=t.hiddenLayers,n=t.allMatrices;if(this.initialLayerInputs=this.hiddenLayers.map(function(t){return new o.default(t,1)}),this.createHiddenLayers(),!t.hiddenLayers.length)throw new Error("net.hiddenLayers not set");for(var r=0,i=e.length;r<i;r++){var a=e[r];for(var s in a)a.hasOwnProperty(s)&&n.push(a[s])}if(this.createOutputMatrix(),!t.outputConnector)throw new Error("net.model.outputConnector not set");if(!t.output)throw new Error("net.model.output not set");n.push(t.outputConnector),n.push(t.output)}},{key:"backpropagate",value:function(){for(var t=this.model.equations.length-1;-1<t;t--)this.model.equations[t].backpropagate()}},{key:"run",value:function(t){return 1===this.inputSize?this.outputLookup?(this.run=this.runObject,this.runObject(t)):(this.run=this.runNumbers,this.runNumbers(t)):(this.run=this.runArrays,this.runArrays(t))}},{key:"forecast",value:function(t,e){return 1===this.inputSize?this.outputLookup?(this.forecast=this.runObject,this.runObject(t)):(this.forecast=this.forecastNumbers,this.forecastNumbers(t,e)):this.outputLookup?(this.forecast=this.forecastObjects,this.forecastObjects(t,e)):(this.forecast=this.forecastArrays,this.forecastArrays(t,e))}},{key:"train",value:function(t){var e=1<arguments.length&&void 0!==arguments[1]?arguments[1]:{};this.trainOpts=e=Object.assign({},this.constructor.trainDefaults,e);var n=e.iterations,r=e.errorThresh,i=!0===e.log?console.log:e.log,o=e.logPeriod,a=e.callback,s=e.callbackPeriod;1!==this.inputSize&&this.inputSize||this.setSize(t),t=this.formatData(t);var u=1/0,c=void 0;for(this.verifyIsInitialized(t),c=0;c<n&&r<u;c++){for(var l=0,f=0;f<t.length;f++)l+=this.trainPattern(t[f],!0);if(u=l/t.length,isNaN(u))throw new Error("network error rate is unexpected NaN, check network configurations and try again");i&&c%o==0&&i("iterations: "+c+", training error: "+u),a&&c%s==0&&a({error:u,iterations:c})}return{error:u,iterations:c}}},{key:"verifyIsInitialized",value:function(t){t[0].input?this.trainInput=this.trainInputOutput:0<t[0].length&&(0<t[0][0].length?this.trainInput=this.trainArrays:1<this.inputSize?this.trainInput=this.trainArrays:this.trainInput=this.trainNumbers),this.model||this.initialize()}},{key:"setSize",value:function(t){switch(d.default.dataShape(t).join(",")){case"array,array,number":case"array,object,number":case"array,datum,array,number":case"array,datum,object,number":break;case"array,array,array,number":this.inputSize=this.outputSize=t[0][0].length;break;case"array,array,object,number":this.inputSize=this.outputSize=Object.keys(d.default.toTable2D(t)).length;break;case"array,datum,array,array,number":this.inputSize=this.outputSize=t[0].input[0].length;break;case"array,datum,array,object,number":this.inputSize=Object.keys(d.default.toInputTable2D(t)).length,this.outputSize=Object.keys(d.default.toOutputTable2D(t)).length;break;default:throw new Error("unknown data shape or configuration")}}},{key:"trainNumbers",value:function(t){for(var e=this.model.equations;e.length<t.length;)this.bindEquation();for(var n=0,r=0,i=t.length-1;r<i;r++)n+=e[r].predictTarget(t[r],t[r+1]);return this.end(),n/t.length}},{key:"runNumbers",value:function(t){if(!this.isRunnable)return null;var e=this.model.equations;for(this.inputLookup&&(t=d.default.toArray(this.inputLookup,t,this.inputLookupLength));e.length<=t.length;)this.bindEquation();for(var n=void 0,r=0;r<t.length;r++)n=e[r].runInput([t[r]]);return this.end(),n.weights[0]}},{key:"forecastNumbers",value:function(t,e){if(!this.isRunnable)return null;for(var n=this.model.equations,r=t.length+e;n.length<=r;)this.bindEquation();for(var i=void 0,o=0,a=0;a<t.length;a++)i=n[o++].runInput([t[a]]);for(var s=[i.weights[0]],u=0,c=e-1;u<c;u++)i=n[o++].runInput(i.weights),s.push(i.weights[0]);return this.end(),s}},{key:"runObject",value:function(t){if(this.inputLookup!==this.outputLookup)return d.default.toObject(this.outputLookup,this.forecastNumbers(d.default.toArray(this.inputLookup,t,this.inputLookupLength),this.outputLookupLength));var e=d.default.toArrayShort(this.inputLookup,t);return d.default.toObjectPartial(this.outputLookup,this.forecastNumbers(e,this.outputLookupLength-e.length),e.length)}},{key:"forecastObjects",value:function(t,e){var n=this;return t=t.map(function(t){return d.default.toArray(n.outputLookup,t,n.outputLookupLength)}),this.forecastArrays(t,e).map(function(t){return d.default.toObject(n.outputLookup,t)})}},{key:"trainInputOutput",value:function(t){for(var e=this.model,n=t.input,r=t.output,i=n.length+r.length,o=e.equations;o.length<i;)this.bindEquation();for(var a=0,s=0,u=0,c=n.length-1;u<c;u++)a+=o[s++].predictTarget(n[u],n[u+1]);a+=o[s++].predictTarget(n[n.length-1],r[0]);for(var l=0,f=r.length-1;l<f;l++)a+=o[s++].predictTarget(r[l],r[l+1]);return this.end(),a/i}},{key:"trainArrays",value:function(t){for(var e=this.model.equations;e.length<t.length;)this.bindEquation();for(var n=0,r=0,i=t.length-1;r<i;r++)n+=e[r].predictTarget(t[r],t[r+1]);return this.end(),n/t.length}},{key:"runArrays",value:function(t){if(!this.isRunnable)return null;for(var e=this.model.equations;e.length<=t.length;)this.bindEquation();this.inputLookup&&(t=d.default.toArrays(this.inputLookup,t,this.inputLookupLength));for(var n=void 0,r=0;r<t.length;r++)n=e[r].runInput(t[r]).weights;return this.end(),this.outputLookup?d.default.toObject(this.outputLookup,n):n}},{key:"forecastArrays",value:function(t,e){if(!this.isRunnable)return null;for(var n=this.model.equations,r=t.length+e;n.length<=r;)this.bindEquation();for(var i=void 0,o=0,a=0;a<t.length;a++)i=n[o++].runInput(t[a]);for(var s=[i.weights],u=0,c=e-1;u<c;u++)i=n[o++].runInput(i.weights),s.push(i.weights.slice(0));return this.end(),s}},{key:"end",value:function(){this.model.equations[this.model.equations.length-1].runInput(new Float32Array(this.outputSize))}},{key:"formatData",value:function(t){var e=[];switch(d.default.dataShape(t).join(",")){case"array,number":if(1!==this.inputSize)throw new Error("inputSize must be 1 for this data size");if(1!==this.outputSize)throw new Error("outputSize must be 1 for this data size");for(var n=0;n<t.length;n++)e.push(Float32Array.from([t[n]]));return[e];case"array,array,number":if(1===this.inputSize&&1===this.outputSize){for(var r=0;r<t.length;r++)e.push((0,g.arrayToFloat32Arrays)(t[r]));return e}if(this.inputSize!==t[0].length)throw new Error("inputSize must match data input size");if(this.outputSize!==t[0].length)throw new Error("outputSize must match data input size");for(var i=0;i<t.length;i++)e.push(Float32Array.from(t[i]));return[e];case"array,object,number":if(1!==this.inputSize)throw new Error("inputSize must be 1 for this data size");if(1!==this.outputSize)throw new Error("outputSize must be 1 for this data size");if(!this.inputLookup){var o=new y.default(t);this.inputLookup=this.outputLookup=o.table,this.inputLookupLength=this.outputLookupLength=o.length}for(var a=0;a<t.length;a++)e.push((0,g.objectToFloat32Arrays)(t[a]));return e;case"array,datum,array,number":if(1!==this.inputSize)throw new Error("inputSize must be 1 for this data size");if(1!==this.outputSize)throw new Error("outputSize must be 1 for this data size");for(var s=0;s<t.length;s++){var u=t[s];e.push({input:(0,g.arrayToFloat32Arrays)(u.input),output:(0,g.arrayToFloat32Arrays)(u.output)})}return e;case"array,datum,object,number":if(1!==this.inputSize)throw new Error("inputSize must be 1 for this data size");if(1!==this.outputSize)throw new Error("outputSize must be 1 for this data size");if(!this.inputLookup){var c=new y.default(t,"input");this.inputLookup=c.table,this.inputLookupLength=c.length}if(!this.outputLookup){var l=new y.default(t,"output");this.outputLookup=l.table,this.outputLookupLength=l.length}for(var f=0;f<t.length;f++){var h=t[f];e.push({input:(0,g.objectToFloat32Arrays)(h.input),output:(0,g.objectToFloat32Arrays)(h.output)})}return e;case"array,array,array,number":for(var p=0;p<t.length;p++)e.push((0,g.arraysToFloat32Arrays)(t[p]));return e;case"array,array,object,number":if(!this.inputLookup){var m=new y.default(t);this.inputLookup=this.outputLookup=m.table,this.inputLookupLength=this.outputLookupLength=m.length}for(var b=0;b<t.length;b++){for(var x=[],_=0;_<t[b].length;_++)x.push((0,g.objectToFloat32Array)(t[b][_],this.inputLookup,this.inputLookupLength));e.push(x)}return e;case"array,datum,array,array,number":if(1===this.inputSize&&1===this.outputSize)for(var w=0;w<t.length;w++){var S=t[w];e.push({input:Float32Array.from(S.input),output:Float32Array.from(S.output)})}else{if(this.inputSize!==t[0].input[0].length)throw new Error("inputSize must match data input size");if(this.outputSize!==t[0].output[0].length)throw new Error("outputSize must match data output size");for(var E=0;E<t.length;E++){var T=t[E];e.push({input:(0,g.arraysToFloat32Arrays)(T.input),output:(0,g.arraysToFloat32Arrays)(T.output)})}}return e;case"array,datum,array,object,number":if(!this.inputLookup){var k=new v.default(t,"input");this.inputLookup=k.table,this.inputLookupLength=k.length}if(!this.outputLookup){var O=new v.default(t,"output");this.outputLookup=O.table,this.outputLookupLength=O.length}for(var A=0;A<t.length;A++){var j=t[A];e.push({input:(0,g.objectsToFloat32Arrays)(j.input,this.inputLookup,this.inputLookupLength),output:(0,g.objectsToFloat32Arrays)(j.output,this.outputLookup,this.outputLookupLength)})}return e;default:throw new Error("unknown data shape or configuration")}}},{key:"test",value:function(t){var e=this.formatData(t),n=[],r=0;switch(d.default.dataShape(t).join(",")){case"array,array,number":if(1!==this.inputSize)throw new Error("unknown data shape or configuration");for(var i=0;i<e.length;i++){var o=e[i],a=this.run(o.splice(0,o.length-1)),s=o[o.length-1][0]-a,u=s*s;if(r+=u,Math.abs(u)>this.trainOpts.errorThresh){var c=t[i];Object.assign(c,{value:o,actual:a}),n.push(c)}}break;case"array,array,array,number":for(var l=0;l<e.length;l++){for(var f=e[l],h=this.run(f.splice(0,f.length-1)),p=f[f.length-1],y=0,v=0,g=0;g<h.length;g++){v++;var m=p[g]-h[g];y+=m*m}if(r+=y/v,Math.abs(y)>this.trainOpts.errorThresh){var b=t[l];n.push({value:b,actual:h})}}break;case"array,object,number":for(var x=0;x<e.length;x++){var _=e[x],w=this.run(d.default.toObjectPartial(this.outputLookup,_,0,_.length-1)),S=_[_.length-1],E=0,T=void 0;for(T in w);var k=S[x]-w[T];if(r+=E+=k*k,Math.abs(E)>this.trainOpts.errorThresh){var O=t[x];n.push({value:O,actual:w})}}break;case"array,array,object,number":for(var A=0;A<e.length;A++){var j=e[A],P=this.run(j.slice(0,j.length-1)),R=t[A][j.length-1],C=0,I=0;for(var L in P){var N=R[L]-P[L];C+=N*N,I++}if(r+=C/I,Math.abs(C)>this.trainOpts.errorThresh){var F=t[A];n.push({value:F,actual:P})}}break;case"array,datum,array,number":case"array,datum,object,number":for(var M=0;M<e.length;M++){for(var D=e[M],U=this.forecast(D.input,D.output.length),G=0,z=0,B=0;B<U.length;B++){var V=D.output[B][0]-U[B];G+=V*V,z++}if(r+=G/z,Math.abs(G)>this.trainOpts.errorThresh){var W=t[M];Object.assign(W,{actual:this.outputLookup?d.default.toObject(this.outputLookup,U):U}),n.push(W)}}break;case"array,datum,array,array,number":for(var X=0;X<e.length;X++){for(var K=e[X],q=this.forecast(K.input,K.output.length),H=0,$=0;$<q.length;$++)for(var Y=0;Y<q[$].length;Y++){var J=K.output[$][Y]-q[$][Y];H+=J*J}if(r+=H,Math.abs(H)>this.trainOpts.errorThresh){var Q=t[X];n.push({input:Q.input,output:Q.output,actual:q})}}break;case"array,datum,array,object,number":for(var Z=0;Z<e.length;Z++){for(var tt=e[Z],et=this.forecast(tt.input,tt.output.length),nt=0,rt=0;rt<et.length;rt++)for(var it in et[rt]){var ot=t[Z].output[rt][it]-et[rt][it];nt+=ot*ot}if(r+=nt,Math.abs(nt)>this.trainOpts.errorThresh){var at=t[Z];n.push({input:at.input,output:at.output,actual:et})}}break;default:throw new Error("unknown data shape or configuration")}return{error:r/e.length,misclasses:n,total:e.length}}},{key:"addFormat",value:function(t){switch(d.default.dataShape(t).join(",")){case"array,array,number":case"datum,array,array,number":case"array,number":case"datum,array,number":return;case"datum,object,number":this.inputLookup=d.default.addKeys(t.input,this.inputLookup),this.inputLookup&&(this.inputLookupLength=Object.keys(this.inputLookup).length),this.outputLookup=d.default.addKeys(t.output,this.outputLookup),this.outputLookup&&(this.outputLookupLength=Object.keys(this.outputLookup).length);break;case"object,number":this.inputLookup=this.outputLookup=d.default.addKeys(t,this.inputLookup),this.inputLookup&&(this.inputLookupLength=this.outputLookupLength=Object.keys(this.inputLookup).length);break;case"array,object,number":for(var e=0;e<t.length;e++)this.inputLookup=this.outputLookup=d.default.addKeys(t[e],this.inputLookup),this.inputLookup&&(this.inputLookupLength=this.outputLookupLength=Object.keys(this.inputLookup).length);break;case"datum,array,object,number":for(var n=0;n<t.input.length;n++)this.inputLookup=d.default.addKeys(t.input[n],this.inputLookup),this.inputLookup&&(this.inputLookupLength=Object.keys(this.inputLookup).length);for(var r=0;r<t.output.length;r++)this.outputLookup=d.default.addKeys(t.output[r],this.outputLookup),this.outputLookup&&(this.outputLookupLength=Object.keys(this.outputLookup).length);break;default:throw new Error("unknown data shape or configuration")}}},{key:"toJSON",value:function(){var t=this.constructor.defaults;this.model||this.initialize();var e=this.model,n={};for(var r in t)t.hasOwnProperty(r)&&(n[r]=this[r]);return{type:this.constructor.name,options:n,hiddenLayers:e.hiddenLayers.map(function(t){var e={};for(var n in t)e[n]=t[n].toJSON();return e}),outputConnector:this.model.outputConnector.toJSON(),output:this.model.output.toJSON()}}},{key:"fromJSON",value:function(t){var e=this.constructor.defaults,n=t.options;this.model=null,this.hiddenLayers=null;var r=[],i=[];(t.hiddenLayers||t.hiddenSizes).forEach(function(t){var e={};for(var n in t)e[n]=o.default.fromJSON(t[n]),r.push(e[n]);i.push(e)});var a=o.default.fromJSON(t.outputConnector);r.push(a);var s=o.default.fromJSON(t.output);r.push(s),Object.assign(this,e,n),n.hiddenSizes&&(this.hiddenLayers=n.hiddenSizes),this.model={hiddenLayers:i,output:s,allMatrices:r,outputConnector:a,equations:[],equationConnections:[]},this.initialLayerInputs=this.hiddenLayers.map(function(t){return new o.default(t,1)}),this.bindEquation()}},{key:"toFunction",value:function(){var t=this.model,e=this.model.equations,n=this.inputSize,r=this.inputLookup,i=this.inputLookupLength,o=this.outputLookup,a=this.outputLookupLength,s=e[1].states,u=JSON.stringify(this.toJSON());function d(n){for(var r=t.equationConnections[0],i=e[0].states,o=0,a=i.length;o<a;o++)if(i[o].product===n)return o;return r.indexOf(n)}function y(e,n){if(!e||!e.rows||!e.columns)return"null";if(e===t.outputConnector)return"json.outputConnector";if(e===t.output)return"json.output";for(var r=0,i=t.hiddenLayers.length;r<i;r++){var o=t.hiddenLayers[r];for(var a in o)if(o.hasOwnProperty(a)&&o[a]===e)return"json.hiddenLayers["+r+"]."+a}return function(t,e){for(var n=0,r=s.length;n<r;n++){var i=s[n];if(n===e){var o=d(t);switch(t){case i.left:if(-1<o)return"typeof prevStates["+o+"] === 'object' ? prevStates["+o+"].product : new Matrix("+t.rows+", "+t.columns+")";case i.right:if(-1<o)return"typeof prevStates["+o+"] === 'object' ? prevStates["+o+"].product : new Matrix("+t.rows+", "+t.columns+")";case i.product:return"new Matrix("+t.rows+", "+t.columns+")";default:throw Error("unknown state")}}if(t===i.product)return"states["+n+"].product";if(t===i.right)return"states["+n+"].right";if(t===i.left)return"states["+n+"].left"}}(e,n)}for(var v,g=[],m={},b=[],x=0,_=s.length;x<_;x++){var w=s[x];g.push("states["+x+"] = {\n      name: '"+w.forwardFn.name+"',\n      left: "+y(w.left,x)+",\n      right: "+y(w.right,x)+",\n      product: "+y(w.product,x)+"\n    }");var S=w.forwardFn.name;m[S]||(m[S]=!0,b.push("        case '"+S+"':"+("forwardFn"!==S?" //compiled from src/recurrent/matrix/"+S.replace(/[A-Z]/g,function(t){return"-"+t.toLowerCase()})+".js":"")+"\n          "+((v=(v=w.forwardFn.toString()).toString().split("{")).shift(),(v=(v=v.join("{")).split("}")).pop(),v.join("}").split("\n").join("\n        ").replace("product.weights = _input.weights = _this.inputValue;",r&&1===n?"product.weights = _i < input.length ? input[_i]: prevStates[prevStates.length - 1].product.weights;":1===n?"product.weights = [input[_i]];":"product.weights = input[_i];").replace("product.deltas[i] = 0;","").replace("product.deltas[column] = 0;","").replace("left.deltas[leftIndex] = 0;","").replace("right.deltas[rightIndex] = 0;","").replace("product.deltas = left.deltas.slice(0);",""))+"\n          break;"))}var E=1===this.inputSize&&this.outputLookup,T="\n  var input = "+(this.inputLookup?"lookupInput(rawInput)":"rawInput")+";\n  var json = "+u+";\n  var output = [];\n  var states = [];\n  var prevStates;\n  var state;\n  var max = "+(E?r===o?i:"input.length + "+(a-1):"input.length")+";\n  for (var _i = 0; _i < max; _i++) {\n    prevStates = states;\n    states = [];\n    "+g.join(";\n    ")+";\n    for (var stateIndex = 0, stateMax = "+g.length+"; stateIndex < stateMax; stateIndex++) {\n      state = states[stateIndex];\n      var product = state.product;\n      var left = state.left;\n      var right = state.right;\n      \n      switch (state.name) {\n"+b.join("\n")+"\n      }\n    }\n    "+(1===n&&r?"if (_i >= input.length - 1) { output.push(state.product.weights); }":"output = state.product.weights;")+"\n  }\n  "+(o?o===r?"return lookupOutputPartial(output, input)":"return lookupOutput(output)":1===n?"return output[0]":"return output")+";\n  "+(r?1===n?r===o?"function lookupInput(input) {\n            var table = "+JSON.stringify(r)+";\n            var result = [];\n            for (var p in table) {\n              if (!input.hasOwnProperty(p)) break;\n              result.push(Float32Array.from([input[p]]));\n            }\n            return result;\n          }":"function lookupInput(input) {\n          var table = "+JSON.stringify(r)+";\n          var result = [];\n          for (var p in table) {\n            result.push(Float32Array.from([input[p]]));\n          }\n          return result;\n        }":"function lookupInput(rawInputs) {\n        var table = "+JSON.stringify(r)+";\n        var result = [];\n        for (var i = 0; i < rawInputs.length; i++) {\n          var rawInput = rawInputs[i];\n          var input = new Float32Array("+i+");\n          for (var p in table) {\n            input[table[p]] = rawInput.hasOwnProperty(p) ? rawInput[p] : 0;\n          }\n          result.push(input);\n        }\n        return result;\n      }":"")+"\n  "+(o?1===n?r===o?"function lookupOutputPartial(output, input) {\n            var table = "+JSON.stringify(o)+";\n            var offset = input.length;\n            var result = {};\n            var i = 0;\n            for (var p in table) {\n              if (i++ < offset) continue;\n              result[p] = output[table[p] - offset][0];\n            }\n            return result;\n          }":"function lookupOutput(output) {\n          var table = "+JSON.stringify(o)+";\n          var result = {};\n          for (var p in table) {\n            result[p] = output[table[p]][0];\n          }\n          return result;\n        }":"function lookupOutput(output) {\n        var table = "+JSON.stringify(o)+";\n        var result = {};\n        for (var p in table) {\n          result[p] = output[table[p]];\n        }\n        return result;\n      }":"")+"\n  \n  function Matrix(rows, columns) {\n    this.rows = rows;\n    this.columns = columns;\n    this.weights = zeros(rows * columns);\n  }\n  "+c.default.toString()+"\n  "+l.default.toString().replace("_2.default","Matrix")+"\n  "+f.randomF.toString()+"\n  "+h.default.toString()+"\n  "+p.default.toString();return new Function("rawInput",T)}}]),e}();(e.default=b).defaults={inputSize:1,hiddenLayers:[20],outputSize:1,learningRate:u.default.defaults.learningRate,decayRate:u.default.defaults.decayRate,smoothEps:u.default.defaults.smoothEps,regc:u.default.defaults.regc,clipval:u.default.defaults.clipval},b.trainDefaults=u.default.trainDefaults},function(t,e,n){"use strict";Object.defineProperty(e,"__esModule",{value:!0}),e.default=function(t){for(var e=new i.default(t.rows,t.columns),n=-999999,r=0;r<t.weights.length;r++)t.weights[r]>n&&(n=t.weights[r]);for(var o=0,a=0;a<t.weights.length;a++)e.weights[a]=Math.exp(t.weights[a]-n),o+=e.weights[a];for(var s=0;s<t.weights.length;s++)e.weights[s]/=o;return e};var r,i=(r=n(31))&&r.__esModule?r:{default:r}},function(t,e,n){t.exports=!n(7)&&!n(3)(function(){return 7!=Object.defineProperty(n(107)("div"),"a",{get:function(){return 7}}).a})},function(t,e,n){e.f=n(5)},function(t,e,n){var r=n(16),i=n(17),o=n(77)(!1),a=n(109)("IE_PROTO");t.exports=function(t,e){var n,s=i(t),u=0,c=[];for(n in s)n!=a&&r(s,n)&&c.push(n);for(;e.length>u;)r(s,n=e[u++])&&(~o(c,n)||c.push(n));return c}},function(t,e,n){var r=n(8),i=n(1),o=n(42);t.exports=n(7)?Object.defineProperties:function(t,e){i(t);for(var n,a=o(e),s=a.length,u=0;u<s;)r.f(t,n=a[u++],e[n]);return t}},function(t,e,n){function r(t){return(r="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t})(t)}var i=n(17),o=n(45).f,a={}.toString,s="object"==("undefined"==typeof window?"undefined":r(window))&&window&&Object.getOwnPropertyNames?Object.getOwnPropertyNames(window):[];t.exports.f=function(t){return s&&"[object Window]"==a.call(t)?function(t){try{return o(t)}catch(t){return s.slice()}}(t):o(i(t))}},function(t,e,n){"use strict";var r=n(42),i=n(78),o=n(64),a=n(9),s=n(63),u=Object.assign;t.exports=!u||n(3)(function(){var t={},e={},n=Symbol(),r="abcdefghijklmnopqrst";return t[n]=7,r.split("").forEach(function(t){e[t]=t}),7!=u({},t)[n]||Object.keys(u({},e)).join("")!=r})?function(t,e){for(var n=a(t),u=arguments.length,c=1,l=i.f,f=o.f;c<u;)for(var h,p=s(arguments[c++]),d=l?r(p).concat(l(p)):r(p),y=d.length,v=0;v<y;)f.call(p,h=d[v++])&&(n[h]=p[h]);return n}:u},function(t,e){t.exports=Object.is||function(t,e){return t===e?0!==t||1/t==1/e:t!=t&&e!=e}},function(t,e,n){"use strict";var r=n(11),i=n(4),o=n(175),a=[].slice,s={};t.exports=Function.bind||function(t){var e=r(this),n=a.call(arguments,1),u=function r(){var i=n.concat(a.call(arguments));return this instanceof r?function(t,e,n){if(!(e in s)){for(var r=[],i=0;i<e;i++)r[i]="a["+i+"]";s[e]=Function("F,a","return new F("+r.join(",")+")")}return s[e](t,n)}(e,i.length,i):o(e,i,t)};return i(e.prototype)&&(u.prototype=e.prototype),u}},function(t,e){t.exports=function(t,e,n){var r=void 0===n;switch(e.length){case 0:return r?t():t.call(n);case 1:return r?t(e[0]):t.call(n,e[0]);case 2:return r?t(e[0],e[1]):t.call(n,e[0],e[1]);case 3:return r?t(e[0],e[1],e[2]):t.call(n,e[0],e[1],e[2]);case 4:return r?t(e[0],e[1],e[2],e[3]):t.call(n,e[0],e[1],e[2],e[3])}return t.apply(n,e)}},function(t,e,n){var r=n(2).parseInt,i=n(57).trim,o=n(113),a=/^[-+]?0[xX]/;t.exports=8!==r(o+"08")||22!==r(o+"0x16")?function(t,e){var n=i(String(t),3);return r(n,e>>>0||(a.test(n)?16:10))}:r},function(t,e,n){var r=n(2).parseFloat,i=n(57).trim;t.exports=1/r(n(113)+"-0")!=-1/0?function(t){var e=i(String(t),3),n=r(e);return 0===n&&"-"==e.charAt(0)?-0:n}:r},function(t,e,n){var r=n(22);t.exports=function(t,e){if("number"!=typeof t&&"Number"!=r(t))throw TypeError(e);return+t}},function(t,e,n){var r=n(4),i=Math.floor;t.exports=function(t){return!r(t)&&isFinite(t)&&i(t)===t}},function(t,e){t.exports=Math.log1p||function(t){return-1e-8<(t=+t)&&t<1e-8?t-t*t/2:Math.log(1+t)}},function(t,e,n){var r=n(116),i=Math.pow,o=i(2,-52),a=i(2,-23),s=i(2,127)*(2-a),u=i(2,-126);t.exports=Math.fround||function(t){var e,n,i=Math.abs(t),c=r(t);return i<u?c*(i/u/a+1/o-1/o)*u*a:s<(n=(e=(1+a/o)*i)-(e-i))||n!=n?c*(1/0):c*n}},function(t,e,n){var r=n(1);t.exports=function(t,e,n,i){try{return i?e(r(n)[0],n[1]):e(n)}catch(e){var o=t.return;throw void 0!==o&&r(o.call(t)),e}}},function(t,e,n){var r=n(11),i=n(9),o=n(63),a=n(6);t.exports=function(t,e,n,s,u){r(e);var c=i(t),l=o(c),f=a(c.length),h=u?f-1:0,p=u?-1:1;if(n<2)for(;;){if(h in l){s=l[h],h+=p;break}if(h+=p,u?h<0:f<=h)throw TypeError("Reduce of empty array with no initial value")}for(;u?0<=h:h<f;h+=p)h in l&&(s=e(s,l[h],h,c));return s}},function(t,e,n){"use strict";var r=n(9),i=n(43),o=n(6);t.exports=[].copyWithin||function(t,e){var n=r(this),a=o(n.length),s=i(t,a),u=i(e,a),c=2<arguments.length?arguments[2]:void 0,l=Math.min((void 0===c?a:i(c,a))-u,a-s),f=1;for(u<s&&s<u+l&&(f=-1,u+=l-1,s+=l-1);0<l--;)u in n?n[s]=n[u]:delete n[s],s+=f,u+=f;return n}},function(t,e){t.exports=function(t,e){return{value:e,done:!!t}}},function(t,e,n){"use strict";var r=n(128);n(0)({target:"RegExp",proto:!0,forced:r!==/./.exec},{exec:r})},function(t,e,n){n(7)&&"g"!=/./g.flags&&n(8).f(RegExp.prototype,"flags",{configurable:!0,get:n(65)})},function(t,e){t.exports=function(t){try{return{e:!1,v:t()}}catch(t){return{e:!0,v:t}}}},function(t,e,n){var r=n(1),i=n(4),o=n(132);t.exports=function(t,e){if(r(t),i(e)&&e.constructor===t)return e;var n=o.f(t);return(0,n.resolve)(e),n.promise}},function(t,e,n){"use strict";var r=n(191),i=n(59);t.exports=n(86)("Map",function(t){return function(){return t(this,0<arguments.length?arguments[0]:void 0)}},{get:function(t){var e=r.getEntry(i(this,"Map"),t);return e&&e.v},set:function(t,e){return r.def(i(this,"Map"),0===t?0:t,e)}},r,!0)},function(t,e,n){"use strict";var r=n(8).f,i=n(44),o=n(49),a=n(21),s=n(47),u=n(48),c=n(118),l=n(185),f=n(46),h=n(7),p=n(35).fastKey,d=n(59),y=h?"_s":"size",v=function(t,e){var n,r=p(e);if("F"!==r)return t._i[r];for(n=t._f;n;n=n.n)if(n.k==e)return n};t.exports={getConstructor:function(t,e,n,c){var l=t(function(t,r){s(t,l,e,"_i"),t._t=e,t._i=i(null),t._f=void 0,t._l=void 0,t[y]=0,null!=r&&u(r,n,t[c],t)});return o(l.prototype,{clear:function(){for(var t=d(this,e),n=t._i,r=t._f;r;r=r.n)r.r=!0,r.p&&(r.p=r.p.n=void 0),delete n[r.i];t._f=t._l=void 0,t[y]=0},delete:function(t){var n=d(this,e),r=v(n,t);if(r){var i=r.n,o=r.p;delete n._i[r.i],r.r=!0,o&&(o.n=i),i&&(i.p=o),n._f==r&&(n._f=i),n._l==r&&(n._l=o),n[y]--}return!!r},forEach:function(t){d(this,e);for(var n,r=a(t,1<arguments.length?arguments[1]:void 0,3);n=n?n.n:this._f;)for(r(n.v,n.k,this);n&&n.r;)n=n.p},has:function(t){return!!v(d(this,e),t)}}),h&&r(l.prototype,"size",{get:function(){return d(this,e)[y]}}),l},def:function(t,e,n){var r,i,o=v(t,e);return o?o.v=n:(t._l=o={i:i=p(e,!0),k:e,v:n,p:r=t._l,n:void 0,r:!1},t._f||(t._f=o),r&&(r.n=o),t[y]++,"F"!==i&&(t._i[i]=o)),t},getEntry:v,setStrong:function(t,e,n){c(t,e,function(t,n){this._t=d(t,e),this._k=n,this._l=void 0},function(){for(var t=this._k,e=this._l;e&&e.r;)e=e.p;return this._t&&(this._l=e=e?e.n:this._t._f)?l(0,"keys"==t?e.k:"values"==t?e.v:[e.k,e.v]):(this._t=void 0,l(1))},n?"entries":"values",!n,!0),f(e)}}},function(t,e,n){"use strict";var r=n(191),i=n(59);t.exports=n(86)("Set",function(t){return function(){return t(this,0<arguments.length?arguments[0]:void 0)}},{add:function(t){return r.def(i(this,"Set"),t=0===t?0:t,t)}},r)},function(t,e,n){"use strict";var r,i=n(30)(0),o=n(13),a=n(35),s=n(172),u=n(194),c=n(4),l=n(3),f=n(59),h="WeakMap",p=a.getWeak,d=Object.isExtensible,y=u.ufstore,v={},g=function(t){return function(){return t(this,0<arguments.length?arguments[0]:void 0)}},m={get:function(t){if(c(t)){var e=p(t);return!0===e?y(f(this,h)).get(t):e?e[this._i]:void 0}},set:function(t,e){return u.def(f(this,h),t,e)}},b=t.exports=n(86)(h,g,m,u,!0,!0);l(function(){return 7!=(new b).set((Object.freeze||Object)(v),7).get(v)})&&(s((r=u.getConstructor(g,h)).prototype,m),a.NEED=!0,i(["delete","has","get","set"],function(t){var e=b.prototype,n=e[t];o(e,t,function(e,i){if(!c(e)||d(e))return n.call(this,e,i);this._f||(this._f=new r);var o=this._f[t](e,i);return"set"==t?this:o})}))},function(t,e,n){"use strict";var r=n(49),i=n(35).getWeak,o=n(1),a=n(4),s=n(47),u=n(48),c=n(30),l=n(16),f=n(59),h=c(5),p=c(6),d=0,y=function(t){return t._l||(t._l=new v)},v=function(){this.a=[]},g=function(t,e){return h(t.a,function(t){return t[0]===e})};v.prototype={get:function(t){var e=g(this,t);if(e)return e[1]},has:function(t){return!!g(this,t)},set:function(t,e){var n=g(this,t);n?n[1]=e:this.a.push([t,e])},delete:function(t){var e=p(this.a,function(e){return e[0]===t});return~e&&this.a.splice(e,1),!!~e}},t.exports={getConstructor:function(t,e,n,o){var c=t(function(t,r){s(t,c,e,"_i"),t._t=e,t._i=d++,t._l=void 0,null!=r&&u(r,n,t[o],t)});return r(c.prototype,{delete:function(t){if(!a(t))return!1;var n=i(t);return!0===n?y(f(this,e)).delete(t):n&&l(n,this._i)&&delete n[this._i]},has:function(t){if(!a(t))return!1;var n=i(t);return!0===n?y(f(this,e)).has(t):n&&l(n,this._i)}}),c},def:function(t,e,n){var r=i(o(e),!0);return!0===r?y(t).set(e,n):r[t._i]=n,t},ufstore:y}},function(t,e,n){var r=n(23),i=n(6);t.exports=function(t){if(void 0===t)return 0;var e=r(t),n=i(e);if(e!==n)throw RangeError("Wrong length!");return n}},function(t,e,n){var r=n(45),i=n(78),o=n(1),a=n(2).Reflect;t.exports=a&&a.ownKeys||function(t){var e=r.f(o(t)),n=i.f;return n?e.concat(n(t)):e}},function(t,e,n){"use strict";var r=n(79),i=n(4),o=n(6),a=n(21),s=n(5)("isConcatSpreadable");t.exports=function t(e,n,u,c,l,f,h,p){for(var d,y,v=l,g=0,m=!!h&&a(h,p,3);g<c;){if(g in u){if(d=m?m(u[g],g,n):u[g],y=!1,i(d)&&(y=void 0!==(y=d[s])?!!y:r(d)),y&&0<f)v=t(e,n,d,o(d.length),v,f-1)-1;else{if(9007199254740991<=v)throw TypeError();e[v]=d}v++}g++}return v}},function(t,e,n){var r=n(6),i=n(115),o=n(28);t.exports=function(t,e,n,a){var s=String(o(t)),u=s.length,c=void 0===n?" ":String(n),l=r(e);if(l<=u||""==c)return s;var f=l-u,h=i.call(c,Math.ceil(f/c.length));return h.length>f&&(h=h.slice(0,f)),a?h+s:s+h}},function(t,e,n){var r=n(42),i=n(17),o=n(64).f;t.exports=function(t){return function(e){for(var n,a=i(e),s=r(a),u=s.length,c=0,l=[];c<u;)o.call(a,n=s[c++])&&l.push(t?[n,a[n]]:a[n]);return l}}},function(t,e,n){var r=n(56),i=n(201);t.exports=function(t){return function(){if(r(this)!=t)throw TypeError(t+"#toJSON isn't generic");return i(this)}}},function(t,e,n){var r=n(48);t.exports=function(t,e){var n=[];return r(t,!1,n.push,n,e),n}},function(t,e){t.exports=Math.scale||function(t,e,n,r,i){return 0===arguments.length||t!=t||e!=e||n!=n||r!=r||i!=i?NaN:t===1/0||t===-1/0?t:(t-e)*(i-r)/(n-e)+r}},function(t,e,n){function r(t){return(r="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t})(t)}function i(t,e,n){return e in t?Object.defineProperty(t,e,{value:n,enumerable:!0,configurable:!0,writable:!0}):t[e]=n,t}function o(t,e,n,r,i,o,a){try{var s=t[o](a),u=s.value}catch(t){return void n(t)}s.done?e(u):Promise.resolve(u).then(r,i)}function a(t){return function(){var e=this,n=arguments;return new Promise(function(r,i){var a=t.apply(e,n);function s(t){o(a,r,i,s,u,"next",t)}function u(t){o(a,r,i,s,u,"throw",t)}s(void 0)})}}function s(t,e){for(var n=0;n<e.length;n++){var r=e[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(t,r.key,r)}}function u(t,e){return!e||"object"!==r(e)&&"function"!=typeof e?function(t){if(void 0!==t)return t;throw new ReferenceError("this hasn't been initialised - super() hasn't been called")}(t):e}function c(t){return(c=Object.setPrototypeOf?Object.getPrototypeOf:function(t){return t.__proto__||Object.getPrototypeOf(t)})(t)}function l(t,e){return(l=Object.setPrototypeOf||function(t,e){return t.__proto__=e,t})(t,e)}var f=n(134),h=n(51)._,p=n(480),d=p.sorter,y=p.select,v=p.AdapterService,g=n(483).default,m=function(t){for(var e=arguments.length,n=new Array(1<e?e-1:0),r=1;r<e;r++)n[r-1]=arguments[r];return y.apply(void 0,n)(JSON.parse(JSON.stringify(t)))},b=function(t){function e(){var t,n=0<arguments.length&&void 0!==arguments[0]?arguments[0]:{};return function(t,n){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this),(t=u(this,c(e).call(this,h.extend({id:"id",matcher:g,sorter:d},n)))).store=n.store||{},t._uId=n.startId||0,t}var n,r,o,p,y,b,x,_,w;return function(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function");t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,writable:!0,configurable:!0}}),e&&l(t,e)}(e,v),n=e,(r=[{key:"getEntries",value:(w=a(regeneratorRuntime.mark(function t(){var e,n,r,i=arguments;return regeneratorRuntime.wrap(function(t){for(;;)switch(t.prev=t.next){case 0:return e=0<i.length&&void 0!==i[0]?i[0]:{},n=this.filterQuery(e),r=n.query,t.abrupt("return",this._find(Object.assign({},e,{paginate:!1,query:r})));case 3:case"end":return t.stop()}},t,this)})),function(){return w.apply(this,arguments)})},{key:"_find",value:(_=a(regeneratorRuntime.mark(function t(){var e,n,r,i,o,a,s,u,c=arguments;return regeneratorRuntime.wrap(function(t){for(;;)switch(t.prev=t.next){case 0:if(e=0<c.length&&void 0!==c[0]?c[0]:{},n=this.filterQuery(e),r=n.query,i=n.filters,o=n.paginate,a=h.values(this.store).filter(this.options.matcher(r)),s=a.length,void 0!==i.$sort&&a.sort(this.options.sorter(i.$sort)),void 0!==i.$skip&&(a=a.slice(i.$skip)),void 0!==i.$limit&&(a=a.slice(0,i.$limit)),u={total:s,limit:i.$limit,skip:i.$skip||0,data:a.map(function(t){return m(t,e)})},o&&o.default){t.next=10;break}return t.abrupt("return",u.data);case 10:return t.abrupt("return",u);case 11:case"end":return t.stop()}},t,this)})),function(){return _.apply(this,arguments)})},{key:"_get",value:(x=a(regeneratorRuntime.mark(function t(e){var n,r,i,o,a=arguments;return regeneratorRuntime.wrap(function(t){for(;;)switch(t.prev=t.next){case 0:if(n=1<a.length&&void 0!==a[1]?a[1]:{},!(e in this.store)){t.next=6;break}if(r=this.filterQuery(n),i=r.query,o=this.store[e],this.options.matcher(i)(o))return t.abrupt("return",m(o,n,this.id));t.next=6;break;case 6:throw new f.NotFound("No record found for id '".concat(e,"'"));case 7:case"end":return t.stop()}},t,this)})),function(t){return x.apply(this,arguments)})},{key:"_create",value:(b=a(regeneratorRuntime.mark(function t(e){var n,r,o,a,s=this,u=arguments;return regeneratorRuntime.wrap(function(t){for(;;)switch(t.prev=t.next){case 0:if(n=1<u.length&&void 0!==u[1]?u[1]:{},Array.isArray(e))return t.abrupt("return",Promise.all(e.map(function(t){return s._create(t,n)})));t.next=3;break;case 3:return r=e[this.id]||this._uId++,o=h.extend({},e,i({},this.id,r)),a=this.store[r]=o,t.abrupt("return",m(a,n,this.id));case 7:case"end":return t.stop()}},t,this)})),function(t){return b.apply(this,arguments)})},{key:"_update",value:(y=a(regeneratorRuntime.mark(function t(e,n){var r,o,a,s=arguments;return regeneratorRuntime.wrap(function(t){for(;;)switch(t.prev=t.next){case 0:return r=2<s.length&&void 0!==s[2]?s[2]:{},t.next=3,this._get(e);case 3:return o=t.sent,a=o[this.id],e=a==e?a:e,this.store[e]=h.extend({},n,i({},this.id,e)),t.abrupt("return",this._get(e,r));case 8:case"end":return t.stop()}},t,this)})),function(t,e){return y.apply(this,arguments)})},{key:"_patch",value:(p=a(regeneratorRuntime.mark(function t(e,n){var r,i,o=this,a=arguments;return regeneratorRuntime.wrap(function(t){for(;;)switch(t.prev=t.next){case 0:if(r=2<a.length&&void 0!==a[2]?a[2]:{},null===e)return t.next=4,this.getEntries(r);t.next=6;break;case 4:return i=t.sent,t.abrupt("return",Promise.all(i.map(function(t){return o._patch(t[o.id],n,r)})));case 6:return t.next=8,this._get(e,r);case 8:return this.store[e]=h.extend(this.store[e],h.omit(n,this.id)),t.abrupt("return",this._get(e,r));case 10:case"end":return t.stop()}},t,this)})),function(t,e){return p.apply(this,arguments)})},{key:"_remove",value:(o=a(regeneratorRuntime.mark(function t(e){var n,r,i,o=this,a=arguments;return regeneratorRuntime.wrap(function(t){for(;;)switch(t.prev=t.next){case 0:if(n=1<a.length&&void 0!==a[1]?a[1]:{},null===e)return t.next=4,this.getEntries(n);t.next=6;break;case 4:return r=t.sent,t.abrupt("return",Promise.all(r.map(function(t){return o._remove(t[o.id],n)})));case 6:return t.next=8,this._get(e,n);case 8:return i=t.sent,delete this.store[e],t.abrupt("return",i);case 11:case"end":return t.stop()}},t,this)})),function(t){return o.apply(this,arguments)})}])&&s(n.prototype,r),e}();t.exports=function(t){return new b(t)},t.exports.Service=b},function(t,e,n){(function(t){function n(t,e,n){return e in t?Object.defineProperty(t,e,{value:n,enumerable:!0,configurable:!0,writable:!0}):t[e]=n,t}function r(t){return(r="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t})(t)}function i(t,e){return function(t){if(Array.isArray(t))return t}(t)||function(t,e){var n=[],r=!0,i=!1,o=void 0;try{for(var a,s=t[Symbol.iterator]();!(r=(a=s.next()).done)&&(n.push(a.value),!e||n.length!==e);r=!0);}catch(t){i=!0,o=t}finally{try{r||null==s.return||s.return()}finally{if(i)throw o}}return n}(t,e)||function(){throw new TypeError("Invalid attempt to destructure non-iterable instance")}()}e.stripSlashes=function(t){return t.replace(/^(\/+)|(\/+)$/g,"")};var o=e._={each:function(t,e){t&&"function"==typeof t.forEach?t.forEach(e):o.isObject(t)&&Object.keys(t).forEach(function(n){return e(t[n],n)})},some:function(t,e){return Object.keys(t).map(function(e){return[t[e],e]}).some(function(t){var n=i(t,2),r=n[0],o=n[1];return e(r,o)})},every:function(t,e){return Object.keys(t).map(function(e){return[t[e],e]}).every(function(t){var n=i(t,2),r=n[0],o=n[1];return e(r,o)})},keys:function(t){return Object.keys(t)},values:function(t){return o.keys(t).map(function(e){return t[e]})},isMatch:function(t,e){return o.keys(e).every(function(n){return t[n]===e[n]})},isEmpty:function(t){return 0===o.keys(t).length},isObject:function(t){return"object"===r(t)&&!Array.isArray(t)&&null!==t},isObjectOrArray:function(t){return"object"===r(t)&&null!==t},extend:function(){return Object.assign.apply(Object,arguments)},omit:function(t){for(var e=o.extend({},t),n=arguments.length,r=new Array(1<n?n-1:0),i=1;i<n;i++)r[i-1]=arguments[i];return r.forEach(function(t){return delete e[t]}),e},pick:function(t){for(var e=arguments.length,n=new Array(1<e?e-1:0),r=1;r<e;r++)n[r-1]=arguments[r];return n.reduce(function(e,n){return void 0!==t[n]&&(e[n]=t[n]),e},{})},merge:function(t,e){return o.isObject(t)&&o.isObject(e)&&Object.keys(e).forEach(function(r){o.isObject(e[r])?(t[r]||Object.assign(t,n({},r,{})),o.merge(t[r],e[r])):Object.assign(t,n({},r,e[r]))}),t}};e.isPromise=function(t){return o.isObject(t)&&"function"==typeof t.then},e.makeUrl=function(n){var r=1<arguments.length&&void 0!==arguments[1]?arguments[1]:{},i="function"==typeof r.get?r.get.bind(r):function(){},o=i("env")||"production",a=i("host")||t.env.HOST_NAME||"localhost",s="development"===o||"test"===o||void 0===o?"http":"https",u=i("port")||t.env.PORT||3030,c="development"===o||"test"===o||void 0===o?":".concat(u):"";return n=n||"","".concat(s,"://").concat(a).concat(c,"/").concat(e.stripSlashes(n))},e.createSymbol=function(t){return"undefined"!=typeof Symbol?Symbol(t):t}}).call(this,n(50))},function(t,e,n){function r(t){return(r="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t})(t)}var i=n(51)._,o=n(134).BadRequest;function a(t){if(void 0!==t)return Math.abs(parseInt(t,10))}function s(t,e,n,r){return Array.isArray(n)?i.each(n,function(n){void 0!==e[n]&&(t[n]=e[n])}):i.each(n,function(n,i){var o=n(e[i],r);void 0!==o&&(t[i]=o)}),t}var u={$sort:function(t){return"object"!==r(e=t)||Array.isArray(e)?e:Object.keys(e).reduce(function(t,n){return t[n]="object"===r(e[n])?e[n]:parseInt(e[n],10),t},{});var e},$limit:function(t,e){return function(t,e){if(e&&e.default){var n="number"==typeof t?t:e.default,r="number"==typeof e.max?e.max:Number.MAX_VALUE;return Math.min(n,r)}return t}(a(t),e.paginate)},$skip:function(t){return a(t)},$select:function(t){return t}},c=["$in","$nin","$lt","$lte","$gt","$gte","$ne","$or"];t.exports=function(t){var e=1<arguments.length&&void 0!==arguments[1]?arguments[1]:{},n=e.filters,r=void 0===n?{}:n,a=e.operators,l=void 0===a?[]:a,f={};return f.filters=s({},t,u,e),f.filters=s(f.filters,t,r,e),f.query=function t(e,n,r){if(i.isObject(e)&&e.constructor==={}.constructor){var a={};return i.each(e,function(i,s){if("$"===s[0]){if(void 0!==r[s])return;if(!n.includes(s))throw new o("Invalid query parameter ".concat(s),e)}a[s]=t(i,n,r)}),Object.getOwnPropertySymbols(e).forEach(function(t){a[t]=e[t]}),a}return e}(t,c.concat(l),f.filters),f},Object.assign(t.exports,{OPERATORS:c,FILTERS:u})},function(t,e,n){function r(t){return function(t){if(Array.isArray(t)){for(var e=0,n=new Array(t.length);e<t.length;e++)n[e]=t[e];return n}}(t)||function(t){if(Symbol.iterator in Object(t)||"[object Arguments]"===Object.prototype.toString.call(t))return Array.from(t)}(t)||function(){throw new TypeError("Invalid attempt to spread non-iterable instance")}()}var i=n(51),o=i.hooks,a=i.isPromise,s=i._,u=n(489),c=o.createHookObject,l=o.getHooks,f=o.processHooks,h=o.enableHooks,p=o.ACTIVATE_HOOKS,d=function(t){var e=t.app,n=t.service,i=t.method,o=t.original;return function(){var t=0<arguments.length&&void 0!==arguments[0]?arguments[0]:{},l=e.hookTypes.reduce(function(e,n){var r=t[n]||[];return e[n]=Array.isArray(r)?r:[r],e},{});return function(){for(var t=arguments.length,h=new Array(t),p=0;p<t;p++)h[p]=arguments[p];var d=!0===h[h.length-1]&&h.pop(),y=o||n[i].bind(n),v=c(i,{type:"before",arguments:h,service:n,app:e});return f.call(n,u.concat(l.before),v).then(function(t){if(void 0!==t.result)return t;var e,o,s=y.apply(void 0,r((e=i,o=t,n.methods[e].reduce(function(t,e){return[].concat(r(t),[o[e]])},[]))));if(!a(s))throw new Error("Service method '".concat(t.method,"' for '").concat(t.path,"' service must return a promise"));return s.then(function(e){return t.result=e,t})}).then(function(t){return Object.assign({},t,{type:"after"})}).then(function(t){var e=l.after.concat(l.finally);return f.call(n,e,t)}).then(function(t){return d?t:t.result}).catch(function(t){var e=l.error.concat(l.finally),r=s.omit(Object.assign({},t.hook,v,{type:"error",original:t.hook,error:t}),"result");return f.call(n,e,r).catch(function(t){return r.error=t,r}).then(function(t){return d?void 0!==t.result?t:Promise.reject(t):void 0!==t.result?t.result:Promise.reject(t.error)})})}}},y=e.hookMixin=function(t){if("function"!=typeof t.hooks){t.methods=Object.getOwnPropertyNames(t).filter(function(e){return"function"==typeof t[e]&&t[e][p]}).reduce(function(e,n){return e[n]=t[n][p],e},t.methods||{}),Object.assign(t.methods,{find:["params"],get:["id","params"],create:["data","params"],update:["id","data","params"],patch:["id","data","params"],remove:["id","params"]});var e=this,n=Object.keys(t.methods),i=n.reduce(function(n,i){return"function"!=typeof t[i]||(n[i]=function(){var t=Array.from(arguments),n=this._super.bind(this);return d({app:e,service:this,method:i,original:n})({before:l(e,this,"before",i),after:l(e,this,"after",i,!0),error:l(e,this,"error",i,!0),finally:l(e,this,"finally",i,!0)}).apply(void 0,r(t))}),n},{});h(t,n,e.hookTypes),t.mixin(i)}};t.exports=function(){return function(t){Object.assign(t,{hookTypes:["before","after","error","finally"]}),h(t,t.methods,t.hookTypes),t.mixins.push(y)}},t.exports.withHooks=d,t.exports.ACTIVATE_HOOKS=p,t.exports.activateHooks=function(t){return function(e){return Object.defineProperty(e,p,{value:t}),e}}},function(t,e){t.exports="3.3.1"},function(t,e,n){var r=n(209),i=n(34)("mysam-core/hooks/md5-id");t.exports=function(){var t=0<arguments.length&&void 0!==arguments[0]?arguments[0]:"_id",e=1<arguments.length&&void 0!==arguments[1]?arguments[1]:"text";return function(n){var o=n.result||n.data;return o&&o[e]&&(i("Setting MD5 id from",o[e]),o[t]=r(o[e])),n}}},function(t,e,n){var r;!function(i){"use strict";function o(t,e){var n=(65535&t)+(65535&e);return(t>>16)+(e>>16)+(n>>16)<<16|65535&n}function a(t,e,n,r,i,a){return o((s=o(o(e,t),o(r,a)))<<(u=i)|s>>>32-u,n);var s,u}function s(t,e,n,r,i,o,s){return a(e&n|~e&r,t,e,i,o,s)}function u(t,e,n,r,i,o,s){return a(e&r|n&~r,t,e,i,o,s)}function c(t,e,n,r,i,o,s){return a(e^n^r,t,e,i,o,s)}function l(t,e,n,r,i,o,s){return a(n^(e|~r),t,e,i,o,s)}function f(t,e){var n,r,i,a,f;t[e>>5]|=128<<e%32,t[14+(e+64>>>9<<4)]=e;var h=1732584193,p=-271733879,d=-1732584194,y=271733878;for(n=0;n<t.length;n+=16)p=l(p=l(p=l(p=l(p=c(p=c(p=c(p=c(p=u(p=u(p=u(p=u(p=s(p=s(p=s(p=s(i=p,d=s(a=d,y=s(f=y,h=s(r=h,p,d,y,t[n],7,-680876936),p,d,t[n+1],12,-389564586),h,p,t[n+2],17,606105819),y,h,t[n+3],22,-1044525330),d=s(d,y=s(y,h=s(h,p,d,y,t[n+4],7,-176418897),p,d,t[n+5],12,1200080426),h,p,t[n+6],17,-1473231341),y,h,t[n+7],22,-45705983),d=s(d,y=s(y,h=s(h,p,d,y,t[n+8],7,1770035416),p,d,t[n+9],12,-1958414417),h,p,t[n+10],17,-42063),y,h,t[n+11],22,-1990404162),d=s(d,y=s(y,h=s(h,p,d,y,t[n+12],7,1804603682),p,d,t[n+13],12,-40341101),h,p,t[n+14],17,-1502002290),y,h,t[n+15],22,1236535329),d=u(d,y=u(y,h=u(h,p,d,y,t[n+1],5,-165796510),p,d,t[n+6],9,-1069501632),h,p,t[n+11],14,643717713),y,h,t[n],20,-373897302),d=u(d,y=u(y,h=u(h,p,d,y,t[n+5],5,-701558691),p,d,t[n+10],9,38016083),h,p,t[n+15],14,-660478335),y,h,t[n+4],20,-405537848),d=u(d,y=u(y,h=u(h,p,d,y,t[n+9],5,568446438),p,d,t[n+14],9,-1019803690),h,p,t[n+3],14,-187363961),y,h,t[n+8],20,1163531501),d=u(d,y=u(y,h=u(h,p,d,y,t[n+13],5,-1444681467),p,d,t[n+2],9,-51403784),h,p,t[n+7],14,1735328473),y,h,t[n+12],20,-1926607734),d=c(d,y=c(y,h=c(h,p,d,y,t[n+5],4,-378558),p,d,t[n+8],11,-2022574463),h,p,t[n+11],16,1839030562),y,h,t[n+14],23,-35309556),d=c(d,y=c(y,h=c(h,p,d,y,t[n+1],4,-1530992060),p,d,t[n+4],11,1272893353),h,p,t[n+7],16,-155497632),y,h,t[n+10],23,-1094730640),d=c(d,y=c(y,h=c(h,p,d,y,t[n+13],4,681279174),p,d,t[n],11,-358537222),h,p,t[n+3],16,-722521979),y,h,t[n+6],23,76029189),d=c(d,y=c(y,h=c(h,p,d,y,t[n+9],4,-640364487),p,d,t[n+12],11,-421815835),h,p,t[n+15],16,530742520),y,h,t[n+2],23,-995338651),d=l(d,y=l(y,h=l(h,p,d,y,t[n],6,-198630844),p,d,t[n+7],10,1126891415),h,p,t[n+14],15,-1416354905),y,h,t[n+5],21,-57434055),d=l(d,y=l(y,h=l(h,p,d,y,t[n+12],6,1700485571),p,d,t[n+3],10,-1894986606),h,p,t[n+10],15,-1051523),y,h,t[n+1],21,-2054922799),d=l(d,y=l(y,h=l(h,p,d,y,t[n+8],6,1873313359),p,d,t[n+15],10,-30611744),h,p,t[n+6],15,-1560198380),y,h,t[n+13],21,1309151649),d=l(d,y=l(y,h=l(h,p,d,y,t[n+4],6,-145523070),p,d,t[n+11],10,-1120210379),h,p,t[n+2],15,718787259),y,h,t[n+9],21,-343485551),h=o(h,r),p=o(p,i),d=o(d,a),y=o(y,f);return[h,p,d,y]}function h(t){var e,n="",r=32*t.length;for(e=0;e<r;e+=8)n+=String.fromCharCode(t[e>>5]>>>e%32&255);return n}function p(t){var e,n=[];for(n[(t.length>>2)-1]=void 0,e=0;e<n.length;e+=1)n[e]=0;var r=8*t.length;for(e=0;e<r;e+=8)n[e>>5]|=(255&t.charCodeAt(e/8))<<e%32;return n}function d(t){var e,n,r="0123456789abcdef",i="";for(n=0;n<t.length;n+=1)e=t.charCodeAt(n),i+=r.charAt(e>>>4&15)+r.charAt(15&e);return i}function y(t){return unescape(encodeURIComponent(t))}function v(t){return h(f(p(e=y(t)),8*e.length));var e}function g(t,e){return function(t,e){var n,r,i=p(t),o=[],a=[];for(o[15]=a[15]=void 0,16<i.length&&(i=f(i,8*t.length)),n=0;n<16;n+=1)o[n]=909522486^i[n],a[n]=1549556828^i[n];return r=f(o.concat(p(e)),512+8*e.length),h(f(a.concat(r),640))}(y(t),y(e))}function m(t,e,n){return e?n?g(e,t):d(g(e,t)):n?v(t):d(v(t))}void 0===(r=function(){return m}.call(e,n,e,t))||(t.exports=r)}()},function(t,e,n){var r=n(136),i=n(214),o=n(215),a=n(521),s=n(528),u=n(531),c=n(532),l=n(533),f=n(535),h=n(225),p=n(227),d=n(96),y=n(540),v=n(541),g=n(546),m=n(26),b=n(141),x=n(548),_=n(38),w=n(550),S=n(69),E="[object Arguments]",T="[object Function]",k="[object Object]",O={};O[E]=O["[object Array]"]=O["[object ArrayBuffer]"]=O["[object DataView]"]=O["[object Boolean]"]=O["[object Date]"]=O["[object Float32Array]"]=O["[object Float64Array]"]=O["[object Int8Array]"]=O["[object Int16Array]"]=O["[object Int32Array]"]=O["[object Map]"]=O["[object Number]"]=O[k]=O["[object RegExp]"]=O["[object Set]"]=O["[object String]"]=O["[object Symbol]"]=O["[object Uint8Array]"]=O["[object Uint8ClampedArray]"]=O["[object Uint16Array]"]=O["[object Uint32Array]"]=!0,O["[object Error]"]=O[T]=O["[object WeakMap]"]=!1,t.exports=function t(e,n,A,j,P,R){var C,I=1&n,L=2&n,N=4&n;if(A&&(C=P?A(e,j,P,R):A(e)),void 0!==C)return C;if(!_(e))return e;var F=m(e);if(F){if(C=y(e),!I)return c(e,C)}else{var M=d(e),D=M==T||"[object GeneratorFunction]"==M;if(b(e))return u(e,I);if(M==k||M==E||D&&!P){if(C=L||D?{}:g(e),!I)return L?f(e,s(C,e)):l(e,a(C,e))}else{if(!O[M])return P?e:{};C=v(e,M,I)}}R||(R=new r);var U=R.get(e);if(U)return U;if(R.set(e,C),w(e))return e.forEach(function(r){C.add(t(r,n,A,r,e,R))}),C;if(x(e))return e.forEach(function(r,i){C.set(i,t(r,n,A,i,e,R))}),C;var G=N?L?p:h:L?keysIn:S,z=F?void 0:G(e);return i(z||e,function(r,i){z&&(r=e[i=r]),o(C,i,t(r,n,A,i,e,R))}),C}},function(t,e,n){var r=n(61),i=n(38);t.exports=function(t){if(!i(t))return!1;var e=r(t);return"[object Function]"==e||"[object GeneratorFunction]"==e||"[object AsyncFunction]"==e||"[object Proxy]"==e}},function(t,e,n){(function(e){function n(t){return(n="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t})(t)}var r="object"==(void 0===e?"undefined":n(e))&&e&&e.Object===Object&&e;t.exports=r}).call(this,n(15))},function(t,e){var n=Function.prototype.toString;t.exports=function(t){if(null!=t){try{return n.call(t)}catch(t){}try{return t+""}catch(t){}}return""}},function(t,e){t.exports=function(t,e){for(var n=-1,r=null==t?0:t.length;++n<r&&!1!==e(t[n],n,t););return t}},function(t,e,n){var r=n(216),i=n(137),o=Object.prototype.hasOwnProperty;t.exports=function(t,e,n){var a=t[e];o.call(t,e)&&i(a,n)&&(void 0!==n||e in t)||r(t,e,n)}},function(t,e,n){var r=n(217);t.exports=function(t,e,n){"__proto__"==e&&r?r(t,e,{configurable:!0,enumerable:!0,value:n,writable:!0}):t[e]=n}},function(t,e,n){var r=n(52),i=function(){try{var t=r(Object,"defineProperty");return t({},"",{}),t}catch(t){}}();t.exports=i},function(t,e,n){var r=n(522),i=n(140),o=n(26),a=n(141),s=n(219),u=n(220),c=Object.prototype.hasOwnProperty;t.exports=function(t,e){var n=o(t),l=!n&&i(t),f=!n&&!l&&a(t),h=!n&&!l&&!f&&u(t),p=n||l||f||h,d=p?r(t.length,String):[],y=d.length;for(var v in t)!e&&!c.call(t,v)||p&&("length"==v||f&&("offset"==v||"parent"==v)||h&&("buffer"==v||"byteLength"==v||"byteOffset"==v)||s(v,y))||d.push(v);return d}},function(t,e){function n(t){return(n="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t})(t)}var r=/^(?:0|[1-9]\d*)$/;t.exports=function(t,e){var i=n(t);return!!(e=null==e?9007199254740991:e)&&("number"==i||"symbol"!=i&&r.test(t))&&-1<t&&t%1==0&&t<e}},function(t,e,n){var r=n(525),i=n(143),o=n(144),a=o&&o.isTypedArray,s=a?i(a):r;t.exports=s},function(t,e){t.exports=function(t,e){return function(n){return t(e(n))}}},function(t,e,n){var r=n(218),i=n(529),o=n(146);t.exports=function(t){return o(t)?r(t,!0):i(t)}},function(t,e){t.exports=function(){return[]}},function(t,e,n){var r=n(148),i=n(149),o=n(147),a=n(223),s=Object.getOwnPropertySymbols?function(t){for(var e=[];t;)r(e,o(t)),t=i(t);return e}:a;t.exports=s},function(t,e,n){var r=n(226),i=n(147),o=n(69);t.exports=function(t){return r(t,o,i)}},function(t,e,n){var r=n(148),i=n(26);t.exports=function(t,e,n){var o=e(t);return i(t)?o:r(o,n(t))}},function(t,e,n){var r=n(226),i=n(224),o=n(222);t.exports=function(t){return r(t,o,i)}},function(t,e,n){var r=n(25).Uint8Array;t.exports=r},function(t,e,n){var r=n(564),i=n(567),o=n(568);t.exports=function(t,e,n,a,s,u){var c=1&n,l=t.length,f=e.length;if(l!=f&&!(c&&l<f))return!1;var h=u.get(t);if(h&&u.get(e))return h==e;var p=-1,d=!0,y=2&n?new r:void 0;for(u.set(t,e),u.set(e,t);++p<l;){var v=t[p],g=e[p];if(a)var m=c?a(g,v,p,e,t,u):a(v,g,p,t,e,u);if(void 0!==m){if(m)continue;d=!1;break}if(y){if(!i(e,function(t,e){if(!o(y,e)&&(v===t||s(v,t,n,a,u)))return y.push(e)})){d=!1;break}}else if(v!==g&&!s(v,g,n,a,u)){d=!1;break}}return u.delete(t),u.delete(e),d}},function(t,e,n){var r=n(573),i=n(574),o=n(575);t.exports=function(t,e){return t&&t.length?r(t,o(e,2),i):void 0}},function(t,e,n){var r=n(38);t.exports=function(t){return t==t&&!r(t)}},function(t,e){t.exports=function(t,e){return function(n){return null!=n&&n[t]===e&&(void 0!==e||t in Object(n))}}},function(t,e){t.exports=function(t,e){for(var n=-1,r=null==t?0:t.length,i=Array(r);++n<r;)i[n]=e(t[n],n,t);return i}},function(t,e,n){var r=n(592).WordTokenizer,i=n(596),o=new r;function a(t){return Array.isArray(t)?t:o.tokenize(t)}(t.exports=function(t){var e=1<arguments.length&&void 0!==arguments[1]?arguments[1]:i;return("string"==typeof t?a(t):t).map(function(t){return e.stem(t)})}).tokenize=a},function(t,e){var n=function(){};n.prototype.trim=function(t){for(;""==t[t.length-1];)t.pop();for(;""==t[0];)t.shift();return t},n.prototype.attach=function(){var t=this;String.prototype.tokenize=function(){return t.tokenize(this)}},n.prototype.tokenize=function(){},t.exports=n},function(t,e){e.words=["about","above","after","again","all","also","am","an","and","another","any","are","as","at","be","because","been","before","being","below","between","both","but","by","came","can","cannot","come","could","did","do","does","doing","during","each","few","for","from","further","get","got","has","had","he","have","her","here","him","himself","his","how","if","in","into","is","it","its","itself","like","make","many","me","might","more","most","much","must","my","myself","never","now","of","on","only","or","other","our","ours","ourselves","out","over","own","said","same","see","should","since","so","some","still","such","take","than","that","the","their","theirs","them","themselves","then","there","these","they","this","those","through","to","too","under","until","up","very","was","way","we","well","were","what","where","when","which","while","who","whom","with","would","why","you","your","yours","yourself","a","b","c","d","e","f","g","h","i","j","k","l","m","n","o","p","q","r","s","t","u","v","w","x","y","z","$","1","2","3","4","5","6","7","8","9","0","_"]},function(t,e){},function(t,e,n){"use strict";Object.defineProperty(e,"__esModule",{value:!0}),e.Block=void 0;var r=o(n(614)),i=o(n(615));function o(t){return t&&t.__esModule?t:{default:t}}e.default=r.default,e.Block=i.default,"undefined"!=typeof window&&(window.Thaw=r.default,window.Thaw.Block=i.default)},function(t,e,n){"use strict";Object.defineProperty(e,"__esModule",{value:!0}),e.default=function(t){return Math.max.apply(Math,(0,i.default)(t))};var r,i=(r=n(157))&&r.__esModule?r:{default:r}},function(t,e,n){"use strict";Object.defineProperty(e,"__esModule",{value:!0}),e.default=function(t){for(var e=0,n=0;n<t.length;n++)e+=t[n]*t[n];return e/t.length}},function(t,e,n){"use strict";Object.defineProperty(e,"__esModule",{value:!0}),e.default=function(t){for(var e=new Float32Array(t),n=0;n<t;n++)e[n]=(0,i.default)();return e};var r,i=(r=n(242))&&r.__esModule?r:{default:r}},function(t,e,n){"use strict";Object.defineProperty(e,"__esModule",{value:!0}),e.default=function(){return.4*Math.random()-.2}},function(t,e,n){"use strict";Object.defineProperty(e,"__esModule",{value:!0}),e.default=function(t,e){for(var n=[];t<e;t++)n.push(t);return n}},function(t,e,n){"use strict";Object.defineProperty(e,"__esModule",{value:!0}),e.default=function(t,e){if(this.length=0,e){this.prop=e;for(var n=this.table={},r=0;r<t.length;r++){var i=t[r][e];for(var o in i)n.hasOwnProperty(o)||(n[o]=this.length++)}}else if(Array.isArray(t[0]))for(var a=this.table={},s=0;s<t.length;s++)for(var u=t[s],c=0;c<u.length;c++){var l=u[c];for(var f in l)a.hasOwnProperty(f)||(a[f]=this.length++)}else for(var h=this.table={},p=0;p<t.length;p++){var d=t[p];for(var y in d)h.hasOwnProperty(y)||(h[y]=this.length++)}}},function(t,e,n){"use strict";Object.defineProperty(e,"__esModule",{value:!0}),e.arraysToFloat32Arrays=function(t){for(var e=[],n=0;n<t.length;n++)e.push(Float32Array.from(t[n]));return e},e.arrayToFloat32Arrays=function(t){for(var e=[],n=0;n<t.length;n++)e.push(Float32Array.from([t[n]]));return e},e.arrayToFloat32Array=function(t){return Float32Array.from(t)},e.objectsToFloat32Arrays=function(t,e,n){for(var r=[],i=0;i<t.length;i++){var o=t[i],a=new Float32Array(n);for(var s in o)o.hasOwnProperty(s)&&(a[e[s]]=o[s]);r.push(a)}return r},e.objectToFloat32Arrays=function(t){var e=[];for(var n in t)e.push(Float32Array.from([t[n]]));return e},e.objectToFloat32Array=function(t,e,n){var r=new Float32Array(n);for(var i in t)t.hasOwnProperty(i)&&(r[e[i]]=t[i]);return r}},function(t,e,n){"use strict";var r=function(){function t(t,e){for(var n=0;n<e.length;n++){var r=e[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(t,r.key,r)}}return function(e,n,r){return n&&t(e.prototype,n),r&&t(e,r),e}}(),i=function(){function t(){!function(e,n){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this)}return r(t,null,[{key:"isCanvas",value:function(t){return null!==t&&(t.nodeName&&t.getContext&&"CANVAS"===t.nodeName.toUpperCase()||"undefined"!=typeof OffscreenCanvas&&t instanceof OffscreenCanvas)}},{key:"isCanvasSupported",value:function(){return o}},{key:"initCanvas",value:function(){if(!o)return null;var t="undefined"!=typeof document?document.createElement("canvas"):new OffscreenCanvas(0,0);return t.width=2,t.height=2,t}},{key:"isWebGl",value:function(t){return t&&"function"==typeof t.getExtension}},{key:"isWebGl2",value:function(t){return t&&"undefined"!=typeof WebGL2RenderingContext&&t instanceof WebGL2RenderingContext}},{key:"isWebGlSupported",value:function(){return u}},{key:"isWebGl2Supported",value:function(){return c}},{key:"isWebGlDrawBuffersSupported",value:function(){return l}},{key:"initWebGlDefaultOptions",value:function(){return{alpha:!1,depth:!1,antialias:!1}}},{key:"initWebGl",value:function(e){if((void 0!==o||null===e)&&!o)return null;if(!t.isCanvas(e))throw new Error("Invalid canvas object - "+e);var n=null,r=t.initWebGlDefaultOptions();try{n=e.getContext("experimental-webgl",r)}catch(e){}return null===n&&(n=e.getContext("webgl2",r)||e.getContext("webgl",r)),n&&(n.OES_texture_float=n.getExtension("OES_texture_float"),n.OES_texture_float_linear=n.getExtension("OES_texture_float_linear"),n.OES_element_index_uint=n.getExtension("OES_element_index_uint")),n}},{key:"initWebGl2",value:function(e){if((void 0!==o||null===e)&&!o)return null;if(!t.isCanvas(e))throw new Error("Invalid canvas object - "+e);return e.getContext("webgl2",t.initWebGlDefaultOptions())}},{key:"checkOutput",value:function(t){if(!t||!Array.isArray(t))throw new Error("kernel.output not an array");for(var e=0;e<t.length;e++)if(isNaN(t[e])||t[e]<1)throw new Error("kernel.output["+e+"] incorrectly defined as `"+t[e]+"`, needs to be numeric, and greater than 0")}}]),t}(),o="undefined"!=typeof document?i.isCanvas(document.createElement("canvas")):"undefined"!=typeof OffscreenCanvas,a=i.initWebGl(i.initCanvas()),s=i.initWebGl2(i.initCanvas()),u=i.isWebGl(a),c=i.isWebGl2(s),l=u&&Boolean(a.getExtension("WEBGL_draw_buffers"));i.OES_element_index_uint=u?(i.OES_texture_float=a.OES_texture_float,i.OES_texture_float_linear=a.OES_texture_float_linear,a.OES_element_index_uint):(i.OES_texture_float=!1,i.OES_texture_float_linear=!1),t.exports=i},function(t,e,n){"use strict";function r(t){return(r="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t})(t)}var i=function(){function t(t,e){for(var n=0;n<e.length;n++){var r=e[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(t,r.key,r)}}return function(e,n,r){return n&&t(e.prototype,n),r&&t(e,r),e}}(),o=n(158),a=n(102),s=n(249);t.exports=function(t){function e(t){!function(t,n){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this);var n=function(t,e){if(!t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!e||"object"!==r(e)&&"function"!=typeof e?t:e}(this,(e.__proto__||Object.getPrototypeOf(e)).call(this,new s,t));return n.Kernel=a,n.kernel=null,n}return function(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function, not "+r(e));t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,enumerable:!1,writable:!0,configurable:!0}}),e&&(Object.setPrototypeOf?Object.setPrototypeOf(t,e):t.__proto__=e)}(e,o),i(e,[{key:"getMode",value:function(){return"gpu"}}]),e}()},function(t,e,n){"use strict";var r=function(){function t(t,e){for(var n=0;n<e.length;n++){var r=e[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(t,r.key,r)}}return function(e,n,r){return n&&t(e.prototype,n),r&&t(e,r),e}}(),i=n(10),o=n(101);t.exports=function(){function t(e,n){for(var r in function(e,n){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this),this.paramNames=i.getParamNamesFromString(e),this.fnString=e,this.output=null,this.debug=!1,this.graphical=!1,this.loopMaxIterations=0,this.constants=null,this.wraparound=null,this.hardcodeConstants=null,this.outputToTexture=null,this.outputImmutable=null,this.texSize=null,this._canvas=null,this._webGl=null,this.threadDim=null,this.floatTextures=null,this.floatOutput=null,this.floatOutputForce=null,this.addFunction=null,this.functions=null,this.nativeFunctions=null,this.subKernels=null,this.subKernelProperties=null,this.subKernelNames=null,this.subKernelOutputVariableNames=null,this.functionBuilder=null,this.paramTypes=null,this.paramSizes=null,this.constantTypes=null,this.fixIntegerDivisionAccuracy=null,n)n.hasOwnProperty(r)&&this.hasOwnProperty(r)&&(this[r]=n[r]);n.hasOwnProperty("canvas")&&(this._canvas=n.canvas),n.hasOwnProperty("webGl")&&(this._webGl=n.webGl),n.hasOwnProperty("output")&&this.setOutput(n.output),this._canvas||(this._canvas=i.initCanvas())}return r(t,[{key:"build",value:function(){throw new Error('"build" not defined on Base')}},{key:"setupParams",value:function(t){this.paramTypes=[],this.paramSizes=[];for(var e=0;e<t.length;e++){var n=t[e];this.paramTypes.push(i.getArgumentType(n)),this.paramSizes.push(n.constructor===o?n.size:null)}}},{key:"setupConstants",value:function(){if(this.constantTypes={},this.constants)for(var t in this.constants)this.constantTypes[t]=i.getArgumentType(this.constants[t])}},{key:"setFunctions",value:function(t){return this.functions=t,this}},{key:"setOutput",value:function(t){return t.hasOwnProperty("x")?t.hasOwnProperty("y")?t.hasOwnProperty("z")?this.output=[t.x,t.y,t.z]:this.output=[t.x,t.y]:this.output=[t.x]:this.output=t,this}},{key:"setDebug",value:function(t){return this.debug=t,this}},{key:"setGraphical",value:function(t){return this.graphical=t,this}},{key:"setLoopMaxIterations",value:function(t){return this.loopMaxIterations=t,this}},{key:"setFixIntegerDivisionAccuracy",value:function(t){return this.fixIntegerDivisionAccuracy=t,this}},{key:"setConstants",value:function(t){return this.constants=t,this}},{key:"setWraparound",value:function(t){return console.warn("Wraparound mode is not supported and undocumented."),this.wraparound=t,this}},{key:"setHardcodeConstants",value:function(t){return this.hardcodeConstants=t,this}},{key:"setOutputToTexture",value:function(t){return this.outputToTexture=t,this}},{key:"setOutputImmutable",value:function(t){return this.outputImmutable=t,this}},{key:"setFloatTextures",value:function(t){return this.floatTextures=t,this}},{key:"setFloatOutput",value:function(t){return this.floatOutput=t,this}},{key:"setFloatOutputForce",value:function(t){return this.floatOutputForce=t,this}},{key:"setCanvas",value:function(t){return this._canvas=t,this}},{key:"setWebGl",value:function(t){return this._webGl=t,this}},{key:"getCanvas",value:function(){return this._canvas}},{key:"getWebGl",value:function(){return this._webGl}},{key:"validateOptions",value:function(){throw new Error("validateOptions not defined")}},{key:"exec",value:function(){return this.execute.apply(this,arguments)}},{key:"execute",value:function(){var t=this,e=1===arguments.length?[arguments[0]]:Array.apply(null,arguments);return i.newPromise(function(n,r){try{n(t.run.apply(t,e))}catch(n){r(n)}})}},{key:"addSubKernel",value:function(t){return null===this.subKernels&&(this.subKernels=[],this.subKernelNames=[]),this.subKernels.push(t),this.subKernelNames.push(i.getFunctionNameFromString(t)),this}},{key:"addSubKernelProperty",value:function(t,e){if(null===this.subKernelProperties&&(this.subKernelProperties={},this.subKernelNames=[]),this.subKernelProperties.hasOwnProperty(t))throw new Error("cannot add sub kernel "+t+", already defined");return this.subKernelProperties[t]=e,this.subKernelNames.push(i.getFunctionNameFromString(e)),this}},{key:"addNativeFunction",value:function(t,e){this.functionBuilder.addNativeFunction(t,e)}},{key:"destroy",value:function(){}}]),t}()},function(t,e,n){"use strict";function r(t){return(r="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t})(t)}var i=function(){function t(t,e){for(var n=0;n<e.length;n++){var r=e[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(t,r.key,r)}}return function(e,n,r){return n&&t(e.prototype,n),r&&t(e,r),e}}(),o=n(160),a=n(161);function s(t){return Math.floor(t+.5)}t.exports=function(t){function e(){!function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,e);var t=function(t,e){if(!t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!e||"object"!==r(e)&&"function"!=typeof e?t:e}(this,(e.__proto__||Object.getPrototypeOf(e)).call(this));return t.Node=a,t}return function(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function, not "+r(e));t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,enumerable:!1,writable:!0,configurable:!0}}),e&&(Object.setPrototypeOf?Object.setPrototypeOf(t,e):t.__proto__=e)}(e,o),i(e,[{key:"polyfillStandardFunctions",value:function(){this.addFunction("round",s)}}],[{key:"round",value:function(t){return s(t)}}]),e}()},function(module,exports,__webpack_require__){"use strict";function _typeof2(t){return(_typeof2="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t})(t)}var _typeof="function"==typeof Symbol&&"symbol"===_typeof2(Symbol.iterator)?function(t){return _typeof2(t)}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":_typeof2(t)},_createClass=function(){function t(t,e){for(var n=0;n<e.length;n++){var r=e[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(t,r.key,r)}}return function(e,n,r){return n&&t(e.prototype,n),r&&t(e,r),e}}();function _classCallCheck(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}var utils=__webpack_require__(10),acorn=__webpack_require__(621);module.exports=function(){function BaseFunctionNode(t,e,n){_classCallCheck(this,BaseFunctionNode),this.calledFunctions=[],this.calledFunctionsArguments={},this.builder=null,this.isRootKernel=!1,this.isSubKernel=!1,this.parent=null,this.debug=null,this.prototypeOnly=null,this.constants=null,this.output=null,this.declarations={},this.states=[],this.fixIntegerDivisionAccuracy=null;var r=void 0,i=void 0;if(n&&(n.hasOwnProperty("debug")&&(this.debug=n.debug),n.hasOwnProperty("prototypeOnly")&&(this.prototypeOnly=n.prototypeOnly),n.hasOwnProperty("constants")&&(this.constants=n.constants),n.hasOwnProperty("output")&&(this.output=n.output),n.hasOwnProperty("loopMaxIterations")&&(this.loopMaxIterations=n.loopMaxIterations),n.hasOwnProperty("paramTypes")&&(this.paramTypes=r=n.paramTypes),n.hasOwnProperty("constantTypes")?this.constantTypes=n.constantTypes:this.constantTypes={},n.hasOwnProperty("returnType")&&(i=n.returnType),n.hasOwnProperty("fixIntegerDivisionAccuracy")&&(this.fixIntegerDivisionAccuracy=n.fixIntegerDivisionAccuracy)),!e)throw"jsFunction, parameter is missing";if(this.jsFunctionString=e.toString(),!utils.isFunctionString(this.jsFunctionString))throw console.error("jsFunction, to string conversion check failed: not a function?",this.jsFunctionString),"jsFunction, to string conversion check failed: not a function?";if(utils.isFunction(e)?this.jsFunction=e:this.jsFunction=null,this.functionName=t||e&&e.name||utils.getFunctionNameFromString(this.jsFunctionString),!this.functionName)throw"jsFunction, missing name argument or value";if(this.paramNames=utils.getParamNamesFromString(this.jsFunctionString),r){if(Array.isArray(r)){if(r.length!==this.paramNames.length)throw"Invalid argument type array length, against function length -> ("+r.length+","+this.paramNames.length+")";this.paramTypes=r}else if("object"===(void 0===r?"undefined":_typeof(r))){var o=Object.keys(r);if(r.hasOwnProperty("returns")&&(this.returnType=r.returns,o.splice(o.indexOf("returns"),1)),0<o.length&&o.length!==this.paramNames.length)throw"Invalid argument type array length, against function length -> ("+o.length+","+this.paramNames.length+")";this.paramTypes=this.paramNames.map(function(t){return r.hasOwnProperty(t)?r[t]:"Number"})}}else this.paramTypes=[];this.returnType||(this.returnType=i||"Number")}return _createClass(BaseFunctionNode,[{key:"isIdentifierConstant",value:function(t){return!!this.constants&&this.constants.hasOwnProperty(t)}},{key:"isInput",value:function(t){return"Input"===this.paramTypes[this.paramNames.indexOf(t)]}},{key:"setBuilder",value:function(t){return this.builder=t,this}},{key:"pushState",value:function(t){this.states.push(t)}},{key:"popState",value:function(t){if(this.state!==t)throw new Error("Cannot popState "+t+" when in "+this.state);this.states.pop()}},{key:"isState",value:function(t){return this.state===t}},{key:"getJsFunction",value:function getJsFunction(){if(this.jsFunction)return this.jsFunction;if(this.jsFunctionString)return this.jsFunction=eval(this.jsFunctionString),this.jsFunction;throw"Missing jsFunction, and jsFunctionString parameter"}},{key:"astMemberExpressionUnroll",value:function(t){if("Identifier"===t.type)return t.name;if("ThisExpression"===t.type)return"this";if("MemberExpression"===t.type&&t.object&&t.property)return t.object.hasOwnProperty("name")&&"_"===t.object.name[0]?this.astMemberExpressionUnroll(t.property):this.astMemberExpressionUnroll(t.object)+"."+this.astMemberExpressionUnroll(t.property);if(t.hasOwnProperty("expressions")){var e=t.expressions[0];if("Literal"===e.type&&0===e.value&&2===t.expressions.length)return this.astMemberExpressionUnroll(t.expressions[1])}throw this.astErrorOutput("Unknown CallExpression_unroll",t)}},{key:"getJsAST",value:function(t){if(this.jsFunctionAST)return this.jsFunctionAST;if(null===(t=t||acorn))throw"Missing JS to AST parser";var e=t.parse("var "+this.functionName+" = "+this.jsFunctionString+";",{locations:!0});if(null===e)throw"Failed to parse JS code";var n=e.body[0].declarations[0].init;return this.jsFunctionAST=n}},{key:"getFunctionString",value:function(){return this.generate(),this.functionString}},{key:"setFunctionString",value:function(t){this.functionString=t}},{key:"getParamType",value:function(t){var e=this.paramNames.indexOf(t);if(-1===e)return this.declarations.hasOwnProperty(t)?this.declarations[t]:"Number";if(this.parent){if(this.paramTypes[e])return this.paramTypes[e];for(var n=this.parent.calledFunctionsArguments[this.functionName],r=0;r<n.length;r++){var i=n[r];if(null!==i[e])return this.paramTypes[e]=i[e].type}}else if(this.paramTypes[e])return this.paramTypes[e];return"Number"}},{key:"getConstantType",value:function(t){return this.constantTypes[t]?this.constantTypes[t]:null}},{key:"getUserParamName",value:function(t){var e=this.paramNames.indexOf(t);if(-1===e)return null;if(!this.parent||!this.isSubKernel)return null;for(var n=this.parent.calledFunctionsArguments[this.functionName],r=0;r<n.length;r++){var i=n[r][e];if(null!==i&&"Integer"!==i.type)return i.name}return null}},{key:"generate",value:function(t){throw new Error("generate not defined on BaseFunctionNode")}},{key:"astGeneric",value:function(t,e){if(null===t)throw this.astErrorOutput("NULL ast",t);if(Array.isArray(t)){for(var n=0;n<t.length;n++)this.astGeneric(t[n],e);return e}switch(t.type){case"FunctionDeclaration":return this.astFunctionDeclaration(t,e);case"FunctionExpression":return this.astFunctionExpression(t,e);case"ReturnStatement":return this.astReturnStatement(t,e);case"Literal":return this.astLiteral(t,e);case"BinaryExpression":return this.astBinaryExpression(t,e);case"Identifier":return this.astIdentifierExpression(t,e);case"AssignmentExpression":return this.astAssignmentExpression(t,e);case"ExpressionStatement":return this.astExpressionStatement(t,e);case"EmptyStatement":return this.astEmptyStatement(t,e);case"BlockStatement":return this.astBlockStatement(t,e);case"IfStatement":return this.astIfStatement(t,e);case"BreakStatement":return this.astBreakStatement(t,e);case"ContinueStatement":return this.astContinueStatement(t,e);case"ForStatement":return this.astForStatement(t,e);case"WhileStatement":return this.astWhileStatement(t,e);case"DoWhileStatement":return this.astDoWhileStatement(t,e);case"VariableDeclaration":return this.astVariableDeclaration(t,e);case"VariableDeclarator":return this.astVariableDeclarator(t,e);case"ThisExpression":return this.astThisExpression(t,e);case"SequenceExpression":return this.astSequenceExpression(t,e);case"UnaryExpression":return this.astUnaryExpression(t,e);case"UpdateExpression":return this.astUpdateExpression(t,e);case"LogicalExpression":return this.astLogicalExpression(t,e);case"MemberExpression":return this.astMemberExpression(t,e);case"CallExpression":return this.astCallExpression(t,e);case"ArrayExpression":return this.astArrayExpression(t,e);case"DebuggerStatement":return this.astDebuggerStatement(t,e)}throw this.astErrorOutput("Unknown ast type : "+t.type,t)}},{key:"astErrorOutput",value:function(t,e){return console.error(utils.getAstString(this.jsFunctionString,e)),console.error(t,e,this),t}},{key:"astDebuggerStatement",value:function(t,e){return e}},{key:"astFunctionDeclaration",value:function(t,e){return e}},{key:"astFunctionExpression",value:function(t,e){return e}},{key:"astReturnStatement",value:function(t,e){return e}},{key:"astLiteral",value:function(t,e){return e}},{key:"astBinaryExpression",value:function(t,e){return e}},{key:"astIdentifierExpression",value:function(t,e){return e}},{key:"astAssignmentExpression",value:function(t,e){return e}},{key:"astExpressionStatement",value:function(t,e){return e}},{key:"astEmptyStatement",value:function(t,e){return e}},{key:"astBlockStatement",value:function(t,e){return e}},{key:"astIfStatement",value:function(t,e){return e}},{key:"astBreakStatement",value:function(t,e){return e}},{key:"astContinueStatement",value:function(t,e){return e}},{key:"astForStatement",value:function(t,e){return e}},{key:"astWhileStatement",value:function(t,e){return e}},{key:"astDoWhileStatement",value:function(t,e){return e}},{key:"astVariableDeclaration",value:function(t,e){return e}},{key:"astVariableDeclarator",value:function(t,e){return e}},{key:"astThisExpression",value:function(t,e){return e}},{key:"astSequenceExpression",value:function(t,e){return e}},{key:"astUnaryExpression",value:function(t,e){return e}},{key:"astUpdateExpression",value:function(t,e){return e}},{key:"astLogicalExpression",value:function(t,e){return e}},{key:"astMemberExpression",value:function(t,e){return e}},{key:"astCallExpression",value:function(t,e){return e}},{key:"astArrayExpression",value:function(t,e){return e}},{key:"pushParameter",value:function(t,e){this.isState("in-get-call-parameters")?t.push("int("+e+")"):t.push(e)}},{key:"state",get:function(){return this.states[this.states.length-1]}}]),BaseFunctionNode}()},function(t,e,n){"use strict";function r(t){return(r="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t})(t)}var i=function(){function t(t,e){for(var n=0;n<e.length;n++){var r=e[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(t,r.key,r)}}return function(e,n,r){return n&&t(e.prototype,n),r&&t(e,r),e}}(),o=n(158),a=n(252),s=n(162);t.exports=function(t){function e(t){!function(t,n){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this);var n=function(t,e){if(!t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!e||"object"!==r(e)&&"function"!=typeof e?t:e}(this,(e.__proto__||Object.getPrototypeOf(e)).call(this,new a,t));return n.Kernel=s,n.kernel=null,n}return function(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function, not "+r(e));t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,enumerable:!1,writable:!0,configurable:!0}}),e&&(Object.setPrototypeOf?Object.setPrototypeOf(t,e):t.__proto__=e)}(e,o),i(e,[{key:"getMode",value:function(){return"gpu"}}]),e}()},function(t,e,n){"use strict";function r(t){return(r="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t})(t)}var i=n(160),o=n(253);t.exports=function(t){function e(){!function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,e);var t=function(t,e){if(!t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!e||"object"!==r(e)&&"function"!=typeof e?t:e}(this,(e.__proto__||Object.getPrototypeOf(e)).call(this));return t.Node=o,t}return function(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function, not "+r(e));t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,enumerable:!1,writable:!0,configurable:!0}}),e&&(Object.setPrototypeOf?Object.setPrototypeOf(t,e):t.__proto__=e)}(e,i),e}()},function(t,e,n){"use strict";function r(t){return(r="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t})(t)}var i=function(){function t(t,e){for(var n=0;n<e.length;n++){var r=e[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(t,r.key,r)}}return function(e,n,r){return n&&t(e.prototype,n),r&&t(e,r),e}}(),o=n(161),a=/decode32\(\s+encode32\(/g,s=/encode32\(\s+decode32\(/g;t.exports=function(t){function e(){return function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,e),function(t,e){if(!t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!e||"object"!==r(e)&&"function"!=typeof e?t:e}(this,(e.__proto__||Object.getPrototypeOf(e)).apply(this,arguments))}return function(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function, not "+r(e));t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,enumerable:!1,writable:!0,configurable:!0}}),e&&(Object.setPrototypeOf?Object.setPrototypeOf(t,e):t.__proto__=e)}(e,o),i(e,[{key:"generate",value:function(){return this.debug&&console.log(this),this.prototypeOnly?this.astFunctionPrototype(this.getJsAST(),[]).join("").trim():(this.functionStringArray=this.astGeneric(this.getJsAST(),[]),this.functionString=this.functionStringArray.join("").trim().replace(a,"((").replace(s,"(("),this.functionString)}},{key:"astIdentifierExpression",value:function(t,e){if("Identifier"!==t.type)throw this.astErrorOutput("IdentifierExpression - not an Identifier",t);var n=!this.isState("in-get-call-parameters");switch(t.name){case"gpu_threadX":n&&e.push("float("),e.push("threadId.x"),n&&e.push(")");break;case"gpu_threadY":n&&e.push("float("),e.push("threadId.y"),n&&e.push(")");break;case"gpu_threadZ":n&&e.push("float("),e.push("threadId.z"),n&&e.push(")");break;case"gpu_outputX":e.push("uOutputDim.x");break;case"gpu_outputY":e.push("uOutputDim.y");break;case"gpu_outputZ":e.push("uOutputDim.z");break;case"Infinity":e.push("intBitsToFloat(2139095039)");break;default:var r=this.getUserParamName(t.name);null!==r?this.pushParameter(e,"user_"+r):this.pushParameter(e,"user_"+t.name)}return e}}]),e}()},function(t,e,n){"use strict";function r(t){return(r="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t})(t)}var i=function(){function t(t,e){for(var n=0;n<e.length;n++){var r=e[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(t,r.key,r)}}return function(e,n,r){return n&&t(e.prototype,n),r&&t(e,r),e}}();n(10);var o=n(158),a=n(255),s=n(256);t.exports=function(t){function e(t){!function(t,n){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this);var n=function(t,e){if(!t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!e||"object"!==r(e)&&"function"!=typeof e?t:e}(this,(e.__proto__||Object.getPrototypeOf(e)).call(this,new s,t));return n.Kernel=a,n.kernel=null,n}return function(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function, not "+r(e));t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,enumerable:!1,writable:!0,configurable:!0}}),e&&(Object.setPrototypeOf?Object.setPrototypeOf(t,e):t.__proto__=e)}(e,o),i(e,[{key:"getMode",value:function(){return"cpu"}}]),e}()},function(t,e,n){"use strict";function r(t){return(r="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t})(t)}var i=function(){function t(t,e){for(var n=0;n<e.length;n++){var r=e[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(t,r.key,r)}}return function(e,n,r){return n&&t(e.prototype,n),r&&t(e,r),e}}(),o=n(248),a=n(10),s=n(624);t.exports=function(t){function e(t,n){!function(t,n){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this);var i=function(t,e){if(!t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!e||"object"!==r(e)&&"function"!=typeof e?t:e}(this,(e.__proto__||Object.getPrototypeOf(e)).call(this,t,n));return i._fn=null,i.run=null,i._canvasCtx=null,i._imageData=null,i._colorData=null,i._kernelString=null,i.thread={x:0,y:0,z:0},i.run=function(){return this.run=null,this.build.apply(this,arguments),this.run.apply(this,arguments)}.bind(i),i}return function(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function, not "+r(e));t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,enumerable:!1,writable:!0,configurable:!0}}),e&&(Object.setPrototypeOf?Object.setPrototypeOf(t,e):t.__proto__=e)}(e,o),i(e,[{key:"validateOptions",value:function(){if(!this.output||0===this.output.length){if(1!==arguments.length)throw"Auto dimensions only supported for kernels with only one input";var t=a.getArgumentType(arguments[0]);if("Array"===t)this.output=a.getDimensions(t);else{if("NumberTexture"!==t&&"ArrayTexture(4)"!==t)throw"Auto dimensions not supported for input type: "+t;this.output=arguments[0].output}}a.checkOutput(this.output)}},{key:"build",value:function(){this.setupConstants(),this.setupParams(arguments),this.validateOptions();var t=this._canvas;t&&(this._canvasCtx=t.getContext("2d"));for(var e=this.threadDim=a.clone(this.output);e.length<3;)e.push(1);if(this.graphical){var n=this._canvas;if(!n)throw new Error("no canvas available for using graphical output");n.width=e[0],n.height=e[1],this._imageData=this._canvasCtx.createImageData(e[0],e[1]),this._colorData=new Uint8ClampedArray(e[0]*e[1]*4)}var r=this.getKernelString();this.debug&&(console.log("Options:"),console.dir(this),console.log("Function output:"),console.log(r)),this.kernelString=r,this.run=new Function([],r).bind(this)()}},{key:"color",value:function(t,e,n,r){void 0===r&&(r=1),t=Math.floor(255*t),e=Math.floor(255*e),n=Math.floor(255*n),r=Math.floor(255*r);var i=this.output[0],o=this.output[1],a=this.thread.x+(o-this.thread.y-1)*i;this._colorData[4*a+0]=t,this._colorData[4*a+1]=e,this._colorData[4*a+2]=n,this._colorData[4*a+3]=r}},{key:"getKernelString",value:function(){if(null!==this._kernelString)return this._kernelString;for(var t=this.functionBuilder,e=this.threadDim||(this.threadDim=a.clone(this.output));e.length<3;)e.push(1);if(t.addKernel(this.fnString,{prototypeOnly:!1,constants:this.constants,output:e,debug:this.debug,loopMaxIterations:this.loopMaxIterations,paramNames:this.paramNames,paramTypes:this.paramTypes,paramSizes:this.paramSizes,constantTypes:this.constantTypes}),t.addFunctions(this.functions,{constants:this.constants,output:e}),t.addNativeFunctions(this.nativeFunctions),null!==this.subKernels){this.subKernelOutputTextures=[],this.subKernelOutputVariableNames=[];for(var n=0;n<this.subKernels.length;n++){var r=this.subKernels[n];t.addSubKernel(r,{prototypeOnly:!1,constants:this.constants,output:this.output,debug:this.debug,loopMaxIterations:this.loopMaxIterations}),this.subKernelOutputVariableNames.push(r.name+"Result")}}else if(null!==this.subKernelProperties)for(var i in this.subKernelOutputVariableNames=[],this.subKernelProperties)if(this.subKernelProperties.hasOwnProperty(i)){var o=this.subKernelProperties[i];t.addSubKernel(o),this.subKernelOutputVariableNames.push(o.name+"Result")}var s=t.getPrototypes("kernel"),u=null;return 1<s.length?s=s.filter(function(t){return/^function/.test(t)?t:(u=t,!1)}):u=s.shift(),this._kernelString="\n\t\tvar LOOP_MAX = "+this._getLoopMaxString()+"\n\t\tvar constants = this.constants;\n\t\tvar _this = this;\n    return function ("+this.paramNames.map(function(t){return"user_"+t}).join(", ")+") {\n      "+this._processConstants()+"\n      "+this._processParams()+"\n      "+this._kernelLoop(u)+"\n      if (this.graphical) {\n        this._imageData.data.set(this._colorData);\n        this._canvasCtx.putImageData(this._imageData, 0, 0);\n        return;\n      }\n      "+this._kernelOutput()+"\n      "+(0<s.length?s.join("\n"):"")+"\n    }.bind(this);"}},{key:"toString",value:function(){return s(this)}},{key:"_getLoopMaxString",value:function(){return this.loopMaxIterations?" "+parseInt(this.loopMaxIterations)+";\n":" 1000;\n"}},{key:"_processConstants",value:function(){if(!this.constants)return"";var t=[];for(var e in this.constants)switch(this.constantTypes[e]){case"HTMLImage":t.push("  var constants_"+e+" = this._imageTo2DArray(this.constants."+e+")");break;case"HTMLImageArray":t.push("  var constants_"+e+" = this._imageTo3DArray(this.constants."+e+")");break;case"Input":t.push("  var constants_"+e+" = this.constants."+e+".value");break;default:t.push("  var constants_"+e+" = this.constants."+e)}return t.join("\n")}},{key:"_processParams",value:function(){for(var t=[],e=0;e<this.paramTypes.length;e++)switch(this.paramTypes[e]){case"HTMLImage":t.push("  user_"+this.paramNames[e]+" = this._imageTo2DArray(user_"+this.paramNames[e]+")");break;case"HTMLImageArray":t.push("  user_"+this.paramNames[e]+" = this._imageTo3DArray(user_"+this.paramNames[e]+")");break;case"Input":t.push("  user_"+this.paramNames[e]+" = user_"+this.paramNames[e]+".value")}return t.join(";\n")}},{key:"_imageTo2DArray",value:function(t){var e=this._canvas;e.width<t.width&&(e.width=t.width),e.height<t.height&&(e.height=t.height);var n=this._canvasCtx;n.drawImage(t,0,0,t.width,t.height);for(var r=n.getImageData(0,0,t.width,t.height).data,i=new Array(t.height),o=0,a=t.height-1;0<=a;a--){i[a]=new Array(t.width);for(var s=0;s<t.width;s++){var u=r[o++]/255,c=r[o++]/255,l=r[o++]/255,f=r[o++]/255,h=[u,c,l,f];h.r=u,h.g=c,h.b=l,h.a=f,i[a][s]=h}}return i}},{key:"_imageTo3DArray",value:function(t){for(var e=new Array(t.length),n=0;n<t.length;n++)e[n]=this._imageTo2DArray(t[n]);return e}},{key:"_kernelLoop",value:function(t){switch(this.output.length){case 1:return this._kernel1DLoop(t);case 2:return this._kernel2DLoop(t);case 3:return this._kernel3DLoop(t);default:throw new Error("unsupported size kernel")}}},{key:"_kernel1DLoop",value:function(t){var e=this.threadDim;return"\n    var result = new Float32Array("+e[0]+");\n    "+this._mapSubKernels(function(t){return"var result_"+t+" = new Float32Array("+e[0]+");\n"}).join("")+"\n    for (var x = 0; x < "+e[0]+"; x++) {\n      this.thread.x = x;\n      this.thread.y = 0;\n      this.thread.z = 0;\n      var kernelResult;\n      "+t+"\n      result[x] = kernelResult;\n      "+this._mapSubKernels(function(t){return"result_"+t+"[x] = "+t+";\n"}).join("")+"\n    }"}},{key:"_kernel2DLoop",value:function(t){var e=this.threadDim;return"\n    var result = new Array("+e[1]+");\n    "+this._mapSubKernels(function(t){return"var result_"+t+" = new Array("+e[1]+");\n"}).join("")+"\n    for (var y = 0; y < "+e[1]+"; y++) {\n      this.thread.z = 0;\n      this.thread.y = y;\n      var resultX = result[y] = new Float32Array("+e[0]+");\n      "+this._mapSubKernels(function(t){return"var result_"+t+"X = result_"+t+"[y] = new Float32Array("+e[0]+");\n"}).join("")+"\n      for (var x = 0; x < "+e[0]+"; x++) {\n      \tthis.thread.x = x;\n        var kernelResult;\n        "+t+"\n        resultX[x] = kernelResult;\n        "+this._mapSubKernels(function(t){return"result_"+t+"X[x] = "+t+";\n"}).join("")+"\n      }\n    }"}},{key:"_kernel3DLoop",value:function(t){var e=this.threadDim;return"\n    var result = new Array("+e[2]+");\n    "+this._mapSubKernels(function(t){return"var result_"+t+" = new Array("+e[2]+");\n"}).join("")+"\n    for (var z = 0; z < "+e[2]+"; z++) {\n      this.thread.z = z;\n      var resultY = result[z] = new Array("+e[1]+");\n      "+this._mapSubKernels(function(t){return"var result_"+t+"Y = result_"+t+"[z] = new Array("+e[1]+");\n"}).join("")+"\n      for (var y = 0; y < "+e[1]+"; y++) {\n        this.thread.y = y;\n        var resultX = resultY[y] = new Float32Array("+e[0]+");\n        "+this._mapSubKernels(function(t){return"var result_"+t+"X = result_"+t+"Y[y] = new Float32Array("+e[0]+");\n"}).join("")+"\n        for (var x = 0; x < "+e[0]+"; x++) {\n        \tthis.thread.x = x;\n          var kernelResult;\n          "+t+"\n          resultX[x] = kernelResult;\n          "+this._mapSubKernels(function(t){return"result_"+t+"X[x] = "+t+";\n"}).join("")+"\n        }\n      }\n    }"}},{key:"_kernelOutput",value:function(){var t=this;return this.subKernelOutputVariableNames?"return {\n      result: result,\n      "+Object.keys(this.subKernelProperties||this.subKernelOutputVariableNames).map(function(e,n){return e+": result_"+t.subKernelOutputVariableNames[n]}).join(",\n")+"\n    };":"return result;"}},{key:"_mapSubKernels",value:function(t){return null===this.subKernelOutputVariableNames?[""]:this.subKernelOutputVariableNames.map(t)}}]),e}()},function(t,e,n){"use strict";function r(t){return(r="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t})(t)}var i=n(160),o=n(257);t.exports=function(t){function e(){!function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,e);var t=function(t,e){if(!t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!e||"object"!==r(e)&&"function"!=typeof e?t:e}(this,(e.__proto__||Object.getPrototypeOf(e)).call(this));return t.Node=o,t}return function(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function, not "+r(e));t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,enumerable:!1,writable:!0,configurable:!0}}),e&&(Object.setPrototypeOf?Object.setPrototypeOf(t,e):t.__proto__=e)}(e,i),e}()},function(t,e,n){"use strict";function r(t){return(r="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t})(t)}var i=function(){function t(t,e){for(var n=0;n<e.length;n++){var r=e[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(t,r.key,r)}}return function(e,n,r){return n&&t(e.prototype,n),r&&t(e,r),e}}(),o=n(250),a=n(10);t.exports=function(t){function e(t,n,i){!function(t,n){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this);var o=function(t,e){if(!t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!e||"object"!==r(e)&&"function"!=typeof e?t:e}(this,(e.__proto__||Object.getPrototypeOf(e)).call(this,t,n,i));return o.paramSizes=i?i.paramSizes:[],o.memberStates=[],o}return function(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function, not "+r(e));t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,enumerable:!1,writable:!0,configurable:!0}}),e&&(Object.setPrototypeOf?Object.setPrototypeOf(t,e):t.__proto__=e)}(e,o),i(e,[{key:"pushMemberState",value:function(t){this.memberStates.push(t)}},{key:"popMemberState",value:function(t){if(this.memberState!==t)throw new Error("Cannot popMemberState "+t+" when in "+this.memberState);this.memberStates.pop()}},{key:"generate",value:function(){return this.debug&&console.log(this),this.functionStringArray=this.astGeneric(this.getJsAST(),[]),this.functionString=this.functionStringArray.join("").trim(),this.functionString}},{key:"getFunctionPrototypeString",value:function(){return this.webGlFunctionPrototypeString?this.webGlFunctionPrototypeString:this.webGlFunctionPrototypeString=this.generate()}},{key:"astFunctionDeclaration",value:function(t,e){return this.builder.addFunction(null,a.getAstString(this.jsFunctionString,t)),e}},{key:"astFunctionPrototype",value:function(t,e){if(this.isRootKernel||this.isSubKernel)return e;e.push(this.returnType),e.push(" "),e.push(this.functionName),e.push("(");for(var n=0;n<this.paramNames.length;++n)0<n&&e.push(", "),e.push("user_"),e.push(this.paramNames[n]);return e.push(");\n"),e}},{key:"astFunctionExpression",value:function(t,e){if(!this.isRootKernel){e.push("function"),e.push(" "),e.push(this.functionName),e.push("(");for(var n=0;n<this.paramNames.length;++n){var r=this.paramNames[n];0<n&&e.push(", "),e.push("user_"),e.push(r)}e.push(") {\n")}for(var i=0;i<t.body.body.length;++i)this.astGeneric(t.body.body[i],e),e.push("\n");return this.isRootKernel||e.push("}\n"),e}},{key:"astReturnStatement",value:function(t,e){return this.isRootKernel?(e.push("kernelResult = "),this.astGeneric(t.argument,e),e.push(";")):this.isSubKernel?(e.push(this.functionName+"Result = "),this.astGeneric(t.argument,e),e.push(";"),e.push("return "+this.functionName+"Result;")):(e.push("return "),this.astGeneric(t.argument,e),e.push(";")),e}},{key:"astLiteral",value:function(t,e){if(isNaN(t.value))throw this.astErrorOutput("Non-numeric literal not supported : "+t.value,t);return e.push(t.value),e}},{key:"astBinaryExpression",value:function(t,e){return e.push("("),this.astGeneric(t.left,e),e.push(t.operator),this.astGeneric(t.right,e),e.push(")"),e}},{key:"astIdentifierExpression",value:function(t,e){if("Identifier"!==t.type)throw this.astErrorOutput("IdentifierExpression - not an Identifier",t);switch(this.state){case"input-index-y":case"input-index-z":e.push("(")}switch(t.name){case"gpu_threadX":e.push("threadId.x");break;case"gpu_threadY":e.push("threadId.y");break;case"gpu_threadZ":e.push("threadId.z");break;case"gpu_outputX":e.push("uOutputDim.x");break;case"gpu_outputY":e.push("uOutputDim.y");break;case"gpu_outputZ":e.push("uOutputDim.z");break;case"Infinity":e.push("Infinity");break;default:if(this.constants&&this.constants.hasOwnProperty(t.name))e.push("constants_"+t.name);else{var n=this.getUserParamName(t.name);null!==n?e.push("user_"+n):e.push("user_"+t.name)}}switch(this.state){case"input-index-y":var r=this.paramSizes[this.paramNames.indexOf(this.memberState)];e.push(" * "+r[0]+")");break;case"input-index-z":var i=this.paramSizes[this.paramNames.indexOf(this.memberState)];e.push(" * "+i[0]*i[1]+")")}return e}},{key:"astForStatement",value:function(t,e){if("ForStatement"!==t.type)throw this.astErrorOutput("Invalid for statement",t);if(t.test&&"BinaryExpression"===t.test.type){if(("Identifier"===t.test.right.type||"Literal"===t.test.right.type)&&"<"===t.test.operator&&!1===this.isIdentifierConstant(t.test.right.name)){if(this.loopMaxIterations||(console.warn("Warning: loopMaxIterations is not set! Using default of 1000 which may result in unintended behavior."),console.warn("Set loopMaxIterations or use a for loop of fixed length to silence this message.")),e.push("for ("),this.astGeneric(t.init,e),";"!==e[e.length-1]&&e.push(";"),this.astGeneric(t.test.left,e),e.push(t.test.operator),e.push("LOOP_MAX"),e.push(";"),this.astGeneric(t.update,e),e.push(")"),e.push("{\n"),e.push("if ("),this.astGeneric(t.test.left,e),e.push(t.test.operator),this.astGeneric(t.test.right,e),e.push(") {\n"),"BlockStatement"===t.body.type)for(var n=0;n<t.body.body.length;n++)this.astGeneric(t.body.body[n],e);else this.astGeneric(t.body,e);return e.push("} else {\n"),e.push("break;\n"),e.push("}\n"),e.push("}\n"),e}if(t.init.declarations){var r=JSON.parse(JSON.stringify(t.init.declarations)),i=t.update.argument;if(!Array.isArray(r)||r.length<1)throw console.log(this.jsFunctionString),new Error("Error: Incompatible for loop declaration");if(1<r.length){for(var o=null,a=0;a<r.length;a++){var s=r[a];s.id.name===i.name?(o=s,r.splice(a,1)):(e.push("var "),this.astGeneric(s,e),e.push(";"))}e.push("for (let "),this.astGeneric(o,e),e.push(";")}else e.push("for ("),this.astGeneric(t.init,e);return this.astGeneric(t.test,e),e.push(";"),this.astGeneric(t.update,e),e.push(")"),this.astGeneric(t.body,e),e}}throw this.astErrorOutput("Invalid for statement",t)}},{key:"astWhileStatement",value:function(t,e){if("WhileStatement"!==t.type)throw this.astErrorOutput("Invalid while statement",t);return e.push("for (let i = 0; i < LOOP_MAX; i++) {"),e.push("if ("),this.astGeneric(t.test,e),e.push(") {\n"),this.astGeneric(t.body,e),e.push("} else {\n"),e.push("break;\n"),e.push("}\n"),e.push("}\n"),e}},{key:"astDoWhileStatement",value:function(t,e){if("DoWhileStatement"!==t.type)throw this.astErrorOutput("Invalid while statement",t);return e.push("for (let i = 0; i < LOOP_MAX; i++) {"),this.astGeneric(t.body,e),e.push("if (!"),this.astGeneric(t.test,e),e.push(") {\n"),e.push("break;\n"),e.push("}\n"),e.push("}\n"),e}},{key:"astAssignmentExpression",value:function(t,e){return this.astGeneric(t.left,e),e.push(t.operator),this.astGeneric(t.right,e),e}},{key:"astEmptyStatement",value:function(t,e){return e}},{key:"astBlockStatement",value:function(t,e){e.push("{\n");for(var n=0;n<t.body.length;n++)this.astGeneric(t.body[n],e);return e.push("}\n"),e}},{key:"astExpressionStatement",value:function(t,e){return this.astGeneric(t.expression,e),e.push(";"),e}},{key:"astVariableDeclaration",value:function(t,e){e.push("var ");for(var n=0;n<t.declarations.length;n++)this.declarations[t.declarations[n].id.name]="var",0<n&&e.push(","),this.astGeneric(t.declarations[n],e);return e.push(";"),e}},{key:"astVariableDeclarator",value:function(t,e){return this.astGeneric(t.id,e),null!==t.init&&(e.push("="),this.astGeneric(t.init,e)),e}},{key:"astIfStatement",value:function(t,e){return e.push("if ("),this.astGeneric(t.test,e),e.push(")"),"BlockStatement"===t.consequent.type?this.astGeneric(t.consequent,e):(e.push(" {\n"),this.astGeneric(t.consequent,e),e.push("\n}\n")),t.alternate&&(e.push("else "),"BlockStatement"===t.alternate.type?this.astGeneric(t.alternate,e):(e.push(" {\n"),this.astGeneric(t.alternate,e),e.push("\n}\n"))),e}},{key:"astBreakStatement",value:function(t,e){return e.push("break;\n"),e}},{key:"astContinueStatement",value:function(t,e){return e.push("continue;\n"),e}},{key:"astLogicalExpression",value:function(t,e){return e.push("("),this.astGeneric(t.left,e),e.push(t.operator),this.astGeneric(t.right,e),e.push(")"),e}},{key:"astUpdateExpression",value:function(t,e){return t.prefix?(e.push(t.operator),this.astGeneric(t.argument,e)):(this.astGeneric(t.argument,e),e.push(t.operator)),e}},{key:"astUnaryExpression",value:function(t,e){return t.prefix?(e.push(t.operator),this.astGeneric(t.argument,e)):(this.astGeneric(t.argument,e),e.push(t.operator)),e}},{key:"astThisExpression",value:function(t,e){return e.push("_this"),e}},{key:"astMemberExpression",value:function(t,e){if(t.computed)if("Identifier"===t.object.type||"MemberExpression"===t.object.type&&t.object.object.object&&"ThisExpression"===t.object.object.object.type&&"constants"===t.object.object.property.name)this.pushState("identifier"),this.astGeneric(t.object,e),this.popState("identifier"),e.push("["),this.isInput(t.object.name),this.astGeneric(t.property,e),e.push("]");else if(t.object.object)if(t.object.object.object&&this.isInput(t.object.object.object.name)){this.pushMemberState(t.object.object.object.name),this.pushState("input-index-z"),this.astGeneric(t.object,e);var n=e.pop();e.push(" + "),this.popState("input-index-z"),this.pushState("input-index"),this.astGeneric(t.property,e),this.popState("input-index"),e.push(n),this.popMemberState(t.object.object.object.name)}else if(this.isInput(t.object.object.name)){this.pushMemberState(t.object.object.name),this.isState("input-index-z")||this.pushState("input-index-y"),this.astGeneric(t.object,e);var r=e.pop();e.push(" + "),this.isState("input-index-z")||this.popState("input-index-y");var i=this.isState("input-index-z");i?this.pushState("input-index-y"):this.pushState("input-index"),this.astGeneric(t.property,e),i?this.popState("input-index-y"):this.popState("input-index"),e.push(r),this.popMemberState(t.object.object.name)}else{this.astGeneric(t.object,e);var o=e.pop();e.push("]["),this.astGeneric(t.property,e),e.push(o)}else{this.astGeneric(t.object,e);var a=e.pop();e.push("]["),this.astGeneric(t.property,e),e.push(a)}else{var s=this.astMemberExpressionUnroll(t);switch("Identifier"===t.property.type&&t.computed&&(s="user_"+s),0===s.indexOf("this.constants")?s="constants_"+s.substring(15):0===s.indexOf("this")&&(s="_"+s),this.state){case"input-index-y":case"input-index-z":e.push("(")}switch(s){case"_this.output.x":e.push(this.output[0]);break;case"_this.output.y":e.push(this.output[1]);break;case"_this.output.z":e.push(this.output[2]);break;default:t.object&&t.object.name&&this.declarations[t.object.name]&&e.push("user_"),e.push(s)}switch(this.state){case"input-index-y":var u=this.paramSizes[this.paramNames.indexOf(this.memberState)];e.push(" * "+u[0]+")");break;case"input-index-z":var c=this.paramSizes[this.paramNames.indexOf(this.memberState)];e.push(" * "+c[0]*c[1]+")")}}return e}},{key:"astSequenceExpression",value:function(t,e){for(var n=0;n<t.expressions.length;n++)0<n&&e.push(","),this.astGeneric(t.expressions,e);return e}},{key:"astCallExpression",value:function(t,e){if(t.callee){var n=this.astMemberExpressionUnroll(t.callee);this.calledFunctions.indexOf(n)<0&&this.calledFunctions.push(n),this.hasOwnProperty("funcName")||(this.calledFunctionsArguments[n]=[]);var r=[];this.calledFunctionsArguments[n].push(r),e.push(n),e.push("(");for(var i=0;i<t.arguments.length;++i){var o=t.arguments[i];if(0<i&&e.push(", "),this.astGeneric(o,e),"Identifier"===o.type){var a=this.paramNames.indexOf(o.name);-1===a?r.push(null):r.push({name:o.name,type:this.paramTypes[a]})}else r.push(null)}return e.push(")"),e}throw this.astErrorOutput("Unknown CallExpression",t)}},{key:"astArrayExpression",value:function(t,e){var n=t.elements.length;e.push("[");for(var r=0;r<n;++r){0<r&&e.push(", ");var i=t.elements[r];this.astGeneric(i,e)}return e.push("]"),e}},{key:"astDebuggerStatement",value:function(t,e){return e.push("debugger;"),e}},{key:"memberState",get:function(){return this.memberStates[this.memberStates.length-1]}}]),e}()},function(t,e,n){"use strict";(function(e,r){var i=n(103);t.exports=b;var o,a=n(259);b.ReadableState=m,n(67).EventEmitter;var s=function(t,e){return t.listeners(e).length},u=n(260),c=n(104).Buffer,l=e.Uint8Array||function(){},f=n(74);f.inherits=n(53);var h=n(633),p=void 0;p=h&&h.debuglog?h.debuglog("stream"):function(){};var d,y=n(634),v=n(262);f.inherits(b,u);var g=["error","close","destroy","pause","resume"];function m(t,e){t=t||{};var r=e instanceof(o=o||n(54));this.objectMode=!!t.objectMode,r&&(this.objectMode=this.objectMode||!!t.readableObjectMode);var i=t.highWaterMark,a=t.readableHighWaterMark,s=this.objectMode?16:16384;this.highWaterMark=i||0===i?i:r&&(a||0===a)?a:s,this.highWaterMark=Math.floor(this.highWaterMark),this.buffer=new y,this.length=0,this.pipes=null,this.pipesCount=0,this.flowing=null,this.ended=!1,this.endEmitted=!1,this.reading=!1,this.sync=!0,this.needReadable=!1,this.emittedReadable=!1,this.readableListening=!1,this.resumeScheduled=!1,this.destroyed=!1,this.defaultEncoding=t.defaultEncoding||"utf8",this.awaitDrain=0,this.readingMore=!1,this.decoder=null,this.encoding=null,t.encoding&&(d||(d=n(263).StringDecoder),this.decoder=new d(t.encoding),this.encoding=t.encoding)}function b(t){if(o=o||n(54),!(this instanceof b))return new b(t);this._readableState=new m(t,this),this.readable=!0,t&&("function"==typeof t.read&&(this._read=t.read),"function"==typeof t.destroy&&(this._destroy=t.destroy)),u.call(this)}function x(t,e,n,r,i){var o,a,s,u=t._readableState;return null===e?(u.reading=!1,function(t,e){if(!e.ended){if(e.decoder){var n=e.decoder.end();n&&n.length&&(e.buffer.push(n),e.length+=e.objectMode?1:n.length)}e.ended=!0,E(t)}}(t,u)):(i||(o=function(t,e){var n,r;return r=e,c.isBuffer(r)||r instanceof l||"string"==typeof e||void 0===e||t.objectMode||(n=new TypeError("Invalid non-string/buffer chunk")),n}(u,e)),o?t.emit("error",o):u.objectMode||e&&0<e.length?("string"==typeof e||u.objectMode||Object.getPrototypeOf(e)===c.prototype||(a=e,e=c.from(a)),r?u.endEmitted?t.emit("error",new Error("stream.unshift() after end event")):_(t,u,e,!0):u.ended?t.emit("error",new Error("stream.push() after EOF")):(u.reading=!1,u.decoder&&!n?(e=u.decoder.write(e),u.objectMode||0!==e.length?_(t,u,e,!1):k(t,u)):_(t,u,e,!1))):r||(u.reading=!1)),!(s=u).ended&&(s.needReadable||s.length<s.highWaterMark||0===s.length)}function _(t,e,n,r){e.flowing&&0===e.length&&!e.sync?(t.emit("data",n),t.read(0)):(e.length+=e.objectMode?1:n.length,r?e.buffer.unshift(n):e.buffer.push(n),e.needReadable&&E(t)),k(t,e)}Object.defineProperty(b.prototype,"destroyed",{get:function(){return void 0!==this._readableState&&this._readableState.destroyed},set:function(t){this._readableState&&(this._readableState.destroyed=t)}}),b.prototype.destroy=v.destroy,b.prototype._undestroy=v.undestroy,b.prototype._destroy=function(t,e){this.push(null),e(t)},b.prototype.push=function(t,e){var n,r=this._readableState;return r.objectMode?n=!0:"string"==typeof t&&((e=e||r.defaultEncoding)!==r.encoding&&(t=c.from(t,e),e=""),n=!0),x(this,t,e,!1,n)},b.prototype.unshift=function(t){return x(this,t,null,!0,!1)},b.prototype.isPaused=function(){return!1===this._readableState.flowing},b.prototype.setEncoding=function(t){return d||(d=n(263).StringDecoder),this._readableState.decoder=new d(t),this._readableState.encoding=t,this};var w=8388608;function S(t,e){return t<=0||0===e.length&&e.ended?0:e.objectMode?1:t!=t?e.flowing&&e.length?e.buffer.head.data.length:e.length:(t>e.highWaterMark&&(e.highWaterMark=(w<=(n=t)?n=w:(n--,n|=n>>>1,n|=n>>>2,n|=n>>>4,n|=n>>>8,n|=n>>>16,n++),n)),t<=e.length?t:e.ended?e.length:(e.needReadable=!0,0));var n}function E(t){var e=t._readableState;e.needReadable=!1,e.emittedReadable||(p("emitReadable",e.flowing),e.emittedReadable=!0,e.sync?i.nextTick(T,t):T(t))}function T(t){p("emit readable"),t.emit("readable"),P(t)}function k(t,e){e.readingMore||(e.readingMore=!0,i.nextTick(O,t,e))}function O(t,e){for(var n=e.length;!e.reading&&!e.flowing&&!e.ended&&e.length<e.highWaterMark&&(p("maybeReadMore read 0"),t.read(0),n!==e.length);)n=e.length;e.readingMore=!1}function A(t){p("readable nexttick read 0"),t.read(0)}function j(t,e){e.reading||(p("resume read 0"),t.read(0)),e.resumeScheduled=!1,e.awaitDrain=0,t.emit("resume"),P(t),e.flowing&&!e.reading&&t.read(0)}function P(t){var e=t._readableState;for(p("flow",e.flowing);e.flowing&&null!==t.read(););}function R(t,e){return 0===e.length?null:(e.objectMode?n=e.buffer.shift():!t||t>=e.length?(n=e.decoder?e.buffer.join(""):1===e.buffer.length?e.buffer.head.data:e.buffer.concat(e.length),e.buffer.clear()):n=function(t,e,n){var r;return t<e.head.data.length?(r=e.head.data.slice(0,t),e.head.data=e.head.data.slice(t)):r=t===e.head.data.length?e.shift():n?function(t,e){var n=e.head,r=1,i=n.data;for(t-=i.length;n=n.next;){var o=n.data,a=t>o.length?o.length:t;if(a===o.length?i+=o:i+=o.slice(0,t),0==(t-=a)){a===o.length?(++r,n.next?e.head=n.next:e.head=e.tail=null):(e.head=n).data=o.slice(a);break}++r}return e.length-=r,i}(t,e):function(t,e){var n=c.allocUnsafe(t),r=e.head,i=1;for(r.data.copy(n),t-=r.data.length;r=r.next;){var o=r.data,a=t>o.length?o.length:t;if(o.copy(n,n.length-t,0,a),0==(t-=a)){a===o.length?(++i,r.next?e.head=r.next:e.head=e.tail=null):(e.head=r).data=o.slice(a);break}++i}return e.length-=i,n}(t,e),r}(t,e.buffer,e.decoder),n);var n}function C(t){var e=t._readableState;if(0<e.length)throw new Error('"endReadable()" called on non-empty stream');e.endEmitted||(e.ended=!0,i.nextTick(I,e,t))}function I(t,e){t.endEmitted||0!==t.length||(t.endEmitted=!0,e.readable=!1,e.emit("end"))}function L(t,e){for(var n=0,r=t.length;n<r;n++)if(t[n]===e)return n;return-1}b.prototype.read=function(t){p("read",t),t=parseInt(t,10);var e=this._readableState,n=t;if(0!==t&&(e.emittedReadable=!1),0===t&&e.needReadable&&(e.length>=e.highWaterMark||e.ended))return p("read: emitReadable",e.length,e.ended),0===e.length&&e.ended?C(this):E(this),null;if(0===(t=S(t,e))&&e.ended)return 0===e.length&&C(this),null;var r,i=e.needReadable;return p("need readable",i),(0===e.length||e.length-t<e.highWaterMark)&&p("length less than watermark",i=!0),e.ended||e.reading?p("reading or ended",i=!1):i&&(p("do read"),e.reading=!0,e.sync=!0,0===e.length&&(e.needReadable=!0),this._read(e.highWaterMark),e.sync=!1,e.reading||(t=S(n,e))),null===(r=0<t?R(t,e):null)?(e.needReadable=!0,t=0):e.length-=t,0===e.length&&(e.ended||(e.needReadable=!0),n!==t&&e.ended&&C(this)),null!==r&&this.emit("data",r),r},b.prototype._read=function(t){this.emit("error",new Error("_read() is not implemented"))},b.prototype.pipe=function(t,e){var n=this,o=this._readableState;switch(o.pipesCount){case 0:o.pipes=t;break;case 1:o.pipes=[o.pipes,t];break;default:o.pipes.push(t)}o.pipesCount+=1,p("pipe count=%d opts=%j",o.pipesCount,e);var u=e&&!1===e.end||t===r.stdout||t===r.stderr?b:c;function c(){p("onend"),t.end()}o.endEmitted?i.nextTick(u):n.once("end",u),t.on("unpipe",function e(r,i){p("onunpipe"),r===n&&i&&!1===i.hasUnpiped&&(i.hasUnpiped=!0,p("cleanup"),t.removeListener("close",g),t.removeListener("finish",m),t.removeListener("drain",f),t.removeListener("error",v),t.removeListener("unpipe",e),n.removeListener("end",c),n.removeListener("end",b),n.removeListener("data",y),h=!0,!o.awaitDrain||t._writableState&&!t._writableState.needDrain||f())});var l,f=(l=n,function(){var t=l._readableState;p("pipeOnDrain",t.awaitDrain),t.awaitDrain&&t.awaitDrain--,0===t.awaitDrain&&s(l,"data")&&(t.flowing=!0,P(l))});t.on("drain",f);var h=!1,d=!1;function y(e){p("ondata"),(d=!1)!==t.write(e)||d||((1===o.pipesCount&&o.pipes===t||1<o.pipesCount&&-1!==L(o.pipes,t))&&!h&&(p("false write response, pause",n._readableState.awaitDrain),n._readableState.awaitDrain++,d=!0),n.pause())}function v(e){p("onerror",e),b(),t.removeListener("error",v),0===s(t,"error")&&t.emit("error",e)}function g(){t.removeListener("finish",m),b()}function m(){p("onfinish"),t.removeListener("close",g),b()}function b(){p("unpipe"),n.unpipe(t)}return n.on("data",y),function(t,e,n){if("function"==typeof t.prependListener)return t.prependListener(e,n);t._events&&t._events[e]?a(t._events[e])?t._events[e].unshift(n):t._events[e]=[n,t._events[e]]:t.on(e,n)}(t,"error",v),t.once("close",g),t.once("finish",m),t.emit("pipe",n),o.flowing||(p("pipe resume"),n.resume()),t},b.prototype.unpipe=function(t){var e=this._readableState,n={hasUnpiped:!1};if(0===e.pipesCount)return this;if(1===e.pipesCount)return t&&t!==e.pipes||(t||(t=e.pipes),e.pipes=null,e.pipesCount=0,e.flowing=!1,t&&t.emit("unpipe",this,n)),this;if(!t){var r=e.pipes,i=e.pipesCount;e.pipes=null,e.pipesCount=0,e.flowing=!1;for(var o=0;o<i;o++)r[o].emit("unpipe",this,n);return this}var a=L(e.pipes,t);return-1===a||(e.pipes.splice(a,1),e.pipesCount-=1,1===e.pipesCount&&(e.pipes=e.pipes[0]),t.emit("unpipe",this,n)),this},b.prototype.addListener=b.prototype.on=function(t,e){var n=u.prototype.on.call(this,t,e);if("data"===t)!1!==this._readableState.flowing&&this.resume();else if("readable"===t){var r=this._readableState;r.endEmitted||r.readableListening||(r.readableListening=r.needReadable=!0,r.emittedReadable=!1,r.reading?r.length&&E(this):i.nextTick(A,this))}return n},b.prototype.resume=function(){var t,e=this._readableState;return e.flowing||(p("resume"),e.flowing=!0,this,(t=e).resumeScheduled||(t.resumeScheduled=!0,i.nextTick(j,this,t))),this},b.prototype.pause=function(){return p("call pause flowing=%j",this._readableState.flowing),!1!==this._readableState.flowing&&(p("pause"),this._readableState.flowing=!1,this.emit("pause")),this},b.prototype.wrap=function(t){var e=this,n=this._readableState,r=!1;for(var i in t.on("end",function(){if(p("wrapped end"),n.decoder&&!n.ended){var t=n.decoder.end();t&&t.length&&e.push(t)}e.push(null)}),t.on("data",function(i){p("wrapped data"),n.decoder&&(i=n.decoder.write(i)),n.objectMode&&null==i||(n.objectMode||i&&i.length)&&(e.push(i)||(r=!0,t.pause()))}),t)void 0===this[i]&&"function"==typeof t[i]&&(this[i]=function(e){return function(){return t[e].apply(t,arguments)}}(i));for(var o=0;o<g.length;o++)t.on(g[o],this.emit.bind(this,g[o]));return this._read=function(e){p("wrapped _read",e),r&&(r=!1,t.resume())},this},Object.defineProperty(b.prototype,"readableHighWaterMark",{enumerable:!1,get:function(){return this._readableState.highWaterMark}}),b._fromList=R}).call(this,n(15),n(50))},function(t,e){var n={}.toString;t.exports=Array.isArray||function(t){return"[object Array]"==n.call(t)}},function(t,e,n){t.exports=n(67).EventEmitter},function(t,e,n){"use strict";(function(t){
/*!
 * The buffer module from node.js, for the browser.
 *
 * @author   Feross Aboukhadijeh <feross@feross.org> <http://feross.org>
 * @license  MIT
 */
var r=n(631),i=n(632),o=n(259);function a(){return u.TYPED_ARRAY_SUPPORT?2147483647:1073741823}function s(t,e){if(a()<e)throw new RangeError("Invalid typed array length");return u.TYPED_ARRAY_SUPPORT?(t=new Uint8Array(e)).__proto__=u.prototype:(null===t&&(t=new u(e)),t.length=e),t}function u(t,e,n){if(!(u.TYPED_ARRAY_SUPPORT||this instanceof u))return new u(t,e,n);if("number"!=typeof t)return c(this,t,e,n);if("string"==typeof e)throw new Error("If encoding is specified then the first argument must be a string");return f(this,t)}function c(t,e,n,r){if("number"==typeof e)throw new TypeError('"value" argument must not be a number');return"undefined"!=typeof ArrayBuffer&&e instanceof ArrayBuffer?function(t,e,n,r){if(e.byteLength,n<0||e.byteLength<n)throw new RangeError("'offset' is out of bounds");if(e.byteLength<n+(r||0))throw new RangeError("'length' is out of bounds");return e=void 0===n&&void 0===r?new Uint8Array(e):void 0===r?new Uint8Array(e,n):new Uint8Array(e,n,r),u.TYPED_ARRAY_SUPPORT?(t=e).__proto__=u.prototype:t=h(t,e),t}(t,e,n,r):"string"==typeof e?function(t,e,n){if("string"==typeof n&&""!==n||(n="utf8"),!u.isEncoding(n))throw new TypeError('"encoding" must be a valid string encoding');var r=0|d(e,n),i=(t=s(t,r)).write(e,n);return i!==r&&(t=t.slice(0,i)),t}(t,e,n):function(t,e){if(u.isBuffer(e)){var n=0|p(e.length);return 0===(t=s(t,n)).length||e.copy(t,0,0,n),t}if(e){if("undefined"!=typeof ArrayBuffer&&e.buffer instanceof ArrayBuffer||"length"in e)return"number"!=typeof e.length||(r=e.length)!=r?s(t,0):h(t,e);if("Buffer"===e.type&&o(e.data))return h(t,e.data)}var r;throw new TypeError("First argument must be a string, Buffer, ArrayBuffer, Array, or array-like object.")}(t,e)}function l(t){if("number"!=typeof t)throw new TypeError('"size" argument must be a number');if(t<0)throw new RangeError('"size" argument must not be negative')}function f(t,e){if(l(e),t=s(t,e<0?0:0|p(e)),!u.TYPED_ARRAY_SUPPORT)for(var n=0;n<e;++n)t[n]=0;return t}function h(t,e){var n=e.length<0?0:0|p(e.length);t=s(t,n);for(var r=0;r<n;r+=1)t[r]=255&e[r];return t}function p(t){if(t>=a())throw new RangeError("Attempt to allocate Buffer larger than maximum size: 0x"+a().toString(16)+" bytes");return 0|t}function d(t,e){if(u.isBuffer(t))return t.length;if("undefined"!=typeof ArrayBuffer&&"function"==typeof ArrayBuffer.isView&&(ArrayBuffer.isView(t)||t instanceof ArrayBuffer))return t.byteLength;"string"!=typeof t&&(t=""+t);var n=t.length;if(0===n)return 0;for(var r=!1;;)switch(e){case"ascii":case"latin1":case"binary":return n;case"utf8":case"utf-8":case void 0:return F(t).length;case"ucs2":case"ucs-2":case"utf16le":case"utf-16le":return 2*n;case"hex":return n>>>1;case"base64":return M(t).length;default:if(r)return F(t).length;e=(""+e).toLowerCase(),r=!0}}function y(t,e,n){var r=t[e];t[e]=t[n],t[n]=r}function v(t,e,n,r,i){if(0===t.length)return-1;if("string"==typeof n?(r=n,n=0):2147483647<n?n=2147483647:n<-2147483648&&(n=-2147483648),n=+n,isNaN(n)&&(n=i?0:t.length-1),n<0&&(n=t.length+n),n>=t.length){if(i)return-1;n=t.length-1}else if(n<0){if(!i)return-1;n=0}if("string"==typeof e&&(e=u.from(e,r)),u.isBuffer(e))return 0===e.length?-1:g(t,e,n,r,i);if("number"==typeof e)return e&=255,u.TYPED_ARRAY_SUPPORT&&"function"==typeof Uint8Array.prototype.indexOf?i?Uint8Array.prototype.indexOf.call(t,e,n):Uint8Array.prototype.lastIndexOf.call(t,e,n):g(t,[e],n,r,i);throw new TypeError("val must be string, number or Buffer")}function g(t,e,n,r,i){var o,a=1,s=t.length,u=e.length;if(void 0!==r&&("ucs2"===(r=String(r).toLowerCase())||"ucs-2"===r||"utf16le"===r||"utf-16le"===r)){if(t.length<2||e.length<2)return-1;s/=a=2,u/=2,n/=2}function c(t,e){return 1===a?t[e]:t.readUInt16BE(e*a)}if(i){var l=-1;for(o=n;o<s;o++)if(c(t,o)===c(e,-1===l?0:o-l)){if(-1===l&&(l=o),o-l+1===u)return l*a}else-1!==l&&(o-=o-l),l=-1}else for(s<n+u&&(n=s-u),o=n;0<=o;o--){for(var f=!0,h=0;h<u;h++)if(c(t,o+h)!==c(e,h)){f=!1;break}if(f)return o}return-1}function m(t,e,n,r){n=Number(n)||0;var i=t.length-n;r?i<(r=Number(r))&&(r=i):r=i;var o=e.length;if(o%2!=0)throw new TypeError("Invalid hex string");o/2<r&&(r=o/2);for(var a=0;a<r;++a){var s=parseInt(e.substr(2*a,2),16);if(isNaN(s))return a;t[n+a]=s}return a}function b(t,e,n,r){return D(function(t){for(var e=[],n=0;n<t.length;++n)e.push(255&t.charCodeAt(n));return e}(e),t,n,r)}function x(t,e,n){return 0===e&&n===t.length?r.fromByteArray(t):r.fromByteArray(t.slice(e,n))}function _(t,e,n){n=Math.min(t.length,n);for(var r=[],i=e;i<n;){var o,a,s,u,c=t[i],l=null,f=239<c?4:223<c?3:191<c?2:1;if(i+f<=n)switch(f){case 1:c<128&&(l=c);break;case 2:128==(192&(o=t[i+1]))&&127<(u=(31&c)<<6|63&o)&&(l=u);break;case 3:o=t[i+1],a=t[i+2],128==(192&o)&&128==(192&a)&&2047<(u=(15&c)<<12|(63&o)<<6|63&a)&&(u<55296||57343<u)&&(l=u);break;case 4:o=t[i+1],a=t[i+2],s=t[i+3],128==(192&o)&&128==(192&a)&&128==(192&s)&&65535<(u=(15&c)<<18|(63&o)<<12|(63&a)<<6|63&s)&&u<1114112&&(l=u)}null===l?(l=65533,f=1):65535<l&&(l-=65536,r.push(l>>>10&1023|55296),l=56320|1023&l),r.push(l),i+=f}return function(t){var e=t.length;if(e<=w)return String.fromCharCode.apply(String,t);for(var n="",r=0;r<e;)n+=String.fromCharCode.apply(String,t.slice(r,r+=w));return n}(r)}e.Buffer=u,e.SlowBuffer=function(t){return+t!=t&&(t=0),u.alloc(+t)},e.INSPECT_MAX_BYTES=50,u.TYPED_ARRAY_SUPPORT=void 0!==t.TYPED_ARRAY_SUPPORT?t.TYPED_ARRAY_SUPPORT:function(){try{var t=new Uint8Array(1);return t.__proto__={__proto__:Uint8Array.prototype,foo:function(){return 42}},42===t.foo()&&"function"==typeof t.subarray&&0===t.subarray(1,1).byteLength}catch(t){return!1}}(),e.kMaxLength=a(),u.poolSize=8192,u._augment=function(t){return t.__proto__=u.prototype,t},u.from=function(t,e,n){return c(null,t,e,n)},u.TYPED_ARRAY_SUPPORT&&(u.prototype.__proto__=Uint8Array.prototype,u.__proto__=Uint8Array,"undefined"!=typeof Symbol&&Symbol.species&&u[Symbol.species]===u&&Object.defineProperty(u,Symbol.species,{value:null,configurable:!0})),u.alloc=function(t,e,n){return r=null,o=e,a=n,l(i=t),i<=0?s(r,i):void 0!==o?"string"==typeof a?s(r,i).fill(o,a):s(r,i).fill(o):s(r,i);var r,i,o,a},u.allocUnsafe=function(t){return f(null,t)},u.allocUnsafeSlow=function(t){return f(null,t)},u.isBuffer=function(t){return!(null==t||!t._isBuffer)},u.compare=function(t,e){if(!u.isBuffer(t)||!u.isBuffer(e))throw new TypeError("Arguments must be Buffers");if(t===e)return 0;for(var n=t.length,r=e.length,i=0,o=Math.min(n,r);i<o;++i)if(t[i]!==e[i]){n=t[i],r=e[i];break}return n<r?-1:r<n?1:0},u.isEncoding=function(t){switch(String(t).toLowerCase()){case"hex":case"utf8":case"utf-8":case"ascii":case"latin1":case"binary":case"base64":case"ucs2":case"ucs-2":case"utf16le":case"utf-16le":return!0;default:return!1}},u.concat=function(t,e){if(!o(t))throw new TypeError('"list" argument must be an Array of Buffers');if(0===t.length)return u.alloc(0);var n;if(void 0===e)for(n=e=0;n<t.length;++n)e+=t[n].length;var r=u.allocUnsafe(e),i=0;for(n=0;n<t.length;++n){var a=t[n];if(!u.isBuffer(a))throw new TypeError('"list" argument must be an Array of Buffers');a.copy(r,i),i+=a.length}return r},u.byteLength=d,u.prototype._isBuffer=!0,u.prototype.swap16=function(){var t=this.length;if(t%2!=0)throw new RangeError("Buffer size must be a multiple of 16-bits");for(var e=0;e<t;e+=2)y(this,e,e+1);return this},u.prototype.swap32=function(){var t=this.length;if(t%4!=0)throw new RangeError("Buffer size must be a multiple of 32-bits");for(var e=0;e<t;e+=4)y(this,e,e+3),y(this,e+1,e+2);return this},u.prototype.swap64=function(){var t=this.length;if(t%8!=0)throw new RangeError("Buffer size must be a multiple of 64-bits");for(var e=0;e<t;e+=8)y(this,e,e+7),y(this,e+1,e+6),y(this,e+2,e+5),y(this,e+3,e+4);return this},u.prototype.toString=function(){var t=0|this.length;return 0===t?"":0===arguments.length?_(this,0,t):function(t,e,n){var r=!1;if((void 0===e||e<0)&&(e=0),e>this.length)return"";if((void 0===n||n>this.length)&&(n=this.length),n<=0)return"";if((n>>>=0)<=(e>>>=0))return"";for(t||(t="utf8");;)switch(t){case"hex":return T(this,e,n);case"utf8":case"utf-8":return _(this,e,n);case"ascii":return S(this,e,n);case"latin1":case"binary":return E(this,e,n);case"base64":return x(this,e,n);case"ucs2":case"ucs-2":case"utf16le":case"utf-16le":return k(this,e,n);default:if(r)throw new TypeError("Unknown encoding: "+t);t=(t+"").toLowerCase(),r=!0}}.apply(this,arguments)},u.prototype.equals=function(t){if(!u.isBuffer(t))throw new TypeError("Argument must be a Buffer");return this===t||0===u.compare(this,t)},u.prototype.inspect=function(){var t="",n=e.INSPECT_MAX_BYTES;return 0<this.length&&(t=this.toString("hex",0,n).match(/.{2}/g).join(" "),this.length>n&&(t+=" ... ")),"<Buffer "+t+">"},u.prototype.compare=function(t,e,n,r,i){if(!u.isBuffer(t))throw new TypeError("Argument must be a Buffer");if(void 0===e&&(e=0),void 0===n&&(n=t?t.length:0),void 0===r&&(r=0),void 0===i&&(i=this.length),e<0||n>t.length||r<0||i>this.length)throw new RangeError("out of range index");if(i<=r&&n<=e)return 0;if(i<=r)return-1;if(n<=e)return 1;if(this===t)return 0;for(var o=(i>>>=0)-(r>>>=0),a=(n>>>=0)-(e>>>=0),s=Math.min(o,a),c=this.slice(r,i),l=t.slice(e,n),f=0;f<s;++f)if(c[f]!==l[f]){o=c[f],a=l[f];break}return o<a?-1:a<o?1:0},u.prototype.includes=function(t,e,n){return-1!==this.indexOf(t,e,n)},u.prototype.indexOf=function(t,e,n){return v(this,t,e,n,!0)},u.prototype.lastIndexOf=function(t,e,n){return v(this,t,e,n,!1)},u.prototype.write=function(t,e,n,r){if(void 0===e)r="utf8",n=this.length,e=0;else if(void 0===n&&"string"==typeof e)r=e,n=this.length,e=0;else{if(!isFinite(e))throw new Error("Buffer.write(string, encoding, offset[, length]) is no longer supported");e|=0,isFinite(n)?(n|=0,void 0===r&&(r="utf8")):(r=n,n=void 0)}var i=this.length-e;if((void 0===n||i<n)&&(n=i),0<t.length&&(n<0||e<0)||e>this.length)throw new RangeError("Attempt to write outside buffer bounds");r||(r="utf8");for(var o,a,s,u,c,l,f=!1;;)switch(r){case"hex":return m(this,t,e,n);case"utf8":case"utf-8":return c=e,l=n,D(F(t,this.length-c),this,c,l);case"ascii":return b(this,t,e,n);case"latin1":case"binary":return b(this,t,e,n);case"base64":return this,s=e,u=n,D(M(t),this,s,u);case"ucs2":case"ucs-2":case"utf16le":case"utf-16le":return o=e,a=n,D(function(t,e){for(var n,r,i,o=[],a=0;a<t.length&&!((e-=2)<0);++a)r=(n=t.charCodeAt(a))>>8,i=n%256,o.push(i),o.push(r);return o}(t,this.length-o),this,o,a);default:if(f)throw new TypeError("Unknown encoding: "+r);r=(""+r).toLowerCase(),f=!0}},u.prototype.toJSON=function(){return{type:"Buffer",data:Array.prototype.slice.call(this._arr||this,0)}};var w=4096;function S(t,e,n){var r="";n=Math.min(t.length,n);for(var i=e;i<n;++i)r+=String.fromCharCode(127&t[i]);return r}function E(t,e,n){var r="";n=Math.min(t.length,n);for(var i=e;i<n;++i)r+=String.fromCharCode(t[i]);return r}function T(t,e,n){var r=t.length;(!e||e<0)&&(e=0),(!n||n<0||r<n)&&(n=r);for(var i="",o=e;o<n;++o)i+=N(t[o]);return i}function k(t,e,n){for(var r=t.slice(e,n),i="",o=0;o<r.length;o+=2)i+=String.fromCharCode(r[o]+256*r[o+1]);return i}function O(t,e,n){if(t%1!=0||t<0)throw new RangeError("offset is not uint");if(n<t+e)throw new RangeError("Trying to access beyond buffer length")}function A(t,e,n,r,i,o){if(!u.isBuffer(t))throw new TypeError('"buffer" argument must be a Buffer instance');if(i<e||e<o)throw new RangeError('"value" argument is out of bounds');if(n+r>t.length)throw new RangeError("Index out of range")}function j(t,e,n,r){e<0&&(e=65535+e+1);for(var i=0,o=Math.min(t.length-n,2);i<o;++i)t[n+i]=(e&255<<8*(r?i:1-i))>>>8*(r?i:1-i)}function P(t,e,n,r){e<0&&(e=4294967295+e+1);for(var i=0,o=Math.min(t.length-n,4);i<o;++i)t[n+i]=e>>>8*(r?i:3-i)&255}function R(t,e,n,r,i,o){if(n+r>t.length)throw new RangeError("Index out of range");if(n<0)throw new RangeError("Index out of range")}function C(t,e,n,r,o){return o||R(t,0,n,4),i.write(t,e,n,r,23,4),n+4}function I(t,e,n,r,o){return o||R(t,0,n,8),i.write(t,e,n,r,52,8),n+8}u.prototype.slice=function(t,e){var n,r=this.length;if((t=~~t)<0?(t+=r)<0&&(t=0):r<t&&(t=r),(e=void 0===e?r:~~e)<0?(e+=r)<0&&(e=0):r<e&&(e=r),e<t&&(e=t),u.TYPED_ARRAY_SUPPORT)(n=this.subarray(t,e)).__proto__=u.prototype;else{var i=e-t;n=new u(i,void 0);for(var o=0;o<i;++o)n[o]=this[o+t]}return n},u.prototype.readUIntLE=function(t,e,n){t|=0,e|=0,n||O(t,e,this.length);for(var r=this[t],i=1,o=0;++o<e&&(i*=256);)r+=this[t+o]*i;return r},u.prototype.readUIntBE=function(t,e,n){t|=0,e|=0,n||O(t,e,this.length);for(var r=this[t+--e],i=1;0<e&&(i*=256);)r+=this[t+--e]*i;return r},u.prototype.readUInt8=function(t,e){return e||O(t,1,this.length),this[t]},u.prototype.readUInt16LE=function(t,e){return e||O(t,2,this.length),this[t]|this[t+1]<<8},u.prototype.readUInt16BE=function(t,e){return e||O(t,2,this.length),this[t]<<8|this[t+1]},u.prototype.readUInt32LE=function(t,e){return e||O(t,4,this.length),(this[t]|this[t+1]<<8|this[t+2]<<16)+16777216*this[t+3]},u.prototype.readUInt32BE=function(t,e){return e||O(t,4,this.length),16777216*this[t]+(this[t+1]<<16|this[t+2]<<8|this[t+3])},u.prototype.readIntLE=function(t,e,n){t|=0,e|=0,n||O(t,e,this.length);for(var r=this[t],i=1,o=0;++o<e&&(i*=256);)r+=this[t+o]*i;return(i*=128)<=r&&(r-=Math.pow(2,8*e)),r},u.prototype.readIntBE=function(t,e,n){t|=0,e|=0,n||O(t,e,this.length);for(var r=e,i=1,o=this[t+--r];0<r&&(i*=256);)o+=this[t+--r]*i;return(i*=128)<=o&&(o-=Math.pow(2,8*e)),o},u.prototype.readInt8=function(t,e){return e||O(t,1,this.length),128&this[t]?-1*(255-this[t]+1):this[t]},u.prototype.readInt16LE=function(t,e){e||O(t,2,this.length);var n=this[t]|this[t+1]<<8;return 32768&n?4294901760|n:n},u.prototype.readInt16BE=function(t,e){e||O(t,2,this.length);var n=this[t+1]|this[t]<<8;return 32768&n?4294901760|n:n},u.prototype.readInt32LE=function(t,e){return e||O(t,4,this.length),this[t]|this[t+1]<<8|this[t+2]<<16|this[t+3]<<24},u.prototype.readInt32BE=function(t,e){return e||O(t,4,this.length),this[t]<<24|this[t+1]<<16|this[t+2]<<8|this[t+3]},u.prototype.readFloatLE=function(t,e){return e||O(t,4,this.length),i.read(this,t,!0,23,4)},u.prototype.readFloatBE=function(t,e){return e||O(t,4,this.length),i.read(this,t,!1,23,4)},u.prototype.readDoubleLE=function(t,e){return e||O(t,8,this.length),i.read(this,t,!0,52,8)},u.prototype.readDoubleBE=function(t,e){return e||O(t,8,this.length),i.read(this,t,!1,52,8)},u.prototype.writeUIntLE=function(t,e,n,r){t=+t,e|=0,n|=0,r||A(this,t,e,n,Math.pow(2,8*n)-1,0);var i=1,o=0;for(this[e]=255&t;++o<n&&(i*=256);)this[e+o]=t/i&255;return e+n},u.prototype.writeUIntBE=function(t,e,n,r){t=+t,e|=0,n|=0,r||A(this,t,e,n,Math.pow(2,8*n)-1,0);var i=n-1,o=1;for(this[e+i]=255&t;0<=--i&&(o*=256);)this[e+i]=t/o&255;return e+n},u.prototype.writeUInt8=function(t,e,n){return t=+t,e|=0,n||A(this,t,e,1,255,0),u.TYPED_ARRAY_SUPPORT||(t=Math.floor(t)),this[e]=255&t,e+1},u.prototype.writeUInt16LE=function(t,e,n){return t=+t,e|=0,n||A(this,t,e,2,65535,0),u.TYPED_ARRAY_SUPPORT?(this[e]=255&t,this[e+1]=t>>>8):j(this,t,e,!0),e+2},u.prototype.writeUInt16BE=function(t,e,n){return t=+t,e|=0,n||A(this,t,e,2,65535,0),u.TYPED_ARRAY_SUPPORT?(this[e]=t>>>8,this[e+1]=255&t):j(this,t,e,!1),e+2},u.prototype.writeUInt32LE=function(t,e,n){return t=+t,e|=0,n||A(this,t,e,4,4294967295,0),u.TYPED_ARRAY_SUPPORT?(this[e+3]=t>>>24,this[e+2]=t>>>16,this[e+1]=t>>>8,this[e]=255&t):P(this,t,e,!0),e+4},u.prototype.writeUInt32BE=function(t,e,n){return t=+t,e|=0,n||A(this,t,e,4,4294967295,0),u.TYPED_ARRAY_SUPPORT?(this[e]=t>>>24,this[e+1]=t>>>16,this[e+2]=t>>>8,this[e+3]=255&t):P(this,t,e,!1),e+4},u.prototype.writeIntLE=function(t,e,n,r){if(t=+t,e|=0,!r){var i=Math.pow(2,8*n-1);A(this,t,e,n,i-1,-i)}var o=0,a=1,s=0;for(this[e]=255&t;++o<n&&(a*=256);)t<0&&0===s&&0!==this[e+o-1]&&(s=1),this[e+o]=(t/a>>0)-s&255;return e+n},u.prototype.writeIntBE=function(t,e,n,r){if(t=+t,e|=0,!r){var i=Math.pow(2,8*n-1);A(this,t,e,n,i-1,-i)}var o=n-1,a=1,s=0;for(this[e+o]=255&t;0<=--o&&(a*=256);)t<0&&0===s&&0!==this[e+o+1]&&(s=1),this[e+o]=(t/a>>0)-s&255;return e+n},u.prototype.writeInt8=function(t,e,n){return t=+t,e|=0,n||A(this,t,e,1,127,-128),u.TYPED_ARRAY_SUPPORT||(t=Math.floor(t)),t<0&&(t=255+t+1),this[e]=255&t,e+1},u.prototype.writeInt16LE=function(t,e,n){return t=+t,e|=0,n||A(this,t,e,2,32767,-32768),u.TYPED_ARRAY_SUPPORT?(this[e]=255&t,this[e+1]=t>>>8):j(this,t,e,!0),e+2},u.prototype.writeInt16BE=function(t,e,n){return t=+t,e|=0,n||A(this,t,e,2,32767,-32768),u.TYPED_ARRAY_SUPPORT?(this[e]=t>>>8,this[e+1]=255&t):j(this,t,e,!1),e+2},u.prototype.writeInt32LE=function(t,e,n){return t=+t,e|=0,n||A(this,t,e,4,2147483647,-2147483648),u.TYPED_ARRAY_SUPPORT?(this[e]=255&t,this[e+1]=t>>>8,this[e+2]=t>>>16,this[e+3]=t>>>24):P(this,t,e,!0),e+4},u.prototype.writeInt32BE=function(t,e,n){return t=+t,e|=0,n||A(this,t,e,4,2147483647,-2147483648),t<0&&(t=4294967295+t+1),u.TYPED_ARRAY_SUPPORT?(this[e]=t>>>24,this[e+1]=t>>>16,this[e+2]=t>>>8,this[e+3]=255&t):P(this,t,e,!1),e+4},u.prototype.writeFloatLE=function(t,e,n){return C(this,t,e,!0,n)},u.prototype.writeFloatBE=function(t,e,n){return C(this,t,e,!1,n)},u.prototype.writeDoubleLE=function(t,e,n){return I(this,t,e,!0,n)},u.prototype.writeDoubleBE=function(t,e,n){return I(this,t,e,!1,n)},u.prototype.copy=function(t,e,n,r){if(n||(n=0),r||0===r||(r=this.length),e>=t.length&&(e=t.length),e||(e=0),0<r&&r<n&&(r=n),r===n)return 0;if(0===t.length||0===this.length)return 0;if(e<0)throw new RangeError("targetStart out of bounds");if(n<0||n>=this.length)throw new RangeError("sourceStart out of bounds");if(r<0)throw new RangeError("sourceEnd out of bounds");r>this.length&&(r=this.length),t.length-e<r-n&&(r=t.length-e+n);var i,o=r-n;if(this===t&&n<e&&e<r)for(i=o-1;0<=i;--i)t[i+e]=this[i+n];else if(o<1e3||!u.TYPED_ARRAY_SUPPORT)for(i=0;i<o;++i)t[i+e]=this[i+n];else Uint8Array.prototype.set.call(t,this.subarray(n,n+o),e);return o},u.prototype.fill=function(t,e,n,r){if("string"==typeof t){if("string"==typeof e?(r=e,e=0,n=this.length):"string"==typeof n&&(r=n,n=this.length),1===t.length){var i=t.charCodeAt(0);i<256&&(t=i)}if(void 0!==r&&"string"!=typeof r)throw new TypeError("encoding must be a string");if("string"==typeof r&&!u.isEncoding(r))throw new TypeError("Unknown encoding: "+r)}else"number"==typeof t&&(t&=255);if(e<0||this.length<e||this.length<n)throw new RangeError("Out of range index");if(n<=e)return this;var o;if(e>>>=0,n=void 0===n?this.length:n>>>0,t||(t=0),"number"==typeof t)for(o=e;o<n;++o)this[o]=t;else{var a=u.isBuffer(t)?t:F(new u(t,r).toString()),s=a.length;for(o=0;o<n-e;++o)this[o+e]=a[o%s]}return this};var L=/[^+\/0-9A-Za-z-_]/g;function N(t){return t<16?"0"+t.toString(16):t.toString(16)}function F(t,e){var n;e=e||1/0;for(var r=t.length,i=null,o=[],a=0;a<r;++a){if(55295<(n=t.charCodeAt(a))&&n<57344){if(!i){if(56319<n){-1<(e-=3)&&o.push(239,191,189);continue}if(a+1===r){-1<(e-=3)&&o.push(239,191,189);continue}i=n;continue}if(n<56320){-1<(e-=3)&&o.push(239,191,189),i=n;continue}n=65536+(i-55296<<10|n-56320)}else i&&-1<(e-=3)&&o.push(239,191,189);if(i=null,n<128){if((e-=1)<0)break;o.push(n)}else if(n<2048){if((e-=2)<0)break;o.push(n>>6|192,63&n|128)}else if(n<65536){if((e-=3)<0)break;o.push(n>>12|224,n>>6&63|128,63&n|128)}else{if(!(n<1114112))throw new Error("Invalid code point");if((e-=4)<0)break;o.push(n>>18|240,n>>12&63|128,n>>6&63|128,63&n|128)}}return o}function M(t){return r.toByteArray(function(t){var e;if((t=(e=t,e.trim?e.trim():e.replace(/^\s+|\s+$/g,"")).replace(L,"")).length<2)return"";for(;t.length%4!=0;)t+="=";return t}(t))}function D(t,e,n,r){for(var i=0;i<r&&!(i+n>=e.length||i>=t.length);++i)e[i+n]=t[i];return i}}).call(this,n(15))},function(t,e,n){"use strict";var r=n(103);function i(t,e){t.emit("error",e)}t.exports={destroy:function(t,e){var n=this,o=this._readableState&&this._readableState.destroyed,a=this._writableState&&this._writableState.destroyed;return o||a?e?e(t):!t||this._writableState&&this._writableState.errorEmitted||r.nextTick(i,this,t):(this._readableState&&(this._readableState.destroyed=!0),this._writableState&&(this._writableState.destroyed=!0),this._destroy(t||null,function(t){!e&&t?(r.nextTick(i,n,t),n._writableState&&(n._writableState.errorEmitted=!0)):e&&e(t)})),this},undestroy:function(){this._readableState&&(this._readableState.destroyed=!1,this._readableState.reading=!1,this._readableState.ended=!1,this._readableState.endEmitted=!1),this._writableState&&(this._writableState.destroyed=!1,this._writableState.ended=!1,this._writableState.ending=!1,this._writableState.finished=!1,this._writableState.errorEmitted=!1)}}},function(t,e,n){"use strict";var r=n(104).Buffer,i=r.isEncoding||function(t){switch((t=""+t)&&t.toLowerCase()){case"hex":case"utf8":case"utf-8":case"ascii":case"binary":case"base64":case"ucs2":case"ucs-2":case"utf16le":case"utf-16le":case"raw":return!0;default:return!1}};function o(t){var e;switch(this.encoding=function(t){var e=function(t){if(!t)return"utf8";for(var e;;)switch(t){case"utf8":case"utf-8":return"utf8";case"ucs2":case"ucs-2":case"utf16le":case"utf-16le":return"utf16le";case"latin1":case"binary":return"latin1";case"base64":case"ascii":case"hex":return t;default:if(e)return;t=(""+t).toLowerCase(),e=!0}}(t);if("string"!=typeof e&&(r.isEncoding===i||!i(t)))throw new Error("Unknown encoding: "+t);return e||t}(t),this.encoding){case"utf16le":this.text=u,this.end=c,e=4;break;case"utf8":this.fillLast=s,e=4;break;case"base64":this.text=l,this.end=f,e=3;break;default:return this.write=h,void(this.end=p)}this.lastNeed=0,this.lastTotal=0,this.lastChar=r.allocUnsafe(e)}function a(t){return t<=127?0:t>>5==6?2:t>>4==14?3:t>>3==30?4:t>>6==2?-1:-2}function s(t){var e=this.lastTotal-this.lastNeed,n=function(t,e,n){if(128!=(192&e[0]))return t.lastNeed=0,"ï¿½";if(1<t.lastNeed&&1<e.length){if(128!=(192&e[1]))return t.lastNeed=1,"ï¿½";if(2<t.lastNeed&&2<e.length&&128!=(192&e[2]))return t.lastNeed=2,"ï¿½"}}(this,t);return void 0!==n?n:this.lastNeed<=t.length?(t.copy(this.lastChar,e,0,this.lastNeed),this.lastChar.toString(this.encoding,0,this.lastTotal)):(t.copy(this.lastChar,e,0,t.length),void(this.lastNeed-=t.length))}function u(t,e){if((t.length-e)%2!=0)return this.lastNeed=1,this.lastTotal=2,this.lastChar[0]=t[t.length-1],t.toString("utf16le",e,t.length-1);var n=t.toString("utf16le",e);if(n){var r=n.charCodeAt(n.length-1);if(55296<=r&&r<=56319)return this.lastNeed=2,this.lastTotal=4,this.lastChar[0]=t[t.length-2],this.lastChar[1]=t[t.length-1],n.slice(0,-1)}return n}function c(t){var e=t&&t.length?this.write(t):"";if(this.lastNeed){var n=this.lastTotal-this.lastNeed;return e+this.lastChar.toString("utf16le",0,n)}return e}function l(t,e){var n=(t.length-e)%3;return 0===n?t.toString("base64",e):(this.lastNeed=3-n,this.lastTotal=3,1===n?this.lastChar[0]=t[t.length-1]:(this.lastChar[0]=t[t.length-2],this.lastChar[1]=t[t.length-1]),t.toString("base64",e,t.length-n))}function f(t){var e=t&&t.length?this.write(t):"";return this.lastNeed?e+this.lastChar.toString("base64",0,3-this.lastNeed):e}function h(t){return t.toString(this.encoding)}function p(t){return t&&t.length?this.write(t):""}(e.StringDecoder=o).prototype.write=function(t){if(0===t.length)return"";var e,n;if(this.lastNeed){if(void 0===(e=this.fillLast(t)))return"";n=this.lastNeed,this.lastNeed=0}else n=0;return n<t.length?e?e+this.text(t,n):this.text(t,n):e||""},o.prototype.end=function(t){var e=t&&t.length?this.write(t):"";return this.lastNeed?e+"ï¿½":e},o.prototype.text=function(t,e){var n=function(t,e,n){var r=e.length-1;if(r<n)return 0;var i=a(e[r]);return 0<=i?(0<i&&(t.lastNeed=i-1),i):--r<n||-2===i?0:0<=(i=a(e[r]))?(0<i&&(t.lastNeed=i-2),i):--r<n||-2===i?0:0<=(i=a(e[r]))?(0<i&&(2===i?i=0:t.lastNeed=i-3),i):0}(this,t,e);if(!this.lastNeed)return t.toString("utf8",e);this.lastTotal=n;var r=t.length-(n-this.lastNeed);return t.copy(this.lastChar,0,r),t.toString("utf8",e,r)},o.prototype.fillLast=function(t){if(this.lastNeed<=t.length)return t.copy(this.lastChar,this.lastTotal-this.lastNeed,0,this.lastNeed),this.lastChar.toString(this.encoding,0,this.lastTotal);t.copy(this.lastChar,this.lastTotal-this.lastNeed,0,t.length),this.lastNeed-=t.length}},function(t,e,n){"use strict";t.exports=o;var r=n(54),i=n(74);function o(t){if(!(this instanceof o))return new o(t);r.call(this,t),this._transformState={afterTransform:function(t,e){var n=this._transformState;n.transforming=!1;var r=n.writecb;if(!r)return this.emit("error",new Error("write callback called multiple times"));n.writechunk=null,(n.writecb=null)!=e&&this.push(e),r(t);var i=this._readableState;i.reading=!1,(i.needReadable||i.length<i.highWaterMark)&&this._read(i.highWaterMark)}.bind(this),needTransform:!1,transforming:!1,writecb:null,writechunk:null,writeencoding:null},this._readableState.needReadable=!0,this._readableState.sync=!1,t&&("function"==typeof t.transform&&(this._transform=t.transform),"function"==typeof t.flush&&(this._flush=t.flush)),this.on("prefinish",a)}function a(){var t=this;"function"==typeof this._flush?this._flush(function(e,n){s(t,e,n)}):s(this,null,null)}function s(t,e,n){if(e)return t.emit("error",e);if(null!=n&&t.push(n),t._writableState.length)throw new Error("Calling transform done when ws.length != 0");if(t._transformState.transforming)throw new Error("Calling transform done when still transforming");return t.push(null)}i.inherits=n(53),i.inherits(o,r),o.prototype.push=function(t,e){return this._transformState.needTransform=!1,r.prototype.push.call(this,t,e)},o.prototype._transform=function(t,e,n){throw new Error("_transform() is not implemented")},o.prototype._write=function(t,e,n){var r=this._transformState;if(r.writecb=n,r.writechunk=t,r.writeencoding=e,!r.transforming){var i=this._readableState;(r.needTransform||i.needReadable||i.length<i.highWaterMark)&&this._read(i.highWaterMark)}},o.prototype._read=function(t){var e=this._transformState;null!==e.writechunk&&e.writecb&&!e.transforming?(e.transforming=!0,this._transform(e.writechunk,e.writeencoding,e.afterTransform)):e.needTransform=!0},o.prototype._destroy=function(t,e){var n=this;r.prototype._destroy.call(this,t,function(t){e(t),n.emit("close")})}},function(t,e,n){"use strict";Object.defineProperty(e,"__esModule",{value:!0});var r=function(){function t(t,e){for(var n=0;n<e.length;n++){var r=e[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(t,r.key,r)}}return function(e,n,r){return n&&t(e.prototype,n),r&&t(e,r),e}}(),i=w(n(31)),o=(w(n(644)),w(n(267)),w(n(645))),a=w(n(646)),s=w(n(647)),u=w(n(648)),c=w(n(649)),l=w(n(650)),f=w(n(651)),h=w(n(652)),p=w(n(653)),d=w(n(654)),y=w(n(655)),v=w(n(656)),g=w(n(657)),m=w(n(658)),b=w(n(659)),x=w(n(660)),_=w(n(166));function w(t){return t&&t.__esModule?t:{default:t}}var S=function(){function t(){!function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,t),this.inputRow=0,this.inputValue=null,this.states=[]}return r(t,[{key:"add",value:function(t,e){if(t.weights.length!==e.weights.length)throw new Error("misaligned matrices");var n=new i.default(t.rows,t.columns);return this.states.push({left:t,right:e,product:n,forwardFn:a.default,backpropagationFn:s.default}),n}},{key:"allOnes",value:function(t,e){var n=new i.default(t,e);return this.states.push({left:n,product:n,forwardFn:u.default}),n}},{key:"cloneNegative",value:function(t){var e=new i.default(t.rows,t.columns);return this.states.push({left:t,product:e,forwardFn:o.default}),e}},{key:"subtract",value:function(t,e){if(t.weights.length!==e.weights.length)throw new Error("misaligned matrices");return this.add(this.add(this.allOnes(t.rows,t.columns),this.cloneNegative(t)),e)}},{key:"multiply",value:function(t,e){if(t.columns!==e.rows)throw new Error("misaligned matrices");var n=new i.default(t.rows,e.columns);return this.states.push({left:t,right:e,product:n,forwardFn:c.default,backpropagationFn:l.default}),n}},{key:"multiplyElement",value:function(t,e){if(t.weights.length!==e.weights.length)throw new Error("misaligned matrices");var n=new i.default(t.rows,t.columns);return this.states.push({left:t,right:e,product:n,forwardFn:f.default,backpropagationFn:h.default}),n}},{key:"relu",value:function(t){var e=new i.default(t.rows,t.columns);return this.states.push({left:t,product:e,forwardFn:p.default,backpropagationFn:d.default}),e}},{key:"input",value:function(t){var e=this;return this.states.push({product:t,forwardFn:function(n){n.weights=t.weights=e.inputValue}}),t}},{key:"inputMatrixToRow",value:function(t){var e=this,n=new i.default(t.columns,1);return this.states.push({left:t,get right(){return e.inputRow},product:n,forwardFn:y.default,backpropagationFn:v.default}),n}},{key:"sigmoid",value:function(t){var e=new i.default(t.rows,t.columns);return this.states.push({left:t,product:e,forwardFn:g.default,backpropagationFn:m.default}),e}},{key:"tanh",value:function(t){var e=new i.default(t.rows,t.columns);return this.states.push({left:t,product:e,forwardFn:b.default,backpropagationFn:x.default}),e}},{key:"observe",value:function(t){return this.states.push({forwardFn:function(){},backpropagationFn:function(){}}),t}},{key:"runIndex",value:function(){var t=0<arguments.length&&void 0!==arguments[0]?arguments[0]:0;this.inputRow=t;for(var e=void 0,n=0,r=this.states.length;n<r;n++)(e=this.states[n]).hasOwnProperty("forwardFn")&&e.forwardFn(e.product,e.left,e.right);return e.product}},{key:"runInput",value:function(t){this.inputValue=t;for(var e=void 0,n=0,r=this.states.length;n<r;n++)(e=this.states[n]).hasOwnProperty("forwardFn")&&e.forwardFn(e.product,e.left,e.right);return e.product}},{key:"backpropagate",value:function(){for(var t=this.states.length,e=void 0;0<t--;)(e=this.states[t]).hasOwnProperty("backpropagationFn")&&e.backpropagationFn(e.product,e.left,e.right);return e.product}},{key:"backpropagateIndex",value:function(){var t=0<arguments.length&&void 0!==arguments[0]?arguments[0]:0;this.inputRow=t;for(var e=this.states.length,n=void 0;0<e--;)(n=this.states[e]).hasOwnProperty("backpropagationFn")&&n.backpropagationFn(n.product,n.left,n.right);return n.product}},{key:"predictTarget",value:function(t,e){for(var n=this.runInput(t),r=0,i=0;i<n.weights.length;i++){var o=n.weights[i]-e[i];r+=Math.abs(o),n.deltas[i]=o}return r}},{key:"predictTargetIndex",value:function(t,e){var n=this.runIndex(t),r=n,i=(0,_.default)(n);return r.deltas=i.weights.slice(0),r.deltas[e]-=1,-Math.log2(i.weights[e])}}]),t}();e.default=S},function(t,e,n){"use strict";Object.defineProperty(e,"__esModule",{value:!0}),e.default=function(t){if("undefined"!=typeof Float32Array)return new Float32Array(t).fill(1);for(var e=new Array(t),n=0;n<t;n++)e[n]=1;return e}},function(t,e,n){"use strict";Object.defineProperty(e,"__esModule",{value:!0}),e.default=function(t,e){t.rows=parseInt(e.rows),t.columns=parseInt(e.columns),t.weights=e.weights.slice(0),t.deltas=e.deltas.slice(0)}},function(t,e,n){"use strict";Object.defineProperty(e,"__esModule",{value:!0}),e.default=function(t){for(var e=r(0,1),n=0,i=0,o=t.weights;;){if(e<(n+=o[i]))return i;i++}};var r=n(75).randomF},function(t,e,n){"use strict";Object.defineProperty(e,"__esModule",{value:!0}),e.default=function(t){for(var e=t.weights,n=e[0],r=0,i=1;i<e.length;i++){var o=e[i];o<n||(r=i,n=o)}return r}},function(t,e,n){"use strict";Object.defineProperty(e,"__esModule",{value:!0});var r=function(){function t(t,e){for(var n=0;n<e.length;n++){var r=e[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(t,r.key,r)}}return function(e,n,r){return n&&t(e.prototype,n),r&&t(e,r),e}}();function i(t){if(Array.isArray(t)){for(var e=0,n=Array(t.length);e<t.length;e++)n[e]=t[e];return n}return Array.from(t)}var o=function(){function t(e){var n=1<arguments.length&&void 0!==arguments[1]?arguments[1]:0;!function(e,n){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this),void 0!==e&&(this.values=e,this.indexTable={},this.characterTable={},this.characters=[],this.specialIndexes=[],this.buildCharactersFromIterable(e),this.buildTables(n))}return r(t,[{key:"buildCharactersFromIterable",value:function(t){for(var e={},n=0,r=t.length;n<r;n++){var i=t[n];if(i.hasOwnProperty("length"))for(var o=0,a=i.length;o<a;o++){var s=i[o];e.hasOwnProperty(s)||(e[s]=!0,this.characters.push(s))}else{var u=t[n];if(e.hasOwnProperty(u))continue;e[n]=!0,this.characters.push(u)}}}},{key:"buildTables",value:function(t){for(var e=this.characters.length,n=0;n<e;n++){var r=this.characters[n];t<=n&&(this.indexTable[r]=n,this.characterTable[n]=r)}}},{key:"toIndexes",value:function(t){for(var e=1<arguments.length&&void 0!==arguments[1]?arguments[1]:0,n=[],r=this.indexTable,i=0,o=t.length;i<o;i++){var a=t[i],s=r[a];if(void 0===s){if(!r.unrecognized)throw new Error('unrecognized character "'+a+'"');s=r.unrecognized}s<e||n.push(s)}return n}},{key:"toIndexesInputOutput",value:function(t){var e=1<arguments.length&&void 0!==arguments[1]?arguments[1]:null,n=2<arguments.length&&void 0!==arguments[2]?arguments[2]:0,r=void 0;return r="string"==typeof t?this.toIndexes(t.split("").concat(["stop-input","start-output"]),n):this.toIndexes(t.concat(["stop-input","start-output"]),n),null===e?r:"string"==typeof e?r.concat(this.toIndexes(e.split(""),n)):r.concat(this.toIndexes(e,n))}},{key:"toCharacters",value:function(t){for(var e=1<arguments.length&&void 0!==arguments[1]?arguments[1]:0,n=[],r=this.characterTable,i=this.indexTable,o=0,a=t.length;o<a;o++){var s=t[o];if(!(s<e)){var u=r[s];if(void 0===u){if(!i.unrecognized)throw new Error('unrecognized index "'+s+'"');u=r[i.unrecognized]}else null!==u&&n.push(u)}}return n}},{key:"toString",value:function(t,e){return this.toCharacters(t,e).join("")}},{key:"addInputOutput",value:function(){this.addSpecial("stop-input"),this.addSpecial("start-output")}},{key:"addUnrecognized",value:function(){this.addSpecial("unrecognized")}},{key:"addSpecial",value:function(t){var e=1<arguments.length&&void 0!==arguments[1]?arguments[1]:null,n=this.indexTable[t]=this.characters.length;this.characterTable[n]=e,this.specialIndexes.push(this.characters.length),this.characters.push(t)}},{key:"countSpecial",value:function(t){for(var e=0,n=0;n<this.specialIndexes;n++)for(var r=-1;r=-1<t.indexOf(this.specialIndexes[n],r);)e++;return e}},{key:"toFunctionString",value:function(){return"\nvar characterTable = "+JSON.stringify(this.characterTable)+";\nvar indexTable = "+JSON.stringify(this.indexTable)+";\nvar characters = "+JSON.stringify(this.characters)+";\n"+this.toIndexes.toString().replace(/(let|var) indexTable = this[.]indexTable;\n/,"").replace(/this[.]/g,"")+"\n"+this.toIndexesInputOutput.toString().replace(/this[.]/g,"")+"\n"+this.toCharacters.toString().replace(/(let|var) characterTable = this[.]characterTable;\n/g,"").replace(/this[.]/,"")+"\n"}}],[{key:"fromAllPrintable",value:function(e){for(var n=1<arguments.length&&void 0!==arguments[1]?arguments[1]:["\n"],r=32;r<=126;r++)n.push(String.fromCharCode(r));return new t(n,e)}},{key:"fromAllPrintableInputOutput",value:function(e){var n=1<arguments.length&&void 0!==arguments[1]?arguments[1]:["\n"],r=t.fromAllPrintable(e,n);return r.addInputOutput(),r}},{key:"fromStringInputOutput",value:function(e,n){var r,o=new t((r=String.prototype).concat.apply(r,i(new Set(e))),n);return o.addInputOutput(),o}},{key:"fromArrayInputOutput",value:function(e,n){var r=new t(e.filter(function(t,e,n){return n.indexOf(t)===e}).sort(),n);return r.addInputOutput(),r}},{key:"fromString",value:function(e,n){var r;return new t((r=String.prototype).concat.apply(r,i(new Set(e))),n)}},{key:"fromJSON",value:function(e){var n=new t;return n.indexTable=e.indexTable,n.characterTable=e.characterTable,n.values=e.values,n.characters=e.characters,n.specialIndexes=e.specialIndexes,n}}]),t}();e.default=o},function(t,e,n){"use strict";function r(t){return(r="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t})(t)}Object.defineProperty(e,"__esModule",{value:!0});var i=function(){function t(t,e){for(var n=0;n<e.length;n++){var r=e[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(t,r.key,r)}}return function(e,n,r){return n&&t(e.prototype,n),r&&t(e,r),e}}(),o=u(n(31)),a=u(n(105)),s=u(n(106));function u(t){return t&&t.__esModule?t:{default:t}}var c=function(t){function e(){return function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,e),function(t,e){if(!t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!e||"object"!==r(e)&&"function"!=typeof e?t:e}(this,(e.__proto__||Object.getPrototypeOf(e)).apply(this,arguments))}return function(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function, not "+r(e));t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,enumerable:!1,writable:!0,configurable:!0}}),e&&(Object.setPrototypeOf?Object.setPrototypeOf(t,e):t.__proto__=e)}(e,s.default),i(e,[{key:"getModel",value:function(t,e){return{inputMatrix:new a.default(t,e,.08),inputHidden:new a.default(t,t,.08),inputBias:new o.default(t,1),forgetMatrix:new a.default(t,e,.08),forgetHidden:new a.default(t,t,.08),forgetBias:new o.default(t,1),outputMatrix:new a.default(t,e,.08),outputHidden:new a.default(t,t,.08),outputBias:new o.default(t,1),cellActivationMatrix:new a.default(t,e,.08),cellActivationHidden:new a.default(t,t,.08),cellActivationBias:new o.default(t,1)}}},{key:"getEquation",value:function(t,e,n,r){var i=t.sigmoid.bind(t),o=t.add.bind(t),a=t.multiply.bind(t),s=t.multiplyElement.bind(t),u=t.tanh.bind(t),c=i(o(o(a(r.inputMatrix,e),a(r.inputHidden,n)),r.inputBias)),l=i(o(o(a(r.forgetMatrix,e),a(r.forgetHidden,n)),r.forgetBias)),f=i(o(o(a(r.outputMatrix,e),a(r.outputHidden,n)),r.outputBias)),h=u(o(o(a(r.cellActivationMatrix,e),a(r.cellActivationHidden,n)),r.cellActivationBias));return s(f,u(o(s(l,n),s(c,h))))}}]),e}();e.default=c},function(t,e,n){"use strict";function r(t){return(r="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t})(t)}Object.defineProperty(e,"__esModule",{value:!0});var i=function(){function t(t,e){for(var n=0;n<e.length;n++){var r=e[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(t,r.key,r)}}return function(e,n,r){return n&&t(e.prototype,n),r&&t(e,r),e}}(),o=u(n(31)),a=u(n(105)),s=u(n(106));function u(t){return t&&t.__esModule?t:{default:t}}var c=function(t){function e(){return function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,e),function(t,e){if(!t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!e||"object"!==r(e)&&"function"!=typeof e?t:e}(this,(e.__proto__||Object.getPrototypeOf(e)).apply(this,arguments))}return function(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function, not "+r(e));t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,enumerable:!1,writable:!0,configurable:!0}}),e&&(Object.setPrototypeOf?Object.setPrototypeOf(t,e):t.__proto__=e)}(e,s.default),i(e,[{key:"getModel",value:function(t,e){return{updateGateInputMatrix:new a.default(t,e,.08),updateGateHiddenMatrix:new a.default(t,t,.08),updateGateBias:new o.default(t,1),resetGateInputMatrix:new a.default(t,e,.08),resetGateHiddenMatrix:new a.default(t,t,.08),resetGateBias:new o.default(t,1),cellWriteInputMatrix:new a.default(t,e,.08),cellWriteHiddenMatrix:new a.default(t,t,.08),cellWriteBias:new o.default(t,1)}}},{key:"getEquation",value:function(t,e,n,r){var i=t.sigmoid.bind(t),o=t.add.bind(t),a=t.multiply.bind(t),s=t.multiplyElement.bind(t),u=t.tanh.bind(t),c=t.allOnes.bind(t),l=t.cloneNegative.bind(t),f=i(o(o(a(r.updateGateInputMatrix,e),a(r.updateGateHiddenMatrix,n)),r.updateGateBias)),h=i(o(o(a(r.resetGateInputMatrix,e),a(r.resetGateHiddenMatrix,n)),r.resetGateBias)),p=u(o(o(a(r.cellWriteInputMatrix,e),a(r.cellWriteHiddenMatrix,s(h,n))),r.cellWriteBias));return o(s(o(c(f.rows,f.columns),l(f)),p),s(n,f))}}]),e}();e.default=c},function(t,e){t.exports=function(t,e){if(!(e=Object.assign({},e)).service)throw new Error("You need to provide a service");var n=e.field||t;return function(r){function i(i){if(!i[n])return Promise.resolve(i);var o=i[n];"function"==typeof i.toObject?i=i.toObject(e):"function"==typeof i.toJSON&&(i=i.toJSON(e));var a=Object.assign({},r.params,{query:void 0});return(Array.isArray(o)?Promise.all(o.map(function(t){return r.app.service(e.service).get(t,a)})):r.app.service(e.service).get(o,a)).then(function(e){return e&&(i[t]=e),i})}if("after"===r.type){var o="find"===r.method&&r.result.data,a=o?r.result.data:r.result;return Array.isArray(a)?Promise.all(a.map(i)).then(function(t){return o?r.result.data=t:r.result=t,r}):i(r.result).then(function(t){return r.result=t,r})}}}},function(t,e,n){n(275),t.exports=n(476)},function(t,e,n){"use strict";(function(t){if(n(276),n(472),n(473),t._babelPolyfill)throw new Error("only one instance of babel-polyfill is allowed");function e(t,e,n){t[e]||Object.defineProperty(t,e,{writable:!0,configurable:!0,value:n})}t._babelPolyfill=!0,e(String.prototype,"padLeft","".padStart),e(String.prototype,"padRight","".padEnd),"pop,reverse,shift,keys,values,entries,indexOf,every,some,forEach,map,filter,find,findIndex,includes,join,slice,concat,push,splice,unshift,sort,lastIndexOf,reduce,reduceRight,copyWithin,fill".split(",").forEach(function(t){[][t]&&e(Array,t,Function.call.bind([][t]))})}).call(this,n(15))},function(t,e,n){n(277),n(279),n(280),n(281),n(282),n(283),n(284),n(285),n(286),n(287),n(288),n(289),n(290),n(291),n(292),n(293),n(294),n(295),n(296),n(297),n(298),n(299),n(300),n(301),n(302),n(303),n(304),n(305),n(306),n(307),n(308),n(309),n(310),n(311),n(312),n(313),n(314),n(315),n(316),n(317),n(318),n(319),n(320),n(321),n(322),n(323),n(324),n(325),n(326),n(327),n(328),n(329),n(330),n(331),n(332),n(333),n(334),n(335),n(336),n(337),n(338),n(339),n(340),n(341),n(342),n(343),n(344),n(345),n(346),n(347),n(348),n(349),n(350),n(351),n(352),n(353),n(354),n(356),n(357),n(359),n(360),n(361),n(362),n(363),n(364),n(365),n(367),n(368),n(369),n(370),n(371),n(372),n(373),n(374),n(375),n(376),n(377),n(378),n(379),n(127),n(380),n(186),n(381),n(187),n(382),n(383),n(384),n(385),n(386),n(190),n(192),n(193),n(387),n(388),n(389),n(390),n(391),n(392),n(393),n(394),n(395),n(396),n(397),n(398),n(399),n(400),n(401),n(402),n(403),n(404),n(405),n(406),n(407),n(408),n(409),n(410),n(411),n(412),n(413),n(414),n(415),n(416),n(417),n(418),n(419),n(420),n(421),n(422),n(423),n(424),n(425),n(426),n(427),n(428),n(429),n(430),n(431),n(432),n(433),n(434),n(435),n(436),n(437),n(438),n(439),n(440),n(441),n(442),n(443),n(444),n(445),n(446),n(447),n(448),n(449),n(450),n(451),n(452),n(453),n(454),n(455),n(456),n(457),n(458),n(459),n(460),n(461),n(462),n(463),n(464),n(465),n(466),n(467),n(468),n(469),n(470),n(471),t.exports=n(20)},function(t,e,n){"use strict";function r(t){return(r="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t})(t)}var i=n(2),o=n(16),a=n(7),s=n(0),u=n(13),c=n(35).KEY,l=n(3),f=n(76),h=n(55),p=n(41),d=n(5),y=n(168),v=n(108),g=n(278),m=n(79),b=n(1),x=n(4),_=n(17),w=n(27),S=n(40),E=n(44),T=n(171),k=n(18),O=n(8),A=n(42),j=k.f,P=O.f,R=T.f,C=i.Symbol,I=i.JSON,L=I&&I.stringify,N="prototype",F=d("_hidden"),M=d("toPrimitive"),D={}.propertyIsEnumerable,U=f("symbol-registry"),G=f("symbols"),z=f("op-symbols"),B=Object[N],V="function"==typeof C,W=i.QObject,X=!W||!W[N]||!W[N].findChild,K=a&&l(function(){return 7!=E(P({},"a",{get:function(){return P(this,"a",{value:7}).a}})).a})?function(t,e,n){var r=j(B,e);r&&delete B[e],P(t,e,n),r&&t!==B&&P(B,e,r)}:P,q=function(t){var e=G[t]=E(C[N]);return e._k=t,e},H=V&&"symbol"==r(C.iterator)?function(t){return"symbol"==r(t)}:function(t){return t instanceof C},$=function(t,e,n){return t===B&&$(z,e,n),b(t),e=w(e,!0),b(n),o(G,e)?(n.enumerable?(o(t,F)&&t[F][e]&&(t[F][e]=!1),n=E(n,{enumerable:S(0,!1)})):(o(t,F)||P(t,F,S(1,{})),t[F][e]=!0),K(t,e,n)):P(t,e,n)},Y=function(t,e){b(t);for(var n,r=g(e=_(e)),i=0,o=r.length;i<o;)$(t,n=r[i++],e[n]);return t},J=function(t){var e=D.call(this,t=w(t,!0));return!(this===B&&o(G,t)&&!o(z,t))&&(!(e||!o(this,t)||!o(G,t)||o(this,F)&&this[F][t])||e)},Q=function(t,e){if(t=_(t),e=w(e,!0),t!==B||!o(G,e)||o(z,e)){var n=j(t,e);return!n||!o(G,e)||o(t,F)&&t[F][e]||(n.enumerable=!0),n}},Z=function(t){for(var e,n=R(_(t)),r=[],i=0;n.length>i;)o(G,e=n[i++])||e==F||e==c||r.push(e);return r},tt=function(t){for(var e,n=t===B,r=R(n?z:_(t)),i=[],a=0;r.length>a;)!o(G,e=r[a++])||n&&!o(B,e)||i.push(G[e]);return i};V||(u((C=function(){if(this instanceof C)throw TypeError("Symbol is not a constructor!");var t=p(0<arguments.length?arguments[0]:void 0);return a&&X&&K(B,t,{configurable:!0,set:function e(n){this===B&&e.call(z,n),o(this,F)&&o(this[F],t)&&(this[F][t]=!1),K(this,t,S(1,n))}}),q(t)})[N],"toString",function(){return this._k}),k.f=Q,O.f=$,n(45).f=T.f=Z,n(64).f=J,n(78).f=tt,a&&!n(36)&&u(B,"propertyIsEnumerable",J,!0),y.f=function(t){return q(d(t))}),s(s.G+s.W+s.F*!V,{Symbol:C});for(var et="hasInstance,isConcatSpreadable,iterator,match,replace,search,species,split,toPrimitive,toStringTag,unscopables".split(","),nt=0;et.length>nt;)d(et[nt++]);for(var rt=A(d.store),it=0;rt.length>it;)v(rt[it++]);s(s.S+s.F*!V,"Symbol",{for:function(t){return o(U,t+="")?U[t]:U[t]=C(t)},keyFor:function(t){if(!H(t))throw TypeError(t+" is not a symbol!");for(var e in U)if(U[e]===t)return e},useSetter:function(){X=!0},useSimple:function(){X=!1}}),s(s.S+s.F*!V,"Object",{create:function(t,e){return void 0===e?E(t):Y(E(t),e)},defineProperty:$,defineProperties:Y,getOwnPropertyDescriptor:Q,getOwnPropertyNames:Z,getOwnPropertySymbols:tt}),I&&s(s.S+s.F*(!V||l(function(){var t=C();return"[null]"!=L([t])||"{}"!=L({a:t})||"{}"!=L(Object(t))})),"JSON",{stringify:function(t){for(var e,n,r=[t],i=1;arguments.length>i;)r.push(arguments[i++]);if(n=e=r[1],(x(e)||void 0!==t)&&!H(t))return m(e)||(e=function(t,e){if("function"==typeof n&&(e=n.call(this,t,e)),!H(e))return e}),r[1]=e,L.apply(I,r)}}),C[N][M]||n(12)(C[N],M,C[N].valueOf),h(C,"Symbol"),h(Math,"Math",!0),h(i.JSON,"JSON",!0)},function(t,e,n){var r=n(42),i=n(78),o=n(64);t.exports=function(t){var e=r(t),n=i.f;if(n)for(var a,s=n(t),u=o.f,c=0;s.length>c;)u.call(t,a=s[c++])&&e.push(a);return e}},function(t,e,n){var r=n(0);r(r.S,"Object",{create:n(44)})},function(t,e,n){var r=n(0);r(r.S+r.F*!n(7),"Object",{defineProperty:n(8).f})},function(t,e,n){var r=n(0);r(r.S+r.F*!n(7),"Object",{defineProperties:n(170)})},function(t,e,n){var r=n(17),i=n(18).f;n(29)("getOwnPropertyDescriptor",function(){return function(t,e){return i(r(t),e)}})},function(t,e,n){var r=n(9),i=n(19);n(29)("getPrototypeOf",function(){return function(t){return i(r(t))}})},function(t,e,n){var r=n(9),i=n(42);n(29)("keys",function(){return function(t){return i(r(t))}})},function(t,e,n){n(29)("getOwnPropertyNames",function(){return n(171).f})},function(t,e,n){var r=n(4),i=n(35).onFreeze;n(29)("freeze",function(t){return function(e){return t&&r(e)?t(i(e)):e}})},function(t,e,n){var r=n(4),i=n(35).onFreeze;n(29)("seal",function(t){return function(e){return t&&r(e)?t(i(e)):e}})},function(t,e,n){var r=n(4),i=n(35).onFreeze;n(29)("preventExtensions",function(t){return function(e){return t&&r(e)?t(i(e)):e}})},function(t,e,n){var r=n(4);n(29)("isFrozen",function(t){return function(e){return!r(e)||!!t&&t(e)}})},function(t,e,n){var r=n(4);n(29)("isSealed",function(t){return function(e){return!r(e)||!!t&&t(e)}})},function(t,e,n){var r=n(4);n(29)("isExtensible",function(t){return function(e){return!!r(e)&&(!t||t(e))}})},function(t,e,n){var r=n(0);r(r.S+r.F,"Object",{assign:n(172)})},function(t,e,n){var r=n(0);r(r.S,"Object",{is:n(173)})},function(t,e,n){var r=n(0);r(r.S,"Object",{setPrototypeOf:n(112).set})},function(t,e,n){"use strict";var r=n(56),i={};i[n(5)("toStringTag")]="z",i+""!="[object z]"&&n(13)(Object.prototype,"toString",function(){return"[object "+r(this)+"]"},!0)},function(t,e,n){var r=n(0);r(r.P,"Function",{bind:n(174)})},function(t,e,n){var r=n(8).f,i=Function.prototype,o=/^\s*function ([^ (]*)/;"name"in i||n(7)&&r(i,"name",{configurable:!0,get:function(){try{return(""+this).match(o)[1]}catch(t){return""}}})},function(t,e,n){"use strict";var r=n(4),i=n(19),o=n(5)("hasInstance"),a=Function.prototype;o in a||n(8).f(a,o,{value:function(t){if("function"!=typeof this||!r(t))return!1;if(!r(this.prototype))return t instanceof this;for(;t=i(t);)if(this.prototype===t)return!0;return!1}})},function(t,e,n){var r=n(0),i=n(176);r(r.G+r.F*(parseInt!=i),{parseInt:i})},function(t,e,n){var r=n(0),i=n(177);r(r.G+r.F*(parseFloat!=i),{parseFloat:i})},function(t,e,n){"use strict";var r=n(2),i=n(16),o=n(22),a=n(114),s=n(27),u=n(3),c=n(45).f,l=n(18).f,f=n(8).f,h=n(57).trim,p="Number",d=r[p],y=d,v=d.prototype,g=o(n(44)(v))==p,m="trim"in String.prototype,b=function(t){var e=s(t,!1);if("string"==typeof e&&2<e.length){var n,r,i,o=(e=m?e.trim():h(e,3)).charCodeAt(0);if(43===o||45===o){if(88===(n=e.charCodeAt(2))||120===n)return NaN}else if(48===o){switch(e.charCodeAt(1)){case 66:case 98:r=2,i=49;break;case 79:case 111:r=8,i=55;break;default:return+e}for(var a,u=e.slice(2),c=0,l=u.length;c<l;c++)if((a=u.charCodeAt(c))<48||i<a)return NaN;return parseInt(u,r)}}return+e};if(!d(" 0o1")||!d("0b1")||d("+0x1")){d=function(t){var e=arguments.length<1?0:t,n=this;return n instanceof d&&(g?u(function(){v.valueOf.call(n)}):o(n)!=p)?a(new y(b(e)),n,d):b(e)};for(var x,_=n(7)?c(y):"MAX_VALUE,MIN_VALUE,NaN,NEGATIVE_INFINITY,POSITIVE_INFINITY,EPSILON,isFinite,isInteger,isNaN,isSafeInteger,MAX_SAFE_INTEGER,MIN_SAFE_INTEGER,parseFloat,parseInt,isInteger".split(","),w=0;_.length>w;w++)i(y,x=_[w])&&!i(d,x)&&f(d,x,l(y,x));(d.prototype=v).constructor=d,n(13)(r,p,d)}},function(t,e,n){"use strict";var r=n(0),i=n(23),o=n(178),a=n(115),s=1..toFixed,u=Math.floor,c=[0,0,0,0,0,0],l="Number.toFixed: incorrect invocation!",f=function(t,e){for(var n=-1,r=e;++n<6;)r+=t*c[n],c[n]=r%1e7,r=u(r/1e7)},h=function(t){for(var e=6,n=0;0<=--e;)n+=c[e],c[e]=u(n/t),n=n%t*1e7},p=function(){for(var t=6,e="";0<=--t;)if(""!==e||0===t||0!==c[t]){var n=String(c[t]);e=""===e?n:e+a.call("0",7-n.length)+n}return e},d=function t(e,n,r){return 0===n?r:n%2==1?t(e,n-1,r*e):t(e*e,n/2,r)};r(r.P+r.F*(!!s&&("0.000"!==8e-5.toFixed(3)||"1"!==.9.toFixed(0)||"1.25"!==1.255.toFixed(2)||"1000000000000000128"!==(0xde0b6b3a7640080).toFixed(0))||!n(3)(function(){s.call({})})),"Number",{toFixed:function(t){var e,n,r,s,u=o(this,l),c=i(t),y="",v="0";if(c<0||20<c)throw RangeError(l);if(u!=u)return"NaN";if(u<=-1e21||1e21<=u)return String(u);if(u<0&&(y="-",u=-u),1e-21<u)if(n=(e=function(t){for(var e=0,n=u*d(2,69,1);4096<=n;)e+=12,n/=4096;for(;2<=n;)e+=1,n/=2;return e}()-69)<0?u*d(2,-e,1):u/d(2,e,1),n*=4503599627370496,0<(e=52-e)){for(f(0,n),r=c;7<=r;)f(1e7,0),r-=7;for(f(d(10,r,1),0),r=e-1;23<=r;)h(1<<23),r-=23;h(1<<r),f(1,1),h(2),v=p()}else f(0,n),f(1<<-e,0),v=p()+a.call("0",c);return 0<c?y+((s=v.length)<=c?"0."+a.call("0",c-s)+v:v.slice(0,s-c)+"."+v.slice(s-c)):y+v}})},function(t,e,n){"use strict";var r=n(0),i=n(3),o=n(178),a=1..toPrecision;r(r.P+r.F*(i(function(){return"1"!==a.call(1,void 0)})||!i(function(){a.call({})})),"Number",{toPrecision:function(t){var e=o(this,"Number#toPrecision: incorrect invocation!");return void 0===t?a.call(e):a.call(e,t)}})},function(t,e,n){var r=n(0);r(r.S,"Number",{EPSILON:Math.pow(2,-52)})},function(t,e,n){var r=n(0),i=n(2).isFinite;r(r.S,"Number",{isFinite:function(t){return"number"==typeof t&&i(t)}})},function(t,e,n){var r=n(0);r(r.S,"Number",{isInteger:n(179)})},function(t,e,n){var r=n(0);r(r.S,"Number",{isNaN:function(t){return t!=t}})},function(t,e,n){var r=n(0),i=n(179),o=Math.abs;r(r.S,"Number",{isSafeInteger:function(t){return i(t)&&o(t)<=9007199254740991}})},function(t,e,n){var r=n(0);r(r.S,"Number",{MAX_SAFE_INTEGER:9007199254740991})},function(t,e,n){var r=n(0);r(r.S,"Number",{MIN_SAFE_INTEGER:-9007199254740991})},function(t,e,n){var r=n(0),i=n(177);r(r.S+r.F*(Number.parseFloat!=i),"Number",{parseFloat:i})},function(t,e,n){var r=n(0),i=n(176);r(r.S+r.F*(Number.parseInt!=i),"Number",{parseInt:i})},function(t,e,n){var r=n(0),i=n(180),o=Math.sqrt,a=Math.acosh;r(r.S+r.F*!(a&&710==Math.floor(a(Number.MAX_VALUE))&&a(1/0)==1/0),"Math",{acosh:function(t){return(t=+t)<1?NaN:94906265.62425156<t?Math.log(t)+Math.LN2:i(t-1+o(t-1)*o(t+1))}})},function(t,e,n){var r=n(0),i=Math.asinh;r(r.S+r.F*!(i&&0<1/i(0)),"Math",{asinh:function t(e){return isFinite(e=+e)&&0!=e?e<0?-t(-e):Math.log(e+Math.sqrt(e*e+1)):e}})},function(t,e,n){var r=n(0),i=Math.atanh;r(r.S+r.F*!(i&&1/i(-0)<0),"Math",{atanh:function(t){return 0==(t=+t)?t:Math.log((1+t)/(1-t))/2}})},function(t,e,n){var r=n(0),i=n(116);r(r.S,"Math",{cbrt:function(t){return i(t=+t)*Math.pow(Math.abs(t),1/3)}})},function(t,e,n){var r=n(0);r(r.S,"Math",{clz32:function(t){return(t>>>=0)?31-Math.floor(Math.log(t+.5)*Math.LOG2E):32}})},function(t,e,n){var r=n(0),i=Math.exp;r(r.S,"Math",{cosh:function(t){return(i(t=+t)+i(-t))/2}})},function(t,e,n){var r=n(0),i=n(117);r(r.S+r.F*(i!=Math.expm1),"Math",{expm1:i})},function(t,e,n){var r=n(0);r(r.S,"Math",{fround:n(181)})},function(t,e,n){var r=n(0),i=Math.abs;r(r.S,"Math",{hypot:function(t,e){for(var n,r,o=0,a=0,s=arguments.length,u=0;a<s;)u<(n=i(arguments[a++]))?(o=o*(r=u/n)*r+1,u=n):o+=0<n?(r=n/u)*r:n;return u===1/0?1/0:u*Math.sqrt(o)}})},function(t,e,n){var r=n(0),i=Math.imul;r(r.S+r.F*n(3)(function(){return-5!=i(4294967295,5)||2!=i.length}),"Math",{imul:function(t,e){var n=+t,r=+e,i=65535&n,o=65535&r;return 0|i*o+((65535&n>>>16)*o+i*(65535&r>>>16)<<16>>>0)}})},function(t,e,n){var r=n(0);r(r.S,"Math",{log10:function(t){return Math.log(t)*Math.LOG10E}})},function(t,e,n){var r=n(0);r(r.S,"Math",{log1p:n(180)})},function(t,e,n){var r=n(0);r(r.S,"Math",{log2:function(t){return Math.log(t)/Math.LN2}})},function(t,e,n){var r=n(0);r(r.S,"Math",{sign:n(116)})},function(t,e,n){var r=n(0),i=n(117),o=Math.exp;r(r.S+r.F*n(3)(function(){return-2e-17!=!Math.sinh(-2e-17)}),"Math",{sinh:function(t){return Math.abs(t=+t)<1?(i(t)-i(-t))/2:(o(t-1)-o(-t-1))*(Math.E/2)}})},function(t,e,n){var r=n(0),i=n(117),o=Math.exp;r(r.S,"Math",{tanh:function(t){var e=i(t=+t),n=i(-t);return e==1/0?1:n==1/0?-1:(e-n)/(o(t)+o(-t))}})},function(t,e,n){var r=n(0);r(r.S,"Math",{trunc:function(t){return(0<t?Math.floor:Math.ceil)(t)}})},function(t,e,n){var r=n(0),i=n(43),o=String.fromCharCode,a=String.fromCodePoint;r(r.S+r.F*(!!a&&1!=a.length),"String",{fromCodePoint:function(t){for(var e,n=[],r=arguments.length,a=0;a<r;){if(e=+arguments[a++],i(e,1114111)!==e)throw RangeError(e+" is not a valid code point");n.push(e<65536?o(e):o(55296+((e-=65536)>>10),e%1024+56320))}return n.join("")}})},function(t,e,n){var r=n(0),i=n(17),o=n(6);r(r.S,"String",{raw:function(t){for(var e=i(t.raw),n=o(e.length),r=arguments.length,a=[],s=0;s<n;)a.push(String(e[s++])),s<r&&a.push(String(arguments[s]));return a.join("")}})},function(t,e,n){"use strict";n(57)("trim",function(t){return function(){return t(this,3)}})},function(t,e,n){"use strict";var r=n(80)(!0);n(118)(String,"String",function(t){this._t=String(t),this._i=0},function(){var t,e=this._t,n=this._i;return n>=e.length?{value:void 0,done:!0}:(t=r(e,n),this._i+=t.length,{value:t,done:!1})})},function(t,e,n){"use strict";var r=n(0),i=n(80)(!1);r(r.P,"String",{codePointAt:function(t){return i(this,t)}})},function(t,e,n){"use strict";var r=n(0),i=n(6),o=n(120),a="endsWith",s=""[a];r(r.P+r.F*n(121)(a),"String",{endsWith:function(t){var e=o(this,t,a),n=1<arguments.length?arguments[1]:void 0,r=i(e.length),u=void 0===n?r:Math.min(i(n),r),c=String(t);return s?s.call(e,c,u):e.slice(u-c.length,u)===c}})},function(t,e,n){"use strict";var r=n(0),i=n(120);r(r.P+r.F*n(121)("includes"),"String",{includes:function(t){return!!~i(this,t,"includes").indexOf(t,1<arguments.length?arguments[1]:void 0)}})},function(t,e,n){var r=n(0);r(r.P,"String",{repeat:n(115)})},function(t,e,n){"use strict";var r=n(0),i=n(6),o=n(120),a="startsWith",s=""[a];r(r.P+r.F*n(121)(a),"String",{startsWith:function(t){var e=o(this,t,a),n=i(Math.min(1<arguments.length?arguments[1]:void 0,e.length)),r=String(t);return s?s.call(e,r,n):e.slice(n,n+r.length)===r}})},function(t,e,n){"use strict";n(14)("anchor",function(t){return function(e){return t(this,"a","name",e)}})},function(t,e,n){"use strict";n(14)("big",function(t){return function(){return t(this,"big","","")}})},function(t,e,n){"use strict";n(14)("blink",function(t){return function(){return t(this,"blink","","")}})},function(t,e,n){"use strict";n(14)("bold",function(t){return function(){return t(this,"b","","")}})},function(t,e,n){"use strict";n(14)("fixed",function(t){return function(){return t(this,"tt","","")}})},function(t,e,n){"use strict";n(14)("fontcolor",function(t){return function(e){return t(this,"font","color",e)}})},function(t,e,n){"use strict";n(14)("fontsize",function(t){return function(e){return t(this,"font","size",e)}})},function(t,e,n){"use strict";n(14)("italics",function(t){return function(){return t(this,"i","","")}})},function(t,e,n){"use strict";n(14)("link",function(t){return function(e){return t(this,"a","href",e)}})},function(t,e,n){"use strict";n(14)("small",function(t){return function(){return t(this,"small","","")}})},function(t,e,n){"use strict";n(14)("strike",function(t){return function(){return t(this,"strike","","")}})},function(t,e,n){"use strict";n(14)("sub",function(t){return function(){return t(this,"sub","","")}})},function(t,e,n){"use strict";n(14)("sup",function(t){return function(){return t(this,"sup","","")}})},function(t,e,n){var r=n(0);r(r.S,"Date",{now:function(){return(new Date).getTime()}})},function(t,e,n){"use strict";var r=n(0),i=n(9),o=n(27);r(r.P+r.F*n(3)(function(){return null!==new Date(NaN).toJSON()||1!==Date.prototype.toJSON.call({toISOString:function(){return 1}})}),"Date",{toJSON:function(t){var e=i(this),n=o(e);return"number"!=typeof n||isFinite(n)?e.toISOString():null}})},function(t,e,n){var r=n(0),i=n(355);r(r.P+r.F*(Date.prototype.toISOString!==i),"Date",{toISOString:i})},function(t,e,n){"use strict";var r=n(3),i=Date.prototype.getTime,o=Date.prototype.toISOString,a=function(t){return 9<t?t:"0"+t};t.exports=r(function(){return"0385-07-25T07:06:39.999Z"!=o.call(new Date(-5e13-1))})||!r(function(){o.call(new Date(NaN))})?function(){if(!isFinite(i.call(this)))throw RangeError("Invalid time value");var t=this.getUTCFullYear(),e=this.getUTCMilliseconds(),n=t<0?"-":9999<t?"+":"";return n+("00000"+Math.abs(t)).slice(n?-6:-4)+"-"+a(this.getUTCMonth()+1)+"-"+a(this.getUTCDate())+"T"+a(this.getUTCHours())+":"+a(this.getUTCMinutes())+":"+a(this.getUTCSeconds())+"."+(99<e?e:"0"+a(e))+"Z"}:o},function(t,e,n){var r=Date.prototype,i="Invalid Date",o=r.toString,a=r.getTime;new Date(NaN)+""!=i&&n(13)(r,"toString",function(){var t=a.call(this);return t==t?o.call(this):i})},function(t,e,n){var r=n(5)("toPrimitive"),i=Date.prototype;r in i||n(12)(i,r,n(358))},function(t,e,n){"use strict";var r=n(1),i=n(27);t.exports=function(t){if("string"!==t&&"number"!==t&&"default"!==t)throw TypeError("Incorrect hint");return i(r(this),"number"!=t)}},function(t,e,n){var r=n(0);r(r.S,"Array",{isArray:n(79)})},function(t,e,n){"use strict";var r=n(21),i=n(0),o=n(9),a=n(182),s=n(122),u=n(6),c=n(123),l=n(124);i(i.S+i.F*!n(82)(function(t){Array.from(t)}),"Array",{from:function(t){var e,n,i,f,h=o(t),p="function"==typeof this?this:Array,d=arguments.length,y=1<d?arguments[1]:void 0,v=void 0!==y,g=0,m=l(h);if(v&&(y=r(y,2<d?arguments[2]:void 0,2)),null==m||p==Array&&s(m))for(n=new p(e=u(h.length));g<e;g++)c(n,g,v?y(h[g],g):h[g]);else for(f=m.call(h),n=new p;!(i=f.next()).done;g++)c(n,g,v?a(f,y,[i.value,g],!0):i.value);return n.length=g,n}})},function(t,e,n){"use strict";var r=n(0),i=n(123);r(r.S+r.F*n(3)(function(){function t(){}return!(Array.of.call(t)instanceof t)}),"Array",{of:function(){for(var t=0,e=arguments.length,n=new("function"==typeof this?this:Array)(e);t<e;)i(n,t,arguments[t++]);return n.length=e,n}})},function(t,e,n){"use strict";var r=n(0),i=n(17),o=[].join;r(r.P+r.F*(n(63)!=Object||!n(24)(o)),"Array",{join:function(t){return o.call(i(this),void 0===t?",":t)}})},function(t,e,n){"use strict";var r=n(0),i=n(111),o=n(22),a=n(43),s=n(6),u=[].slice;r(r.P+r.F*n(3)(function(){i&&u.call(i)}),"Array",{slice:function(t,e){var n=s(this.length),r=o(this);if(e=void 0===e?n:e,"Array"==r)return u.call(this,t,e);for(var i=a(t,n),c=a(e,n),l=s(c-i),f=new Array(l),h=0;h<l;h++)f[h]="String"==r?this.charAt(i+h):this[i+h];return f}})},function(t,e,n){"use strict";var r=n(0),i=n(11),o=n(9),a=n(3),s=[].sort,u=[1,2,3];r(r.P+r.F*(a(function(){u.sort(void 0)})||!a(function(){u.sort(null)})||!n(24)(s)),"Array",{sort:function(t){return void 0===t?s.call(o(this)):s.call(o(this),i(t))}})},function(t,e,n){"use strict";var r=n(0),i=n(30)(0),o=n(24)([].forEach,!0);r(r.P+r.F*!o,"Array",{forEach:function(t){return i(this,t,arguments[1])}})},function(t,e,n){var r=n(4),i=n(79),o=n(5)("species");t.exports=function(t){var e;return i(t)&&("function"!=typeof(e=t.constructor)||e!==Array&&!i(e.prototype)||(e=void 0),r(e)&&null===(e=e[o])&&(e=void 0)),void 0===e?Array:e}},function(t,e,n){"use strict";var r=n(0),i=n(30)(1);r(r.P+r.F*!n(24)([].map,!0),"Array",{map:function(t){return i(this,t,arguments[1])}})},function(t,e,n){"use strict";var r=n(0),i=n(30)(2);r(r.P+r.F*!n(24)([].filter,!0),"Array",{filter:function(t){return i(this,t,arguments[1])}})},function(t,e,n){"use strict";var r=n(0),i=n(30)(3);r(r.P+r.F*!n(24)([].some,!0),"Array",{some:function(t){return i(this,t,arguments[1])}})},function(t,e,n){"use strict";var r=n(0),i=n(30)(4);r(r.P+r.F*!n(24)([].every,!0),"Array",{every:function(t){return i(this,t,arguments[1])}})},function(t,e,n){"use strict";var r=n(0),i=n(183);r(r.P+r.F*!n(24)([].reduce,!0),"Array",{reduce:function(t){return i(this,t,arguments.length,arguments[1],!1)}})},function(t,e,n){"use strict";var r=n(0),i=n(183);r(r.P+r.F*!n(24)([].reduceRight,!0),"Array",{reduceRight:function(t){return i(this,t,arguments.length,arguments[1],!0)}})},function(t,e,n){"use strict";var r=n(0),i=n(77)(!1),o=[].indexOf,a=!!o&&1/[1].indexOf(1,-0)<0;r(r.P+r.F*(a||!n(24)(o)),"Array",{indexOf:function(t){return a?o.apply(this,arguments)||0:i(this,t,arguments[1])}})},function(t,e,n){"use strict";var r=n(0),i=n(17),o=n(23),a=n(6),s=[].lastIndexOf,u=!!s&&1/[1].lastIndexOf(1,-0)<0;r(r.P+r.F*(u||!n(24)(s)),"Array",{lastIndexOf:function(t){if(u)return s.apply(this,arguments)||0;var e=i(this),n=a(e.length),r=n-1;for(1<arguments.length&&(r=Math.min(r,o(arguments[1]))),r<0&&(r=n+r);0<=r;r--)if(r in e&&e[r]===t)return r||0;return-1}})},function(t,e,n){var r=n(0);r(r.P,"Array",{copyWithin:n(184)}),n(37)("copyWithin")},function(t,e,n){var r=n(0);r(r.P,"Array",{fill:n(126)}),n(37)("fill")},function(t,e,n){"use strict";var r=n(0),i=n(30)(5),o=!0;"find"in[]&&Array(1).find(function(){o=!1}),r(r.P+r.F*o,"Array",{find:function(t){return i(this,t,1<arguments.length?arguments[1]:void 0)}}),n(37)("find")},function(t,e,n){"use strict";var r=n(0),i=n(30)(6),o="findIndex",a=!0;o in[]&&Array(1)[o](function(){a=!1}),r(r.P+r.F*a,"Array",{findIndex:function(t){return i(this,t,1<arguments.length?arguments[1]:void 0)}}),n(37)(o)},function(t,e,n){n(46)("Array")},function(t,e,n){var r=n(2),i=n(114),o=n(8).f,a=n(45).f,s=n(81),u=n(65),c=r.RegExp,l=c,f=c.prototype,h=/a/g,p=/a/g,d=new c(h)!==h;if(n(7)&&(!d||n(3)(function(){return p[n(5)("match")]=!1,c(h)!=h||c(p)==p||"/a/i"!=c(h,"i")}))){c=function(t,e){var n=this instanceof c,r=s(t),o=void 0===e;return!n&&r&&t.constructor===c&&o?t:i(d?new l(r&&!o?t.source:t,e):l((r=t instanceof c)?t.source:t,r&&o?u.call(t):e),n?this:f,c)};for(var y=function(t){t in c||o(c,t,{configurable:!0,get:function(){return l[t]},set:function(e){l[t]=e}})},v=a(l),g=0;v.length>g;)y(v[g++]);(f.constructor=c).prototype=f,n(13)(r,"RegExp",c)}n(46)("RegExp")},function(t,e,n){"use strict";n(187);var r=n(1),i=n(65),o=n(7),a="toString",s=/./[a],u=function(t){n(13)(RegExp.prototype,a,t,!0)};n(3)(function(){return"/a/b"!=s.call({source:"a",flags:"b"})})?u(function(){var t=r(this);return"/".concat(t.source,"/","flags"in t?t.flags:!o&&t instanceof RegExp?i.call(t):void 0)}):s.name!=a&&u(function(){return s.call(this)})},function(t,e,n){"use strict";var r=n(1),i=n(6),o=n(129),a=n(83);n(84)("match",1,function(t,e,n,s){return[function(n){var r=t(this),i=null==n?void 0:n[e];return void 0!==i?i.call(n,r):new RegExp(n)[e](String(r))},function(t){var e=s(n,t,this);if(e.done)return e.value;var u=r(t),c=String(this);if(!u.global)return a(u,c);for(var l,f=u.unicode,h=[],p=u.lastIndex=0;null!==(l=a(u,c));){var d=String(l[0]);""===(h[p]=d)&&(u.lastIndex=o(c,i(u.lastIndex),f)),p++}return 0===p?null:h}]})},function(t,e,n){"use strict";var r=n(1),i=n(9),o=n(6),a=n(23),s=n(129),u=n(83),c=Math.max,l=Math.min,f=Math.floor,h=/\$([$&`']|\d\d?|<[^>]*>)/g,p=/\$([$&`']|\d\d?)/g;n(84)("replace",2,function(t,e,n,d){return[function(r,i){var o=t(this),a=null==r?void 0:r[e];return void 0!==a?a.call(r,o,i):n.call(String(o),r,i)},function(t,e){var i=d(n,t,this,e);if(i.done)return i.value;var f=r(t),h=String(this),p="function"==typeof e;p||(e=String(e));var v=f.global;if(v){var g=f.unicode;f.lastIndex=0}for(var m=[];;){var b=u(f,h);if(null===b)break;if(m.push(b),!v)break;""===String(b[0])&&(f.lastIndex=s(h,o(f.lastIndex),g))}for(var x,_="",w=0,S=0;S<m.length;S++){b=m[S];for(var E=String(b[0]),T=c(l(a(b.index),h.length),0),k=[],O=1;O<b.length;O++)k.push(void 0===(x=b[O])?x:String(x));var A=b.groups;if(p){var j=[E].concat(k,T,h);void 0!==A&&j.push(A);var P=String(e.apply(void 0,j))}else P=y(E,h,T,k,A,e);w<=T&&(_+=h.slice(w,T)+P,w=T+E.length)}return _+h.slice(w)}];function y(t,e,r,o,a,s){var u=r+t.length,c=o.length,l=p;return void 0!==a&&(a=i(a),l=h),n.call(s,l,function(n,i){var s;switch(i.charAt(0)){case"$":return"$";case"&":return t;case"`":return e.slice(0,r);case"'":return e.slice(u);case"<":s=a[i.slice(1,-1)];break;default:var l=+i;if(0===l)return i;if(c<l){var h=f(l/10);return 0===h?i:h<=c?void 0===o[h-1]?i.charAt(1):o[h-1]+i.charAt(1):i}s=o[l-1]}return void 0===s?"":s})}})},function(t,e,n){"use strict";var r=n(1),i=n(173),o=n(83);n(84)("search",1,function(t,e,n,a){return[function(n){var r=t(this),i=null==n?void 0:n[e];return void 0!==i?i.call(n,r):new RegExp(n)[e](String(r))},function(t){var e=a(n,t,this);if(e.done)return e.value;var s=r(t),u=String(this),c=s.lastIndex;i(c,0)||(s.lastIndex=0);var l=o(s,u);return i(s.lastIndex,c)||(s.lastIndex=c),null===l?-1:l.index}]})},function(t,e,n){"use strict";var r=n(81),i=n(1),o=n(66),a=n(129),s=n(6),u=n(83),c=n(128),l=Math.min,f=[].push,h="split",p="length",d="lastIndex",y=!!function(){try{return new RegExp("x","y")}catch(t){}}();n(84)("split",2,function(t,e,n,v){var g;return g="c"=="abbc"[h](/(b)*/)[1]||4!="test"[h](/(?:)/,-1)[p]||2!="ab"[h](/(?:ab)*/)[p]||4!="."[h](/(.?)(.?)/)[p]||1<"."[h](/()()/)[p]||""[h](/.?/)[p]?function(t,e){var i=String(this);if(void 0===t&&0===e)return[];if(!r(t))return n.call(i,t,e);for(var o,a,s,u=[],l=(t.ignoreCase?"i":"")+(t.multiline?"m":"")+(t.unicode?"u":"")+(t.sticky?"y":""),h=0,y=void 0===e?4294967295:e>>>0,v=new RegExp(t.source,l+"g");(o=c.call(v,i))&&!(h<(a=v[d])&&(u.push(i.slice(h,o.index)),1<o[p]&&o.index<i[p]&&f.apply(u,o.slice(1)),s=o[0][p],h=a,u[p]>=y));)v[d]===o.index&&v[d]++;return h===i[p]?!s&&v.test("")||u.push(""):u.push(i.slice(h)),u[p]>y?u.slice(0,y):u}:"0"[h](void 0,0)[p]?function(t,e){return void 0===t&&0===e?[]:n.call(this,t,e)}:n,[function(n,r){var i=t(this),o=null==n?void 0:n[e];return void 0!==o?o.call(n,i,r):g.call(String(i),n,r)},function(t,e){var r=v(g,t,this,e,g!==n);if(r.done)return r.value;var c=i(t),f=String(this),h=o(c,RegExp),p=c.unicode,d=(c.ignoreCase?"i":"")+(c.multiline?"m":"")+(c.unicode?"u":"")+(y?"y":"g"),m=new h(y?c:"^(?:"+c.source+")",d),b=void 0===e?4294967295:e>>>0;if(0===b)return[];if(0===f.length)return null===u(m,f)?[f]:[];for(var x=0,_=0,w=[];_<f.length;){m.lastIndex=y?_:0;var S,E=u(m,y?f:f.slice(_));if(null===E||(S=l(s(m.lastIndex+(y?0:_)),f.length))===x)_=a(f,_,p);else{if(w.push(f.slice(x,_)),w.length===b)return w;for(var T=1;T<=E.length-1;T++)if(w.push(E[T]),w.length===b)return w;_=x=S}}return w.push(f.slice(x)),w}]})},function(t,e,n){"use strict";var r,i,o,a,s=n(36),u=n(2),c=n(21),l=n(56),f=n(0),h=n(4),p=n(11),d=n(47),y=n(48),v=n(66),g=n(130).set,m=n(131)(),b=n(132),x=n(188),_=n(85),w=n(189),S="Promise",E=u.TypeError,T=u.process,k=T&&T.versions,O=k&&k.v8||"",A=u[S],j="process"==l(T),P=function(){},R=i=b.f,C=!!function(){try{var t=A.resolve(1),e=(t.constructor={})[n(5)("species")]=function(t){t(P,P)};return(j||"function"==typeof PromiseRejectionEvent)&&t.then(P)instanceof e&&0!==O.indexOf("6.6")&&-1===_.indexOf("Chrome/66")}catch(t){}}(),I=function(t){var e;return!(!h(t)||"function"!=typeof(e=t.then))&&e},L=function(t,e){if(!t._n){t._n=!0;var n=t._c;m(function(){for(var r=t._v,i=1==t._s,o=0,a=function(e){var n,o,a,s=i?e.ok:e.fail,u=e.resolve,c=e.reject,l=e.domain;try{s?(i||(2==t._h&&M(t),t._h=1),!0===s?n=r:(l&&l.enter(),n=s(r),l&&(l.exit(),a=!0)),n===e.promise?c(E("Promise-chain cycle")):(o=I(n))?o.call(n,u,c):u(n)):c(r)}catch(e){l&&!a&&l.exit(),c(e)}};n.length>o;)a(n[o++]);t._c=[],t._n=!1,e&&!t._h&&N(t)})}},N=function(t){g.call(u,function(){var e,n,r,i=t._v,o=F(t);if(o&&(e=x(function(){j?T.emit("unhandledRejection",i,t):(n=u.onunhandledrejection)?n({promise:t,reason:i}):(r=u.console)&&r.error&&r.error("Unhandled promise rejection",i)}),t._h=j||F(t)?2:1),t._a=void 0,o&&e.e)throw e.v})},F=function(t){return 1!==t._h&&0===(t._a||t._c).length},M=function(t){g.call(u,function(){var e;j?T.emit("rejectionHandled",t):(e=u.onrejectionhandled)&&e({promise:t,reason:t._v})})},D=function(t){var e=this;e._d||(e._d=!0,(e=e._w||e)._v=t,e._s=2,e._a||(e._a=e._c.slice()),L(e,!0))},U=function t(e){var n,r=this;if(!r._d){r._d=!0,r=r._w||r;try{if(r===e)throw E("Promise can't be resolved itself");(n=I(e))?m(function(){var i={_w:r,_d:!1};try{n.call(e,c(t,i,1),c(D,i,1))}catch(t){D.call(i,t)}}):(r._v=e,r._s=1,L(r,!1))}catch(t){D.call({_w:r,_d:!1},t)}}};C||(A=function(t){d(this,A,S,"_h"),p(t),r.call(this);try{t(c(U,this,1),c(D,this,1))}catch(t){D.call(this,t)}},(r=function(t){this._c=[],this._a=void 0,this._s=0,this._d=!1,this._v=void 0,this._h=0,this._n=!1}).prototype=n(49)(A.prototype,{then:function(t,e){var n=R(v(this,A));return n.ok="function"!=typeof t||t,n.fail="function"==typeof e&&e,n.domain=j?T.domain:void 0,this._c.push(n),this._a&&this._a.push(n),this._s&&L(this,!1),n.promise},catch:function(t){return this.then(void 0,t)}}),o=function(){var t=new r;this.promise=t,this.resolve=c(U,t,1),this.reject=c(D,t,1)},b.f=R=function(t){return t===A||t===a?new o(t):i(t)}),f(f.G+f.W+f.F*!C,{Promise:A}),n(55)(A,S),n(46)(S),a=n(20)[S],f(f.S+f.F*!C,S,{reject:function(t){var e=R(this);return(0,e.reject)(t),e.promise}}),f(f.S+f.F*(s||!C),S,{resolve:function(t){return w(s&&this===a?A:this,t)}}),f(f.S+f.F*!(C&&n(82)(function(t){A.all(t).catch(P)})),S,{all:function(t){var e=this,n=R(e),r=n.resolve,i=n.reject,o=x(function(){var n=[],o=0,a=1;y(t,!1,function(t){var s=o++,u=!1;n.push(void 0),a++,e.resolve(t).then(function(t){u||(u=!0,n[s]=t,--a||r(n))},i)}),--a||r(n)});return o.e&&i(o.v),n.promise},race:function(t){var e=this,n=R(e),r=n.reject,i=x(function(){y(t,!1,function(t){e.resolve(t).then(n.resolve,r)})});return i.e&&r(i.v),n.promise}})},function(t,e,n){"use strict";var r=n(194),i=n(59);n(86)("WeakSet",function(t){return function(){return t(this,0<arguments.length?arguments[0]:void 0)}},{add:function(t){return r.def(i(this,"WeakSet"),t,!0)}},r,!1,!0)},function(t,e,n){"use strict";var r=n(0),i=n(87),o=n(133),a=n(1),s=n(43),u=n(6),c=n(4),l=n(2).ArrayBuffer,f=n(66),h=o.ArrayBuffer,p=o.DataView,d=i.ABV&&l.isView,y=h.prototype.slice,v=i.VIEW,g="ArrayBuffer";r(r.G+r.W+r.F*(l!==h),{ArrayBuffer:h}),r(r.S+r.F*!i.CONSTR,g,{isView:function(t){return d&&d(t)||c(t)&&v in t}}),r(r.P+r.U+r.F*n(3)(function(){return!new h(2).slice(1,void 0).byteLength}),g,{slice:function(t,e){if(void 0!==y&&void 0===e)return y.call(a(this),t);for(var n=a(this).byteLength,r=s(t,n),i=s(void 0===e?n:e,n),o=new(f(this,h))(u(i-r)),c=new p(this),l=new p(o),d=0;r<i;)l.setUint8(d++,c.getUint8(r++));return o}}),n(46)(g)},function(t,e,n){var r=n(0);r(r.G+r.W+r.F*!n(87).ABV,{DataView:n(133).DataView})},function(t,e,n){n(32)("Int8",1,function(t){return function(e,n,r){return t(this,e,n,r)}})},function(t,e,n){n(32)("Uint8",1,function(t){return function(e,n,r){return t(this,e,n,r)}})},function(t,e,n){n(32)("Uint8",1,function(t){return function(e,n,r){return t(this,e,n,r)}},!0)},function(t,e,n){n(32)("Int16",2,function(t){return function(e,n,r){return t(this,e,n,r)}})},function(t,e,n){n(32)("Uint16",2,function(t){return function(e,n,r){return t(this,e,n,r)}})},function(t,e,n){n(32)("Int32",4,function(t){return function(e,n,r){return t(this,e,n,r)}})},function(t,e,n){n(32)("Uint32",4,function(t){return function(e,n,r){return t(this,e,n,r)}})},function(t,e,n){n(32)("Float32",4,function(t){return function(e,n,r){return t(this,e,n,r)}})},function(t,e,n){n(32)("Float64",8,function(t){return function(e,n,r){return t(this,e,n,r)}})},function(t,e,n){var r=n(0),i=n(11),o=n(1),a=(n(2).Reflect||{}).apply,s=Function.apply;r(r.S+r.F*!n(3)(function(){a(function(){})}),"Reflect",{apply:function(t,e,n){var r=i(t),u=o(n);return a?a(r,e,u):s.call(r,e,u)}})},function(t,e,n){var r=n(0),i=n(44),o=n(11),a=n(1),s=n(4),u=n(3),c=n(174),l=(n(2).Reflect||{}).construct,f=u(function(){function t(){}return!(l(function(){},[],t)instanceof t)}),h=!u(function(){l(function(){})});r(r.S+r.F*(f||h),"Reflect",{construct:function(t,e){o(t),a(e);var n=arguments.length<3?t:o(arguments[2]);if(h&&!f)return l(t,e,n);if(t==n){switch(e.length){case 0:return new t;case 1:return new t(e[0]);case 2:return new t(e[0],e[1]);case 3:return new t(e[0],e[1],e[2]);case 4:return new t(e[0],e[1],e[2],e[3])}var r=[null];return r.push.apply(r,e),new(c.apply(t,r))}var u=n.prototype,p=i(s(u)?u:Object.prototype),d=Function.apply.call(t,p,e);return s(d)?d:p}})},function(t,e,n){var r=n(8),i=n(0),o=n(1),a=n(27);i(i.S+i.F*n(3)(function(){Reflect.defineProperty(r.f({},1,{value:1}),1,{value:2})}),"Reflect",{defineProperty:function(t,e,n){o(t),e=a(e,!0),o(n);try{return r.f(t,e,n),!0}catch(t){return!1}}})},function(t,e,n){var r=n(0),i=n(18).f,o=n(1);r(r.S,"Reflect",{deleteProperty:function(t,e){var n=i(o(t),e);return!(n&&!n.configurable)&&delete t[e]}})},function(t,e,n){"use strict";var r=n(0),i=n(1),o=function(t){this._t=i(t),this._i=0;var e,n=this._k=[];for(e in t)n.push(e)};n(119)(o,"Object",function(){var t,e=this._k;do{if(this._i>=e.length)return{value:void 0,done:!0}}while(!((t=e[this._i++])in this._t));return{value:t,done:!1}}),r(r.S,"Reflect",{enumerate:function(t){return new o(t)}})},function(t,e,n){var r=n(18),i=n(19),o=n(16),a=n(0),s=n(4),u=n(1);a(a.S,"Reflect",{get:function t(e,n){var a,c,l=arguments.length<3?e:arguments[2];return u(e)===l?e[n]:(a=r.f(e,n))?o(a,"value")?a.value:void 0!==a.get?a.get.call(l):void 0:s(c=i(e))?t(c,n,l):void 0}})},function(t,e,n){var r=n(18),i=n(0),o=n(1);i(i.S,"Reflect",{getOwnPropertyDescriptor:function(t,e){return r.f(o(t),e)}})},function(t,e,n){var r=n(0),i=n(19),o=n(1);r(r.S,"Reflect",{getPrototypeOf:function(t){return i(o(t))}})},function(t,e,n){var r=n(0);r(r.S,"Reflect",{has:function(t,e){return e in t}})},function(t,e,n){var r=n(0),i=n(1),o=Object.isExtensible;r(r.S,"Reflect",{isExtensible:function(t){return i(t),!o||o(t)}})},function(t,e,n){var r=n(0);r(r.S,"Reflect",{ownKeys:n(196)})},function(t,e,n){var r=n(0),i=n(1),o=Object.preventExtensions;r(r.S,"Reflect",{preventExtensions:function(t){i(t);try{return o&&o(t),!0}catch(t){return!1}}})},function(t,e,n){var r=n(8),i=n(18),o=n(19),a=n(16),s=n(0),u=n(40),c=n(1),l=n(4);s(s.S,"Reflect",{set:function t(e,n,s){var f,h,p=arguments.length<4?e:arguments[3],d=i.f(c(e),n);if(!d){if(l(h=o(e)))return t(h,n,s,p);d=u(0)}if(a(d,"value")){if(!1===d.writable||!l(p))return!1;if(f=i.f(p,n)){if(f.get||f.set||!1===f.writable)return!1;f.value=s,r.f(p,n,f)}else r.f(p,n,u(0,s));return!0}return void 0!==d.set&&(d.set.call(p,s),!0)}})},function(t,e,n){var r=n(0),i=n(112);i&&r(r.S,"Reflect",{setPrototypeOf:function(t,e){i.check(t,e);try{return i.set(t,e),!0}catch(t){return!1}}})},function(t,e,n){"use strict";var r=n(0),i=n(77)(!0);r(r.P,"Array",{includes:function(t){return i(this,t,1<arguments.length?arguments[1]:void 0)}}),n(37)("includes")},function(t,e,n){"use strict";var r=n(0),i=n(197),o=n(9),a=n(6),s=n(11),u=n(125);r(r.P,"Array",{flatMap:function(t){var e,n,r=o(this);return s(t),e=a(r.length),n=u(r,0),i(n,r,r,e,0,1,t,arguments[1]),n}}),n(37)("flatMap")},function(t,e,n){"use strict";var r=n(0),i=n(197),o=n(9),a=n(6),s=n(23),u=n(125);r(r.P,"Array",{flatten:function(){var t=arguments[0],e=o(this),n=a(e.length),r=u(e,0);return i(r,e,e,n,0,void 0===t?1:s(t)),r}}),n(37)("flatten")},function(t,e,n){"use strict";var r=n(0),i=n(80)(!0);r(r.P,"String",{at:function(t){return i(this,t)}})},function(t,e,n){"use strict";var r=n(0),i=n(198),o=n(85);r(r.P+r.F*/Version\/10\.\d+(\.\d+)? Safari\//.test(o),"String",{padStart:function(t){return i(this,t,1<arguments.length?arguments[1]:void 0,!0)}})},function(t,e,n){"use strict";var r=n(0),i=n(198),o=n(85);r(r.P+r.F*/Version\/10\.\d+(\.\d+)? Safari\//.test(o),"String",{padEnd:function(t){return i(this,t,1<arguments.length?arguments[1]:void 0,!1)}})},function(t,e,n){"use strict";n(57)("trimLeft",function(t){return function(){return t(this,1)}},"trimStart")},function(t,e,n){"use strict";n(57)("trimRight",function(t){return function(){return t(this,2)}},"trimEnd")},function(t,e,n){"use strict";var r=n(0),i=n(28),o=n(6),a=n(81),s=n(65),u=RegExp.prototype,c=function(t,e){this._r=t,this._s=e};n(119)(c,"RegExp String",function(){var t=this._r.exec(this._s);return{value:t,done:null===t}}),r(r.P,"String",{matchAll:function(t){if(i(this),!a(t))throw TypeError(t+" is not a regexp!");var e=String(this),n="flags"in u?String(t.flags):s.call(t),r=new RegExp(t.source,~n.indexOf("g")?n:"g"+n);return r.lastIndex=o(t.lastIndex),new c(r,e)}})},function(t,e,n){n(108)("asyncIterator")},function(t,e,n){n(108)("observable")},function(t,e,n){var r=n(0),i=n(196),o=n(17),a=n(18),s=n(123);r(r.S,"Object",{getOwnPropertyDescriptors:function(t){for(var e,n,r=o(t),u=a.f,c=i(r),l={},f=0;c.length>f;)void 0!==(n=u(r,e=c[f++]))&&s(l,e,n);return l}})},function(t,e,n){var r=n(0),i=n(199)(!1);r(r.S,"Object",{values:function(t){return i(t)}})},function(t,e,n){var r=n(0),i=n(199)(!0);r(r.S,"Object",{entries:function(t){return i(t)}})},function(t,e,n){"use strict";var r=n(0),i=n(9),o=n(11),a=n(8);n(7)&&r(r.P+n(88),"Object",{__defineGetter__:function(t,e){a.f(i(this),t,{get:o(e),enumerable:!0,configurable:!0})}})},function(t,e,n){"use strict";var r=n(0),i=n(9),o=n(11),a=n(8);n(7)&&r(r.P+n(88),"Object",{__defineSetter__:function(t,e){a.f(i(this),t,{set:o(e),enumerable:!0,configurable:!0})}})},function(t,e,n){"use strict";var r=n(0),i=n(9),o=n(27),a=n(19),s=n(18).f;n(7)&&r(r.P+n(88),"Object",{__lookupGetter__:function(t){var e,n=i(this),r=o(t,!0);do{if(e=s(n,r))return e.get}while(n=a(n))}})},function(t,e,n){"use strict";var r=n(0),i=n(9),o=n(27),a=n(19),s=n(18).f;n(7)&&r(r.P+n(88),"Object",{__lookupSetter__:function(t){var e,n=i(this),r=o(t,!0);do{if(e=s(n,r))return e.set}while(n=a(n))}})},function(t,e,n){var r=n(0);r(r.P+r.R,"Map",{toJSON:n(200)("Map")})},function(t,e,n){var r=n(0);r(r.P+r.R,"Set",{toJSON:n(200)("Set")})},function(t,e,n){n(89)("Map")},function(t,e,n){n(89)("Set")},function(t,e,n){n(89)("WeakMap")},function(t,e,n){n(89)("WeakSet")},function(t,e,n){n(90)("Map")},function(t,e,n){n(90)("Set")},function(t,e,n){n(90)("WeakMap")},function(t,e,n){n(90)("WeakSet")},function(t,e,n){var r=n(0);r(r.G,{global:n(2)})},function(t,e,n){var r=n(0);r(r.S,"System",{global:n(2)})},function(t,e,n){var r=n(0),i=n(22);r(r.S,"Error",{isError:function(t){return"Error"===i(t)}})},function(t,e,n){var r=n(0);r(r.S,"Math",{clamp:function(t,e,n){return Math.min(n,Math.max(e,t))}})},function(t,e,n){var r=n(0);r(r.S,"Math",{DEG_PER_RAD:Math.PI/180})},function(t,e,n){var r=n(0),i=180/Math.PI;r(r.S,"Math",{degrees:function(t){return t*i}})},function(t,e,n){var r=n(0),i=n(202),o=n(181);r(r.S,"Math",{fscale:function(t,e,n,r,a){return o(i(t,e,n,r,a))}})},function(t,e,n){var r=n(0);r(r.S,"Math",{iaddh:function(t,e,n,r){var i=t>>>0,o=n>>>0;return(e>>>0)+(r>>>0)+((i&o|(i|o)&~(i+o>>>0))>>>31)|0}})},function(t,e,n){var r=n(0);r(r.S,"Math",{isubh:function(t,e,n,r){var i=t>>>0,o=n>>>0;return(e>>>0)-(r>>>0)-((~i&o|~(i^o)&i-o>>>0)>>>31)|0}})},function(t,e,n){var r=n(0);r(r.S,"Math",{imulh:function(t,e){var n=+t,r=+e,i=65535&n,o=65535&r,a=n>>16,s=r>>16,u=(a*o>>>0)+(i*o>>>16);return a*s+(u>>16)+((i*s>>>0)+(65535&u)>>16)}})},function(t,e,n){var r=n(0);r(r.S,"Math",{RAD_PER_DEG:180/Math.PI})},function(t,e,n){var r=n(0),i=Math.PI/180;r(r.S,"Math",{radians:function(t){return t*i}})},function(t,e,n){var r=n(0);r(r.S,"Math",{scale:n(202)})},function(t,e,n){var r=n(0);r(r.S,"Math",{umulh:function(t,e){var n=+t,r=+e,i=65535&n,o=65535&r,a=n>>>16,s=r>>>16,u=(a*o>>>0)+(i*o>>>16);return a*s+(u>>>16)+((i*s>>>0)+(65535&u)>>>16)}})},function(t,e,n){var r=n(0);r(r.S,"Math",{signbit:function(t){return(t=+t)!=t?t:0==t?1/t==1/0:0<t}})},function(t,e,n){"use strict";var r=n(0),i=n(20),o=n(2),a=n(66),s=n(189);r(r.P+r.R,"Promise",{finally:function(t){var e=a(this,i.Promise||o.Promise),n="function"==typeof t;return this.then(n?function(n){return s(e,t()).then(function(){return n})}:t,n?function(n){return s(e,t()).then(function(){throw n})}:t)}})},function(t,e,n){"use strict";var r=n(0),i=n(132),o=n(188);r(r.S,"Promise",{try:function(t){var e=i.f(this),n=o(t);return(n.e?e.reject:e.resolve)(n.v),e.promise}})},function(t,e,n){var r=n(33),i=n(1),o=r.key,a=r.set;r.exp({defineMetadata:function(t,e,n,r){a(t,e,i(n),o(r))}})},function(t,e,n){var r=n(33),i=n(1),o=r.key,a=r.map,s=r.store;r.exp({deleteMetadata:function(t,e){var n=arguments.length<3?void 0:o(arguments[2]),r=a(i(e),n,!1);if(void 0===r||!r.delete(t))return!1;if(r.size)return!0;var u=s.get(e);return u.delete(n),!!u.size||s.delete(e)}})},function(t,e,n){var r=n(33),i=n(1),o=n(19),a=r.has,s=r.get,u=r.key;r.exp({getMetadata:function(t,e){return function t(e,n,r){if(a(e,n,r))return s(e,n,r);var i=o(n);return null!==i?t(e,i,r):void 0}(t,i(e),arguments.length<3?void 0:u(arguments[2]))}})},function(t,e,n){var r=n(192),i=n(201),o=n(33),a=n(1),s=n(19),u=o.keys,c=o.key;o.exp({getMetadataKeys:function(t){return function t(e,n){var o=u(e,n),a=s(e);if(null===a)return o;var c=t(a,n);return c.length?o.length?i(new r(o.concat(c))):c:o}(a(t),arguments.length<2?void 0:c(arguments[1]))}})},function(t,e,n){var r=n(33),i=n(1),o=r.get,a=r.key;r.exp({getOwnMetadata:function(t,e){return o(t,i(e),arguments.length<3?void 0:a(arguments[2]))}})},function(t,e,n){var r=n(33),i=n(1),o=r.keys,a=r.key;r.exp({getOwnMetadataKeys:function(t){return o(i(t),arguments.length<2?void 0:a(arguments[1]))}})},function(t,e,n){var r=n(33),i=n(1),o=n(19),a=r.has,s=r.key;r.exp({hasMetadata:function(t,e){return function t(e,n,r){if(a(e,n,r))return!0;var i=o(n);return null!==i&&t(e,i,r)}(t,i(e),arguments.length<3?void 0:s(arguments[2]))}})},function(t,e,n){var r=n(33),i=n(1),o=r.has,a=r.key;r.exp({hasOwnMetadata:function(t,e){return o(t,i(e),arguments.length<3?void 0:a(arguments[2]))}})},function(t,e,n){var r=n(33),i=n(1),o=n(11),a=r.key,s=r.set;r.exp({metadata:function(t,e){return function(n,r){s(t,e,(void 0!==r?i:o)(n),a(r))}}})},function(t,e,n){var r=n(0),i=n(131)(),o=n(2).process,a="process"==n(22)(o);r(r.G,{asap:function(t){var e=a&&o.domain;i(e?e.bind(t):t)}})},function(t,e,n){"use strict";var r=n(0),i=n(2),o=n(20),a=n(131)(),s=n(5)("observable"),u=n(11),c=n(1),l=n(47),f=n(49),h=n(12),p=n(48),d=p.RETURN,y=function(t){return null==t?void 0:u(t)},v=function(t){var e=t._c;e&&(t._c=void 0,e())},g=function(t){return void 0===t._o},m=function(t){g(t)||(t._o=void 0,v(t))},b=function(t,e){c(t),this._c=void 0,this._o=t,t=new x(this);try{var n=e(t),r=n;null!=n&&("function"==typeof n.unsubscribe?n=function(){r.unsubscribe()}:u(n),this._c=n)}catch(e){return void t.error(e)}g(this)&&v(this)};b.prototype=f({},{unsubscribe:function(){m(this)}});var x=function(t){this._s=t};x.prototype=f({},{next:function(t){var e=this._s;if(!g(e)){var n=e._o;try{var r=y(n.next);if(r)return r.call(n,t)}catch(t){try{m(e)}finally{throw t}}}},error:function(t){var e=this._s;if(g(e))throw t;var n=e._o;e._o=void 0;try{var r=y(n.error);if(!r)throw t;t=r.call(n,t)}catch(t){try{v(e)}finally{throw t}}return v(e),t},complete:function(t){var e=this._s;if(!g(e)){var n=e._o;e._o=void 0;try{var r=y(n.complete);t=r?r.call(n,t):void 0}catch(t){try{v(e)}finally{throw t}}return v(e),t}}});var _=function(t){l(this,_,"Observable","_f")._f=u(t)};f(_.prototype,{subscribe:function(t){return new b(t,this._f)},forEach:function(t){var e=this;return new(o.Promise||i.Promise)(function(n,r){u(t);var i=e.subscribe({next:function(e){try{return t(e)}catch(e){r(e),i.unsubscribe()}},error:r,complete:n})})}}),f(_,{from:function(t){var e="function"==typeof this?this:_,n=y(c(t)[s]);if(n){var r=c(n.call(t));return r.constructor===e?r:new e(function(t){return r.subscribe(t)})}return new e(function(e){var n=!1;return a(function(){if(!n){try{if(p(t,!1,function(t){if(e.next(t),n)return d})===d)return}catch(t){if(n)throw t;return void e.error(t)}e.complete()}}),function(){n=!0}})},of:function(){for(var t=0,e=arguments.length,n=new Array(e);t<e;)n[t]=arguments[t++];return new("function"==typeof this?this:_)(function(t){var e=!1;return a(function(){if(!e){for(var r=0;r<n.length;++r)if(t.next(n[r]),e)return;t.complete()}}),function(){e=!0}})}}),h(_.prototype,s,function(){return this}),r(r.G,{Observable:_}),n(46)("Observable")},function(t,e,n){var r=n(2),i=n(0),o=n(85),a=[].slice,s=/MSIE .\./.test(o),u=function(t){return function(e,n){var r=2<arguments.length,i=!!r&&a.call(arguments,2);return t(r?function(){("function"==typeof e?e:Function(e)).apply(this,i)}:e,n)}};i(i.G+i.B+i.F*s,{setTimeout:u(r.setTimeout),setInterval:u(r.setInterval)})},function(t,e,n){var r=n(0),i=n(130);r(r.G+r.B,{setImmediate:i.set,clearImmediate:i.clear})},function(t,e,n){for(var r=n(127),i=n(42),o=n(13),a=n(2),s=n(12),u=n(58),c=n(5),l=c("iterator"),f=c("toStringTag"),h=u.Array,p={CSSRuleList:!0,CSSStyleDeclaration:!1,CSSValueList:!1,ClientRectList:!1,DOMRectList:!1,DOMStringList:!1,DOMTokenList:!0,DataTransferItemList:!1,FileList:!1,HTMLAllCollection:!1,HTMLCollection:!1,HTMLFormElement:!1,HTMLSelectElement:!1,MediaList:!0,MimeTypeArray:!1,NamedNodeMap:!1,NodeList:!0,PaintRequestList:!1,Plugin:!1,PluginArray:!1,SVGLengthList:!1,SVGNumberList:!1,SVGPathSegList:!1,SVGPointList:!1,SVGStringList:!1,SVGTransformList:!1,SourceBufferList:!1,StyleSheetList:!0,TextTrackCueList:!1,TextTrackList:!1,TouchList:!1},d=i(p),y=0;y<d.length;y++){var v,g=d[y],m=p[g],b=a[g],x=b&&b.prototype;if(x&&(x[l]||s(x,l,h),x[f]||s(x,f,g),u[g]=h,m))for(v in r)x[v]||o(x,v,r[v],!0)}},function(t,e,n){(function(t,e){function n(t){return(n="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t})(t)}!function(t){"use strict";var r,i=Object.prototype,o=i.hasOwnProperty,a="function"==typeof Symbol?Symbol:{},s=a.iterator||"@@iterator",u=a.asyncIterator||"@@asyncIterator",c=a.toStringTag||"@@toStringTag",l="object"===n(e),f=t.regeneratorRuntime;if(f)l&&(e.exports=f);else{(f=t.regeneratorRuntime=l?e.exports:{}).wrap=_;var h="suspendedStart",p="suspendedYield",d="executing",y="completed",v={},g={};g[s]=function(){return this};var m=Object.getPrototypeOf,b=m&&m(m(C([])));b&&b!==i&&o.call(b,s)&&(g=b);var x=T.prototype=S.prototype=Object.create(g);E.prototype=x.constructor=T,T.constructor=E,T[c]=E.displayName="GeneratorFunction",f.isGeneratorFunction=function(t){var e="function"==typeof t&&t.constructor;return!!e&&(e===E||"GeneratorFunction"===(e.displayName||e.name))},f.mark=function(t){return Object.setPrototypeOf?Object.setPrototypeOf(t,T):(t.__proto__=T,c in t||(t[c]="GeneratorFunction")),t.prototype=Object.create(x),t},f.awrap=function(t){return{__await:t}},k(O.prototype),O.prototype[u]=function(){return this},f.AsyncIterator=O,f.async=function(t,e,n,r){var i=new O(_(t,e,n,r));return f.isGeneratorFunction(e)?i:i.next().then(function(t){return t.done?t.value:i.next()})},k(x),x[c]="Generator",x[s]=function(){return this},x.toString=function(){return"[object Generator]"},f.keys=function(t){var e=[];for(var n in t)e.push(n);return e.reverse(),function n(){for(;e.length;){var r=e.pop();if(r in t)return n.value=r,n.done=!1,n}return n.done=!0,n}},f.values=C,R.prototype={constructor:R,reset:function(t){if(this.prev=0,this.next=0,this.sent=this._sent=r,this.done=!1,this.delegate=null,this.method="next",this.arg=r,this.tryEntries.forEach(P),!t)for(var e in this)"t"===e.charAt(0)&&o.call(this,e)&&!isNaN(+e.slice(1))&&(this[e]=r)},stop:function(){this.done=!0;var t=this.tryEntries[0].completion;if("throw"===t.type)throw t.arg;return this.rval},dispatchException:function(t){if(this.done)throw t;var e=this;function n(n,i){return s.type="throw",s.arg=t,e.next=n,i&&(e.method="next",e.arg=r),!!i}for(var i=this.tryEntries.length-1;0<=i;--i){var a=this.tryEntries[i],s=a.completion;if("root"===a.tryLoc)return n("end");if(a.tryLoc<=this.prev){var u=o.call(a,"catchLoc"),c=o.call(a,"finallyLoc");if(u&&c){if(this.prev<a.catchLoc)return n(a.catchLoc,!0);if(this.prev<a.finallyLoc)return n(a.finallyLoc)}else if(u){if(this.prev<a.catchLoc)return n(a.catchLoc,!0)}else{if(!c)throw new Error("try statement without catch or finally");if(this.prev<a.finallyLoc)return n(a.finallyLoc)}}}},abrupt:function(t,e){for(var n=this.tryEntries.length-1;0<=n;--n){var r=this.tryEntries[n];if(r.tryLoc<=this.prev&&o.call(r,"finallyLoc")&&this.prev<r.finallyLoc){var i=r;break}}i&&("break"===t||"continue"===t)&&i.tryLoc<=e&&e<=i.finallyLoc&&(i=null);var a=i?i.completion:{};return a.type=t,a.arg=e,i?(this.method="next",this.next=i.finallyLoc,v):this.complete(a)},complete:function(t,e){if("throw"===t.type)throw t.arg;return"break"===t.type||"continue"===t.type?this.next=t.arg:"return"===t.type?(this.rval=this.arg=t.arg,this.method="return",this.next="end"):"normal"===t.type&&e&&(this.next=e),v},finish:function(t){for(var e=this.tryEntries.length-1;0<=e;--e){var n=this.tryEntries[e];if(n.finallyLoc===t)return this.complete(n.completion,n.afterLoc),P(n),v}},catch:function(t){for(var e=this.tryEntries.length-1;0<=e;--e){var n=this.tryEntries[e];if(n.tryLoc===t){var r=n.completion;if("throw"===r.type){var i=r.arg;P(n)}return i}}throw new Error("illegal catch attempt")},delegateYield:function(t,e,n){return this.delegate={iterator:C(t),resultName:e,nextLoc:n},"next"===this.method&&(this.arg=r),v}}}function _(t,e,n,r){var i,o,a,s,u=e&&e.prototype instanceof S?e:S,c=Object.create(u.prototype),l=new R(r||[]);return c._invoke=(i=t,o=n,a=l,s=h,function(t,e){if(s===d)throw new Error("Generator is already running");if(s===y){if("throw"===t)throw e;return I()}for(a.method=t,a.arg=e;;){var n=a.delegate;if(n){var r=A(n,a);if(r){if(r===v)continue;return r}}if("next"===a.method)a.sent=a._sent=a.arg;else if("throw"===a.method){if(s===h)throw s=y,a.arg;a.dispatchException(a.arg)}else"return"===a.method&&a.abrupt("return",a.arg);s=d;var u=w(i,o,a);if("normal"===u.type){if(s=a.done?y:p,u.arg===v)continue;return{value:u.arg,done:a.done}}"throw"===u.type&&(s=y,a.method="throw",a.arg=u.arg)}}),c}function w(t,e,n){try{return{type:"normal",arg:t.call(e,n)}}catch(t){return{type:"throw",arg:t}}}function S(){}function E(){}function T(){}function k(t){["next","throw","return"].forEach(function(e){t[e]=function(t){return this._invoke(e,t)}})}function O(e){function r(t,i,a,s){var u=w(e[t],e,i);if("throw"!==u.type){var c=u.arg,l=c.value;return l&&"object"===n(l)&&o.call(l,"__await")?Promise.resolve(l.__await).then(function(t){r("next",t,a,s)},function(t){r("throw",t,a,s)}):Promise.resolve(l).then(function(t){c.value=t,a(c)},s)}s(u.arg)}var i;"object"===n(t.process)&&t.process.domain&&(r=t.process.domain.bind(r)),this._invoke=function(t,e){function n(){return new Promise(function(n,i){r(t,e,n,i)})}return i=i?i.then(n,n):n()}}function A(t,e){var n=t.iterator[e.method];if(n===r){if(e.delegate=null,"throw"===e.method){if(t.iterator.return&&(e.method="return",e.arg=r,A(t,e),"throw"===e.method))return v;e.method="throw",e.arg=new TypeError("The iterator does not provide a 'throw' method")}return v}var i=w(n,t.iterator,e.arg);if("throw"===i.type)return e.method="throw",e.arg=i.arg,e.delegate=null,v;var o=i.arg;return o?o.done?(e[t.resultName]=o.value,e.next=t.nextLoc,"return"!==e.method&&(e.method="next",e.arg=r),e.delegate=null,v):o:(e.method="throw",e.arg=new TypeError("iterator result is not an object"),e.delegate=null,v)}function j(t){var e={tryLoc:t[0]};1 in t&&(e.catchLoc=t[1]),2 in t&&(e.finallyLoc=t[2],e.afterLoc=t[3]),this.tryEntries.push(e)}function P(t){var e=t.completion||{};e.type="normal",delete e.arg,t.completion=e}function R(t){this.tryEntries=[{tryLoc:"root"}],t.forEach(j,this),this.reset(!0)}function C(t){if(t){var e=t[s];if(e)return e.call(t);if("function"==typeof t.next)return t;if(!isNaN(t.length)){var n=-1,i=function e(){for(;++n<t.length;)if(o.call(t,n))return e.value=t[n],e.done=!1,e;return e.value=r,e.done=!0,e};return i.next=i}}return{next:I}}function I(){return{value:r,done:!0}}}("object"===(void 0===t?"undefined":n(t))?t:"object"===("undefined"==typeof window?"undefined":n(window))?window:"object"===("undefined"==typeof self?"undefined":n(self))?self:this)}).call(this,n(15),n(60)(t))},function(t,e,n){n(474),t.exports=n(20).RegExp.escape},function(t,e,n){var r=n(0),i=n(475)(/[\\^$*+?.()|[\]{}]/g,"\\$&");r(r.S,"RegExp",{escape:function(t){return i(t)}})},function(t,e){t.exports=function(t,e){var n=e===Object(e)?function(t){return e[t]}:e;return function(e){return String(e).replace(t,n)}}},function(t,e,n){var r=n(203),i=n(484),o=n(485);t.exports=o(function(t){return("undefined"!=typeof window&&window.localStorage?i:r)(t)}),t.exports.init=o},function(t,e,n){function r(t){return function(t){if(Array.isArray(t)){for(var e=0,n=new Array(t.length);e<t.length;e++)n[e]=t[e];return n}}(t)||function(t){if(Symbol.iterator in Object(t)||"[object Arguments]"===Object.prototype.toString.call(t))return Array.from(t)}(t)||function(){throw new TypeError("Invalid attempt to spread non-iterable instance")}()}t.exports=function(t){function e(t){for(var e=0,n=0;n<t.length;n++)e=(e<<5)-e+t.charCodeAt(n),e|=0;return i.colors[Math.abs(e)%i.colors.length]}function i(t){var n;function r(){for(var t=arguments.length,e=new Array(t),o=0;o<t;o++)e[o]=arguments[o];if(r.enabled){var a=r,s=Number(new Date),u=s-(n||s);a.diff=u,a.prev=n,a.curr=s,n=s,e[0]=i.coerce(e[0]),"string"!=typeof e[0]&&e.unshift("%O");var c=0;e[0]=e[0].replace(/%([a-zA-Z%])/g,function(t,n){if("%%"===t)return t;c++;var r=i.formatters[n];if("function"==typeof r){var o=e[c];t=r.call(a,o),e.splice(c,1),c--}return t}),i.formatArgs.call(a,e),(a.log||i.log).apply(a,e)}}return r.namespace=t,r.enabled=i.enabled(t),r.useColors=i.useColors(),r.color=e(t),r.destroy=o,r.extend=a,"function"==typeof i.init&&i.init(r),i.instances.push(r),r}function o(){var t=i.instances.indexOf(this);return-1!==t&&(i.instances.splice(t,1),!0)}function a(t,e){var n=i(this.namespace+(void 0===e?":":e)+t);return n.log=this.log,n}function s(t){return t.toString().substring(2,t.toString().length-2).replace(/\.\*\?$/,"*")}return((i.debug=i).default=i).coerce=function(t){return t instanceof Error?t.stack||t.message:t},i.disable=function(){var t=[].concat(r(i.names.map(s)),r(i.skips.map(s).map(function(t){return"-"+t}))).join(",");return i.enable(""),t},i.enable=function(t){var e;i.save(t),i.names=[],i.skips=[];var n=("string"==typeof t?t:"").split(/[\s,]+/),r=n.length;for(e=0;e<r;e++)n[e]&&("-"===(t=n[e].replace(/\*/g,".*?"))[0]?i.skips.push(new RegExp("^"+t.substr(1)+"$")):i.names.push(new RegExp("^"+t+"$")));for(e=0;e<i.instances.length;e++){var o=i.instances[e];o.enabled=i.enabled(o.namespace)}},i.enabled=function(t){if("*"===t[t.length-1])return!0;var e,n;for(e=0,n=i.skips.length;e<n;e++)if(i.skips[e].test(t))return!1;for(e=0,n=i.names.length;e<n;e++)if(i.names[e].test(t))return!0;return!1},i.humanize=n(478),Object.keys(t).forEach(function(e){i[e]=t[e]}),i.instances=[],i.names=[],i.skips=[],i.formatters={},i.selectColor=e,i.enable(i.load()),i}},function(t,e){function n(t){return(n="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t})(t)}var r=864e5;function i(t,e,n,r){var i=1.5*n<=e;return Math.round(t/n)+" "+r+(i?"s":"")}t.exports=function(t,e){e=e||{};var o=n(t);if("string"===o&&0<t.length)return function(t){if(!(100<(t=String(t)).length)){var e=/^((?:\d+)?\-?\d?\.?\d+) *(milliseconds?|msecs?|ms|seconds?|secs?|s|minutes?|mins?|m|hours?|hrs?|h|days?|d|weeks?|w|years?|yrs?|y)?$/i.exec(t);if(e){var n=parseFloat(e[1]);switch((e[2]||"ms").toLowerCase()){case"years":case"year":case"yrs":case"yr":case"y":return 315576e5*n;case"weeks":case"week":case"w":return 6048e5*n;case"days":case"day":case"d":return n*r;case"hours":case"hour":case"hrs":case"hr":case"h":return 36e5*n;case"minutes":case"minute":case"mins":case"min":case"m":return 6e4*n;case"seconds":case"second":case"secs":case"sec":case"s":return 1e3*n;case"milliseconds":case"millisecond":case"msecs":case"msec":case"ms":return n;default:return}}}}(t);if("number"===o&&!1===isNaN(t))return e.long?function(t){var e=Math.abs(t);return r<=e?i(t,e,r,"day"):36e5<=e?i(t,e,36e5,"hour"):6e4<=e?i(t,e,6e4,"minute"):1e3<=e?i(t,e,1e3,"second"):t+" ms"}(t):function(t){var e=Math.abs(t);return r<=e?Math.round(t/r)+"d":36e5<=e?Math.round(t/36e5)+"h":6e4<=e?Math.round(t/6e4)+"m":1e3<=e?Math.round(t/1e3)+"s":t+"ms"}(t);throw new Error("val is not a non-empty string or a valid number. val="+JSON.stringify(t))}},function(t,e,n){function r(t){return(r="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t})(t)}var i=n(204),o=i._,a=o.each,s=o.pick,u=i.createSymbol,c=u("__feathersSkipHooks");e.SKIP=c,e.ACTIVATE_HOOKS=u("__feathersActivateHooks"),e.createHookObject=function(t){var e=1<arguments.length&&void 0!==arguments[1]?arguments[1]:{},n={};return Object.defineProperty(n,"toJSON",{value:function(){return s(this,"type","method","path","params","id","data","result","error")}}),Object.assign(n,e,{method:t,get path(){var t=e.app,n=e.service;return n&&t&&t.services?Object.keys(t.services).find(function(e){return t.services[e]===n}):null}})},e.defaultMakeArguments=function(t){var e=[];return void 0!==t.id&&e.push(t.id),t.data&&e.push(t.data),e.push(t.params||{}),e},e.makeArguments=function(t){switch(t.method){case"find":return[t.params];case"get":case"remove":return[t.id,t.params];case"update":case"patch":return[t.id,t.data,t.params];case"create":return[t.data,t.params]}return e.defaultMakeArguments(t)},e.convertHookData=function(t){var e={};return Array.isArray(t)?e={all:t}:"object"!==r(t)?e={all:[t]}:a(t,function(t,n){e[n]=Array.isArray(t)?t:[t]}),e},e.isHookObject=function(t){return"object"===r(t)&&"string"==typeof t.method&&"string"==typeof t.type},e.getHooks=function(t,e,n,r){var i=4<arguments.length&&void 0!==arguments[4]&&arguments[4],o=t.__hooks[n][r]||[],a=e.__hooks[n][r]||[];return i?a.concat(o):o.concat(a)},e.processHooks=function(t,n){var r=this,i=n,o=function(t){if(t){if(t===c)return c;if(!e.isHookObject(t))throw new Error("".concat(i.type," hook for '").concat(i.method,"' method returned invalid hook object"));i=t}return i};return t.reduce(function(t,e){var n=e.bind(r);return(t=2===n.length?t.then(function(t){return t===c?c:new Promise(function(e,r){n(t,function(t,n){return t?r(t):e(n)})})}):t.then(function(t){return t===c?c:n(t)})).then(o)},Promise.resolve(i)).then(function(){return i}).catch(function(t){throw t.hook=i,t})},e.enableHooks=function(t,n,r){if("function"==typeof t.hooks)return t;var i={};return r.forEach(function(t){i[t]={}}),Object.defineProperty(t,"__hooks",{value:i}),Object.assign(t,{hooks:function(t){var r=this;return a(t,function(t,i){if(!r.__hooks[i])throw new Error("'".concat(i,"' is not a valid hook type"));var o=e.convertHookData(t);a(o,function(t,e){if("all"!==e&&-1===n.indexOf(e))throw new Error("'".concat(e,"' is not a valid hook method"))}),n.forEach(function(t){var e=r.__hooks[i][t]||(r.__hooks[i][t]=[]);o.all&&e.push.apply(e,o.all),o[t]&&e.push.apply(e,o[t])})}),this}})}},function(t,e,n){var r=n(51)._,i=n(481),o=n(205),a=n(482);t.exports=Object.assign({select:function(t){for(var e=t&&t.query&&t.query.$select,n=arguments.length,i=new Array(1<n?n-1:0),o=1;o<n;o++)i[o-1]=arguments[o];Array.isArray(e)&&i.length&&e.push.apply(e,i);var a=function(t){return Array.isArray(e)?r.pick.apply(r,[t].concat(function(t){return function(t){if(Array.isArray(t)){for(var e=0,n=new Array(t.length);e<t.length;e++)n[e]=t[e];return n}}(t)||function(t){if(Symbol.iterator in Object(t)||"[object Arguments]"===Object.prototype.toString.call(t))return Array.from(t)}(t)||function(){throw new TypeError("Invalid attempt to spread non-iterable instance")}()}(e))):t};return function(t){return Array.isArray(t)?t.map(a):a(t)}},filterQuery:o,AdapterService:i},a)},function(t,e,n){function r(t,e){for(var n=0;n<e.length;n++){var r=e[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(t,r.key,r)}}var i=n(134),o=i.NotImplemented,a=i.BadRequest,s=i.MethodNotAllowed,u=n(205),c=function(t,e){if("function"!=typeof t[e])return Promise.reject(new o("Method ".concat(e," not available")));for(var n=arguments.length,r=new Array(2<n?n-2:0),i=2;i<n;i++)r[i-2]=arguments[i];return t[e].apply(t,r)},l=function(t,e){return!0===e||!!Array.isArray(e)&&e.includes(t)};t.exports=function(){function t(e){!function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,t),this.options=Object.assign({events:[],paginate:{},multi:!1},e)}var e,n;return e=t,(n=[{key:"filterQuery",value:function(){var t=0<arguments.length&&void 0!==arguments[0]?arguments[0]:{},e=1<arguments.length&&void 0!==arguments[1]?arguments[1]:{},n=void 0!==t.paginate?t.paginate:this.options.paginate,r=t.query,i=void 0===r?{}:r,o=Object.assign({operators:this.options.whitelist||[],filters:this.options.filters,paginate:n},e),a=u(i,o);return Object.assign(a,{paginate:n})}},{key:"find",value:function(t){return c(this,"_find",t)}},{key:"get",value:function(t,e){return c(this,"_get",t,e)}},{key:"create",value:function(t,e){return Array.isArray(t)&&!l("create",this.options.multi)?Promise.reject(new s("Can not create multiple entries")):c(this,"_create",t,e)}},{key:"update",value:function(t,e,n){return null===t||Array.isArray(e)?Promise.reject(new a("You can not replace multiple instances. Did you mean 'patch'?")):c(this,"_update",t,e,n)}},{key:"patch",value:function(t,e,n){return null!==t||l("patch",this.options.multi)?c(this,"_patch",t,e,n):Promise.reject(new s("Can not patch multiple entries"))}},{key:"remove",value:function(t,e,n){return null!==t||l("remove",this.options.multi)?c(this,"_remove",t,e,n):Promise.reject(new s("Can not remove multiple entries"))}},{key:"id",get:function(){return this.options.id}},{key:"events",get:function(){return this.options.events}}])&&r(e.prototype,n),t}()},function(t,e){e.compareNSB=function(t,e){return t<e?-1:e<t?1:0},e.compareArrays=function(t,n){var r,i;for(r=0;r<Math.min(t.length,n.length);r+=1)if(0!==(i=e.compare(t[r],n[r])))return i;return e.compareNSB(t.length,n.length)},e.compare=function(t,n){var r=2<arguments.length&&void 0!==arguments[2]?arguments[2]:e.compareNSB,i=e,o=i.compareNSB,a=i.compare,s=i.compareArrays;if(void 0===t)return void 0===n?0:-1;if(void 0===n)return void 0===t?0:1;if(null===t)return null===n?0:-1;if(null===n)return null===t?0:1;if("number"==typeof t)return"number"==typeof n?o(t,n):-1;if("number"==typeof n)return"number"==typeof t?o(t,n):1;if("string"==typeof t)return"string"==typeof n?r(t,n):-1;if("string"==typeof n)return"string"==typeof t?r(t,n):1;if("boolean"==typeof t)return"boolean"==typeof n?o(t,n):-1;if("boolean"==typeof n)return"boolean"==typeof t?o(t,n):1;if(t instanceof Date)return n instanceof Date?o(t.getTime(),n.getTime()):-1;if(n instanceof Date)return t instanceof Date?o(t.getTime(),n.getTime()):1;if(Array.isArray(t))return Array.isArray(n)?s(t,n):-1;if(Array.isArray(n))return Array.isArray(t)?s(t,n):1;for(var u=Object.keys(t).sort(),c=Object.keys(n).sort(),l=0,f=0;f<Math.min(u.length,c.length);f+=1)if(0!==(l=a(t[u[f]],n[c[f]])))return l;return o(u.length,c.length)},e.sorter=function(t){var n=Object.keys(t).map(function(e){return{key:e,direction:t[e]}});return function(t,r){for(var i,o=0;o<n.length;o++){var a=n[o];if(0!=(i=a.direction*e.compare(t[a.key],r[a.key])))return i}return 0}}},function(t,e,n){"use strict";function r(t){return(r="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t})(t)}function i(t){return"function"==typeof t}function o(t){return"[object Array]"===Object.prototype.toString.call(t)}function a(t){return t instanceof Date?t.getTime():o(t)?t.map(a):t&&"function"==typeof t.toJSON?t.toJSON():t}function s(t,e){return i(t.get)?t.get(e):t[e]}function u(t){return function(e,n){if(!o(n)||!n.length)return t(e,n);for(var r=0,i=n.length;r<i;r++)if(t(e,s(n,r)))return!0;return!1}}function c(t,e,n,r){return t.v(t.a,e,n,r)}n.r(e),n.d(e,"default",function(){return m}),n.d(e,"indexOf",function(){return b}),n.d(e,"compare",function(){return x});var l,f={$eq:u(function(t,e){return t(e)}),$ne:(l=function(t,e){return!t(e)},function(t,e){if(!o(e)||!e.length)return l(t,e);for(var n=0,r=e.length;n<r;n++)if(!l(t,s(e,n)))return!1;return!0}),$gt:u(function(t,e){return 0<x(a(e),t)}),$gte:u(function(t,e){return 0<=x(a(e),t)}),$lt:u(function(t,e){return x(a(e),t)<0}),$lte:u(function(t,e){return x(a(e),t)<=0}),$mod:u(function(t,e){return e%t[0]==t[1]}),$in:function(t,e){if(!(e instanceof Array)){var n=a(e);if(n===e&&"object"===r(e))for(o=t.length;o--;)if(String(t[o])===String(e)&&"[object Object]"!==String(e))return!0;if(void 0===n)for(o=t.length;o--;)if(null==t[o])return!0;for(o=t.length;o--;){var i=c(g(s(t,o),void 0),e,o,t);if(i&&"[object Object]"!==String(i)&&"[object Object]"!==String(e))return!0}return!!~t.indexOf(n)}for(var o=e.length;o--;)if(~t.indexOf(a(s(e,o))))return!0;return!1},$nin:function(t,e,n,r){return!f.$in(t,e,n,r)},$not:function(t,e,n,r){return!c(t,e,n,r)},$type:function(t,e){return null!=e&&(e instanceof t||e.constructor==t)},$all:function(t,e,n,r){return f.$and(t,e,n,r)},$size:function(t,e){return!!e&&t===e.length},$or:function(t,e,n,r){for(var i=0,o=t.length;i<o;i++)if(c(s(t,i),e,n,r))return!0;return!1},$nor:function(t,e,n,r){return!f.$or(t,e,n,r)},$and:function(t,e,n,r){for(var i=0,o=t.length;i<o;i++)if(!c(s(t,i),e,n,r))return!1;return!0},$regex:u(function(t,e){return"string"==typeof e&&t.test(e)}),$where:function(t,e,n,r){return t.call(e,e,n,r)},$elemMatch:function(t,e,n,r){return o(e)?!!~p(e,t):c(t,e,n,r)},$exists:function(t,e,n,r){return r.hasOwnProperty(n)===t}},h={$eq:function(t){return t instanceof RegExp?function(e){return"string"==typeof e&&t.test(e)}:t instanceof Function?t:o(t)&&!t.length?function(t){return o(t)&&!t.length}:null===t?function(t){return null==t}:function(e){return 0===x(a(e),a(t))}},$ne:function(t){return h.$eq(t)},$and:function(t){return t.map(v)},$all:function(t){return h.$and(t)},$or:function(t){return t.map(v)},$nor:function(t){return t.map(v)},$not:function(t){return v(t)},$regex:function(t,e){return new RegExp(t,e.$options)},$where:function(t){return"string"==typeof t?new Function("obj","return "+t):t},$elemMatch:function(t){return v(t)},$exists:function(t){return!!t}};function p(t,e){for(var n=0;n<t.length;n++)if(s(t,n),c(e,s(t,n)))return n;return-1}function d(t,e){return{a:t,v:e}}function y(t,e){var n=[];if(function t(e,n,r,i,a){if(r!==n.length&&null!=e){var u=s(n,r);if(o(e)&&isNaN(Number(u)))for(var c=0,l=e.length;c<l;c++)t(s(e,c),n,r,e,a);else t(s(e,u),n,r+1,e,a)}else a.push([e,n[r-1],i])}(e,t.k,0,e,n),1===n.length){var r=n[0];return c(t.nv,r[0],r[1],r[2])}for(var i=t&&t.q&&void 0!==t.q.$ne,a=i,u=0;u<n.length;u++){var l=n[u],f=c(t.nv,l[0],l[1],l[2]);i?a&=f:a|=f}return a}function v(t){var e;(t=a(t))&&(e=t)&&e.constructor===Object||(t={$eq:t});var n=[];for(var r in t){var i=t[r];if("$options"!==r)if(f[r])h[r]&&(i=h[r](i,t)),n.push(d(a(i),f[r]));else{if(36===r.charCodeAt(0))throw new Error("Unknown operation "+r);n.push({a:{k:r.split("."),nv:v(i),q:i},v:y})}}return 1===n.length?n[0]:d(n,f.$and)}function g(t,e){var n=v(t);return e&&(n={a:n,v:function(t,n,r,i){return c(t,e(n),r,i)}}),n}function m(t,e,n){i(e)&&(n=e,e=void 0);var r=g(t,n);function o(t,e,n){return c(r,t,e,n)}return e?e.filter(o):o}function b(t,e,n){return p(e,g(t,n))}function x(t,e){if(t===e)return 0;if(r(t)===r(e)){if(e<t)return 1;if(t<e)return-1}}},function(t,e,n){function r(t){return(r="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t})(t)}function i(t,e){for(var n=0;n<e.length;n++){var r=e[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(t,r.key,r)}}function o(t,e){return!e||"object"!==r(e)&&"function"!=typeof e?function(t){if(void 0!==t)return t;throw new ReferenceError("this hasn't been initialised - super() hasn't been called")}(t):e}function a(t,e,n){return(a="undefined"!=typeof Reflect&&Reflect.get?Reflect.get:function(t,e,n){var r=function(t,e){for(;!Object.prototype.hasOwnProperty.call(t,e)&&null!==(t=s(t)););return t}(t,e);if(r){var i=Object.getOwnPropertyDescriptor(r,e);return i.get?i.get.call(n):i.value}})(t,e,n||t)}function s(t){return(s=Object.setPrototypeOf?Object.getPrototypeOf:function(t){return t.__proto__||Object.getPrototypeOf(t)})(t)}function u(t,e){return(u=Object.setPrototypeOf||function(t,e){return t.__proto__=e,t})(t,e)}var c=n(203).Service,l=[],f=function(t){function e(){var t,n=0<arguments.length&&void 0!==arguments[0]?arguments[0]:{};if(function(t,n){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this),(t=o(this,s(e).call(this,n)))._storageKey=n.name||"feathers",t._storage=n.storage||"undefined"!=typeof window&&window.localStorage,t._throttle=n.throttle||200,t.store=null,!t._storage)throw new Error("The `storage` option needs to be provided");if(-1!==l.indexOf(t._storageKey))throw new Error("The storage name '".concat(t._storageKey,"' is already in use by another instance."));return l.push(t._storageKey),t}var n,r;return function(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function");t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,writable:!0,configurable:!0}}),e&&u(t,e)}(e,c),n=e,(r=[{key:"ready",value:function(){var t=this;return this.store?Promise.resolve(this.store):Promise.resolve(this._storage.getItem(this._storageKey)).then(function(t){return JSON.parse(t||"{}")}).then(function(e){var n=Object.keys(e),r=e[n[n.length-1]];return t._uId=n.length&&void 0!==r[t.id]?r[t.id]+1:t._uId,t.store=e})}},{key:"flush",value:function(t){var e=this;return this._timeout||(this._timeout=setTimeout(function(){e._storage.setItem(e._storageKey,JSON.stringify(e.store)),delete e._timeout},this._throttle)),t}},{key:"execute",value:function(t){for(var n=this,r=arguments.length,i=new Array(1<r?r-1:0),o=1;o<r;o++)i[o-1]=arguments[o];return this.ready().then(function(){var r;return(r=a(s(e.prototype),t,n)).call.apply(r,[n].concat(i))})}},{key:"find",value:function(){for(var t=arguments.length,e=new Array(t),n=0;n<t;n++)e[n]=arguments[n];return this.execute.apply(this,["find"].concat(e))}},{key:"get",value:function(){for(var t=arguments.length,e=new Array(t),n=0;n<t;n++)e[n]=arguments[n];return this.execute.apply(this,["get"].concat(e))}},{key:"create",value:function(){for(var t=this,e=arguments.length,n=new Array(e),r=0;r<e;r++)n[r]=arguments[r];return this.execute.apply(this,["create"].concat(n)).then(function(e){return t.flush(e)})}},{key:"patch",value:function(){for(var t=this,e=arguments.length,n=new Array(e),r=0;r<e;r++)n[r]=arguments[r];return this.execute.apply(this,["patch"].concat(n)).then(function(e){return t.flush(e)})}},{key:"update",value:function(){for(var t=this,e=arguments.length,n=new Array(e),r=0;r<e;r++)n[r]=arguments[r];return this.execute.apply(this,["update"].concat(n)).then(function(e){return t.flush(e)})}},{key:"remove",value:function(){for(var t=this,e=arguments.length,n=new Array(e),r=0;r<e;r++)n[r]=arguments[r];return this.execute.apply(this,["remove"].concat(n)).then(function(e){return t.flush(e)})}}])&&i(n.prototype,r),e}();t.exports=function(t){return new f(t)},t.exports.Service=c},function(t,e,n){var r=n(486),i=n(490);t.exports=function(t){return function(){var e=0<arguments.length&&void 0!==arguments[0]?arguments[0]:function(){},n=r();return n.set("paginate",{default:10,max:50}),n.defaultService=function(e){var r=n.get("paginate");return t({paginate:r,name:"mysam-".concat(e),startId:1,id:"_id"})},n.configure(e),n.configure(i),n}}},function(t,e,n){var r=n(51).hooks,i=n(135),o=n(487),a=n(207),s=n(206),u=s.ACTIVATE_HOOKS,c=s.activateHooks,l=Object.create(null);function f(){var t=Object.create(l);return i.mixin(o,t),t.init(),t}f.version=a,f.SKIP=r.SKIP,f.ACTIVATE_HOOKS=u,f.activateHooks=c,t.exports=f,t.exports.default=f},function(t,e,n){var r=n(34)("feathers:application"),i=n(51).stripSlashes,o=n(135),a=n(488),s=n(206),u=n(207),c=o.extend({create:null}),l={init:function(){Object.assign(this,{version:u,methods:["find","get","create","update","patch","remove"],mixins:[],services:{},providers:[],_setup:!1,settings:{}}),this.configure(s()),this.configure(a())},get:function(t){return this.settings[t]},set:function(t,e){return this.settings[t]=e,this},disable:function(t){return this.settings[t]=!1,this},disabled:function(t){return!this.settings[t]},enable:function(t){return this.settings[t]=!0,this},enabled:function(t){return!!this.settings[t]},configure:function(t){return t.call(this,this),this},service:function(t,e){if(void 0!==e)throw new Error("Registering a new service with `app.service(path, service)` is no longer supported. Use `app.use(path, service)` instead.");var n=i(t)||"/",r=this.services[n];return void 0===r&&"function"==typeof this.defaultService?this.use("/".concat(n),this.defaultService(n)).service(n):r},use:function(t,e){var n=this,o=2<arguments.length&&void 0!==arguments[2]?arguments[2]:{};if("string"!=typeof t)throw new Error("'".concat(t,"' is not a valid service path."));var a=i(t)||"/",s="function"==typeof e.service&&e.services,u=this.methods.concat("setup").some(function(t){return e&&"function"==typeof e[t]});if(s){var l=e;return Object.keys(l.services).forEach(function(t){return n.use("".concat(a,"/").concat(t),l.service(t))}),this}if(!u)throw new Error("Invalid service object passed for path `".concat(a,"`"));var f=c.isPrototypeOf(e)?e:c.extend(e);return r("Registering new service at `".concat(a,"`")),this.mixins.forEach(function(t){return t.call(n,f,a,o)}),"function"==typeof f._setup&&f._setup(this,a),this.providers.forEach(function(t){return t.call(n,f,a,o)}),this._isSetup&&"function"==typeof f.setup&&(r("Setting up service for `".concat(a,"`")),f.setup(this,a)),this.services[a]=f,this},setup:function(){var t=this;return Object.keys(this.services).forEach(function(e){var n=t.services[e];r("Setting up service for `".concat(e,"`")),"function"==typeof n.setup&&n.setup(t,e)}),this._isSetup=!0,this}};t.exports=l},function(t,e,n){var r=n(67).EventEmitter,i=n(135),o=e.eventHook=function(){return function(t){var e=t.app,n=t.service,r=e.eventMappings[t.method],i=n._hookEvents&&-1!==n._hookEvents.indexOf(r);r&&i&&"error"!==t.type&&(Array.isArray(t.result)?t.result:[t.result]).forEach(function(e){return n.emit(r,e,t)})}},a=e.eventMixin=function(t){if(!t._serviceEvents){var e=this,n="function"==typeof t.on&&"function"==typeof t.emit;"function"!=typeof t.mixin||n||t.mixin(r.prototype),Object.defineProperties(t,{_serviceEvents:{value:Array.isArray(t.events)?t.events.slice():[]},_hookEvents:{value:[]}}),Object.keys(e.eventMappings).forEach(function(n){var r=e.eventMappings[n],i=-1!==t._serviceEvents.indexOf(r);"function"!=typeof t[n]||i||(t._serviceEvents.push(r),t._hookEvents.push(r))})}};t.exports=function(){return function(t){Object.assign(t,{eventMappings:{create:"created",update:"updated",remove:"removed",patch:"patched"}}),t.hooks({finally:o()}),i.mixin(r.prototype,t),t.mixins.push(a)}}},function(t,e,n){var r=n(51)._;t.exports=[function(t){var e=t.service,n=t.method,r=e.methods[n],i=t.arguments.reduce(function(t,e,n){return t[r[n]]=e,t},{});return i.params||(i.params={}),Object.assign(t,i),t},function(t){var e=t.service,n=t.method,i=e.methods[n];if(i.includes("id")&&void 0===t.id)throw new Error("An id must be provided to the '".concat(n,"' method"));if(i.includes("data")&&!r.isObjectOrArray(t.data))throw new Error("A data object must be provided to the '".concat(n,"' method"));return t}]},function(t,e,n){var r=n(491),i=n(600),o=n(672),a=n(692);t.exports=function(){this.configure(o),this.configure(a),this.configure(r),this.configure(i)}},function(t,e,n){var r=n(208),i=n(91),o=n(552);t.exports=function(){this.use("/tokenize",new o),this.service("tokenize").hooks({before:i(),after:r()})}},function(t,e,n){var r=n(210);t.exports=function(t){return r(t,5)}},function(t,e){t.exports=function(){this.__data__=[],this.size=0}},function(t,e,n){var r=n(93),i=Array.prototype.splice;t.exports=function(t){var e=this.__data__,n=r(e,t);return!(n<0||(n==e.length-1?e.pop():i.call(e,n,1),--this.size,0))}},function(t,e,n){var r=n(93);t.exports=function(t){var e=this.__data__,n=r(e,t);return n<0?void 0:e[n][1]}},function(t,e,n){var r=n(93);t.exports=function(t){return-1<r(this.__data__,t)}},function(t,e,n){var r=n(93);t.exports=function(t,e){var n=this.__data__,i=r(n,t);return i<0?(++this.size,n.push([t,e])):n[i][1]=e,this}},function(t,e,n){var r=n(92);t.exports=function(){this.__data__=new r,this.size=0}},function(t,e){t.exports=function(t){var e=this.__data__,n=e.delete(t);return this.size=e.size,n}},function(t,e){t.exports=function(t){return this.__data__.get(t)}},function(t,e){t.exports=function(t){return this.__data__.has(t)}},function(t,e,n){var r=n(92),i=n(138),o=n(139);t.exports=function(t,e){var n=this.__data__;if(n instanceof r){var a=n.__data__;if(!i||a.length<199)return a.push([t,e]),this.size=++n.size,this;n=this.__data__=new o(a)}return n.set(t,e),this.size=n.size,this}},function(t,e,n){var r=n(211),i=n(506),o=n(38),a=n(213),s=/^\[object .+?Constructor\]$/,u=Function.prototype,c=Object.prototype,l=u.toString,f=c.hasOwnProperty,h=RegExp("^"+l.call(f).replace(/[\\^$.*+?()[\]{}|]/g,"\\$&").replace(/hasOwnProperty|(function).*?(?=\\\()| for .+?(?=\\\])/g,"$1.*?")+"$");t.exports=function(t){return!(!o(t)||i(t))&&(r(t)?h:s).test(a(t))}},function(t,e,n){var r=n(62),i=Object.prototype,o=i.hasOwnProperty,a=i.toString,s=r?r.toStringTag:void 0;t.exports=function(t){var e=o.call(t,s),n=t[s];try{var r=!(t[s]=void 0)}catch(t){}var i=a.call(t);return r&&(e?t[s]=n:delete t[s]),i}},function(t,e){var n=Object.prototype.toString;t.exports=function(t){return n.call(t)}},function(t,e,n){var r,i=n(507),o=(r=/[^.]+$/.exec(i&&i.keys&&i.keys.IE_PROTO||""))?"Symbol(src)_1."+r:"";t.exports=function(t){return!!o&&o in t}},function(t,e,n){var r=n(25)["__core-js_shared__"];t.exports=r},function(t,e){t.exports=function(t,e){return null==t?void 0:t[e]}},function(t,e,n){var r=n(510),i=n(92),o=n(138);t.exports=function(){this.size=0,this.__data__={hash:new r,map:new(o||i),string:new r}}},function(t,e,n){var r=n(511),i=n(512),o=n(513),a=n(514),s=n(515);function u(t){var e=-1,n=null==t?0:t.length;for(this.clear();++e<n;){var r=t[e];this.set(r[0],r[1])}}u.prototype.clear=r,u.prototype.delete=i,u.prototype.get=o,u.prototype.has=a,u.prototype.set=s,t.exports=u},function(t,e,n){var r=n(94);t.exports=function(){this.__data__=r?r(null):{},this.size=0}},function(t,e){t.exports=function(t){var e=this.has(t)&&delete this.__data__[t];return this.size-=e?1:0,e}},function(t,e,n){var r=n(94),i=Object.prototype.hasOwnProperty;t.exports=function(t){var e=this.__data__;if(r){var n=e[t];return"__lodash_hash_undefined__"===n?void 0:n}return i.call(e,t)?e[t]:void 0}},function(t,e,n){var r=n(94),i=Object.prototype.hasOwnProperty;t.exports=function(t){var e=this.__data__;return r?void 0!==e[t]:i.call(e,t)}},function(t,e,n){var r=n(94);t.exports=function(t,e){var n=this.__data__;return this.size+=this.has(t)?0:1,n[t]=r&&void 0===e?"__lodash_hash_undefined__":e,this}},function(t,e,n){var r=n(95);t.exports=function(t){var e=r(this,t).delete(t);return this.size-=e?1:0,e}},function(t,e){function n(t){return(n="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t})(t)}t.exports=function(t){var e=n(t);return"string"==e||"number"==e||"symbol"==e||"boolean"==e?"__proto__"!==t:null===t}},function(t,e,n){var r=n(95);t.exports=function(t){return r(this,t).get(t)}},function(t,e,n){var r=n(95);t.exports=function(t){return r(this,t).has(t)}},function(t,e,n){var r=n(95);t.exports=function(t,e){var n=r(this,t),i=n.size;return n.set(t,e),this.size+=n.size==i?0:1,this}},function(t,e,n){var r=n(68),i=n(69);t.exports=function(t,e){return t&&r(e,i(e),t)}},function(t,e){t.exports=function(t,e){for(var n=-1,r=Array(t);++n<t;)r[n]=e(n);return r}},function(t,e,n){var r=n(61),i=n(39);t.exports=function(t){return i(t)&&"[object Arguments]"==r(t)}},function(t,e){t.exports=function(){return!1}},function(t,e,n){var r=n(61),i=n(142),o=n(39),a={};a["[object Float32Array]"]=a["[object Float64Array]"]=a["[object Int8Array]"]=a["[object Int16Array]"]=a["[object Int32Array]"]=a["[object Uint8Array]"]=a["[object Uint8ClampedArray]"]=a["[object Uint16Array]"]=a["[object Uint32Array]"]=!0,a["[object Arguments]"]=a["[object Array]"]=a["[object ArrayBuffer]"]=a["[object Boolean]"]=a["[object DataView]"]=a["[object Date]"]=a["[object Error]"]=a["[object Function]"]=a["[object Map]"]=a["[object Number]"]=a["[object Object]"]=a["[object RegExp]"]=a["[object Set]"]=a["[object String]"]=a["[object WeakMap]"]=!1,t.exports=function(t){return o(t)&&i(t.length)&&!!a[r(t)]}},function(t,e,n){var r=n(145),i=n(527),o=Object.prototype.hasOwnProperty;t.exports=function(t){if(!r(t))return i(t);var e=[];for(var n in Object(t))o.call(t,n)&&"constructor"!=n&&e.push(n);return e}},function(t,e,n){var r=n(221)(Object.keys,Object);t.exports=r},function(t,e,n){var r=n(68),i=n(222);t.exports=function(t,e){return t&&r(e,i(e),t)}},function(t,e,n){var r=n(38),i=n(145),o=n(530),a=Object.prototype.hasOwnProperty;t.exports=function(t){if(!r(t))return o(t);var e=i(t),n=[];for(var s in t)("constructor"!=s||!e&&a.call(t,s))&&n.push(s);return n}},function(t,e){t.exports=function(t){var e=[];if(null!=t)for(var n in Object(t))e.push(n);return e}},function(t,e,n){(function(t){function r(t){return(r="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t})(t)}var i=n(25),o="object"==r(e)&&e&&!e.nodeType&&e,a=o&&"object"==r(t)&&t&&!t.nodeType&&t,s=a&&a.exports===o?i.Buffer:void 0,u=s?s.allocUnsafe:void 0;t.exports=function(t,e){if(e)return t.slice();var n=t.length,r=u?u(n):new t.constructor(n);return t.copy(r),r}}).call(this,n(60)(t))},function(t,e){t.exports=function(t,e){var n=-1,r=t.length;for(e||(e=Array(r));++n<r;)e[n]=t[n];return e}},function(t,e,n){var r=n(68),i=n(147);t.exports=function(t,e){return r(t,i(t),e)}},function(t,e){t.exports=function(t,e){for(var n=-1,r=null==t?0:t.length,i=0,o=[];++n<r;){var a=t[n];e(a,n,t)&&(o[i++]=a)}return o}},function(t,e,n){var r=n(68),i=n(224);t.exports=function(t,e){return r(t,i(t),e)}},function(t,e,n){var r=n(52)(n(25),"DataView");t.exports=r},function(t,e,n){var r=n(52)(n(25),"Promise");t.exports=r},function(t,e,n){var r=n(52)(n(25),"Set");t.exports=r},function(t,e,n){var r=n(52)(n(25),"WeakMap");t.exports=r},function(t,e){var n=Object.prototype.hasOwnProperty;t.exports=function(t){var e=t.length,r=new t.constructor(e);return e&&"string"==typeof t[0]&&n.call(t,"index")&&(r.index=t.index,r.input=t.input),r}},function(t,e,n){var r=n(150),i=n(542),o=n(543),a=n(544),s=n(545);t.exports=function(t,e,n){var u=t.constructor;switch(e){case"[object ArrayBuffer]":return r(t);case"[object Boolean]":case"[object Date]":return new u(+t);case"[object DataView]":return i(t,n);case"[object Float32Array]":case"[object Float64Array]":case"[object Int8Array]":case"[object Int16Array]":case"[object Int32Array]":case"[object Uint8Array]":case"[object Uint8ClampedArray]":case"[object Uint16Array]":case"[object Uint32Array]":return s(t,n);case"[object Map]":return new u;case"[object Number]":case"[object String]":return new u(t);case"[object RegExp]":return o(t);case"[object Set]":return new u;case"[object Symbol]":return a(t)}}},function(t,e,n){var r=n(150);t.exports=function(t,e){var n=e?r(t.buffer):t.buffer;return new t.constructor(n,t.byteOffset,t.byteLength)}},function(t,e){var n=/\w*$/;t.exports=function(t){var e=new t.constructor(t.source,n.exec(t));return e.lastIndex=t.lastIndex,e}},function(t,e,n){var r=n(62),i=r?r.prototype:void 0,o=i?i.valueOf:void 0;t.exports=function(t){return o?Object(o.call(t)):{}}},function(t,e,n){var r=n(150);t.exports=function(t,e){var n=e?r(t.buffer):t.buffer;return new t.constructor(n,t.byteOffset,t.length)}},function(t,e,n){var r=n(547),i=n(149),o=n(145);t.exports=function(t){return"function"!=typeof t.constructor||o(t)?{}:r(i(t))}},function(t,e,n){var r=n(38),i=Object.create,o=function(){function t(){}return function(e){if(!r(e))return{};if(i)return i(e);t.prototype=e;var n=new t;return t.prototype=void 0,n}}();t.exports=o},function(t,e,n){var r=n(549),i=n(143),o=n(144),a=o&&o.isMap,s=a?i(a):r;t.exports=s},function(t,e,n){var r=n(96),i=n(39);t.exports=function(t){return i(t)&&"[object Map]"==r(t)}},function(t,e,n){var r=n(551),i=n(143),o=n(144),a=o&&o.isSet,s=a?i(a):r;t.exports=s},function(t,e,n){var r=n(96),i=n(39);t.exports=function(t){return i(t)&&"[object Set]"==r(t)}},function(t,e,n){function r(t,e){for(var n=0;n<e.length;n++){var r=e[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(t,r.key,r)}}var i=n(34)("mysam-core/services/tokenize"),o=n(151);t.exports=function(){function t(){!function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,t)}var e,n;return e=t,(n=[{key:"create",value:function(t){var e=t.text,n=o.tokenize(e),r={text:e,tokens:n,stems:o.stem(n)};return i("Tokenized",r),Promise.resolve(r)}}])&&r(e.prototype,n),t}()},function(t,e,n){function r(t,e){return function(t){if(Array.isArray(t))return t}(t)||function(t,e){var n=[],r=!0,i=!1,o=void 0;try{for(var a,s=t[Symbol.iterator]();!(r=(a=s.next()).done)&&(n.push(a.value),!e||n.length!==e);r=!0);}catch(t){i=!0,o=t}finally{try{r||null==s.return||s.return()}finally{if(i)throw o}}return n}(t,e)||function(){throw new TypeError("Invalid attempt to destructure non-iterable instance")}()}function i(t,e){for(var n=0;n<e.length;n++){var r=e[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(t,r.key,r)}}var o=n(554),a=n(562),s=n(230),u=n(234),c=u.tokenize,l=function(t){return Array.isArray(t.bounds)&&2===t.bounds.length},f=function(){function t(e){var n=1<arguments.length&&void 0!==arguments[1]?arguments[1]:[];!function(e,n){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this),this.baseline=u(e),this.tags=n.filter(l)}var e,n;return e=t,(n=[{key:"tag",value:function(t){var e=this;return o(t,function(t,n){var r={label:n,bounds:t};l(r)&&e.tags.push(r)}),this.tags.sort(function(t,e){return t.bounds[0]-e.bounds[0]}),this}},{key:"extract",value:function(t){var e=c(t),n=this.getTags(u(e)),r={};return o(n,function(t,n){r[n]=t?e.slice(t[0],t[1]+1).join(" "):null}),{tags:n,extracted:r}}},{key:"getTags",value:function(t){var e=this,n=t,i=0,o=this.tags.map(function(t){var o=r(t.bounds,2),a=o[0],s=o[1],u=e.baseline.slice(a,s+1),c=e.getTag(t,n,i);if(c.bounds){var l=r(c.bounds,2),f=l[0],h=l[1],p=n.slice(0);u.length===h-f+1&&(p.splice.apply(p,[f,h+1-f].concat(function(t){return function(t){if(Array.isArray(t)){for(var e=0,n=new Array(t.length);e<t.length;e++)n[e]=t[e];return n}}(t)||function(t){if(Symbol.iterator in Object(t)||"[object Arguments]"===Object.prototype.toString.call(t))return Array.from(t)}(t)||function(){throw new TypeError("Invalid attempt to spread non-iterable instance")}()}(u))),n=p),i=c.bounds[1]}return c}),a={};return o.forEach(function(t){a[t.label]=t.bounds}),a}},{key:"getTag",value:function(t,e){var n=2<arguments.length&&void 0!==arguments[2]?arguments[2]:0,i=t.label,o=r(t.bounds,2),a=o[0],s=o[1],u=a-s,c=null,l=0===a?0:this.bestMatch(e,a-1,-1,n).location;if(-1===l)return{label:i,bounds:c};var f=s===this.baseline.length-1?e.length-1:this.bestMatch(e,a+1,1,l).location;return-1===f?c=[l,l+u]:l<=f&&(c=[l,f]),{label:i,bounds:c}}},{key:"bestMatch",value:function(t,e,n){for(var r,i,o=3<arguments.length&&void 0!==arguments[3]?arguments[3]:0,u=[];i=r,o=(r=this.matchWords(t,e,n,o)).location+r.matches,u.push(r),-1!==r.location&&!a(r,i););return s(u,function(t){return t.matches})}},{key:"matchWords",value:function(t,e){var n=2<arguments.length&&void 0!==arguments[2]?arguments[2]:-1,r=3<arguments.length&&void 0!==arguments[3]?arguments[3]:0,i=this.baseline[e],o=t.indexOf(i,r),a=o-e,s=o,u=0;for(-1!==s&&(s=o+-1*n);-1!==o&&void 0!==t[o]&&void 0!==this.baseline[o-a]&&t[o]===this.baseline[o-a];)u++,o+=n;return{location:s,matches:u}}}])&&i(e.prototype,n),t}();t.exports=f},function(t,e,n){t.exports=n(555)},function(t,e,n){var r=n(214),i=n(556),o=n(561),a=n(26);t.exports=function(t,e){return(a(t)?r:i)(t,o(e))}},function(t,e,n){var r=n(557),i=n(560)(r);t.exports=i},function(t,e,n){var r=n(558),i=n(69);t.exports=function(t,e){return t&&r(t,e,i)}},function(t,e,n){var r=n(559)();t.exports=r},function(t,e){t.exports=function(t){return function(e,n,r){for(var i=-1,o=Object(e),a=r(e),s=a.length;s--;){var u=a[t?s:++i];if(!1===n(o[u],u,o))break}return e}}},function(t,e,n){var r=n(146);t.exports=function(t,e){return function(n,i){if(null==n)return n;if(!r(n))return t(n,i);for(var o=n.length,a=e?o:-1,s=Object(n);(e?a--:++a<o)&&!1!==i(s[a],a,s););return n}}},function(t,e,n){var r=n(152);t.exports=function(t){return"function"==typeof t?t:r}},function(t,e,n){var r=n(153);t.exports=function(t,e){return r(t,e)}},function(t,e,n){var r=n(136),i=n(229),o=n(569),a=n(572),s=n(96),u=n(26),c=n(141),l=n(220),f="[object Arguments]",h="[object Array]",p="[object Object]",d=Object.prototype.hasOwnProperty;t.exports=function(t,e,n,y,v,g){var m=u(t),b=u(e),x=m?h:s(t),_=b?h:s(e),w=(x=x==f?p:x)==p,S=(_=_==f?p:_)==p,E=x==_;if(E&&c(t)){if(!c(e))return!1;w=!(m=!0)}if(E&&!w)return g||(g=new r),m||l(t)?i(t,e,n,y,v,g):o(t,e,x,n,y,v,g);if(!(1&n)){var T=w&&d.call(t,"__wrapped__"),k=S&&d.call(e,"__wrapped__");if(T||k){var O=T?t.value():t,A=k?e.value():e;return g||(g=new r),v(O,A,n,y,g)}}return!!E&&(g||(g=new r),a(t,e,n,y,v,g))}},function(t,e,n){var r=n(139),i=n(565),o=n(566);function a(t){var e=-1,n=null==t?0:t.length;for(this.__data__=new r;++e<n;)this.add(t[e])}a.prototype.add=a.prototype.push=i,a.prototype.has=o,t.exports=a},function(t,e){t.exports=function(t){return this.__data__.set(t,"__lodash_hash_undefined__"),this}},function(t,e){t.exports=function(t){return this.__data__.has(t)}},function(t,e){t.exports=function(t,e){for(var n=-1,r=null==t?0:t.length;++n<r;)if(e(t[n],n,t))return!0;return!1}},function(t,e){t.exports=function(t,e){return t.has(e)}},function(t,e,n){var r=n(62),i=n(228),o=n(137),a=n(229),s=n(570),u=n(571),c=r?r.prototype:void 0,l=c?c.valueOf:void 0;t.exports=function(t,e,n,r,c,f,h){switch(n){case"[object DataView]":if(t.byteLength!=e.byteLength||t.byteOffset!=e.byteOffset)return!1;t=t.buffer,e=e.buffer;case"[object ArrayBuffer]":return!(t.byteLength!=e.byteLength||!f(new i(t),new i(e)));case"[object Boolean]":case"[object Date]":case"[object Number]":return o(+t,+e);case"[object Error]":return t.name==e.name&&t.message==e.message;case"[object RegExp]":case"[object String]":return t==e+"";case"[object Map]":var p=s;case"[object Set]":var d=1&r;if(p||(p=u),t.size!=e.size&&!d)return!1;var y=h.get(t);if(y)return y==e;r|=2,h.set(t,e);var v=a(p(t),p(e),r,c,f,h);return h.delete(t),v;case"[object Symbol]":if(l)return l.call(t)==l.call(e)}return!1}},function(t,e){t.exports=function(t){var e=-1,n=Array(t.size);return t.forEach(function(t,r){n[++e]=[r,t]}),n}},function(t,e){t.exports=function(t){var e=-1,n=Array(t.size);return t.forEach(function(t){n[++e]=t}),n}},function(t,e,n){var r=n(225),i=Object.prototype.hasOwnProperty;t.exports=function(t,e,n,o,a,s){var u=1&n,c=r(t),l=c.length;if(l!=r(e).length&&!u)return!1;for(var f=l;f--;){var h=c[f];if(!(u?h in e:i.call(e,h)))return!1}var p=s.get(t);if(p&&s.get(e))return p==e;var d=!0;s.set(t,e),s.set(e,t);for(var y=u;++f<l;){var v=t[h=c[f]],g=e[h];if(o)var m=u?o(g,v,h,e,t,s):o(v,g,h,t,e,s);if(!(void 0===m?v===g||a(v,g,n,o,s):m)){d=!1;break}y||(y="constructor"==h)}if(d&&!y){var b=t.constructor,x=e.constructor;b!=x&&"constructor"in t&&"constructor"in e&&!("function"==typeof b&&b instanceof b&&"function"==typeof x&&x instanceof x)&&(d=!1)}return s.delete(t),s.delete(e),d}},function(t,e,n){var r=n(70);t.exports=function(t,e,n){for(var i=-1,o=t.length;++i<o;){var a=t[i],s=e(a);if(null!=s&&(void 0===u?s==s&&!r(s):n(s,u)))var u=s,c=a}return c}},function(t,e){t.exports=function(t,e){return e<t}},function(t,e,n){function r(t){return(r="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t})(t)}var i=n(576),o=n(579),a=n(152),s=n(26),u=n(589);t.exports=function(t){return"function"==typeof t?t:null==t?a:"object"==r(t)?s(t)?o(t[0],t[1]):i(t):u(t)}},function(t,e,n){var r=n(577),i=n(578),o=n(232);t.exports=function(t){var e=i(t);return 1==e.length&&e[0][2]?o(e[0][0],e[0][1]):function(n){return n===t||r(n,t,e)}}},function(t,e,n){var r=n(136),i=n(153);t.exports=function(t,e,n,o){var a=n.length,s=a,u=!o;if(null==t)return!s;for(t=Object(t);a--;){var c=n[a];if(u&&c[2]?c[1]!==t[c[0]]:!(c[0]in t))return!1}for(;++a<s;){var l=(c=n[a])[0],f=t[l],h=c[1];if(u&&c[2]){if(void 0===f&&!(l in t))return!1}else{var p=new r;if(o)var d=o(f,h,l,t,e,p);if(!(void 0===d?i(h,f,3,o,p):d))return!1}}return!0}},function(t,e,n){var r=n(231),i=n(69);t.exports=function(t){for(var e=i(t),n=e.length;n--;){var o=e[n],a=t[o];e[n]=[o,a,r(a)]}return e}},function(t,e,n){var r=n(153),i=n(580),o=n(586),a=n(155),s=n(231),u=n(232),c=n(71);t.exports=function(t,e){return a(t)&&s(e)?u(c(t),e):function(n){var a=i(n,t);return void 0===a&&a===e?o(n,t):r(e,a,3)}}},function(t,e,n){var r=n(154);t.exports=function(t,e,n){var i=null==t?void 0:r(t,e);return void 0===i?n:i}},function(t,e,n){var r=n(582),i=/[^.[\]]+|\[(?:(-?\d+(?:\.\d+)?)|(["'])((?:(?!\2)[^\\]|\\.)*?)\2)\]|(?=(?:\.|\[\])(?:\.|\[\]|$))/g,o=/\\(\\)?/g,a=r(function(t){var e=[];return 46===t.charCodeAt(0)&&e.push(""),t.replace(i,function(t,n,r,i){e.push(r?i.replace(o,"$1"):n||t)}),e});t.exports=a},function(t,e,n){var r=n(583);t.exports=function(t){var e=r(t,function(t){return 500===n.size&&n.clear(),t}),n=e.cache;return e}},function(t,e,n){var r=n(139),i="Expected a function";function o(t,e){if("function"!=typeof t||null!=e&&"function"!=typeof e)throw new TypeError(i);var n=function n(){var r=arguments,i=e?e.apply(this,r):r[0],o=n.cache;if(o.has(i))return o.get(i);var a=t.apply(this,r);return n.cache=o.set(i,a)||o,a};return n.cache=new(o.Cache||r),n}o.Cache=r,t.exports=o},function(t,e,n){var r=n(585);t.exports=function(t){return null==t?"":r(t)}},function(t,e,n){var r=n(62),i=n(233),o=n(26),a=n(70),s=r?r.prototype:void 0,u=s?s.toString:void 0;t.exports=function t(e){if("string"==typeof e)return e;if(o(e))return i(e,t)+"";if(a(e))return u?u.call(e):"";var n=e+"";return"0"==n&&1/e==-1/0?"-0":n}},function(t,e,n){var r=n(587),i=n(588);t.exports=function(t,e){return null!=t&&i(t,e,r)}},function(t,e){t.exports=function(t,e){return null!=t&&e in Object(t)}},function(t,e,n){var r=n(97),i=n(140),o=n(26),a=n(219),s=n(142),u=n(71);t.exports=function(t,e,n){for(var c=-1,l=(e=r(e,t)).length,f=!1;++c<l;){var h=u(e[c]);if(!(f=null!=t&&n(t,h)))break;t=t[h]}return f||++c!=l?f:!!(l=null==t?0:t.length)&&s(l)&&a(h,l)&&(o(t)||i(t))}},function(t,e,n){var r=n(590),i=n(591),o=n(155),a=n(71);t.exports=function(t){return o(t)?r(a(t)):i(t)}},function(t,e){t.exports=function(t){return function(e){return null==e?void 0:e[t]}}},function(t,e,n){var r=n(154);t.exports=function(t){return function(e){return r(e,t)}}},function(t,e,n){var r=n(235),i=n(98),o=n(594)._,a=function(t){t=t||{},this._pattern=t.pattern||this._pattern,this.discardEmpty=t.discardEmpty||!0,this._gaps=t.gaps,void 0===this._gaps&&(this._gaps=!0)};i.inherits(a,r),a.prototype.tokenize=function(t){var e;return this._gaps?(e=t.split(this._pattern),this.discardEmpty?o.without(e,""," "):e):t.match(this._pattern)},e.RegexpTokenizer=a;var s=n(595),u=function(t){var e=s[t.language];e?(this._pattern=e,a.call(this,t)):c.call(this,t)};i.inherits(u,a),e.OrthographyTokenizer=u;var c=function(t){this._pattern=/[^A-Za-zÐ-Ð¯Ð°-Ñ0-9_]+/,a.call(this,t)};i.inherits(c,a),e.WordTokenizer=c;var l=function(t){this._pattern=new RegExp(/([A-zÃ€-Ã¿-]+|[0-9._]+|.|!|\?|'|"|:|;|,|-)/i),a.call(this,t)};i.inherits(l,a),e.WordPunctTokenizer=l},function(t,e){function n(t){return(n="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t})(t)}t.exports=function(t){return t&&"object"===n(t)&&"function"==typeof t.copy&&"function"==typeof t.fill&&"function"==typeof t.readUInt8}},function(t,e,n){(function(t,n){var r;function i(t){return(i="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t})(t)}!function(){var o="object"==("undefined"==typeof self?"undefined":i(self))&&self.self===self&&self||"object"==(void 0===t?"undefined":i(t))&&t.global===t&&t||this||{},a=o._,s=Array.prototype,u=Object.prototype,c="undefined"!=typeof Symbol?Symbol.prototype:null,l=s.push,f=s.slice,h=u.toString,p=u.hasOwnProperty,d=Array.isArray,y=Object.keys,v=Object.create,g=function(){},m=function t(e){return e instanceof t?e:this instanceof t?void(this._wrapped=e):new t(e)};e.nodeType?o._=m:(!n.nodeType&&n.exports&&(e=n.exports=m),e._=m),m.VERSION="1.9.1";var b,x=function(t,e,n){if(void 0===e)return t;switch(null==n?3:n){case 1:return function(n){return t.call(e,n)};case 3:return function(n,r,i){return t.call(e,n,r,i)};case 4:return function(n,r,i,o){return t.call(e,n,r,i,o)}}return function(){return t.apply(e,arguments)}},_=function(t,e,n){return m.iteratee!==b?m.iteratee(t,e):null==t?m.identity:m.isFunction(t)?x(t,e,n):m.isObject(t)&&!m.isArray(t)?m.matcher(t):m.property(t)};m.iteratee=b=function(t,e){return _(t,e,1/0)};var w=function(t,e){return e=null==e?t.length-1:+e,function(){for(var n=Math.max(arguments.length-e,0),r=Array(n),i=0;i<n;i++)r[i]=arguments[i+e];switch(e){case 0:return t.call(this,r);case 1:return t.call(this,arguments[0],r);case 2:return t.call(this,arguments[0],arguments[1],r)}var o=Array(e+1);for(i=0;i<e;i++)o[i]=arguments[i];return o[e]=r,t.apply(this,o)}},S=function(t){if(!m.isObject(t))return{};if(v)return v(t);g.prototype=t;var e=new g;return g.prototype=null,e},E=function(t){return function(e){return null==e?void 0:e[t]}},T=function(t,e){return null!=t&&p.call(t,e)},k=function(t,e){for(var n=e.length,r=0;r<n;r++){if(null==t)return;t=t[e[r]]}return n?t:void 0},O=Math.pow(2,53)-1,A=E("length"),j=function(t){var e=A(t);return"number"==typeof e&&0<=e&&e<=O};m.each=m.forEach=function(t,e,n){var r,i;if(e=x(e,n),j(t))for(r=0,i=t.length;r<i;r++)e(t[r],r,t);else{var o=m.keys(t);for(r=0,i=o.length;r<i;r++)e(t[o[r]],o[r],t)}return t},m.map=m.collect=function(t,e,n){e=_(e,n);for(var r=!j(t)&&m.keys(t),i=(r||t).length,o=Array(i),a=0;a<i;a++){var s=r?r[a]:a;o[a]=e(t[s],s,t)}return o};var P=function(t){return function(e,n,r,i){var o=3<=arguments.length;return function(e,n,r,i){var o=!j(e)&&m.keys(e),a=(o||e).length,s=0<t?0:a-1;for(i||(r=e[o?o[s]:s],s+=t);0<=s&&s<a;s+=t){var u=o?o[s]:s;r=n(r,e[u],u,e)}return r}(e,x(n,i,4),r,o)}};m.reduce=m.foldl=m.inject=P(1),m.reduceRight=m.foldr=P(-1),m.find=m.detect=function(t,e,n){var r=(j(t)?m.findIndex:m.findKey)(t,e,n);if(void 0!==r&&-1!==r)return t[r]},m.filter=m.select=function(t,e,n){var r=[];return e=_(e,n),m.each(t,function(t,n,i){e(t,n,i)&&r.push(t)}),r},m.reject=function(t,e,n){return m.filter(t,m.negate(_(e)),n)},m.every=m.all=function(t,e,n){e=_(e,n);for(var r=!j(t)&&m.keys(t),i=(r||t).length,o=0;o<i;o++){var a=r?r[o]:o;if(!e(t[a],a,t))return!1}return!0},m.some=m.any=function(t,e,n){e=_(e,n);for(var r=!j(t)&&m.keys(t),i=(r||t).length,o=0;o<i;o++){var a=r?r[o]:o;if(e(t[a],a,t))return!0}return!1},m.contains=m.includes=m.include=function(t,e,n,r){return j(t)||(t=m.values(t)),("number"!=typeof n||r)&&(n=0),0<=m.indexOf(t,e,n)},m.invoke=w(function(t,e,n){var r,i;return m.isFunction(e)?i=e:m.isArray(e)&&(r=e.slice(0,-1),e=e[e.length-1]),m.map(t,function(t){var o=i;if(!o){if(r&&r.length&&(t=k(t,r)),null==t)return;o=t[e]}return null==o?o:o.apply(t,n)})}),m.pluck=function(t,e){return m.map(t,m.property(e))},m.where=function(t,e){return m.filter(t,m.matcher(e))},m.findWhere=function(t,e){return m.find(t,m.matcher(e))},m.max=function(t,e,n){var r,o,a=-1/0,s=-1/0;if(null==e||"number"==typeof e&&"object"!=i(t[0])&&null!=t)for(var u=0,c=(t=j(t)?t:m.values(t)).length;u<c;u++)null!=(r=t[u])&&a<r&&(a=r);else e=_(e,n),m.each(t,function(t,n,r){o=e(t,n,r),(s<o||o===-1/0&&a===-1/0)&&(a=t,s=o)});return a},m.min=function(t,e,n){var r,o,a=1/0,s=1/0;if(null==e||"number"==typeof e&&"object"!=i(t[0])&&null!=t)for(var u=0,c=(t=j(t)?t:m.values(t)).length;u<c;u++)null!=(r=t[u])&&r<a&&(a=r);else e=_(e,n),m.each(t,function(t,n,r){((o=e(t,n,r))<s||o===1/0&&a===1/0)&&(a=t,s=o)});return a},m.shuffle=function(t){return m.sample(t,1/0)},m.sample=function(t,e,n){if(null==e||n)return j(t)||(t=m.values(t)),t[m.random(t.length-1)];var r=j(t)?m.clone(t):m.values(t),i=A(r);e=Math.max(Math.min(e,i),0);for(var o=i-1,a=0;a<e;a++){var s=m.random(a,o),u=r[a];r[a]=r[s],r[s]=u}return r.slice(0,e)},m.sortBy=function(t,e,n){var r=0;return e=_(e,n),m.pluck(m.map(t,function(t,n,i){return{value:t,index:r++,criteria:e(t,n,i)}}).sort(function(t,e){var n=t.criteria,r=e.criteria;if(n!==r){if(r<n||void 0===n)return 1;if(n<r||void 0===r)return-1}return t.index-e.index}),"value")};var R=function(t,e){return function(n,r,i){var o=e?[[],[]]:{};return r=_(r,i),m.each(n,function(e,i){var a=r(e,i,n);t(o,e,a)}),o}};m.groupBy=R(function(t,e,n){T(t,n)?t[n].push(e):t[n]=[e]}),m.indexBy=R(function(t,e,n){t[n]=e}),m.countBy=R(function(t,e,n){T(t,n)?t[n]++:t[n]=1});var C=/[^\ud800-\udfff]|[\ud800-\udbff][\udc00-\udfff]|[\ud800-\udfff]/g;m.toArray=function(t){return t?m.isArray(t)?f.call(t):m.isString(t)?t.match(C):j(t)?m.map(t,m.identity):m.values(t):[]},m.size=function(t){return null==t?0:j(t)?t.length:m.keys(t).length},m.partition=R(function(t,e,n){t[n?0:1].push(e)},!0),m.first=m.head=m.take=function(t,e,n){return null==t||t.length<1?null==e?void 0:[]:null==e||n?t[0]:m.initial(t,t.length-e)},m.initial=function(t,e,n){return f.call(t,0,Math.max(0,t.length-(null==e||n?1:e)))},m.last=function(t,e,n){return null==t||t.length<1?null==e?void 0:[]:null==e||n?t[t.length-1]:m.rest(t,Math.max(0,t.length-e))},m.rest=m.tail=m.drop=function(t,e,n){return f.call(t,null==e||n?1:e)},m.compact=function(t){return m.filter(t,Boolean)};var I=function t(e,n,r,i){for(var o=(i=i||[]).length,a=0,s=A(e);a<s;a++){var u=e[a];if(j(u)&&(m.isArray(u)||m.isArguments(u)))if(n)for(var c=0,l=u.length;c<l;)i[o++]=u[c++];else t(u,n,r,i),o=i.length;else r||(i[o++]=u)}return i};m.flatten=function(t,e){return I(t,e,!1)},m.without=w(function(t,e){return m.difference(t,e)}),m.uniq=m.unique=function(t,e,n,r){m.isBoolean(e)||(r=n,n=e,e=!1),null!=n&&(n=_(n,r));for(var i=[],o=[],a=0,s=A(t);a<s;a++){var u=t[a],c=n?n(u,a,t):u;e&&!n?(a&&o===c||i.push(u),o=c):n?m.contains(o,c)||(o.push(c),i.push(u)):m.contains(i,u)||i.push(u)}return i},m.union=w(function(t){return m.uniq(I(t,!0,!0))}),m.intersection=function(t){for(var e=[],n=arguments.length,r=0,i=A(t);r<i;r++){var o=t[r];if(!m.contains(e,o)){var a;for(a=1;a<n&&m.contains(arguments[a],o);a++);a===n&&e.push(o)}}return e},m.difference=w(function(t,e){return e=I(e,!0,!0),m.filter(t,function(t){return!m.contains(e,t)})}),m.zip=w(m.unzip=function(t){for(var e=t&&m.max(t,A).length||0,n=Array(e),r=0;r<e;r++)n[r]=m.pluck(t,r);return n}),m.object=function(t,e){for(var n={},r=0,i=A(t);r<i;r++)e?n[t[r]]=e[r]:n[t[r][0]]=t[r][1];return n};var L=function(t){return function(e,n,r){n=_(n,r);for(var i=A(e),o=0<t?0:i-1;0<=o&&o<i;o+=t)if(n(e[o],o,e))return o;return-1}};m.findIndex=L(1),m.findLastIndex=L(-1);var N=function(t,e,n){return function(r,i,o){var a=0,s=A(r);if("number"==typeof o)0<t?a=0<=o?o:Math.max(o+s,a):s=0<=o?Math.min(o+1,s):o+s+1;else if(n&&o&&s)return r[o=n(r,i)]===i?o:-1;if(i!=i)return 0<=(o=e(f.call(r,a,s),m.isNaN))?o+a:-1;for(o=0<t?a:s-1;0<=o&&o<s;o+=t)if(r[o]===i)return o;return-1}};m.indexOf=N(1,m.findIndex,m.sortedIndex=function(t,e,n,r){for(var i=(n=_(n,r,1))(e),o=0,a=A(t);o<a;){var s=Math.floor((o+a)/2);n(t[s])<i?o=s+1:a=s}return o}),m.lastIndexOf=N(-1,m.findLastIndex),m.range=function(t,e,n){null==e&&(e=t||0,t=0),n||(n=e<t?-1:1);for(var r=Math.max(Math.ceil((e-t)/n),0),i=Array(r),o=0;o<r;o++,t+=n)i[o]=t;return i},m.chunk=function(t,e){if(null==e||e<1)return[];for(var n=[],r=0,i=t.length;r<i;)n.push(f.call(t,r,r+=e));return n};var F=function(t,e,n,r,i){if(!(r instanceof e))return t.apply(n,i);var o=S(t.prototype),a=t.apply(o,i);return m.isObject(a)?a:o};m.bind=w(function(t,e,n){if(!m.isFunction(t))throw new TypeError("Bind must be called on a function");var r=w(function(i){return F(t,r,e,this,n.concat(i))});return r}),((m.partial=w(function(t,e){var n=m.partial.placeholder;return function r(){for(var i=0,o=e.length,a=Array(o),s=0;s<o;s++)a[s]=e[s]===n?arguments[i++]:e[s];for(;i<arguments.length;)a.push(arguments[i++]);return F(t,r,this,this,a)}})).placeholder=m).bindAll=w(function(t,e){var n=(e=I(e,!1,!1)).length;if(n<1)throw new Error("bindAll must be passed function names");for(;n--;){var r=e[n];t[r]=m.bind(t[r],t)}}),m.memoize=function(t,e){var n=function n(r){var i=n.cache,o=""+(e?e.apply(this,arguments):r);return T(i,o)||(i[o]=t.apply(this,arguments)),i[o]};return n.cache={},n},m.delay=w(function(t,e,n){return setTimeout(function(){return t.apply(null,n)},e)}),m.defer=m.partial(m.delay,m,1),m.throttle=function(t,e,n){var r,i,o,a,s=0;n||(n={});var u=function(){s=!1===n.leading?0:m.now(),r=null,a=t.apply(i,o),r||(i=o=null)},c=function(){var c=m.now();s||!1!==n.leading||(s=c);var l=e-(c-s);return i=this,o=arguments,l<=0||e<l?(r&&(clearTimeout(r),r=null),s=c,a=t.apply(i,o),r||(i=o=null)):r||!1===n.trailing||(r=setTimeout(u,l)),a};return c.cancel=function(){clearTimeout(r),s=0,r=i=o=null},c},m.debounce=function(t,e,n){var r,i,o=function(e,n){r=null,n&&(i=t.apply(e,n))},a=w(function(a){if(r&&clearTimeout(r),n){var s=!r;r=setTimeout(o,e),s&&(i=t.apply(this,a))}else r=m.delay(o,e,this,a);return i});return a.cancel=function(){clearTimeout(r),r=null},a},m.wrap=function(t,e){return m.partial(e,t)},m.negate=function(t){return function(){return!t.apply(this,arguments)}},m.compose=function(){var t=arguments,e=t.length-1;return function(){for(var n=e,r=t[e].apply(this,arguments);n--;)r=t[n].call(this,r);return r}},m.after=function(t,e){return function(){if(--t<1)return e.apply(this,arguments)}},m.once=m.partial(m.before=function(t,e){var n;return function(){return 0<--t&&(n=e.apply(this,arguments)),t<=1&&(e=null),n}},2),m.restArguments=w;var M=!{toString:null}.propertyIsEnumerable("toString"),D=["valueOf","isPrototypeOf","toString","propertyIsEnumerable","hasOwnProperty","toLocaleString"],U=function(t,e){var n=D.length,r=t.constructor,i=m.isFunction(r)&&r.prototype||u,o="constructor";for(T(t,o)&&!m.contains(e,o)&&e.push(o);n--;)(o=D[n])in t&&t[o]!==i[o]&&!m.contains(e,o)&&e.push(o)};m.keys=function(t){if(!m.isObject(t))return[];if(y)return y(t);var e=[];for(var n in t)T(t,n)&&e.push(n);return M&&U(t,e),e},m.allKeys=function(t){if(!m.isObject(t))return[];var e=[];for(var n in t)e.push(n);return M&&U(t,e),e},m.values=function(t){for(var e=m.keys(t),n=e.length,r=Array(n),i=0;i<n;i++)r[i]=t[e[i]];return r},m.mapObject=function(t,e,n){e=_(e,n);for(var r=m.keys(t),i=r.length,o={},a=0;a<i;a++){var s=r[a];o[s]=e(t[s],s,t)}return o},m.pairs=function(t){for(var e=m.keys(t),n=e.length,r=Array(n),i=0;i<n;i++)r[i]=[e[i],t[e[i]]];return r},m.invert=function(t){for(var e={},n=m.keys(t),r=0,i=n.length;r<i;r++)e[t[n[r]]]=n[r];return e},m.functions=m.methods=function(t){var e=[];for(var n in t)m.isFunction(t[n])&&e.push(n);return e.sort()};var G=function(t,e){return function(n){var r=arguments.length;if(e&&(n=Object(n)),r<2||null==n)return n;for(var i=1;i<r;i++)for(var o=arguments[i],a=t(o),s=a.length,u=0;u<s;u++){var c=a[u];e&&void 0!==n[c]||(n[c]=o[c])}return n}};m.extend=G(m.allKeys),m.extendOwn=m.assign=G(m.keys),m.findKey=function(t,e,n){e=_(e,n);for(var r,i=m.keys(t),o=0,a=i.length;o<a;o++)if(e(t[r=i[o]],r,t))return r};var z,B,V=function(t,e,n){return e in n};m.pick=w(function(t,e){var n={},r=e[0];if(null==t)return n;m.isFunction(r)?(1<e.length&&(r=x(r,e[1])),e=m.allKeys(t)):(r=V,e=I(e,!1,!1),t=Object(t));for(var i=0,o=e.length;i<o;i++){var a=e[i],s=t[a];r(s,a,t)&&(n[a]=s)}return n}),m.omit=w(function(t,e){var n,r=e[0];return m.isFunction(r)?(r=m.negate(r),1<e.length&&(n=e[1])):(e=m.map(I(e,!1,!1),String),r=function(t,n){return!m.contains(e,n)}),m.pick(t,r,n)}),m.defaults=G(m.allKeys,!0),m.create=function(t,e){var n=S(t);return e&&m.extendOwn(n,e),n},m.clone=function(t){return m.isObject(t)?m.isArray(t)?t.slice():m.extend({},t):t},m.tap=function(t,e){return e(t),t},m.isMatch=function(t,e){var n=m.keys(e),r=n.length;if(null==t)return!r;for(var i=Object(t),o=0;o<r;o++){var a=n[o];if(e[a]!==i[a]||!(a in i))return!1}return!0},z=function(t,e,n,r){if(t===e)return 0!==t||1/t==1/e;if(null==t||null==e)return!1;if(t!=t)return e!=e;var o=i(t);return("function"===o||"object"===o||"object"==i(e))&&B(t,e,n,r)},B=function(t,e,n,r){t instanceof m&&(t=t._wrapped),e instanceof m&&(e=e._wrapped);var o=h.call(t);if(o!==h.call(e))return!1;switch(o){case"[object RegExp]":case"[object String]":return""+t==""+e;case"[object Number]":return+t!=+t?+e!=+e:0==+t?1/+t==1/e:+t==+e;case"[object Date]":case"[object Boolean]":return+t==+e;case"[object Symbol]":return c.valueOf.call(t)===c.valueOf.call(e)}var a="[object Array]"===o;if(!a){if("object"!=i(t)||"object"!=i(e))return!1;var s=t.constructor,u=e.constructor;if(s!==u&&!(m.isFunction(s)&&s instanceof s&&m.isFunction(u)&&u instanceof u)&&"constructor"in t&&"constructor"in e)return!1}r=r||[];for(var l=(n=n||[]).length;l--;)if(n[l]===t)return r[l]===e;if(n.push(t),r.push(e),a){if((l=t.length)!==e.length)return!1;for(;l--;)if(!z(t[l],e[l],n,r))return!1}else{var f,p=m.keys(t);if(l=p.length,m.keys(e).length!==l)return!1;for(;l--;)if(f=p[l],!T(e,f)||!z(t[f],e[f],n,r))return!1}return n.pop(),r.pop(),!0},m.isEqual=function(t,e){return z(t,e)},m.isEmpty=function(t){return null==t||(j(t)&&(m.isArray(t)||m.isString(t)||m.isArguments(t))?0===t.length:0===m.keys(t).length)},m.isElement=function(t){return!(!t||1!==t.nodeType)},m.isArray=d||function(t){return"[object Array]"===h.call(t)},m.isObject=function(t){var e=i(t);return"function"===e||"object"===e&&!!t},m.each(["Arguments","Function","String","Number","Date","RegExp","Error","Symbol","Map","WeakMap","Set","WeakSet"],function(t){m["is"+t]=function(e){return h.call(e)==="[object "+t+"]"}}),m.isArguments(arguments)||(m.isArguments=function(t){return T(t,"callee")});var W=o.document&&o.document.childNodes;"object"!=("undefined"==typeof Int8Array?"undefined":i(Int8Array))&&"function"!=typeof W&&(m.isFunction=function(t){return"function"==typeof t||!1}),m.isFinite=function(t){return!m.isSymbol(t)&&isFinite(t)&&!isNaN(parseFloat(t))},m.isNaN=function(t){return m.isNumber(t)&&isNaN(t)},m.isBoolean=function(t){return!0===t||!1===t||"[object Boolean]"===h.call(t)},m.isNull=function(t){return null===t},m.isUndefined=function(t){return void 0===t},m.has=function(t,e){if(!m.isArray(e))return T(t,e);for(var n=e.length,r=0;r<n;r++){var i=e[r];if(null==t||!p.call(t,i))return!1;t=t[i]}return!!n},m.noConflict=function(){return o._=a,this},m.identity=function(t){return t},m.constant=function(t){return function(){return t}},m.noop=function(){},m.property=function(t){return m.isArray(t)?function(e){return k(e,t)}:E(t)},m.propertyOf=function(t){return null==t?function(){}:function(e){return m.isArray(e)?k(t,e):t[e]}},m.matcher=m.matches=function(t){return t=m.extendOwn({},t),function(e){return m.isMatch(e,t)}},m.times=function(t,e,n){var r=Array(Math.max(0,t));e=x(e,n,1);for(var i=0;i<t;i++)r[i]=e(i);return r},m.random=function(t,e){return null==e&&(e=t,t=0),t+Math.floor(Math.random()*(e-t+1))},m.now=Date.now||function(){return(new Date).getTime()};var X={"&":"&amp;","<":"&lt;",">":"&gt;",'"':"&quot;","'":"&#x27;","`":"&#x60;"},K=m.invert(X),q=function(t){var e=function(e){return t[e]},n="(?:"+m.keys(t).join("|")+")",r=RegExp(n),i=RegExp(n,"g");return function(t){return t=null==t?"":""+t,r.test(t)?t.replace(i,e):t}};m.escape=q(X),m.unescape=q(K),m.result=function(t,e,n){m.isArray(e)||(e=[e]);var r=e.length;if(!r)return m.isFunction(n)?n.call(t):n;for(var i=0;i<r;i++){var o=null==t?void 0:t[e[i]];void 0===o&&(o=n,i=r),t=m.isFunction(o)?o.call(t):o}return t};var H=0;m.uniqueId=function(t){var e=++H+"";return t?t+e:e},m.templateSettings={evaluate:/<%([\s\S]+?)%>/g,interpolate:/<%=([\s\S]+?)%>/g,escape:/<%-([\s\S]+?)%>/g};var $=/(.)^/,Y={"'":"'","\\":"\\","\r":"r","\n":"n","\u2028":"u2028","\u2029":"u2029"},J=/\\|'|\r|\n|\u2028|\u2029/g,Q=function(t){return"\\"+Y[t]};m.template=function(t,e,n){!e&&n&&(e=n),e=m.defaults({},e,m.templateSettings);var r,i=RegExp([(e.escape||$).source,(e.interpolate||$).source,(e.evaluate||$).source].join("|")+"|$","g"),o=0,a="__p+='";t.replace(i,function(e,n,r,i,s){return a+=t.slice(o,s).replace(J,Q),o=s+e.length,n?a+="'+\n((__t=("+n+"))==null?'':_.escape(__t))+\n'":r?a+="'+\n((__t=("+r+"))==null?'':__t)+\n'":i&&(a+="';\n"+i+"\n__p+='"),e}),a+="';\n",e.variable||(a="with(obj||{}){\n"+a+"}\n"),a="var __t,__p='',__j=Array.prototype.join,print=function(){__p+=__j.call(arguments,'');};\n"+a+"return __p;\n";try{r=new Function(e.variable||"obj","_",a)}catch(e){throw e.source=a,e}var s=function(t){return r.call(this,t,m)},u=e.variable||"obj";return s.source="function("+u+"){\n"+a+"}",s},m.chain=function(t){var e=m(t);return e._chain=!0,e};var Z=function(t,e){return t._chain?m(e).chain():e};m.mixin=function(t){return m.each(m.functions(t),function(e){var n=m[e]=t[e];m.prototype[e]=function(){var t=[this._wrapped];return l.apply(t,arguments),Z(this,n.apply(m,t))}}),m},m.mixin(m),m.each(["pop","push","reverse","shift","sort","splice","unshift"],function(t){var e=s[t];m.prototype[t]=function(){var n=this._wrapped;return e.apply(n,arguments),"shift"!==t&&"splice"!==t||0!==n.length||delete n[0],Z(this,n)}}),m.each(["concat","join","slice"],function(t){var e=s[t];m.prototype[t]=function(){return Z(this,e.apply(this._wrapped,arguments))}}),m.prototype.valueOf=m.prototype.toJSON=m.prototype.value=function(){return this._wrapped},m.prototype.toString=function(){return String(this._wrapped)},void 0===(r=function(){return m}.apply(e,[]))||(n.exports=r)}()}).call(this,n(15),n(60)(t))},function(t,e){t.exports={fi:/[^A-Za-zÃ…Ã¥Ã„Ã¤Ã–Ã¶]/}},function(t,e,n){function r(t){return t.replace(/[^aeiouy]+y/g,"CV").replace(/[aeiou]+/g,"V").replace(/[^V]+/g,"C")}function i(t){return t.replace(/[^aeiouy]y/g,"CV").replace(/[aeiou]/g,"V").replace(/[^V]/g,"C")}function o(t){return t?r(t).replace(/^C/,"").replace(/V$/,"").length/2:-1}function a(t,e,n,r){var i=null;return"string"==typeof e&&t.substr(0-e.length)==e?i=t.replace(new RegExp(e+"$"),n):e instanceof RegExp&&t.match(e)&&(i=t.replace(e,n)),i&&r?r(i):i}function s(t,e,n){for(var r=t,i=0;i<e.length;i++)(null==n||o(a(t,e[i][0],e[i][1]))>n)&&(r=a(r,e[i][0],e[i][2])||r);return r}function u(t,e,n){return s(t,e,n)||t}function c(t,e,n,r){var i,a="";return e.test(t)&&(i=e.exec(t),n.forEach(function(t){a+=i[t]})),o(a)>r?a:null}function l(t){return t.match(/(ss|i)es$/)?t.replace(/(ss|i)es$/,"$1"):"s"==t.substr(-1)&&"s"!=t.substr(-2,1)&&2<t.length?t.replace(/s?$/,""):t}function f(t){if("eed"==t.substr(-3)){if(0<o(t.substr(0,t.length-3)))return t.replace(/eed$/,"ee")}else{var e=a(t,/(ed|ing)$/,"",function(t){return 0<=r(t).indexOf("V")?(e=s(t,[["at","","ate"],["bl","","ble"],["iz","","ize"]]))!=t?e:t.match(/([^aeiou])\1$/)&&t.match(/[^lsz]$/)?t.replace(/([^aeiou])\1$/,"$1"):1==o(t)&&"CVC"==i(t).substr(-3)&&t.match(/[^wxy]$/)?t+"e":t:null});if(e)return e}return t}function h(t){var e=r(t);return"y"==t.substr(-1)&&-1<e.substr(0,e.length-1).indexOf("V")?t.replace(/y$/,"i"):t}function p(t){return u(t,[["ational","","ate"],["tional","","tion"],["enci","","ence"],["anci","","ance"],["izer","","ize"],["abli","","able"],["bli","","ble"],["alli","","al"],["entli","","ent"],["eli","","e"],["ousli","","ous"],["ization","","ize"],["ation","","ate"],["ator","","ate"],["alism","","al"],["iveness","","ive"],["fulness","","ful"],["ousness","","ous"],["aliti","","al"],["iviti","","ive"],["biliti","","ble"],["logi","","log"]],0)}function d(t){return u(t,[["icate","","ic"],["ative","",""],["alize","","al"],["iciti","","ic"],["ical","","ic"],["ful","",""],["ness","",""]],0)}function y(t){return c(t,/^(.+?)(al|ance|ence|er|ic|able|ible|ant|ement|ment|ent|ou|ism|ate|iti|ous|ive|ize)$/,[1],1)||c(t,/^(.+?)(s|t)(ion)$/,[1,2],1)||t}function v(t){var e=o(t.replace(/e$/,""));return(1<e||1==e&&("CVC"!=i(t).substr(-4,3)||!t.match(/[^wxy].$/)))&&(t=t.replace(/e$/,"")),t}function g(t){return 1<o(t)?t.replace(/ll$/,"l"):t}var m=new(n(597));(t.exports=m).stem=function(t){return t.length<3?t:g(v(y(d(p(h(f(l(t.toLowerCase())))))))).toString()},m.categorizeGroups=r,m.measure=o,m.step1a=l,m.step1b=f,m.step1c=h,m.step2=p,m.step3=d,m.step4=y,m.step5a=v,m.step5b=g},function(t,e,n){var r=n(598),i=n(599);t.exports=function(){var t=this;t.stem=function(t){return t},t.addStopWord=function(t){r.words.push(t)},t.addStopWords=function(t){r.words=r.words.concat(t)},t.removeStopWord=function(t){this.removeStopWords([t])},t.removeStopWords=function(t){t.forEach(function(t){var e=r.words.indexOf(t);0<=e&&r.words.splice(e,1)})},t.tokenizeAndStem=function(e,n){var o=[],a=e.toLowerCase(),s=(new i).tokenize(a);return n?s.forEach(function(e){o.push(t.stem(e))}):s.forEach(function(e){-1==r.words.indexOf(e)&&o.push(t.stem(e))}),o},t.attach=function(){String.prototype.stem=function(){return t.stem(this)},String.prototype.tokenizeAndStem=function(e){return t.tokenizeAndStem(this,e)}}}},function(t,e){e.words=["about","above","after","again","all","also","am","an","and","another","any","are","as","at","be","because","been","before","being","below","between","both","but","by","came","can","cannot","come","could","did","do","does","doing","during","each","few","for","from","further","get","got","has","had","he","have","her","here","him","himself","his","how","if","in","into","is","it","its","itself","like","make","many","me","might","more","most","much","must","my","myself","never","now","of","on","only","or","other","our","ours","ourselves","out","over","own","said","same","see","should","since","so","some","still","such","take","than","that","the","their","theirs","them","themselves","then","there","these","they","this","those","through","to","too","under","until","up","very","was","way","we","well","were","what","where","when","which","while","who","whom","with","would","why","you","your","yours","yourself","a","b","c","d","e","f","g","h","i","j","k","l","m","n","o","p","q","r","s","t","u","v","w","x","y","z","$","1","2","3","4","5","6","7","8","9","0","_"]},function(t,e,n){var r=n(235),i=function(){r.call(this)};n(98).inherits(i,r),(t.exports=i).prototype.tokenize=function(t){return this.trim(t.split(/\W+/))}},function(t,e,n){var r=n(601),i=n(208),o=n(669),a=n(273),s=n(670),u=n(671),c=n(91);t.exports=function(){this.use("/classify",new r);var t=this.service("classify");t.hooks({before:{all:[c()],create:[o("text")]},after:{create:[i(),a("action",{service:"actions"}),s(),u()]}});var e=this.service("trainings"),n=t.addTraining.bind(t),l=t.removeTraining.bind(t),f=function(t){l(t),n(t)};e.find({paginate:!1}).then(function(t){return t.forEach(n)}),e.on("created",n),e.on("removed",l),e.on("updated",f),e.on("patched",f)}},function(t,e,n){function r(t,e){for(var n=0;n<e.length;n++){var r=e[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(t,r.key,r)}}var i=n(602),o=n(230),a=n(666),s=n(34)("mysam-core:classifier-service");i.disableStopWords(),t.exports=function(){function t(){var e=0<arguments.length&&void 0!==arguments[0]?arguments[0]:{};!function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,t),this.classifier=new i(Object.assign({iterations:2e3},e))}var e,n;return e=t,(n=[{key:"retrain",value:function(){var t=this;(this._retrain||(this._retrain=a(function(){s("Retraining classifier"),t.classifier.retrain(),"function"==typeof t.emit&&(s("Sending 'trained' event"),t.emit("trained",t.classifier))},250))).call(this)}},{key:"removeTraining",value:function(t){this.classifier.removeDocument(t.text,t.action._id),this.retrain()}},{key:"addTraining",value:function(t){this.classifier.addDocument(t.text,t.action._id),this.retrain()}},{key:"create",value:function(t){var e=t.text,n=this.classifier.getClassifications(e);s("Classifications from natural-brain",n);var r=o(n,function(t){return t.value}),i={text:e,action:r.label,confidence:r.value};return s("Created classification",i),Promise.resolve(i)}}])&&r(e.prototype,n),t}()},function(t,e,n){function r(t){return(r="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t})(t)}function i(t,e){return!e||"object"!==r(e)&&"function"!=typeof e?function(t){if(void 0!==t)return t;throw new ReferenceError("this hasn't been initialised - super() hasn't been called")}(t):e}function o(t){return(o=Object.setPrototypeOf?Object.getPrototypeOf:function(t){return t.__proto__||Object.getPrototypeOf(t)})(t)}function a(t,e){return(a=Object.setPrototypeOf||function(t,e){return t.__proto__=e,t})(t,e)}var s=n(236),u=n(603),c=n(610),l=s.words.slice(),f=function(t){function e(t,n){var r;!function(t,n){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this);var a=new c(t);return(r=i(this,o(e).call(this,a,n))).options=t,r}return function(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function");t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,writable:!0,configurable:!0}}),e&&a(t,e)}(e,u),e}();f.restore=function(t,e,n){var r=new f(e||t.options,n);return r.classifier.brain.fromJSON(t.classifier.brain),r.docs=t.docs,r.features=t.features,r.train(),r},f.load=function(t,e,n,r){u.load(t,function(t,i){t&&r(t),"function"==typeof r&&r(t,f.restore(i,e,n))})},f.disableStopWords=function(){return s.words.splice(0,s.words.length),l},f.enableStopWords=function(){s.length||s.words.push.apply(s.words,l)},f.stopwords=s,t.exports=f},function(t,e,n){var r=n(604),i=(n(98),n(67)),o=n(608);try{var a=n(609)}catch(t){if("MODULE_NOT_FOUND"!==t.code)throw t}function s(){if(void 0===a)throw new Error("parallel classification requires the optional dependency webworker-threads")}var u=function(t,e){this.classifier=t,this.docs=[],this.features={},this.stemmer=e||r,this.lastAdded=0,this.events=new i.EventEmitter};function c(t){for(var e=[],n=0;n<t.length;n++){var r=[];for(var i in FEATURES)-1<t[n].observation.indexOf(i)?r.push(1):r.push(0);e.push({index:t[n].index,features:r})}return JSON.stringify(e)}u.prototype.addDocument=function(t,e){if(void 0!==e&&("string"==typeof e&&(e=e.trim()),"string"==typeof t&&(t=this.stemmer.tokenizeAndStem(t,this.keepStops)),0!==t.length)){this.docs.push({label:e,text:t});for(var n=0;n<t.length;n++){var r=t[n];this.features[r]=(this.features[r]||0)+1}}},u.prototype.removeDocument=function(t,e){var n,r,i=this.docs;"string"==typeof t&&(t=this.stemmer.tokenizeAndStem(t,this.keepStops));for(var o=0,a=i.length;o<a;o++)(n=i[o]).text.join(" ")==t.join(" ")&&n.label==e&&(r=o);if(!isNaN(r))for(this.docs.splice(r,1),o=0,a=t.length;o<a;o++)delete this.features[t[o]]},u.prototype.train=function(){for(var t=this.docs.length,e=this.lastAdded;e<t;e++){var n=this.textToFeatures(this.docs[e].text);this.classifier.addExample(n,this.docs[e].label),this.events.emit("trainedWithDocument",{index:e,total:t,doc:this.docs[e]}),this.lastAdded++}this.events.emit("doneTraining",!0),this.classifier.train()},u.prototype.trainParallel=function(t,e){s(),e||(e=t,t=void 0),isNaN(t)&&(t=o.cpus().length);var n=this.docs.length,r=a.createPool(t),i={},u=0,l=this;r.all.eval("var FEATURES = "+JSON.stringify(this.features)),r.all.eval(c);for(var f=[],h=this.lastAdded;h<n;h++){var p=this.docs[h].text;"string"==typeof p&&(p=this.stemmer.tokenizeAndStem(p,this.keepStops)),f.push({index:h,observation:p})}var d,y=function(e){setTimeout(function(){l.events.emit("processedBatch",{size:e.length,docs:n,batches:t,index:u})});for(var r=0;r<e.length;r++)i[e[r].index]=e[r].features},v=function(t){if(t)return r.destroy(),e(t);for(var o=l.lastAdded;o<n;o++)l.classifier.addExample(i[o],l.docs[o].label),l.events.emit("trainedWithDocument",{index:o,total:n,doc:l.docs[o]}),l.lastAdded++;l.events.emit("doneTraining",!0),l.classifier.train(),r.destroy(),e(null)},g=Math.ceil(f.length/t);for(h=0;h<t;h++){var m=f.slice(h*g,(h+1)*g),b=JSON.stringify(m);r.any.eval("docsToFeatures("+b+")",function(e,n){d=e||d,u++,n&&(n=JSON.parse(n),y(n)),t<=u&&v(d)})}},u.prototype.trainParallelBatches=function(t){s();var e=t&&t.numThreads,n=t&&t.batchSize;isNaN(e)&&(e=o.cpus().length),isNaN(n)&&(n=2500);var r=this.docs.length,i=a.createPool(e),u={},l=0,f=this,h=!1,p=function(t){t&&!h&&(h=!0,i.destroy(!0),f.events.emit("doneTrainingError",t))},d=JSON.stringify(this.features);i.all.eval("var FEATURES = "+d+";",p),i.all.eval(c,p);for(var y=[],v=this.lastAdded;v<r;v++){var g=this.docs[v].text;"string"==typeof g&&(g=this.stemmer.tokenizeAndStem(g,this.keepStops)),y.push({index:v,observation:g})}var m=[];for(v=0;;){var b=y.slice(v*n,(v+1)*n);if(!b||!b.length)break;m.push(b),v++}y=null,f.events.emit("startedTraining",{docs:r,batches:m.length});var x=function(){i.destroy(!0),h=!0;for(var t=f.lastAdded;t<r;t++)f.classifier.addExample(u[t],f.docs[t].label),f.events.emit("trainedWithDocument",{index:t,total:r,doc:f.docs[t]}),f.lastAdded++;f.events.emit("doneTraining",!0),f.classifier.train()},_=0,w=function(){h||_>=m.length||(S(JSON.stringify(m[_])),_++)},S=function(t){h||i.any.eval("docsToFeatures("+t+");",function(t,e){if(t)return p(t);l++,e&&(e=JSON.parse(e),setTimeout(function(t){f.events.emit("processedBatch",{size:t.length,docs:r,batches:m.length,index:l});for(var e=0;e<t.length;e++)u[t[e].index]=t[e].features}.bind(null,e))),l>=m.length&&setTimeout(x),setTimeout(w)})};for(v=0;v<e;v++)w()},u.prototype.retrain=function(){this.classifier=new this.classifier.constructor,this.lastAdded=0,this.train()},u.prototype.retrainParallel=function(t,e){this.classifier=new this.classifier.constructor,this.lastAdded=0,this.trainParallel(t,e)},u.prototype.classify=function(t){return this.classifier.classify(this.textToFeatures(t))},u.prototype.textToFeatures=function(t){var e=[];for(var n in"string"==typeof t&&(t=this.stemmer.tokenizeAndStem(t,this.keepStops)),this.features)-1<t.indexOf(n)?e.push(1):e.push(0);return e},u.prototype.save=function(t,e){var r=JSON.stringify(this),i=n(237),o=this;i.writeFile(t,r,"utf8",function(t){e&&e(t,t?null:o)})},u.prototype.getClassifications=function(t){return this.classifier.getClassifications(this.textToFeatures(t))},u.prototype.setOptions=function(t){this.keepStops=!!t.keepStops},u.restore=function(t,e){return t.stemmer=e||r,t.events=new i.EventEmitter,t},u.load=function(t,e){n(237).readFile(t,"utf8",function(t,n){var r;t||(r=JSON.parse(n)),e&&e(t,r)})},t.exports=u},function(t,e,n){function r(t){return t.replace(/[^aeiouy]+y/g,"CV").replace(/[aeiou]+/g,"V").replace(/[^V]+/g,"C")}function i(t){return t.replace(/[^aeiouy]y/g,"CV").replace(/[aeiou]/g,"V").replace(/[^V]/g,"C")}function o(t){return t?r(t).replace(/^C/,"").replace(/V$/,"").length/2:-1}function a(t,e,n,r){var i=null;return"string"==typeof e&&t.substr(0-e.length)==e?i=t.replace(new RegExp(e+"$"),n):e instanceof RegExp&&t.match(e)&&(i=t.replace(e,n)),i&&r?r(i):i}function s(t,e,n){for(var r=t,i=0;i<e.length;i++)(null==n||o(a(t,e[i][0],e[i][1]))>n)&&(r=a(r,e[i][0],e[i][2])||r);return r}function u(t,e,n){return s(t,e,n)||t}function c(t,e,n,r){var i,a="";return e.test(t)&&(i=e.exec(t),n.forEach(function(t){a+=i[t]})),o(a)>r?a:null}function l(t){return t.match(/(ss|i)es$/)?t.replace(/(ss|i)es$/,"$1"):"s"==t.substr(-1)&&"s"!=t.substr(-2,1)&&2<t.length?t.replace(/s?$/,""):t}function f(t){if("eed"==t.substr(-3)){if(0<o(t.substr(0,t.length-3)))return t.replace(/eed$/,"ee")}else{var e=a(t,/(ed|ing)$/,"",function(t){return 0<=r(t).indexOf("V")?(e=s(t,[["at","","ate"],["bl","","ble"],["iz","","ize"]]))!=t?e:t.match(/([^aeiou])\1$/)&&t.match(/[^lsz]$/)?t.replace(/([^aeiou])\1$/,"$1"):1==o(t)&&"CVC"==i(t).substr(-3)&&t.match(/[^wxy]$/)?t+"e":t:null});if(e)return e}return t}function h(t){var e=r(t);return"y"==t.substr(-1)&&-1<e.substr(0,e.length-1).indexOf("V")?t.replace(/y$/,"i"):t}function p(t){return u(t,[["ational","","ate"],["tional","","tion"],["enci","","ence"],["anci","","ance"],["izer","","ize"],["abli","","able"],["bli","","ble"],["alli","","al"],["entli","","ent"],["eli","","e"],["ousli","","ous"],["ization","","ize"],["ation","","ate"],["ator","","ate"],["alism","","al"],["iveness","","ive"],["fulness","","ful"],["ousness","","ous"],["aliti","","al"],["iviti","","ive"],["biliti","","ble"],["logi","","log"]],0)}function d(t){return u(t,[["icate","","ic"],["ative","",""],["alize","","al"],["iciti","","ic"],["ical","","ic"],["ful","",""],["ness","",""]],0)}function y(t){return c(t,/^(.+?)(al|ance|ence|er|ic|able|ible|ant|ement|ment|ent|ou|ism|ate|iti|ous|ive|ize)$/,[1],1)||c(t,/^(.+?)(s|t)(ion)$/,[1,2],1)||t}function v(t){var e=o(t.replace(/e$/,""));return(1<e||1==e&&("CVC"!=i(t).substr(-4,3)||!t.match(/[^wxy].$/)))&&(t=t.replace(/e$/,"")),t}function g(t){return 1<o(t)?t.replace(/ll$/,"l"):t}var m=new(n(605));(t.exports=m).stem=function(t){return t.length<3?t:g(v(y(d(p(h(f(l(t.toLowerCase())))))))).toString()},m.categorizeGroups=r,m.measure=o,m.step1a=l,m.step1b=f,m.step1c=h,m.step2=p,m.step3=d,m.step4=y,m.step5a=v,m.step5b=g},function(t,e,n){var r=n(236),i=n(606);t.exports=function(){var t=this;t.stem=function(t){return t},t.addStopWord=function(t){r.words.push(t)},t.addStopWords=function(t){r.words=r.words.concat(t)},t.removeStopWord=function(t){this.removeStopWords([t])},t.removeStopWords=function(t){t.forEach(function(t){var e=r.words.indexOf(t);0<=e&&r.words.splice(e,1)})},t.tokenizeAndStem=function(e,n){var o=[],a=e.toLowerCase(),s=(new i).tokenize(a);return n?s.forEach(function(e){o.push(t.stem(e))}):s.forEach(function(e){-1==r.words.indexOf(e)&&o.push(t.stem(e))}),o},t.attach=function(){String.prototype.stem=function(){return t.stem(this)},String.prototype.tokenizeAndStem=function(e){return t.tokenizeAndStem(this,e)}}}},function(t,e,n){var r=n(607),i=function(){r.call(this)};n(98).inherits(i,r),(t.exports=i).prototype.tokenize=function(t){return this.trim(t.split(/\W+/))}},function(t,e){var n=function(){};n.prototype.trim=function(t){for(;""==t[t.length-1];)t.pop();for(;""==t[0];)t.shift();return t},n.prototype.attach=function(){var t=this;String.prototype.tokenize=function(){return t.tokenize(this)}},n.prototype.tokenize=function(){},t.exports=n},function(t,e){e.endianness=function(){return"LE"},e.hostname=function(){return"undefined"!=typeof location?location.hostname:""},e.loadavg=function(){return[]},e.uptime=function(){return 0},e.freemem=function(){return Number.MAX_VALUE},e.totalmem=function(){return Number.MAX_VALUE},e.cpus=function(){return[]},e.type=function(){return"Browser"},e.release=function(){return"undefined"!=typeof navigator?navigator.appVersion:""},e.networkInterfaces=e.getNetworkInterfaces=function(){return{}},e.arch=function(){return"javascript"},e.platform=function(){return"browser"},e.tmpdir=e.tmpDir=function(){return"/tmp"},e.EOL="\n",e.homedir=function(){return"/"}},function(t,e){},function(t,e,n){function r(t,e){for(var n=0;n<e.length;n++){var r=e[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(t,r.key,r)}}var i=n(611),o=n(665);t.exports=function(){function t(e){!function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,t),this.brain=new i.NeuralNetwork(e),this.data=[],this.options=e}var e,n;return e=t,(n=[{key:"addExample",value:function(t,e){var n,r;this.data.push({input:t,output:(n={},r=e,1,r in n?Object.defineProperty(n,r,{value:1,enumerable:!0,configurable:!0,writable:!0}):n[r]=1,n)})}},{key:"train",value:function(t){return this.brain.train(this.data,t)}},{key:"getClassifications",value:function(t){var e=this.brain.run(t);return Object.keys(e).map(function(t){return{label:t,value:e[t]}})}},{key:"classify",value:function(t){var e=this.getClassifications(t),n=o(e,function(t){return t.value});return n?n.label:null}}])&&r(e.prototype,n),t}()},function(t,e,n){var r={CrossValidate:n(612).default,likely:n(613).default,lookup:n(99).default,NeuralNetwork:n(156).default,NeuralNetworkGPU:n(616).default,TrainStream:n(629).default,recurrent:{RNNTimeStep:n(165).default,LSTMTimeStep:n(662).default,GRUTimeStep:n(663).default,RNN:n(106).default,LSTM:n(271).default,GRU:n(272).default},utilities:{max:n(239).default,mse:n(240).default,ones:n(266).default,random:n(75).default,randomWeight:n(242).default,randos:n(241).default,range:n(243).default,toArray:n(157).default,DataFormatter:n(270).default,zeros:n(72).default,toSVG:n(664).default}};"undefined"!=typeof window&&(window.brain=r),"undefined"!=typeof self&&(self.brain=r),t.exports=r},function(t,e,n){"use strict";Object.defineProperty(e,"__esModule",{value:!0});var r=function(){function t(t,e){for(var n=0;n<e.length;n++){var r=e[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(t,r.key,r)}}return function(e,n,r){return n&&t(e.prototype,n),r&&t(e,r),e}}(),i=function(){function t(e,n){!function(e,n){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this),this.Classifier=e,this.options=n,this.json=null}return r(t,[{key:"testPartition",value:function(t,e,n){var r=new this.Classifier(this.options),i=Date.now(),o=r.train(e,t),a=Date.now(),s=r.test(n),u=Date.now();return Object.assign({},s,{trainTime:a-i,testTime:u-a,iterations:o.iterations,error:o.error,total:s.total,learningRate:r.trainOpts.learningRate,hiddenLayers:r.hiddenLayers,network:r.toJSON()})}},{key:"shuffleArray",value:function(t){for(var e=t.length-1;0<e;e--){var n=Math.floor(Math.random()*(e+1)),r=t[e];t[e]=t[n],t[n]=r}return t}},{key:"train",value:function(t){var e=1<arguments.length&&void 0!==arguments[1]?arguments[1]:{},n=2<arguments.length&&void 0!==arguments[2]?arguments[2]:4;if(t.length<n)throw new Error("Training set size is too small for "+t.length+" k folds of "+n);var r=t.length/n;if(t.constructor===Array)this.shuffleArray(t);else{var i={};this.shuffleArray(Object.keys(t)).forEach(function(e){i[e]=t[e]}),t=i}for(var o={trainTime:0,testTime:0,iterations:0,error:0},a={total:0},s={total:0,truePos:0,trueNeg:0,falsePos:0,falseNeg:0},u=[],c=void 0,l=null,f=0;f<n;f++){var h=t.slice(0),p=h.splice(f*r,r),d=h,y=this.testPartition(e,d,p);for(c in null===l&&(l=y.hasOwnProperty("falseNeg")&&y.hasOwnProperty("falsePos")&&y.hasOwnProperty("trueNeg")&&y.hasOwnProperty("truePos"))&&Object.assign(a,s),o)c in o&&(o[c]+=y[c]);for(c in a)c in a&&(a[c]+=y[c]);u.push(y)}for(c in o)c in o&&(o[c]/=n);return l&&(a.precision=a.truePos/(a.truePos+a.falsePos),a.recall=a.truePos/(a.truePos+a.falseNeg),a.accuracy=(a.trueNeg+a.truePos)/a.total),a.testSize=r,a.trainSize=t.length-r,this.json={avgs:o,stats:a,sets:u}}},{key:"toNeuralNetwork",value:function(){return this.fromJSON(this.json)}},{key:"toJSON",value:function(){return this.json}},{key:"fromJSON",value:function(t){var e=this.Classifier,n=t.sets.reduce(function(t,e){return t.error<e.error?t:e},{error:1/0}).network;if(e.fromJSON)return e.fromJSON(n);var r=new e;return r.fromJSON(n),r}}]),t}();e.default=i},function(t,e,n){"use strict";Object.defineProperty(e,"__esModule",{value:!0}),e.default=function(t,e){var n=e.run(t),r=null,i=-1;for(var o in n){var a=n[o];i<a&&(r=o,i=a)}return r}},function(t,e,n){"use strict";Object.defineProperty(e,"__esModule",{value:!0});var r=Object.assign||function(t){for(var e=1;e<arguments.length;e++){var n=arguments[e];for(var r in n)Object.prototype.hasOwnProperty.call(n,r)&&(t[r]=n[r])}return t},i=function(){function t(t,e){for(var n=0;n<e.length;n++){var r=e[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(t,r.key,r)}}return function(e,n,r){return n&&t(e.prototype,n),r&&t(e,r),e}}(),o=!(e.thaw=function(t){var e=1<arguments.length&&void 0!==arguments[1]?arguments[1]:{};return new s(t,e)}),a=[],s=function(){function t(e){var n=this,i=1<arguments.length&&void 0!==arguments[1]?arguments[1]:{};!function(e,n){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this);var s=r({},this.constructor.defaultSettings,i),u=s.each,c=s.done;this.items=e,this.i=0,this.options=i;var l=this.tick=function(){if(!(n.i<0||(n.timeout=setTimeout(l,0),o))){var t=e[n.i];if(n.i>=e.length)return null!==c&&(o=!0,c(t,n.i),o=!1),n.i=-1,void clearTimeout(n.timeout);null!==u?(o=!0,u(t,n.i),o=!1):void 0!==t&&t(),n.i++}};a.push(this),i.delay||l()}return i(t,null,[{key:"stopAll",value:function(){for(var t=0;t<a.length;t++)a[t].stop()}},{key:"defaultSettings",get:function(){return{each:null,done:null}}},{key:"isThawing",get:function(){return o}}]),i(t,[{key:"makeReady",value:function(){return this.i<0&&(this.i=this.items.length,!0)}},{key:"add",value:function(t){var e=this.makeReady();return this.items.push(t),e&&this.tick(),this}},{key:"insert",value:function(t){var e=this.makeReady();return this.items.splice(this.i,0,t),e&&this.tick(),this}},{key:"addArray",value:function(t){var e=this.makeReady();return this.items=this.items.concat(t),e&&this.tick(),this}},{key:"insertArray",value:function(t){var e=this.makeReady(),n=this.items,r=t,i=this.items.splice(this.i,this.items.length-this.i+1);return this.items=n.concat(r,i),e&&this.tick(),this}},{key:"stop",value:function(){return this.i=-1,clearTimeout(this.timeout),this.options.done&&this.options.done(),this}}]),t}();e.default=s},function(t,e,n){"use strict";Object.defineProperty(e,"__esModule",{value:!0});var r,i=function(){function t(t,e){for(var n=0;n<e.length;n++){var r=e[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(t,r.key,r)}}return function(e,n,r){return n&&t(e.prototype,n),r&&t(e,r),e}}(),o=(r=n(238))&&r.__esModule?r:{default:r},a=function(){function t(e,n){!function(e,n){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this),this.index=0,this.thaws=[],this.count=n||200,this.options=e}return i(t,[{key:"add",value:function(t){return this._next().add(t),this}},{key:"addArray",value:function(t){return this._next().addArray(t),this}},{key:"insert",value:function(t){return this._next().insert(t),this}},{key:"insertArray",value:function(t){return this._next().insertArray(t),this}},{key:"stop",value:function(){for(var t=0;t<this.thaws.length;t++)this.thaws[t].stop();return this}},{key:"_next",value:function(){var t=null,e=this.thaws;return e.length<this.count?e.push(t=new o.default([],this.options)):t=e[this.index],this.index++,this.index>=this.count&&(this.index=0),t}}]),t}();e.default=a},function(t,e,n){"use strict";function r(t){return(r="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t})(t)}Object.defineProperty(e,"__esModule",{value:!0});var i=function(){function t(t,e){for(var n=0;n<e.length;n++){var r=e[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(t,r.key,r)}}return function(e,n,r){return n&&t(e.prototype,n),r&&t(e,r),e}}(),o=function t(e,n,r){null===e&&(e=Function.prototype);var i=Object.getOwnPropertyDescriptor(e,n);if(void 0===i){var o=Object.getPrototypeOf(e);return null===o?void 0:t(o,n,r)}if("value"in i)return i.value;var a=i.get;return void 0!==a?a.call(r):void 0},a=c(n(156)),s=c(n(99)),u=c(n(100));function c(t){return t&&t.__esModule?t:{default:t}}var l=function(t){function e(){var t=0<arguments.length&&void 0!==arguments[0]?arguments[0]:{};!function(t,n){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this);var n=function(t,e){if(!t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!e||"object"!==r(e)&&"function"!=typeof e?t:e}(this,(e.__proto__||Object.getPrototypeOf(e)).call(this,t));return n.forwardPropagate=[],n.backwardPropagate=[],n.changesPropagate=[],n.biasesPropagate=[],n.biasCopies=[],n.copyBias=[],n.changesCopies=[],n.copyChanges=[],n.weightsCopies=[],n.copyWeights=[],n.errorCheckInterval=100,n.gpu=new u.default({mode:t.mode}),n}return function(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function, not "+r(e));t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,enumerable:!1,writable:!0,configurable:!0}}),e&&(Object.setPrototypeOf?Object.setPrototypeOf(t,e):t.__proto__=e)}(e,a.default),i(e,[{key:"initialize",value:function(){o(e.prototype.__proto__||Object.getPrototypeOf(e.prototype),"initialize",this).call(this),this.buildRunInput(),this.buildCalculateDeltas(),this.buildGetChanges(),this.buildChangeBiases(),this.buildGetMSE()}},{key:"setActivation",value:function(){}},{key:"trainPattern",value:function(t,e){return this.runInput(t.input),this.calculateDeltas(t.output),this.adjustWeights(),e?this.getMSE(this.errors[this.outputLayer])[0]:null}},{key:"adjustWeights",value:function(){this.getChanges(),this.changeBiases()}},{key:"buildRunInput",value:function(){var t=null;switch(this.activation){case"sigmoid":t=f;break;case"relu":t=h;break;case"leaky-relu":t=p;break;case"tanh":t=d;break;default:throw new Error("unknown activation "+this.activation)}for(var e=1;e<=this.outputLayer;e++)this.forwardPropagate[e]=this.gpu.createKernel(t,{output:[this.sizes[e]],outputToTexture:!0,hardcodeConstants:!0,constants:{size:this.sizes[e-1]}});this.texturizeInputData=this.gpu.createKernel(function(t){return t[this.thread.x]},{output:[this.sizes[1]],outputToTexture:!0,hardcodeConstants:!0,outputImmutable:!0})}},{key:"runInput",value:function(t){var e=void 0;this.outputs[0]=t;for(var n=1;n<=this.outputLayer;n++)this.outputs[n]=this.forwardPropagate[n](this.weights[n],this.biases[n],t),e=t=this.outputs[n];return e}},{key:"buildCalculateDeltas",value:function(){var t=null;switch(this.activation){case"sigmoid":t=v;break;case"relu":t=g;break;case"leaky-relu":t=m;break;case"tanh":t=b;break;default:throw new Error("unknown activation "+this.activation)}for(var e=this.outputLayer;0<e;e--)e===this.outputLayer?this.backwardPropagate[e]=this.gpu.createKernelMap({error:u.default.alias("calcErrorOutput",y),deltas:u.default.alias("calcDeltas",t)},function(e,n){var r=e[this.thread.x];return t(y(r,n),r)},{output:[this.sizes[e]],outputToTexture:!0,hardcodeConstants:!0}):this.backwardPropagate[e]=this.gpu.createKernelMap({error:u.default.alias("calcError",x),deltas:u.default.alias("calcDeltas",t)},function(e,n,r){var i=n[this.thread.x];return t(x(e,r),i)},{output:[this.sizes[e]],outputToTexture:!0,hardcodeConstants:!0,constants:{size:this.deltas[e+1].length}})}},{key:"calculateDeltas",value:function(t){for(var e=this.outputLayer;0<e;e--){var n;n=e===this.outputLayer?this.backwardPropagate[e](this.outputs[e],t):this.backwardPropagate[e](this.weights[e+1],this.outputs[e],this.deltas[e+1]),this.deltas[e]=n.deltas,this.errors[e]=n.error}}},{key:"buildGetChanges",value:function(){for(var t=1;t<=this.outputLayer;t++)this.changesPropagate[t]=this.gpu.createKernelMap({weights:u.default.alias("addWeights",w),changes:u.default.alias("calcChanges",_)},function(t,e,n,r){return w(_(r,e,t),n)},{output:[this.sizes[t-1],this.sizes[t]],outputToTexture:!0,hardcodeConstants:!0,constants:{size:this.outputs[t-1].length,learningRate:this.trainOpts.learningRate,momentum:this.trainOpts.momentum}}),this.copyChanges[t]=this.gpu.createKernel(function(t){return t[this.thread.y][this.thread.x]},{output:this.changesPropagate[t].output,outputToTexture:!0,hardCodeConstants:!0}),this.copyWeights[t]=this.gpu.createKernel(function(t){return t[this.thread.y][this.thread.x]},{output:this.changesPropagate[t].output,outputToTexture:!0,hardCodeConstants:!0})}},{key:"getChanges",value:function(){for(var t=1;t<=this.outputLayer;t++){var e=this.changesPropagate[t](this.outputs[t-1],this.deltas[t],this.weightsCopies[t]||this.weights[t],this.changesCopies[t]||this.changes[t]);this.changes[t]=e.changes,this.weights[t]=e.weights,this.changesCopies[t]=this.copyChanges[t](e.changes),this.weightsCopies[t]=this.copyWeights[t](e.weights)}}},{key:"buildChangeBiases",value:function(){for(var t=1;t<=this.outputLayer;t++)this.biasesPropagate[t]=this.gpu.createKernel(S,{output:[this.sizes[t]],outputToTexture:!0,hardcodeConstants:!0,constants:{learningRate:this.trainOpts.learningRate}}),this.copyBias[t]=this.gpu.createKernel(function(t){return t[this.thread.x]},{output:this.biasesPropagate[t].output,outputToTexture:!0,hardCodeConstants:!0})}},{key:"changeBiases",value:function(){for(var t=1;t<=this.outputLayer;t++)this.biases[t]=this.biasesPropagate[t](this.biasCopies[t]||this.biases[t],this.deltas[t]),this.biasCopies[t]=this.copyBias[t](this.biases[t])}},{key:"buildGetMSE",value:function(){this.getMSE=this.gpu.createKernel(E,{output:[1],hardcodeConstants:!0,constants:{size:this.sizes[this.outputLayer]}})}},{key:"run",value:function(t){if(!this.isRunnable)return null;this.inputLookup&&(t=s.default.toArray(this.inputLookup,t,this.inputLookupLength));var e=this.texturizeInputData(t),n=this.runInput(e),r=void 0;return r=n.toArray?n.toArray(this.gpu):n,this.outputLookup&&(r=s.default.toObject(this.outputLookup,r)),r}},{key:"prepTraining",value:function(t,e){var n=this;this.updateTrainingOptions(e),t=this.formatData(t);var r=Date.now()+this.trainOpts.timeout;this.verifyIsInitialized(t);var i=this.gpu.createKernel(function(t){return t[this.thread.x]},{output:[t[0].output.length],outputToTexture:!0,hardcodeConstants:!0,outputImmutable:!0});return{data:t.map(function(t){return{input:n.texturizeInputData(t.input),output:i(t.output)}}),status:{error:1,iterations:0},endTime:r}}},{key:"toJSON",value:function(){var t=this;if(!this.weights[1].toArray)return o(e.prototype.__proto__||Object.getPrototypeOf(e.prototype),"toJSON",this).call(this);for(var n=[],r=[],i=1;i<=this.outputLayer;i++)n[i]=Array.from(this.weights[i].toArray(this.gpu)),r[i]=Array.from(this.biases[i].toArray(this.gpu));return a.default.prototype.toJSON.call({inputLookup:this.inputLookup,outputLookup:this.outputLookup,outputLayer:this.outputLayer,sizes:this.sizes,getTrainOptsJSON:function(){return t.getTrainOptsJSON()},weights:n,biases:r})}}]),e}();function f(t,e,n){for(var r=e[this.thread.x],i=0;i<this.constants.size;i++)r+=t[this.thread.x][i]*n[i];return 1/(1+Math.exp(-r))}function h(t,e,n){for(var r=e[this.thread.x],i=0;i<this.constants.size;i++)r+=t[this.thread.x][i]*n[i];return r<0?0:r}function p(t,e,n){for(var r=e[this.thread.x],i=0;i<this.constants.size;i++)r+=t[this.thread.x][i]*n[i];return r<0?0:.01*r}function d(t,e,n){for(var r=e[this.thread.x],i=0;i<this.constants.size;i++)r+=t[this.thread.x][i]*n[i];return Math.tanh(r)}function y(t,e){return e[this.thread.x]-t}function v(t,e){return t*e*(1-e)}function g(t,e){return 0<e?t:0}function m(t,e){return 0<e?t:.01*t}function b(t,e){return(1-e*e)*t}function x(t,e){for(var n=0,r=0;r<this.constants.size;r++)n+=e[r]*t[r][this.thread.x];return n}function _(t,e,n){return this.constants.learningRate*e[this.thread.y]*n[this.thread.x]+this.constants.momentum*t[this.thread.y][this.thread.x]}function w(t,e){return t+e[this.thread.y][this.thread.x]}function S(t,e){return t[this.thread.x]+e[this.thread.x]*this.constants.learningRate}function E(t){for(var e=0,n=0;n<this.constants.size;n++)e+=Math.pow(t[n],2);return e/this.constants.size}e.default=l},function(t,e,n){"use strict";function r(t){return(r="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t})(t)}var i=function(){function t(t,e){for(var n=0;n<e.length;n++){var r=e[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(t,r.key,r)}}return function(e,n,r){return n&&t(e.prototype,n),r&&t(e,r),e}}(),o=n(10),a=n(247),s=n(251),u=n(254),c=n(625),l=n(626),f=n(627),h=function(t){function e(t){!function(t,n){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this);var n=function(t,e){if(!t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!e||"object"!==r(e)&&"function"!=typeof e?t:e}(this,(e.__proto__||Object.getPrototypeOf(e)).call(this,t));t=t||{},n._canvas=t.canvas||null,n._webGl=t.webGl||null;var i=t.mode,f=void 0;if(o.isWebGlSupported())if(n._webGl)if("undefined"!=typeof WebGL2RenderingContext&&n._webGl.constructor===WebGL2RenderingContext)f="webgl2";else{if("undefined"==typeof WebGLRenderingContext||n._webGl.constructor!==WebGLRenderingContext)throw new Error("unknown WebGL Context");f="webgl"}else f=i||"gpu";else{if(i&&"cpu"!==i)throw new Error('A requested mode of "'+i+'" and is not supported');console.warn("Warning: gpu not supported, falling back to cpu support"),f="cpu"}n.kernels=[];var h={canvas:n._canvas,webGl:n._webGl};switch(f){case"cpu":n._runner=new u(h);break;case"gpu":var p=n.getGPURunner();n._runner=new p(h);break;case"webgl2":n._runner=new s(h);break;case"webgl":n._runner=new a(h);break;case"webgl2-validator":n._runner=new s(h),n._runner.Kernel=l;break;case"webgl-validator":n._runner=new a(h),n._runner.Kernel=c;break;default:throw new Error('"'+i+'" mode is not defined')}return n}return function(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function, not "+r(e));t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,enumerable:!1,writable:!0,configurable:!0}}),e&&(Object.setPrototypeOf?Object.setPrototypeOf(t,e):t.__proto__=e)}(e,f),i(e,[{key:"createKernel",value:function(t,e){if(void 0===t)throw"Missing fn parameter";if(!o.isFunction(t)&&"string"!=typeof t)throw"fn parameter not a function";var n=Object.assign({webGl:this._webGl,canvas:this._canvas},e||{}),r=this._runner.buildKernel(t,n);return this._canvas||(this._canvas=r.getCanvas()),this._runner.canvas||(this._runner.canvas=r.getCanvas()),this.kernels.push(r),r}},{key:"createKernelMap",value:function(){var t=void 0,e=void 0;"function"==typeof arguments[arguments.length-2]?(t=arguments[arguments.length-2],e=arguments[arguments.length-1]):t=arguments[arguments.length-1],o.isWebGlDrawBuffersSupported()||(this._runner=new u(e));var n=this.createKernel(t,e);if(Array.isArray(arguments[0]))for(var r=arguments[0],i=0;i<r.length;i++)n.addSubKernel(r[i]);else{var a=arguments[0];for(var s in a)a.hasOwnProperty(s)&&n.addSubKernelProperty(s,a[s])}return n}},{key:"combineKernels",value:function(){var t=arguments[arguments.length-2],e=arguments[arguments.length-1];if("cpu"===this.getMode())return e;for(var n=arguments[0].getCanvas(),r=arguments[0].getWebGl(),i=0;i<arguments.length-1;i++)arguments[i].setCanvas(n).setWebGl(r).setOutputToTexture(!0);return function(){e.apply(null,arguments);var n=t.texSize,r=t.getWebGl(),i=t.threadDim,a=void 0;if(t.floatOutput){var s=n[0],u=Math.ceil(n[1]/4);a=new Float32Array(s*u*4),r.readPixels(0,0,s,u,r.RGBA,r.FLOAT,a)}else{var c=new Uint8Array(n[0]*n[1]*4);r.readPixels(0,0,n[0],n[1],r.RGBA,r.UNSIGNED_BYTE,c),a=new Float32Array(c.buffer)}return a=a.subarray(0,i[0]*i[1]*i[2]),1===t.output.length?a:2===t.output.length?o.splitArray(a,t.output[0]):3===t.output.length?o.splitArray(a,t.output[0]*t.output[1]).map(function(e){return o.splitArray(e,t.output[0])}):void 0}}},{key:"getGPURunner",value:function(){return"undefined"!=typeof WebGL2RenderingContext&&o.isWebGl2Supported()?s:"undefined"!=typeof WebGLRenderingContext?a:void 0}},{key:"addFunction",value:function(t,e){return this._runner.functionBuilder.addFunction(null,t,e),this}},{key:"addNativeFunction",value:function(t,e){return this._runner.functionBuilder.addNativeFunction(t,e),this}},{key:"getMode",value:function(){return this._runner.getMode()}},{key:"isWebGlSupported",value:function(){return o.isWebGlSupported()}},{key:"hasIntegerDivisionAccuracyBug",value:function(){return o.hasIntegerDivisionAccuracyBug()}},{key:"getCanvas",value:function(){return this._canvas}},{key:"getWebGl",value:function(){return this._webGl}},{key:"destroy",value:function(){var t=this;setTimeout(function(){for(var e=t.kernels,n=!t._webGl&&e.length&&e[0]._webGl,r=0;r<t.kernels.length;r++)t.kernels[r].destroy(!0);if(n){n.OES_texture_float=null,n.OES_texture_float_linear=null,n.OES_element_index_uint=null;var i=n.getExtension("WEBGL_lose_context");i&&i.loseContext()}},0)}}]),e}();Object.assign(h,f),t.exports=h},function(t,e,n){"use strict";t.exports="__HEADER__;\nprecision highp float;\nprecision highp int;\nprecision highp sampler2D;\n\nconst float LOOP_MAX = __LOOP_MAX__;\n\n__CONSTANTS__;\n\nvarying vec2 vTexCoord;\n\nvec4 round(vec4 x) {\n  return floor(x + 0.5);\n}\n\nfloat round(float x) {\n  return floor(x + 0.5);\n}\n\nvec2 integerMod(vec2 x, float y) {\n  vec2 res = floor(mod(x, y));\n  return res * step(1.0 - floor(y), -res);\n}\n\nvec3 integerMod(vec3 x, float y) {\n  vec3 res = floor(mod(x, y));\n  return res * step(1.0 - floor(y), -res);\n}\n\nvec4 integerMod(vec4 x, vec4 y) {\n  vec4 res = floor(mod(x, y));\n  return res * step(1.0 - floor(y), -res);\n}\n\nfloat integerMod(float x, float y) {\n  float res = floor(mod(x, y));\n  return res * (res > floor(y) - 1.0 ? 0.0 : 1.0);\n}\n\nint integerMod(int x, int y) {\n  return x - (y * int(x / y));\n}\n\n__DIVIDE_WITH_INTEGER_CHECK__;\n\n// Here be dragons!\n// DO NOT OPTIMIZE THIS CODE\n// YOU WILL BREAK SOMETHING ON SOMEBODY'S MACHINE\n// LEAVE IT AS IT IS, LEST YOU WASTE YOUR OWN TIME\nconst vec2 MAGIC_VEC = vec2(1.0, -256.0);\nconst vec4 SCALE_FACTOR = vec4(1.0, 256.0, 65536.0, 0.0);\nconst vec4 SCALE_FACTOR_INV = vec4(1.0, 0.00390625, 0.0000152587890625, 0.0); // 1, 1/256, 1/65536\nfloat decode32(vec4 rgba) {\n  __DECODE32_ENDIANNESS__;\n  rgba *= 255.0;\n  vec2 gte128;\n  gte128.x = rgba.b >= 128.0 ? 1.0 : 0.0;\n  gte128.y = rgba.a >= 128.0 ? 1.0 : 0.0;\n  float exponent = 2.0 * rgba.a - 127.0 + dot(gte128, MAGIC_VEC);\n  float res = exp2(round(exponent));\n  rgba.b = rgba.b - 128.0 * gte128.x;\n  res = dot(rgba, SCALE_FACTOR) * exp2(round(exponent-23.0)) + res;\n  res *= gte128.y * -2.0 + 1.0;\n  return res;\n}\n\nvec4 encode32(float f) {\n  float F = abs(f);\n  float sign = f < 0.0 ? 1.0 : 0.0;\n  float exponent = floor(log2(F));\n  float mantissa = (exp2(-exponent) * F);\n  // exponent += floor(log2(mantissa));\n  vec4 rgba = vec4(F * exp2(23.0-exponent)) * SCALE_FACTOR_INV;\n  rgba.rg = integerMod(rgba.rg, 256.0);\n  rgba.b = integerMod(rgba.b, 128.0);\n  rgba.a = exponent*0.5 + 63.5;\n  rgba.ba += vec2(integerMod(exponent+127.0, 2.0), sign) * 128.0;\n  rgba = floor(rgba);\n  rgba *= 0.003921569; // 1/255\n  __ENCODE32_ENDIANNESS__;\n  return rgba;\n}\n// Dragons end here\n\nfloat decode(vec4 rgba, int x, int bitRatio) {\n  if (bitRatio == 1) {\n    return decode32(rgba);\n  }\n  __DECODE32_ENDIANNESS__;\n  int channel = integerMod(x, bitRatio);\n  if (bitRatio == 4) {\n    if (channel == 0) return rgba.r * 255.0;\n    if (channel == 1) return rgba.g * 255.0;\n    if (channel == 2) return rgba.b * 255.0;\n    if (channel == 3) return rgba.a * 255.0;\n  }\n  else {\n    if (channel == 0) return rgba.r * 255.0 + rgba.g * 65280.0;\n    if (channel == 1) return rgba.b * 255.0 + rgba.a * 65280.0;\n  }\n}\n\nint index;\nivec3 threadId;\n\nivec3 indexTo3D(int idx, ivec3 texDim) {\n  int z = int(idx / (texDim.x * texDim.y));\n  idx -= z * int(texDim.x * texDim.y);\n  int y = int(idx / texDim.x);\n  int x = int(integerMod(idx, texDim.x));\n  return ivec3(x, y, z);\n}\n\nfloat get(sampler2D tex, ivec2 texSize, ivec3 texDim, int bitRatio,  int z, int y, int x) {\n  ivec3 xyz = ivec3(x, y, z);\n  __GET_WRAPAROUND__;\n  int index = xyz.x + texDim.x * (xyz.y + texDim.y * xyz.z);\n  __GET_TEXTURE_CHANNEL__;\n  int w = texSize.x;\n  vec2 st = vec2(float(integerMod(index, w)), float(index / w)) + 0.5;\n  __GET_TEXTURE_INDEX__;\n  vec4 texel = texture2D(tex, st / vec2(texSize));\n  __GET_RESULT__;\n  \n}\n\nvec4 getImage2D(sampler2D tex, ivec2 texSize, ivec3 texDim, int z, int y, int x) {\n  ivec3 xyz = ivec3(x, y, z);\n  __GET_WRAPAROUND__;\n  int index = xyz.x + texDim.x * (xyz.y + texDim.y * xyz.z);\n  __GET_TEXTURE_CHANNEL__;\n  int w = texSize.x;\n  vec2 st = vec2(float(integerMod(index, w)), float(index / w)) + 0.5;\n  __GET_TEXTURE_INDEX__;\n  return texture2D(tex, st / vec2(texSize));\n}\n\nfloat get(sampler2D tex, ivec2 texSize, ivec3 texDim, int bitRatio, int y, int x) {\n  return get(tex, texSize, texDim, bitRatio, int(0), y, x);\n}\n\nvec4 getImage2D(sampler2D tex, ivec2 texSize, ivec3 texDim, int y, int x) {\n  return getImage2D(tex, texSize, texDim, int(0), y, x);\n}\n\nfloat get(sampler2D tex, ivec2 texSize, ivec3 texDim, int bitRatio, int x) {\n  return get(tex, texSize, texDim, bitRatio, int(0), int(0), x);\n}\n\nvec4 getImage2D(sampler2D tex, ivec2 texSize, ivec3 texDim, int x) {\n  return getImage2D(tex, texSize, texDim, int(0), int(0), x);\n}\n\n\nvec4 actualColor;\nvoid color(float r, float g, float b, float a) {\n  actualColor = vec4(r,g,b,a);\n}\n\nvoid color(float r, float g, float b) {\n  color(r,g,b,1.0);\n}\n\nvoid color(sampler2D image) {\n  actualColor = texture2D(image, vTexCoord);\n}\n\n__MAIN_PARAMS__;\n__MAIN_CONSTANTS__;\n__KERNEL__;\n\nvoid main(void) {\n  index = int(vTexCoord.s * float(uTexSize.x)) + int(vTexCoord.t * float(uTexSize.y)) * uTexSize.x;\n  __MAIN_RESULT__;\n}"},function(t,e,n){"use strict";t.exports="precision highp float;\nprecision highp int;\nprecision highp sampler2D;\n\nattribute vec2 aPos;\nattribute vec2 aTexCoord;\n\nvarying vec2 vTexCoord;\nuniform vec2 ratio;\n\nvoid main(void) {\n  gl_Position = vec4((aPos + vec2(1)) * ratio + vec2(-1), 0, 1);\n  vTexCoord = aTexCoord;\n}"},function(t,e,n){"use strict";var r=n(10),i=n(159);function o(t){return/^function /.test(t)&&(t=t.substring(9)),t.replace(/[_]typeof/g,"typeof")}function a(t){return t.replace(/[_]typeof/g,"typeof")}n(101),n(73),t.exports=function(t,e){return"() => {\n    "+i.toString()+";\n    const utils = {\n      allPropertiesOf: "+a(r.allPropertiesOf.toString())+",\n      clone: "+a(r.clone.toString())+",\n      splitArray: "+a(r.splitArray.toString())+",\n      getArgumentType: "+a(r.getArgumentType.toString())+",\n      getDimensions: "+a(r.getDimensions.toString())+",\n      dimToTexSize: "+a(r.dimToTexSize.toString())+",\n      flattenTo: "+a(r.flattenTo.toString())+",\n      flatten2dArrayTo: "+a(r.flatten2dArrayTo.toString())+",\n      flatten3dArrayTo: "+a(r.flatten3dArrayTo.toString())+",\n      systemEndianness: '"+a(r.systemEndianness())+"',\n      initWebGl: "+a(r.initWebGl.toString())+",\n      isArray: "+a(r.isArray.toString())+",\n      checkOutput: "+a(r.checkOutput.toString())+"\n    };\n    const Utils = utils;\n    const canvases = [];\n    const maxTexSizes = {};\n    let Texture = function() {};\n    let Input = function() {}; \n    class "+(e||"Kernel")+" {\n      constructor() {\n        this.maxTexSize = null;\n        this.argumentsLength = 0;\n        this.constantsLength = 0;\n        this._canvas = null;\n        this._webGl = null;\n        this.program = null;\n        this.outputToTexture = "+(t.outputToTexture?"true":"false")+";\n        this.paramNames = "+JSON.stringify(t.paramNames)+";\n        this.paramTypes = "+JSON.stringify(t.paramTypes)+";\n        this.texSize = "+JSON.stringify(t.texSize)+";\n        this.output = "+JSON.stringify(t.output)+";\n        this.compiledFragShaderString = `"+t.compiledFragShaderString+"`;\n\t\t    this.compiledVertShaderString = `"+t.compiledVertShaderString+"`;\n\t\t    this.programUniformLocationCache = {};\n\t\t    this.textureCache = {};\n\t\t    this.subKernelOutputTextures = null;\n\t\t    this.subKernelOutputVariableNames = null;\n\t\t    this.uniform1fCache = {};\n\t\t    this.uniform1iCache = {};\n\t\t    this.uniform2fCache = {};\n\t\t    this.uniform2fvCache = {};\n\t\t    this.uniform2ivCache = {};\n\t\t    this.uniform3fvCache = {};\n\t\t    this.uniform3ivCache = {};\n      }\n      _getFragShaderString() { return this.compiledFragShaderString; }\n      _getVertShaderString() { return this.compiledVertShaderString; }\n      validateOptions() {}\n      setupParams() {}\n      setupConstants() {}\n      setCanvas(canvas) { this._canvas = canvas; return this; }\n      setWebGl(webGl) { this._webGl = webGl; return this; }\n      setTexture(Type) { Texture = Type; }\n      setInput(Type) { Input = Type; }\n      "+o(t.getUniformLocation.toString())+"\n      "+o(t.build.toString())+"\n\t\t  "+o(t.run.toString())+"\n\t\t  "+o(t._addArgument.toString())+"\n\t\t  "+o(t._formatArrayTransfer.toString())+"\n\t\t  "+o(t.getArgumentTexture.toString())+"\n\t\t  "+o(t.getTextureCache.toString())+"\n\t\t  "+o(t.getOutputTexture.toString())+"\n\t\t  "+o(t.renderOutput.toString())+"\n\t\t  "+o(t.updateMaxTexSize.toString())+"\n\t\t  "+o(t._setupOutputTexture.toString())+"\n\t\t  "+o(t.detachTextureCache.toString())+"\n\t\t  "+o(t.setUniform1f.toString())+"\n\t\t  "+o(t.setUniform1i.toString())+"\n\t\t  "+o(t.setUniform2f.toString())+"\n\t\t  "+o(t.setUniform2fv.toString())+"\n\t\t  "+o(t.setUniform2iv.toString())+"\n\t\t  "+o(t.setUniform3fv.toString())+"\n\t\t  "+o(t.setUniform3iv.toString())+"\n    };\n    return kernelRunShortcut(new Kernel());\n  };"}},function(t,e,n){"use strict";n.r(e),n.d(e,"version",function(){return St}),n.d(e,"parse",function(){return Et}),n.d(e,"parseExpressionAt",function(){return Tt}),n.d(e,"tokenizer",function(){return kt}),n.d(e,"parse_dammit",function(){return xt}),n.d(e,"LooseParser",function(){return _t}),n.d(e,"pluginsLoose",function(){return wt}),n.d(e,"addLooseExports",function(){return Ot}),n.d(e,"Parser",function(){return U}),n.d(e,"plugins",function(){return M}),n.d(e,"defaultOptions",function(){return F}),n.d(e,"Position",function(){return I}),n.d(e,"SourceLocation",function(){return L}),n.d(e,"getLineInfo",function(){return N}),n.d(e,"Node",function(){return Z}),n.d(e,"TokenType",function(){return v}),n.d(e,"tokTypes",function(){return w}),n.d(e,"keywordTypes",function(){return x}),n.d(e,"TokContext",function(){return nt}),n.d(e,"tokContexts",function(){return rt}),n.d(e,"isIdentifierChar",function(){return y}),n.d(e,"isIdentifierStart",function(){return d}),n.d(e,"Token",function(){return vt}),n.d(e,"isNewLine",function(){return T}),n.d(e,"lineBreak",function(){return S}),n.d(e,"lineBreakG",function(){return E}),n.d(e,"nonASCIIwhitespace",function(){return k});var r={3:"abstract boolean byte char class double enum export extends final float goto implements import int interface long native package private protected public short static super synchronized throws transient volatile",5:"class enum extends super const export import",6:"enum",strict:"implements interface let package private protected public static yield",strictBind:"eval arguments"},i="break case catch continue debugger default do else finally for function if return switch throw try var while with null true false instanceof typeof void delete new in this",o={5:i,6:i+" const class extends export import super"},a=/^in(stanceof)?$/,s="ÂªÂµÂºÃ€-Ã–Ã˜-Ã¶Ã¸-ËË†-Ë‘Ë -Ë¤Ë¬Ë®Í°-Í´Í¶Í·Íº-Í½Í¿Î†Îˆ-ÎŠÎŒÎŽ-Î¡Î£-ÏµÏ·-ÒÒŠ-Ô¯Ô±-Õ–Õ™Õ -Öˆ×-×ª×¯-×²Ø -ÙŠÙ®Ù¯Ù±-Û“Û•Û¥Û¦Û®Û¯Ûº-Û¼Û¿ÜÜ’-Ü¯Ý-Þ¥Þ±ßŠ-ßªß´ßµßºà €-à •à šà ¤à ¨à¡€-à¡˜à¡ -à¡ªà¢ -à¢´à¢¶-à¢½à¤„-à¤¹à¤½à¥à¥˜-à¥¡à¥±-à¦€à¦…-à¦Œà¦à¦à¦“-à¦¨à¦ª-à¦°à¦²à¦¶-à¦¹à¦½à§Žà§œà§à§Ÿ-à§¡à§°à§±à§¼à¨…-à¨Šà¨à¨à¨“-à¨¨à¨ª-à¨°à¨²à¨³à¨µà¨¶à¨¸à¨¹à©™-à©œà©žà©²-à©´àª…-àªàª-àª‘àª“-àª¨àªª-àª°àª²àª³àªµ-àª¹àª½à«à« à«¡à«¹à¬…-à¬Œà¬à¬à¬“-à¬¨à¬ª-à¬°à¬²à¬³à¬µ-à¬¹à¬½à­œà­à­Ÿ-à­¡à­±à®ƒà®…-à®Šà®Ž-à®à®’-à®•à®™à®šà®œà®žà®Ÿà®£à®¤à®¨-à®ªà®®-à®¹à¯à°…-à°Œà°Ž-à°à°’-à°¨à°ª-à°¹à°½à±˜-à±šà± à±¡à²€à²…-à²Œà²Ž-à²à²’-à²¨à²ª-à²³à²µ-à²¹à²½à³žà³ à³¡à³±à³²à´…-à´Œà´Ž-à´à´’-à´ºà´½àµŽàµ”-àµ–àµŸ-àµ¡àµº-àµ¿à¶…-à¶–à¶š-à¶±à¶³-à¶»à¶½à·€-à·†à¸-à¸°à¸²à¸³à¹€-à¹†àºàº‚àº„àº‡àºˆàºŠàºàº”-àº—àº™-àºŸàº¡-àº£àº¥àº§àºªàº«àº­-àº°àº²àº³àº½à»€-à»„à»†à»œ-à»Ÿà¼€à½€-à½‡à½‰-à½¬à¾ˆ-à¾Œá€€-á€ªá€¿á-á•áš-áá¡á¥á¦á®-á°áµ-á‚á‚Žá‚ -áƒ…áƒ‡áƒáƒ-áƒºáƒ¼-á‰ˆá‰Š-á‰á‰-á‰–á‰˜á‰š-á‰á‰ -áŠˆáŠŠ-áŠáŠ-áŠ°áŠ²-áŠµáŠ¸-áŠ¾á‹€á‹‚-á‹…á‹ˆ-á‹–á‹˜-áŒáŒ’-áŒ•áŒ˜-ášáŽ€-áŽáŽ -áµá¸-á½á-á™¬á™¯-á™¿áš-áššáš -á›ªá›®-á›¸áœ€-áœŒáœŽ-áœ‘áœ -áœ±á€-á‘á -á¬á®-á°áž€-áž³áŸ—áŸœá  -á¡¸á¢€-á¢¨á¢ªá¢°-á£µá¤€-á¤žá¥-á¥­á¥°-á¥´á¦€-á¦«á¦°-á§‰á¨€-á¨–á¨ -á©”áª§á¬…-á¬³á­…-á­‹á®ƒ-á® á®®á®¯á®º-á¯¥á°€-á°£á±-á±á±š-á±½á²€-á²ˆá²-á²ºá²½-á²¿á³©-á³¬á³®-á³±á³µá³¶á´€-á¶¿á¸€-á¼•á¼˜-á¼á¼ -á½…á½ˆ-á½á½-á½—á½™á½›á½á½Ÿ-á½½á¾€-á¾´á¾¶-á¾¼á¾¾á¿‚-á¿„á¿†-á¿Œá¿-á¿“á¿–-á¿›á¿ -á¿¬á¿²-á¿´á¿¶-á¿¼â±â¿â‚-â‚œâ„‚â„‡â„Š-â„“â„•â„˜-â„â„¤â„¦â„¨â„ª-â„¹â„¼-â„¿â……-â…‰â…Žâ… -â†ˆâ°€-â°®â°°-â±žâ± -â³¤â³«-â³®â³²â³³â´€-â´¥â´§â´­â´°-âµ§âµ¯â¶€-â¶–â¶ -â¶¦â¶¨-â¶®â¶°-â¶¶â¶¸-â¶¾â·€-â·†â·ˆ-â·Žâ·-â·–â·˜-â·žã€…-ã€‡ã€¡-ã€©ã€±-ã€µã€¸-ã€¼ã-ã‚–ã‚›-ã‚Ÿã‚¡-ãƒºãƒ¼-ãƒ¿ã„…-ã„¯ã„±-ã†Žã† -ã†ºã‡°-ã‡¿ã€-ä¶µä¸€-é¿¯ê€€-ê’Œê“-ê“½ê”€-ê˜Œê˜-ê˜Ÿê˜ªê˜«ê™€-ê™®ê™¿-êšêš -ê›¯êœ—-êœŸêœ¢-êžˆêž‹-êž¹êŸ·-ê ê ƒ-ê …ê ‡-ê Šê Œ-ê ¢ê¡€-ê¡³ê¢‚-ê¢³ê£²-ê£·ê£»ê£½ê£¾ê¤Š-ê¤¥ê¤°-ê¥†ê¥ -ê¥¼ê¦„-ê¦²ê§ê§ -ê§¤ê§¦-ê§¯ê§º-ê§¾ê¨€-ê¨¨ê©€-ê©‚ê©„-ê©‹ê© -ê©¶ê©ºê©¾-êª¯êª±êªµêª¶êª¹-êª½ê«€ê«‚ê«›-ê«ê« -ê«ªê«²-ê«´ê¬-ê¬†ê¬‰-ê¬Žê¬‘-ê¬–ê¬ -ê¬¦ê¬¨-ê¬®ê¬°-ê­šê­œ-ê­¥ê­°-ê¯¢ê°€-íž£íž°-íŸ†íŸ‹-íŸ»ï¤€-ï©­ï©°-ï«™ï¬€-ï¬†ï¬“-ï¬—ï¬ï¬Ÿ-ï¬¨ï¬ª-ï¬¶ï¬¸-ï¬¼ï¬¾ï­€ï­ï­ƒï­„ï­†-ï®±ï¯“-ï´½ïµ-ï¶ï¶’-ï·‡ï·°-ï·»ï¹°-ï¹´ï¹¶-ï»¼ï¼¡-ï¼ºï½-ï½šï½¦-ï¾¾ï¿‚-ï¿‡ï¿Š-ï¿ï¿’-ï¿—ï¿š-ï¿œ",u="â€Œâ€Â·Ì€-Í¯Î‡Òƒ-Ò‡Ö‘-Ö½Ö¿××‚×„×…×‡Ø-ØšÙ‹-Ù©Ù°Û–-ÛœÛŸ-Û¤Û§Û¨Ûª-Û­Û°-Û¹Ü‘Ü°-ÝŠÞ¦-Þ°ß€-ß‰ß«-ß³ß½à –-à ™à ›-à £à ¥-à §à ©-à ­à¡™-à¡›à£“-à£¡à££-à¤ƒà¤º-à¤¼à¤¾-à¥à¥‘-à¥—à¥¢à¥£à¥¦-à¥¯à¦-à¦ƒà¦¼à¦¾-à§„à§‡à§ˆà§‹-à§à§—à§¢à§£à§¦-à§¯à§¾à¨-à¨ƒà¨¼à¨¾-à©‚à©‡à©ˆà©‹-à©à©‘à©¦-à©±à©µàª-àªƒàª¼àª¾-à«…à«‡-à«‰à«‹-à«à«¢à«£à«¦-à«¯à«º-à«¿à¬-à¬ƒà¬¼à¬¾-à­„à­‡à­ˆà­‹-à­à­–à­—à­¢à­£à­¦-à­¯à®‚à®¾-à¯‚à¯†-à¯ˆà¯Š-à¯à¯—à¯¦-à¯¯à°€-à°„à°¾-à±„à±†-à±ˆà±Š-à±à±•à±–à±¢à±£à±¦-à±¯à²-à²ƒà²¼à²¾-à³„à³†-à³ˆà³Š-à³à³•à³–à³¢à³£à³¦-à³¯à´€-à´ƒà´»à´¼à´¾-àµ„àµ†-àµˆàµŠ-àµàµ—àµ¢àµ£àµ¦-àµ¯à¶‚à¶ƒà·Šà·-à·”à·–à·˜-à·Ÿà·¦-à·¯à·²à·³à¸±à¸´-à¸ºà¹‡-à¹Žà¹-à¹™àº±àº´-àº¹àº»àº¼à»ˆ-à»à»-à»™à¼˜à¼™à¼ -à¼©à¼µà¼·à¼¹à¼¾à¼¿à½±-à¾„à¾†à¾‡à¾-à¾—à¾™-à¾¼à¿†á€«-á€¾á€-á‰á–-á™áž-á á¢-á¤á§-á­á±-á´á‚‚-á‚á‚-á‚á-áŸá©-á±áœ’-áœ”áœ²-áœ´á’á“á²á³áž´-áŸ“áŸáŸ -áŸ©á ‹-á á -á ™á¢©á¤ -á¤«á¤°-á¤»á¥†-á¥á§-á§šá¨—-á¨›á©•-á©žá© -á©¼á©¿-áª‰áª-áª™áª°-áª½á¬€-á¬„á¬´-á­„á­-á­™á­«-á­³á®€-á®‚á®¡-á®­á®°-á®¹á¯¦-á¯³á°¤-á°·á±€-á±‰á±-á±™á³-á³’á³”-á³¨á³­á³²-á³´á³·-á³¹á·€-á·¹á·»-á·¿â€¿â€â”âƒ-âƒœâƒ¡âƒ¥-âƒ°â³¯-â³±âµ¿â· -â·¿ã€ª-ã€¯ã‚™ã‚šê˜ -ê˜©ê™¯ê™´-ê™½êšžêšŸê›°ê›±ê ‚ê †ê ‹ê £-ê §ê¢€ê¢ê¢´-ê£…ê£-ê£™ê£ -ê£±ê£¿-ê¤‰ê¤¦-ê¤­ê¥‡-ê¥“ê¦€-ê¦ƒê¦³-ê§€ê§-ê§™ê§¥ê§°-ê§¹ê¨©-ê¨¶ê©ƒê©Œê©ê©-ê©™ê©»-ê©½êª°êª²-êª´êª·êª¸êª¾êª¿ê«ê««-ê«¯ê«µê«¶ê¯£-ê¯ªê¯¬ê¯­ê¯°-ê¯¹ï¬žï¸€-ï¸ï¸ -ï¸¯ï¸³ï¸´ï¹-ï¹ï¼-ï¼™ï¼¿",c=new RegExp("["+s+"]"),l=new RegExp("["+s+u+"]");s=u=null;var f=[0,11,2,25,2,18,2,1,2,14,3,13,35,122,70,52,268,28,4,48,48,31,14,29,6,37,11,29,3,35,5,7,2,4,43,157,19,35,5,35,5,39,9,51,157,310,10,21,11,7,153,5,3,0,2,43,2,1,4,0,3,22,11,22,10,30,66,18,2,1,11,21,11,25,71,55,7,1,65,0,16,3,2,2,2,28,43,28,4,28,36,7,2,27,28,53,11,21,11,18,14,17,111,72,56,50,14,50,14,35,477,28,11,0,9,21,190,52,76,44,33,24,27,35,30,0,12,34,4,0,13,47,15,3,22,0,2,0,36,17,2,24,85,6,2,0,2,3,2,14,2,9,8,46,39,7,3,1,3,21,2,6,2,1,2,4,4,0,19,0,13,4,159,52,19,3,54,47,21,1,2,0,185,46,42,3,37,47,21,0,60,42,86,26,230,43,117,63,32,0,257,0,11,39,8,0,22,0,12,39,3,3,20,0,35,56,264,8,2,36,18,0,50,29,113,6,2,1,2,37,22,0,26,5,2,1,2,31,15,0,328,18,270,921,103,110,18,195,2749,1070,4050,582,8634,568,8,30,114,29,19,47,17,3,32,20,6,18,689,63,129,68,12,0,67,12,65,1,31,6129,15,754,9486,286,82,395,2309,106,6,12,4,8,8,9,5991,84,2,70,2,1,3,0,3,1,3,3,2,11,2,0,2,6,2,64,2,3,3,7,2,6,2,27,2,3,2,4,2,0,4,6,2,339,3,24,2,24,2,30,2,24,2,30,2,24,2,30,2,24,2,30,2,24,2,7,4149,196,60,67,1213,3,2,26,2,1,2,0,3,0,2,9,2,3,2,0,2,0,7,0,5,0,2,0,2,0,2,2,2,1,2,0,3,0,2,0,2,0,2,0,2,0,2,1,2,0,3,3,2,6,2,3,2,3,2,0,2,9,2,16,6,2,2,4,2,16,4421,42710,42,4148,12,221,3,5761,15,7472,3104,541],h=[509,0,227,0,150,4,294,9,1368,2,2,1,6,3,41,2,5,0,166,1,574,3,9,9,525,10,176,2,54,14,32,9,16,3,46,10,54,9,7,2,37,13,2,9,6,1,45,0,13,2,49,13,9,3,4,9,83,11,7,0,161,11,6,9,7,3,56,1,2,6,3,1,3,2,10,0,11,1,3,6,4,4,193,17,10,9,5,0,82,19,13,9,214,6,3,8,28,1,83,16,16,9,82,12,9,9,84,14,5,9,243,14,166,9,280,9,41,6,2,3,9,0,10,10,47,15,406,7,2,7,17,9,57,21,2,13,123,5,4,0,2,1,2,6,2,0,9,9,49,4,2,1,2,4,9,9,330,3,19306,9,135,4,60,6,26,9,1016,45,17,3,19723,1,5319,4,4,5,9,7,3,6,31,3,149,2,1418,49,513,54,5,49,9,0,15,0,23,4,2,14,1361,6,2,16,3,6,2,1,2,4,2214,6,110,6,6,9,792487,239];function p(t,e){for(var n=65536,r=0;r<e.length;r+=2){if(t<(n+=e[r]))return!1;if(t<=(n+=e[r+1]))return!0}}function d(t,e){return t<65?36===t:t<91||(t<97?95===t:t<123||(t<=65535?170<=t&&c.test(String.fromCharCode(t)):!1!==e&&p(t,f)))}function y(t,e){return t<48?36===t:t<58||!(t<65)&&(t<91||(t<97?95===t:t<123||(t<=65535?170<=t&&l.test(String.fromCharCode(t)):!1!==e&&(p(t,f)||p(t,h)))))}var v=function(t,e){void 0===e&&(e={}),this.label=t,this.keyword=e.keyword,this.beforeExpr=!!e.beforeExpr,this.startsExpr=!!e.startsExpr,this.isLoop=!!e.isLoop,this.isAssign=!!e.isAssign,this.prefix=!!e.prefix,this.postfix=!!e.postfix,this.binop=e.binop||null,this.updateContext=null};function g(t,e){return new v(t,{beforeExpr:!0,binop:e})}var m={beforeExpr:!0},b={startsExpr:!0},x={};function _(t,e){return void 0===e&&(e={}),e.keyword=t,x[t]=new v(t,e)}var w={num:new v("num",b),regexp:new v("regexp",b),string:new v("string",b),name:new v("name",b),eof:new v("eof"),bracketL:new v("[",{beforeExpr:!0,startsExpr:!0}),bracketR:new v("]"),braceL:new v("{",{beforeExpr:!0,startsExpr:!0}),braceR:new v("}"),parenL:new v("(",{beforeExpr:!0,startsExpr:!0}),parenR:new v(")"),comma:new v(",",m),semi:new v(";",m),colon:new v(":",m),dot:new v("."),question:new v("?",m),arrow:new v("=>",m),template:new v("template"),invalidTemplate:new v("invalidTemplate"),ellipsis:new v("...",m),backQuote:new v("`",b),dollarBraceL:new v("${",{beforeExpr:!0,startsExpr:!0}),eq:new v("=",{beforeExpr:!0,isAssign:!0}),assign:new v("_=",{beforeExpr:!0,isAssign:!0}),incDec:new v("++/--",{prefix:!0,postfix:!0,startsExpr:!0}),prefix:new v("!/~",{beforeExpr:!0,prefix:!0,startsExpr:!0}),logicalOR:g("||",1),logicalAND:g("&&",2),bitwiseOR:g("|",3),bitwiseXOR:g("^",4),bitwiseAND:g("&",5),equality:g("==/!=/===/!==",6),relational:g("</>/<=/>=",7),bitShift:g("<</>>/>>>",8),plusMin:new v("+/-",{beforeExpr:!0,binop:9,prefix:!0,startsExpr:!0}),modulo:g("%",10),star:g("*",10),slash:g("/",10),starstar:new v("**",{beforeExpr:!0}),_break:_("break"),_case:_("case",m),_catch:_("catch"),_continue:_("continue"),_debugger:_("debugger"),_default:_("default",m),_do:_("do",{isLoop:!0,beforeExpr:!0}),_else:_("else",m),_finally:_("finally"),_for:_("for",{isLoop:!0}),_function:_("function",b),_if:_("if"),_return:_("return",m),_switch:_("switch"),_throw:_("throw",m),_try:_("try"),_var:_("var"),_const:_("const"),_while:_("while",{isLoop:!0}),_with:_("with"),_new:_("new",{beforeExpr:!0,startsExpr:!0}),_this:_("this",b),_super:_("super",b),_class:_("class",b),_extends:_("extends",m),_export:_("export"),_import:_("import"),_null:_("null",b),_true:_("true",b),_false:_("false",b),_in:_("in",{beforeExpr:!0,binop:7}),_instanceof:_("instanceof",{beforeExpr:!0,binop:7}),_typeof:_("typeof",{beforeExpr:!0,prefix:!0,startsExpr:!0}),_void:_("void",{beforeExpr:!0,prefix:!0,startsExpr:!0}),_delete:_("delete",{beforeExpr:!0,prefix:!0,startsExpr:!0})},S=/\r\n?|\n|\u2028|\u2029/,E=new RegExp(S.source,"g");function T(t,e){return 10===t||13===t||!e&&(8232===t||8233===t)}var k=/[\u1680\u180e\u2000-\u200a\u202f\u205f\u3000\ufeff]/,O=/(?:\s|\/\/.*|\/\*[^]*?\*\/)*/g,A=Object.prototype,j=A.hasOwnProperty,P=A.toString;function R(t,e){return j.call(t,e)}var C=Array.isArray||function(t){return"[object Array]"===P.call(t)},I=function(t,e){this.line=t,this.column=e};I.prototype.offset=function(t){return new I(this.line,this.column+t)};var L=function(t,e,n){this.start=e,this.end=n,null!==t.sourceFile&&(this.source=t.sourceFile)};function N(t,e){for(var n=1,r=0;;){E.lastIndex=r;var i=E.exec(t);if(!(i&&i.index<e))return new I(n,e-r);++n,r=i.index+i[0].length}}var F={ecmaVersion:7,sourceType:"script",onInsertedSemicolon:null,onTrailingComma:null,allowReserved:null,allowReturnOutsideFunction:!1,allowImportExportEverywhere:!1,allowAwaitOutsideFunction:!1,allowHashBang:!1,locations:!1,onToken:null,onComment:null,ranges:!1,program:null,sourceFile:null,directSourceFile:null,preserveParens:!1,plugins:{}};var M={};function D(t){return new RegExp("^(?:"+t.replace(/ /g,"|")+")$")}var U=function(t,e,n){this.options=t=function(t){var e,n,r={};for(var i in F)r[i]=t&&R(t,i)?t[i]:F[i];if(2015<=r.ecmaVersion&&(r.ecmaVersion-=2009),null==r.allowReserved&&(r.allowReserved=r.ecmaVersion<5),C(r.onToken)){var o=r.onToken;r.onToken=function(t){return o.push(t)}}return C(r.onComment)&&(r.onComment=(n=(e=r).onComment,function(t,r,i,o,a,s){var u={type:t?"Block":"Line",value:r,start:i,end:o};e.locations&&(u.loc=new L(this,a,s)),e.ranges&&(u.range=[i,o]),n.push(u)})),r}(t),this.sourceFile=t.sourceFile,this.keywords=D(o[6<=t.ecmaVersion?6:5]);var i="";if(!t.allowReserved){for(var a=t.ecmaVersion;!(i=r[a]);a--);"module"===t.sourceType&&(i+=" await")}this.reservedWords=D(i);var s=(i?i+" ":"")+r.strict;this.reservedWordsStrict=D(s),this.reservedWordsStrictBind=D(s+" "+r.strictBind),this.input=String(e),this.containsEsc=!1,this.loadPlugins(t.plugins),this.curLine=n?(this.pos=n,this.lineStart=this.input.lastIndexOf("\n",n-1)+1,this.input.slice(0,this.lineStart).split(S).length):(this.pos=this.lineStart=0,1),this.type=w.eof,this.value=null,this.start=this.end=this.pos,this.startLoc=this.endLoc=this.curPosition(),this.lastTokEndLoc=this.lastTokStartLoc=null,this.lastTokStart=this.lastTokEnd=this.pos,this.context=this.initialContext(),this.exprAllowed=!0,this.inModule="module"===t.sourceType,this.strict=this.inModule||this.strictDirective(this.pos),this.potentialArrowAt=-1,this.inFunction=this.inGenerator=this.inAsync=!1,this.yieldPos=this.awaitPos=0,this.labels=[],0===this.pos&&t.allowHashBang&&"#!"===this.input.slice(0,2)&&this.skipLineComment(2),this.scopeStack=[],this.enterFunctionScope(),this.regexpState=null};U.prototype.isKeyword=function(t){return this.keywords.test(t)},U.prototype.isReservedWord=function(t){return this.reservedWords.test(t)},U.prototype.extend=function(t,e){this[t]=e(this[t])},U.prototype.loadPlugins=function(t){for(var e in t){var n=M[e];if(!n)throw new Error("Plugin '"+e+"' not found");n(this,t[e])}},U.prototype.parse=function(){var t=this.options.program||this.startNode();return this.nextToken(),this.parseTopLevel(t)};var G=U.prototype,z=/^(?:'((?:\\.|[^'])*?)'|"((?:\\.|[^"])*?)"|;)/;function B(){this.shorthandAssign=this.trailingComma=this.parenthesizedAssign=this.parenthesizedBind=this.doubleProto=-1}G.strictDirective=function(t){for(;;){O.lastIndex=t,t+=O.exec(this.input)[0].length;var e=z.exec(this.input.slice(t));if(!e)return!1;if("use strict"===(e[1]||e[2]))return!0;t+=e[0].length}},G.eat=function(t){return this.type===t&&(this.next(),!0)},G.isContextual=function(t){return this.type===w.name&&this.value===t&&!this.containsEsc},G.eatContextual=function(t){return!!this.isContextual(t)&&(this.next(),!0)},G.expectContextual=function(t){this.eatContextual(t)||this.unexpected()},G.canInsertSemicolon=function(){return this.type===w.eof||this.type===w.braceR||S.test(this.input.slice(this.lastTokEnd,this.start))},G.insertSemicolon=function(){if(this.canInsertSemicolon())return this.options.onInsertedSemicolon&&this.options.onInsertedSemicolon(this.lastTokEnd,this.lastTokEndLoc),!0},G.semicolon=function(){this.eat(w.semi)||this.insertSemicolon()||this.unexpected()},G.afterTrailingComma=function(t,e){if(this.type===t)return this.options.onTrailingComma&&this.options.onTrailingComma(this.lastTokStart,this.lastTokStartLoc),e||this.next(),!0},G.expect=function(t){this.eat(t)||this.unexpected()},G.unexpected=function(t){this.raise(null!=t?t:this.start,"Unexpected token")},G.checkPatternErrors=function(t,e){if(t){-1<t.trailingComma&&this.raiseRecoverable(t.trailingComma,"Comma is not permitted after the rest element");var n=e?t.parenthesizedAssign:t.parenthesizedBind;-1<n&&this.raiseRecoverable(n,"Parenthesized pattern")}},G.checkExpressionErrors=function(t,e){if(!t)return!1;var n=t.shorthandAssign,r=t.doubleProto;if(!e)return 0<=n||0<=r;0<=n&&this.raise(n,"Shorthand property assignments are valid only in destructuring patterns"),0<=r&&this.raiseRecoverable(r,"Redefinition of __proto__ property")},G.checkYieldAwaitInDefaultParams=function(){this.yieldPos&&(!this.awaitPos||this.yieldPos<this.awaitPos)&&this.raise(this.yieldPos,"Yield expression cannot be a default value"),this.awaitPos&&this.raise(this.awaitPos,"Await expression cannot be a default value")},G.isSimpleAssignTarget=function(t){return"ParenthesizedExpression"===t.type?this.isSimpleAssignTarget(t.expression):"Identifier"===t.type||"MemberExpression"===t.type};var V=U.prototype;V.parseTopLevel=function(t){var e={};for(t.body||(t.body=[]);this.type!==w.eof;){var n=this.parseStatement(!0,!0,e);t.body.push(n)}return this.adaptDirectivePrologue(t.body),this.next(),6<=this.options.ecmaVersion&&(t.sourceType=this.options.sourceType),this.finishNode(t,"Program")};var W={kind:"loop"},X={kind:"switch"};V.isLet=function(){if(this.options.ecmaVersion<6||!this.isContextual("let"))return!1;O.lastIndex=this.pos;var t=O.exec(this.input),e=this.pos+t[0].length,n=this.input.charCodeAt(e);if(91===n||123===n)return!0;if(d(n,!0)){for(var r=e+1;y(this.input.charCodeAt(r),!0);)++r;var i=this.input.slice(e,r);if(!a.test(i))return!0}return!1},V.isAsyncFunction=function(){if(this.options.ecmaVersion<8||!this.isContextual("async"))return!1;O.lastIndex=this.pos;var t=O.exec(this.input),e=this.pos+t[0].length;return!(S.test(this.input.slice(this.pos,e))||"function"!==this.input.slice(e,e+8)||e+8!==this.input.length&&y(this.input.charAt(e+8)))},V.parseStatement=function(t,e,n){var r,i=this.type,o=this.startNode();switch(this.isLet()&&(i=w._var,r="let"),i){case w._break:case w._continue:return this.parseBreakContinueStatement(o,i.keyword);case w._debugger:return this.parseDebuggerStatement(o);case w._do:return this.parseDoStatement(o);case w._for:return this.parseForStatement(o);case w._function:return!t&&6<=this.options.ecmaVersion&&this.unexpected(),this.parseFunctionStatement(o,!1);case w._class:return t||this.unexpected(),this.parseClass(o,!0);case w._if:return this.parseIfStatement(o);case w._return:return this.parseReturnStatement(o);case w._switch:return this.parseSwitchStatement(o);case w._throw:return this.parseThrowStatement(o);case w._try:return this.parseTryStatement(o);case w._const:case w._var:return r=r||this.value,t||"var"===r||this.unexpected(),this.parseVarStatement(o,r);case w._while:return this.parseWhileStatement(o);case w._with:return this.parseWithStatement(o);case w.braceL:return this.parseBlock();case w.semi:return this.parseEmptyStatement(o);case w._export:case w._import:return this.options.allowImportExportEverywhere||(e||this.raise(this.start,"'import' and 'export' may only appear at the top level"),this.inModule||this.raise(this.start,"'import' and 'export' may appear only with 'sourceType: module'")),i===w._import?this.parseImport(o):this.parseExport(o,n);default:if(this.isAsyncFunction())return t||this.unexpected(),this.next(),this.parseFunctionStatement(o,!0);var a=this.value,s=this.parseExpression();return i===w.name&&"Identifier"===s.type&&this.eat(w.colon)?this.parseLabeledStatement(o,a,s):this.parseExpressionStatement(o,s)}},V.parseBreakContinueStatement=function(t,e){var n="break"===e;this.next(),this.eat(w.semi)||this.insertSemicolon()?t.label=null:this.type!==w.name?this.unexpected():(t.label=this.parseIdent(),this.semicolon());for(var r=0;r<this.labels.length;++r){var i=this.labels[r];if(null==t.label||i.name===t.label.name){if(null!=i.kind&&(n||"loop"===i.kind))break;if(t.label&&n)break}}return r===this.labels.length&&this.raise(t.start,"Unsyntactic "+e),this.finishNode(t,n?"BreakStatement":"ContinueStatement")},V.parseDebuggerStatement=function(t){return this.next(),this.semicolon(),this.finishNode(t,"DebuggerStatement")},V.parseDoStatement=function(t){return this.next(),this.labels.push(W),t.body=this.parseStatement(!1),this.labels.pop(),this.expect(w._while),t.test=this.parseParenExpression(),6<=this.options.ecmaVersion?this.eat(w.semi):this.semicolon(),this.finishNode(t,"DoWhileStatement")},V.parseForStatement=function(t){this.next();var e=9<=this.options.ecmaVersion&&(this.inAsync||!this.inFunction&&this.options.allowAwaitOutsideFunction)&&this.eatContextual("await")?this.lastTokStart:-1;if(this.labels.push(W),this.enterLexicalScope(),this.expect(w.parenL),this.type===w.semi)return-1<e&&this.unexpected(e),this.parseFor(t,null);var n=this.isLet();if(this.type===w._var||this.type===w._const||n){var r=this.startNode(),i=n?"let":this.value;return this.next(),this.parseVar(r,!0,i),this.finishNode(r,"VariableDeclaration"),!(this.type===w._in||6<=this.options.ecmaVersion&&this.isContextual("of"))||1!==r.declarations.length||"var"!==i&&r.declarations[0].init?(-1<e&&this.unexpected(e),this.parseFor(t,r)):(9<=this.options.ecmaVersion&&(this.type===w._in?-1<e&&this.unexpected(e):t.await=-1<e),this.parseForIn(t,r))}var o=new B,a=this.parseExpression(!0,o);return this.type===w._in||6<=this.options.ecmaVersion&&this.isContextual("of")?(9<=this.options.ecmaVersion&&(this.type===w._in?-1<e&&this.unexpected(e):t.await=-1<e),this.toAssignable(a,!1,o),this.checkLVal(a),this.parseForIn(t,a)):(this.checkExpressionErrors(o,!0),-1<e&&this.unexpected(e),this.parseFor(t,a))},V.parseFunctionStatement=function(t,e){return this.next(),this.parseFunction(t,!0,!1,e)},V.parseIfStatement=function(t){return this.next(),t.test=this.parseParenExpression(),t.consequent=this.parseStatement(!this.strict&&this.type===w._function),t.alternate=this.eat(w._else)?this.parseStatement(!this.strict&&this.type===w._function):null,this.finishNode(t,"IfStatement")},V.parseReturnStatement=function(t){return this.inFunction||this.options.allowReturnOutsideFunction||this.raise(this.start,"'return' outside of function"),this.next(),this.eat(w.semi)||this.insertSemicolon()?t.argument=null:(t.argument=this.parseExpression(),this.semicolon()),this.finishNode(t,"ReturnStatement")},V.parseSwitchStatement=function(t){var e,n=this;this.next(),t.discriminant=this.parseParenExpression(),t.cases=[],this.expect(w.braceL),this.labels.push(X),this.enterLexicalScope();for(var r=!1;this.type!==w.braceR;)if(n.type===w._case||n.type===w._default){var i=n.type===w._case;e&&n.finishNode(e,"SwitchCase"),t.cases.push(e=n.startNode()),e.consequent=[],n.next(),e.test=i?n.parseExpression():(r&&n.raiseRecoverable(n.lastTokStart,"Multiple default clauses"),r=!0,null),n.expect(w.colon)}else e||n.unexpected(),e.consequent.push(n.parseStatement(!0));return this.exitLexicalScope(),e&&this.finishNode(e,"SwitchCase"),this.next(),this.labels.pop(),this.finishNode(t,"SwitchStatement")},V.parseThrowStatement=function(t){return this.next(),S.test(this.input.slice(this.lastTokEnd,this.start))&&this.raise(this.lastTokEnd,"Illegal newline after throw"),t.argument=this.parseExpression(),this.semicolon(),this.finishNode(t,"ThrowStatement")};var K=[];V.parseTryStatement=function(t){if(this.next(),t.block=this.parseBlock(),t.handler=null,this.type===w._catch){var e=this.startNode();this.next(),this.eat(w.parenL)?(e.param=this.parseBindingAtom(),this.enterLexicalScope(),this.checkLVal(e.param,"let"),this.expect(w.parenR)):(this.options.ecmaVersion<10&&this.unexpected(),e.param=null,this.enterLexicalScope()),e.body=this.parseBlock(!1),this.exitLexicalScope(),t.handler=this.finishNode(e,"CatchClause")}return t.finalizer=this.eat(w._finally)?this.parseBlock():null,t.handler||t.finalizer||this.raise(t.start,"Missing catch or finally clause"),this.finishNode(t,"TryStatement")},V.parseVarStatement=function(t,e){return this.next(),this.parseVar(t,!1,e),this.semicolon(),this.finishNode(t,"VariableDeclaration")},V.parseWhileStatement=function(t){return this.next(),t.test=this.parseParenExpression(),this.labels.push(W),t.body=this.parseStatement(!1),this.labels.pop(),this.finishNode(t,"WhileStatement")},V.parseWithStatement=function(t){return this.strict&&this.raise(this.start,"'with' in strict mode"),this.next(),t.object=this.parseParenExpression(),t.body=this.parseStatement(!1),this.finishNode(t,"WithStatement")},V.parseEmptyStatement=function(t){return this.next(),this.finishNode(t,"EmptyStatement")},V.parseLabeledStatement=function(t,e,n){for(var r=0,i=this.labels;r<i.length;r+=1)i[r].name===e&&this.raise(n.start,"Label '"+e+"' is already declared");for(var o=this.type.isLoop?"loop":this.type===w._switch?"switch":null,a=this.labels.length-1;0<=a;a--){var s=this.labels[a];if(s.statementStart!==t.start)break;s.statementStart=this.start,s.kind=o}return this.labels.push({name:e,kind:o,statementStart:this.start}),t.body=this.parseStatement(!0),("ClassDeclaration"===t.body.type||"VariableDeclaration"===t.body.type&&"var"!==t.body.kind||"FunctionDeclaration"===t.body.type&&(this.strict||t.body.generator||t.body.async))&&this.raiseRecoverable(t.body.start,"Invalid labeled declaration"),this.labels.pop(),t.label=n,this.finishNode(t,"LabeledStatement")},V.parseExpressionStatement=function(t,e){return t.expression=e,this.semicolon(),this.finishNode(t,"ExpressionStatement")},V.parseBlock=function(t){void 0===t&&(t=!0);var e=this.startNode();for(e.body=[],this.expect(w.braceL),t&&this.enterLexicalScope();!this.eat(w.braceR);){var n=this.parseStatement(!0);e.body.push(n)}return t&&this.exitLexicalScope(),this.finishNode(e,"BlockStatement")},V.parseFor=function(t,e){return t.init=e,this.expect(w.semi),t.test=this.type===w.semi?null:this.parseExpression(),this.expect(w.semi),t.update=this.type===w.parenR?null:this.parseExpression(),this.expect(w.parenR),this.exitLexicalScope(),t.body=this.parseStatement(!1),this.labels.pop(),this.finishNode(t,"ForStatement")},V.parseForIn=function(t,e){var n=this.type===w._in?"ForInStatement":"ForOfStatement";return this.next(),"ForInStatement"===n&&("AssignmentPattern"===e.type||"VariableDeclaration"===e.type&&null!=e.declarations[0].init&&(this.strict||"Identifier"!==e.declarations[0].id.type))&&this.raise(e.start,"Invalid assignment in for-in loop head"),t.left=e,t.right="ForInStatement"===n?this.parseExpression():this.parseMaybeAssign(),this.expect(w.parenR),this.exitLexicalScope(),t.body=this.parseStatement(!1),this.labels.pop(),this.finishNode(t,n)},V.parseVar=function(t,e,n){var r=this;for(t.declarations=[],t.kind=n;;){var i=r.startNode();if(r.parseVarId(i,n),r.eat(w.eq)?i.init=r.parseMaybeAssign(e):"const"!==n||r.type===w._in||6<=r.options.ecmaVersion&&r.isContextual("of")?"Identifier"===i.id.type||e&&(r.type===w._in||r.isContextual("of"))?i.init=null:r.raise(r.lastTokEnd,"Complex binding patterns require an initialization value"):r.unexpected(),t.declarations.push(r.finishNode(i,"VariableDeclarator")),!r.eat(w.comma))break}return t},V.parseVarId=function(t,e){t.id=this.parseBindingAtom(e),this.checkLVal(t.id,e,!1)},V.parseFunction=function(t,e,n,r){this.initFunction(t),(9<=this.options.ecmaVersion||6<=this.options.ecmaVersion&&!r)&&(t.generator=this.eat(w.star)),8<=this.options.ecmaVersion&&(t.async=!!r),e&&(t.id="nullableID"===e&&this.type!==w.name?null:this.parseIdent(),t.id&&this.checkLVal(t.id,this.inModule&&!this.inFunction?"let":"var"));var i=this.inGenerator,o=this.inAsync,a=this.yieldPos,s=this.awaitPos,u=this.inFunction;return this.inGenerator=t.generator,this.inAsync=t.async,this.yieldPos=0,this.awaitPos=0,this.inFunction=!0,this.enterFunctionScope(),e||(t.id=this.type===w.name?this.parseIdent():null),this.parseFunctionParams(t),this.parseFunctionBody(t,n),this.inGenerator=i,this.inAsync=o,this.yieldPos=a,this.awaitPos=s,this.inFunction=u,this.finishNode(t,e?"FunctionDeclaration":"FunctionExpression")},V.parseFunctionParams=function(t){this.expect(w.parenL),t.params=this.parseBindingList(w.parenR,!1,8<=this.options.ecmaVersion),this.checkYieldAwaitInDefaultParams()},V.parseClass=function(t,e){this.next(),this.parseClassId(t,e),this.parseClassSuper(t);var n=this.startNode(),r=!1;for(n.body=[],this.expect(w.braceL);!this.eat(w.braceR);){var i=this.parseClassMember(n);i&&"MethodDefinition"===i.type&&"constructor"===i.kind&&(r&&this.raise(i.start,"Duplicate constructor in the same class"),r=!0)}return t.body=this.finishNode(n,"ClassBody"),this.finishNode(t,e?"ClassDeclaration":"ClassExpression")},V.parseClassMember=function(t){var e=this;if(this.eat(w.semi))return null;var n=this.startNode(),r=function(t,r){void 0===r&&(r=!1);var i=e.start,o=e.startLoc;return!(!e.eatContextual(t)||(e.type===w.parenL||r&&e.canInsertSemicolon())&&(n.key&&e.unexpected(),n.computed=!1,n.key=e.startNodeAt(i,o),n.key.name=t,e.finishNode(n.key,"Identifier"),1))};n.kind="method",n.static=r("static");var i=this.eat(w.star),o=!1;i||(8<=this.options.ecmaVersion&&r("async",!0)?(o=!0,i=9<=this.options.ecmaVersion&&this.eat(w.star)):r("get")?n.kind="get":r("set")&&(n.kind="set")),n.key||this.parsePropertyName(n);var a=n.key;return n.computed||n.static||!("Identifier"===a.type&&"constructor"===a.name||"Literal"===a.type&&"constructor"===a.value)?n.static&&"Identifier"===a.type&&"prototype"===a.name&&this.raise(a.start,"Classes may not have a static property named prototype"):("method"!==n.kind&&this.raise(a.start,"Constructor can't have get/set modifier"),i&&this.raise(a.start,"Constructor can't be a generator"),o&&this.raise(a.start,"Constructor can't be an async method"),n.kind="constructor"),this.parseClassMethod(t,n,i,o),"get"===n.kind&&0!==n.value.params.length&&this.raiseRecoverable(n.value.start,"getter should have no params"),"set"===n.kind&&1!==n.value.params.length&&this.raiseRecoverable(n.value.start,"setter should have exactly one param"),"set"===n.kind&&"RestElement"===n.value.params[0].type&&this.raiseRecoverable(n.value.params[0].start,"Setter cannot use rest params"),n},V.parseClassMethod=function(t,e,n,r){e.value=this.parseMethod(n,r),t.body.push(this.finishNode(e,"MethodDefinition"))},V.parseClassId=function(t,e){t.id=this.type===w.name?this.parseIdent():!0===e?this.unexpected():null},V.parseClassSuper=function(t){t.superClass=this.eat(w._extends)?this.parseExprSubscripts():null},V.parseExport=function(t,e){if(this.next(),this.eat(w.star))return this.expectContextual("from"),this.type!==w.string&&this.unexpected(),t.source=this.parseExprAtom(),this.semicolon(),this.finishNode(t,"ExportAllDeclaration");if(this.eat(w._default)){var n;if(this.checkExport(e,"default",this.lastTokStart),this.type===w._function||(n=this.isAsyncFunction())){var r=this.startNode();this.next(),n&&this.next(),t.declaration=this.parseFunction(r,"nullableID",!1,n)}else if(this.type===w._class){var i=this.startNode();t.declaration=this.parseClass(i,"nullableID")}else t.declaration=this.parseMaybeAssign(),this.semicolon();return this.finishNode(t,"ExportDefaultDeclaration")}if(this.shouldParseExportStatement())t.declaration=this.parseStatement(!0),"VariableDeclaration"===t.declaration.type?this.checkVariableExport(e,t.declaration.declarations):this.checkExport(e,t.declaration.id.name,t.declaration.id.start),t.specifiers=[],t.source=null;else{if(t.declaration=null,t.specifiers=this.parseExportSpecifiers(e),this.eatContextual("from"))this.type!==w.string&&this.unexpected(),t.source=this.parseExprAtom();else{for(var o=0,a=t.specifiers;o<a.length;o+=1){var s=a[o];this.checkUnreserved(s.local)}t.source=null}this.semicolon()}return this.finishNode(t,"ExportNamedDeclaration")},V.checkExport=function(t,e,n){t&&(R(t,e)&&this.raiseRecoverable(n,"Duplicate export '"+e+"'"),t[e]=!0)},V.checkPatternExport=function(t,e){var n=e.type;if("Identifier"===n)this.checkExport(t,e.name,e.start);else if("ObjectPattern"===n)for(var r=0,i=e.properties;r<i.length;r+=1){var o=i[r];this.checkPatternExport(t,o)}else if("ArrayPattern"===n)for(var a=0,s=e.elements;a<s.length;a+=1){var u=s[a];u&&this.checkPatternExport(t,u)}else"Property"===n?this.checkPatternExport(t,e.value):"AssignmentPattern"===n?this.checkPatternExport(t,e.left):"RestElement"===n?this.checkPatternExport(t,e.argument):"ParenthesizedExpression"===n&&this.checkPatternExport(t,e.expression)},V.checkVariableExport=function(t,e){if(t)for(var n=0,r=e;n<r.length;n+=1){var i=r[n];this.checkPatternExport(t,i.id)}},V.shouldParseExportStatement=function(){return"var"===this.type.keyword||"const"===this.type.keyword||"class"===this.type.keyword||"function"===this.type.keyword||this.isLet()||this.isAsyncFunction()},V.parseExportSpecifiers=function(t){var e=[],n=!0;for(this.expect(w.braceL);!this.eat(w.braceR);){if(n)n=!1;else if(this.expect(w.comma),this.afterTrailingComma(w.braceR))break;var r=this.startNode();r.local=this.parseIdent(!0),r.exported=this.eatContextual("as")?this.parseIdent(!0):r.local,this.checkExport(t,r.exported.name,r.exported.start),e.push(this.finishNode(r,"ExportSpecifier"))}return e},V.parseImport=function(t){return this.next(),this.type===w.string?(t.specifiers=K,t.source=this.parseExprAtom()):(t.specifiers=this.parseImportSpecifiers(),this.expectContextual("from"),t.source=this.type===w.string?this.parseExprAtom():this.unexpected()),this.semicolon(),this.finishNode(t,"ImportDeclaration")},V.parseImportSpecifiers=function(){var t=[],e=!0;if(this.type===w.name){var n=this.startNode();if(n.local=this.parseIdent(),this.checkLVal(n.local,"let"),t.push(this.finishNode(n,"ImportDefaultSpecifier")),!this.eat(w.comma))return t}if(this.type===w.star){var r=this.startNode();return this.next(),this.expectContextual("as"),r.local=this.parseIdent(),this.checkLVal(r.local,"let"),t.push(this.finishNode(r,"ImportNamespaceSpecifier")),t}for(this.expect(w.braceL);!this.eat(w.braceR);){if(e)e=!1;else if(this.expect(w.comma),this.afterTrailingComma(w.braceR))break;var i=this.startNode();i.imported=this.parseIdent(!0),this.eatContextual("as")?i.local=this.parseIdent():(this.checkUnreserved(i.imported),i.local=i.imported),this.checkLVal(i.local,"let"),t.push(this.finishNode(i,"ImportSpecifier"))}return t},V.adaptDirectivePrologue=function(t){for(var e=0;e<t.length&&this.isDirectiveCandidate(t[e]);++e)t[e].directive=t[e].expression.raw.slice(1,-1)},V.isDirectiveCandidate=function(t){return"ExpressionStatement"===t.type&&"Literal"===t.expression.type&&"string"==typeof t.expression.value&&('"'===this.input[t.start]||"'"===this.input[t.start])};var q=U.prototype;q.toAssignable=function(t,e,n){if(6<=this.options.ecmaVersion&&t)switch(t.type){case"Identifier":this.inAsync&&"await"===t.name&&this.raise(t.start,"Can not use 'await' as identifier inside an async function");break;case"ObjectPattern":case"ArrayPattern":case"RestElement":break;case"ObjectExpression":t.type="ObjectPattern",n&&this.checkPatternErrors(n,!0);for(var r=0,i=t.properties;r<i.length;r+=1){var o=i[r];this.toAssignable(o,e),"RestElement"!==o.type||"ArrayPattern"!==o.argument.type&&"ObjectPattern"!==o.argument.type||this.raise(o.argument.start,"Unexpected token")}break;case"Property":"init"!==t.kind&&this.raise(t.key.start,"Object pattern can't contain getter or setter"),this.toAssignable(t.value,e);break;case"ArrayExpression":t.type="ArrayPattern",n&&this.checkPatternErrors(n,!0),this.toAssignableList(t.elements,e);break;case"SpreadElement":t.type="RestElement",this.toAssignable(t.argument,e),"AssignmentPattern"===t.argument.type&&this.raise(t.argument.start,"Rest elements cannot have a default value");break;case"AssignmentExpression":"="!==t.operator&&this.raise(t.left.end,"Only '=' operator can be used for specifying default value."),t.type="AssignmentPattern",delete t.operator,this.toAssignable(t.left,e);case"AssignmentPattern":break;case"ParenthesizedExpression":this.toAssignable(t.expression,e);break;case"MemberExpression":if(!e)break;default:this.raise(t.start,"Assigning to rvalue")}else n&&this.checkPatternErrors(n,!0);return t},q.toAssignableList=function(t,e){for(var n=t.length,r=0;r<n;r++){var i=t[r];i&&this.toAssignable(i,e)}if(n){var o=t[n-1];6===this.options.ecmaVersion&&e&&o&&"RestElement"===o.type&&"Identifier"!==o.argument.type&&this.unexpected(o.argument.start)}return t},q.parseSpread=function(t){var e=this.startNode();return this.next(),e.argument=this.parseMaybeAssign(!1,t),this.finishNode(e,"SpreadElement")},q.parseRestBinding=function(){var t=this.startNode();return this.next(),6===this.options.ecmaVersion&&this.type!==w.name&&this.unexpected(),t.argument=this.parseBindingAtom(),this.finishNode(t,"RestElement")},q.parseBindingAtom=function(){if(6<=this.options.ecmaVersion)switch(this.type){case w.bracketL:var t=this.startNode();return this.next(),t.elements=this.parseBindingList(w.bracketR,!0,!0),this.finishNode(t,"ArrayPattern");case w.braceL:return this.parseObj(!0)}return this.parseIdent()},q.parseBindingList=function(t,e,n){for(var r=this,i=[],o=!0;!this.eat(t);)if(o?o=!1:r.expect(w.comma),e&&r.type===w.comma)i.push(null);else{if(n&&r.afterTrailingComma(t))break;if(r.type===w.ellipsis){var a=r.parseRestBinding();r.parseBindingListItem(a),i.push(a),r.type===w.comma&&r.raise(r.start,"Comma is not permitted after the rest element"),r.expect(t);break}var s=r.parseMaybeDefault(r.start,r.startLoc);r.parseBindingListItem(s),i.push(s)}return i},q.parseBindingListItem=function(t){return t},q.parseMaybeDefault=function(t,e,n){if(n=n||this.parseBindingAtom(),this.options.ecmaVersion<6||!this.eat(w.eq))return n;var r=this.startNodeAt(t,e);return r.left=n,r.right=this.parseMaybeAssign(),this.finishNode(r,"AssignmentPattern")},q.checkLVal=function(t,e,n){switch(t.type){case"Identifier":this.strict&&this.reservedWordsStrictBind.test(t.name)&&this.raiseRecoverable(t.start,(e?"Binding ":"Assigning to ")+t.name+" in strict mode"),n&&(R(n,t.name)&&this.raiseRecoverable(t.start,"Argument name clash"),n[t.name]=!0),e&&"none"!==e&&(("var"===e&&!this.canDeclareVarName(t.name)||"var"!==e&&!this.canDeclareLexicalName(t.name))&&this.raiseRecoverable(t.start,"Identifier '"+t.name+"' has already been declared"),"var"===e?this.declareVarName(t.name):this.declareLexicalName(t.name));break;case"MemberExpression":e&&this.raiseRecoverable(t.start,"Binding member expression");break;case"ObjectPattern":for(var r=0,i=t.properties;r<i.length;r+=1){var o=i[r];this.checkLVal(o,e,n)}break;case"Property":this.checkLVal(t.value,e,n);break;case"ArrayPattern":for(var a=0,s=t.elements;a<s.length;a+=1){var u=s[a];u&&this.checkLVal(u,e,n)}break;case"AssignmentPattern":this.checkLVal(t.left,e,n);break;case"RestElement":this.checkLVal(t.argument,e,n);break;case"ParenthesizedExpression":this.checkLVal(t.expression,e,n);break;default:this.raise(t.start,(e?"Binding":"Assigning to")+" rvalue")}};var H=U.prototype;H.checkPropClash=function(t,e,n){if(!(9<=this.options.ecmaVersion&&"SpreadElement"===t.type||6<=this.options.ecmaVersion&&(t.computed||t.method||t.shorthand))){var r,i=t.key;switch(i.type){case"Identifier":r=i.name;break;case"Literal":r=String(i.value);break;default:return}var o=t.kind;if(6<=this.options.ecmaVersion)"__proto__"===r&&"init"===o&&(e.proto&&(n&&n.doubleProto<0?n.doubleProto=i.start:this.raiseRecoverable(i.start,"Redefinition of __proto__ property")),e.proto=!0);else{var a=e[r="$"+r];a?("init"===o?this.strict&&a.init||a.get||a.set:a.init||a[o])&&this.raiseRecoverable(i.start,"Redefinition of property"):a=e[r]={init:!1,get:!1,set:!1},a[o]=!0}}},H.parseExpression=function(t,e){var n=this.start,r=this.startLoc,i=this.parseMaybeAssign(t,e);if(this.type!==w.comma)return i;var o=this.startNodeAt(n,r);for(o.expressions=[i];this.eat(w.comma);)o.expressions.push(this.parseMaybeAssign(t,e));return this.finishNode(o,"SequenceExpression")},H.parseMaybeAssign=function(t,e,n){if(this.inGenerator&&this.isContextual("yield"))return this.parseYield();var r=!1,i=-1,o=-1;e?(i=e.parenthesizedAssign,o=e.trailingComma,e.parenthesizedAssign=e.trailingComma=-1):(e=new B,r=!0);var a=this.start,s=this.startLoc;this.type!==w.parenL&&this.type!==w.name||(this.potentialArrowAt=this.start);var u=this.parseMaybeConditional(t,e);if(n&&(u=n.call(this,u,a,s)),this.type.isAssign){var c=this.startNodeAt(a,s);return c.operator=this.value,c.left=this.type===w.eq?this.toAssignable(u,!1,e):u,r||B.call(e),e.shorthandAssign=-1,this.checkLVal(u),this.next(),c.right=this.parseMaybeAssign(t),this.finishNode(c,"AssignmentExpression")}return r&&this.checkExpressionErrors(e,!0),-1<i&&(e.parenthesizedAssign=i),-1<o&&(e.trailingComma=o),u},H.parseMaybeConditional=function(t,e){var n=this.start,r=this.startLoc,i=this.parseExprOps(t,e);if(this.checkExpressionErrors(e))return i;if(this.eat(w.question)){var o=this.startNodeAt(n,r);return o.test=i,o.consequent=this.parseMaybeAssign(),this.expect(w.colon),o.alternate=this.parseMaybeAssign(t),this.finishNode(o,"ConditionalExpression")}return i},H.parseExprOps=function(t,e){var n=this.start,r=this.startLoc,i=this.parseMaybeUnary(e,!1);return this.checkExpressionErrors(e)?i:i.start===n&&"ArrowFunctionExpression"===i.type?i:this.parseExprOp(i,n,r,-1,t)},H.parseExprOp=function(t,e,n,r,i){var o=this.type.binop;if(null==o||i&&this.type===w._in||!(r<o))return t;var a=this.type===w.logicalOR||this.type===w.logicalAND,s=this.value;this.next();var u=this.start,c=this.startLoc,l=this.parseExprOp(this.parseMaybeUnary(null,!1),u,c,o,i),f=this.buildBinary(e,n,t,l,s,a);return this.parseExprOp(f,e,n,r,i)},H.buildBinary=function(t,e,n,r,i,o){var a=this.startNodeAt(t,e);return a.left=n,a.operator=i,a.right=r,this.finishNode(a,o?"LogicalExpression":"BinaryExpression")},H.parseMaybeUnary=function(t,e){var n,r=this.start,i=this.startLoc;if(this.isContextual("await")&&(this.inAsync||!this.inFunction&&this.options.allowAwaitOutsideFunction))n=this.parseAwait(),e=!0;else if(this.type.prefix){var o=this.startNode(),a=this.type===w.incDec;o.operator=this.value,o.prefix=!0,this.next(),o.argument=this.parseMaybeUnary(null,!0),this.checkExpressionErrors(t,!0),a?this.checkLVal(o.argument):this.strict&&"delete"===o.operator&&"Identifier"===o.argument.type?this.raiseRecoverable(o.start,"Deleting local variable in strict mode"):e=!0,n=this.finishNode(o,a?"UpdateExpression":"UnaryExpression")}else{if(n=this.parseExprSubscripts(t),this.checkExpressionErrors(t))return n;for(;this.type.postfix&&!this.canInsertSemicolon();){var s=this.startNodeAt(r,i);s.operator=this.value,s.prefix=!1,s.argument=n,this.checkLVal(n),this.next(),n=this.finishNode(s,"UpdateExpression")}}return!e&&this.eat(w.starstar)?this.buildBinary(r,i,n,this.parseMaybeUnary(null,!1),"**",!1):n},H.parseExprSubscripts=function(t){var e=this.start,n=this.startLoc,r=this.parseExprAtom(t),i="ArrowFunctionExpression"===r.type&&")"!==this.input.slice(this.lastTokStart,this.lastTokEnd);if(this.checkExpressionErrors(t)||i)return r;var o=this.parseSubscripts(r,e,n);return t&&"MemberExpression"===o.type&&(t.parenthesizedAssign>=o.start&&(t.parenthesizedAssign=-1),t.parenthesizedBind>=o.start&&(t.parenthesizedBind=-1)),o},H.parseSubscripts=function(t,e,n,r){for(var i=this,o=8<=this.options.ecmaVersion&&"Identifier"===t.type&&"async"===t.name&&this.lastTokEnd===t.end&&!this.canInsertSemicolon()&&"async"===this.input.slice(t.start,t.end),a=void 0;;)if((a=i.eat(w.bracketL))||i.eat(w.dot)){var s=i.startNodeAt(e,n);s.object=t,s.property=a?i.parseExpression():i.parseIdent(!0),s.computed=!!a,a&&i.expect(w.bracketR),t=i.finishNode(s,"MemberExpression")}else if(!r&&i.eat(w.parenL)){var u=new B,c=i.yieldPos,l=i.awaitPos;i.yieldPos=0,i.awaitPos=0;var f=i.parseExprList(w.parenR,8<=i.options.ecmaVersion,!1,u);if(o&&!i.canInsertSemicolon()&&i.eat(w.arrow))return i.checkPatternErrors(u,!1),i.checkYieldAwaitInDefaultParams(),i.yieldPos=c,i.awaitPos=l,i.parseArrowExpression(i.startNodeAt(e,n),f,!0);i.checkExpressionErrors(u,!0),i.yieldPos=c||i.yieldPos,i.awaitPos=l||i.awaitPos;var h=i.startNodeAt(e,n);h.callee=t,h.arguments=f,t=i.finishNode(h,"CallExpression")}else{if(i.type!==w.backQuote)return t;var p=i.startNodeAt(e,n);p.tag=t,p.quasi=i.parseTemplate({isTagged:!0}),t=i.finishNode(p,"TaggedTemplateExpression")}},H.parseExprAtom=function(t){var e,n=this.potentialArrowAt===this.start;switch(this.type){case w._super:return this.inFunction||this.raise(this.start,"'super' outside of function or class"),e=this.startNode(),this.next(),this.type!==w.dot&&this.type!==w.bracketL&&this.type!==w.parenL&&this.unexpected(),this.finishNode(e,"Super");case w._this:return e=this.startNode(),this.next(),this.finishNode(e,"ThisExpression");case w.name:var r=this.start,i=this.startLoc,o=this.containsEsc,a=this.parseIdent(this.type!==w.name);if(8<=this.options.ecmaVersion&&!o&&"async"===a.name&&!this.canInsertSemicolon()&&this.eat(w._function))return this.parseFunction(this.startNodeAt(r,i),!1,!1,!0);if(n&&!this.canInsertSemicolon()){if(this.eat(w.arrow))return this.parseArrowExpression(this.startNodeAt(r,i),[a],!1);if(8<=this.options.ecmaVersion&&"async"===a.name&&this.type===w.name&&!o)return a=this.parseIdent(),!this.canInsertSemicolon()&&this.eat(w.arrow)||this.unexpected(),this.parseArrowExpression(this.startNodeAt(r,i),[a],!0)}return a;case w.regexp:var s=this.value;return(e=this.parseLiteral(s.value)).regex={pattern:s.pattern,flags:s.flags},e;case w.num:case w.string:return this.parseLiteral(this.value);case w._null:case w._true:case w._false:return(e=this.startNode()).value=this.type===w._null?null:this.type===w._true,e.raw=this.type.keyword,this.next(),this.finishNode(e,"Literal");case w.parenL:var u=this.start,c=this.parseParenAndDistinguishExpression(n);return t&&(t.parenthesizedAssign<0&&!this.isSimpleAssignTarget(c)&&(t.parenthesizedAssign=u),t.parenthesizedBind<0&&(t.parenthesizedBind=u)),c;case w.bracketL:return e=this.startNode(),this.next(),e.elements=this.parseExprList(w.bracketR,!0,!0,t),this.finishNode(e,"ArrayExpression");case w.braceL:return this.parseObj(!1,t);case w._function:return e=this.startNode(),this.next(),this.parseFunction(e,!1);case w._class:return this.parseClass(this.startNode(),!1);case w._new:return this.parseNew();case w.backQuote:return this.parseTemplate();default:this.unexpected()}},H.parseLiteral=function(t){var e=this.startNode();return e.value=t,e.raw=this.input.slice(this.start,this.end),this.next(),this.finishNode(e,"Literal")},H.parseParenExpression=function(){this.expect(w.parenL);var t=this.parseExpression();return this.expect(w.parenR),t},H.parseParenAndDistinguishExpression=function(t){var e,n=this,r=this.start,i=this.startLoc,o=8<=this.options.ecmaVersion;if(6<=this.options.ecmaVersion){this.next();var a,s=this.start,u=this.startLoc,c=[],l=!0,f=!1,h=new B,p=this.yieldPos,d=this.awaitPos;for(this.yieldPos=0,this.awaitPos=0;this.type!==w.parenR;){if(l?l=!1:n.expect(w.comma),o&&n.afterTrailingComma(w.parenR,!0)){f=!0;break}if(n.type===w.ellipsis){a=n.start,c.push(n.parseParenItem(n.parseRestBinding())),n.type===w.comma&&n.raise(n.start,"Comma is not permitted after the rest element");break}c.push(n.parseMaybeAssign(!1,h,n.parseParenItem))}var y=this.start,v=this.startLoc;if(this.expect(w.parenR),t&&!this.canInsertSemicolon()&&this.eat(w.arrow))return this.checkPatternErrors(h,!1),this.checkYieldAwaitInDefaultParams(),this.yieldPos=p,this.awaitPos=d,this.parseParenArrowList(r,i,c);c.length&&!f||this.unexpected(this.lastTokStart),a&&this.unexpected(a),this.checkExpressionErrors(h,!0),this.yieldPos=p||this.yieldPos,this.awaitPos=d||this.awaitPos,1<c.length?((e=this.startNodeAt(s,u)).expressions=c,this.finishNodeAt(e,"SequenceExpression",y,v)):e=c[0]}else e=this.parseParenExpression();if(this.options.preserveParens){var g=this.startNodeAt(r,i);return g.expression=e,this.finishNode(g,"ParenthesizedExpression")}return e},H.parseParenItem=function(t){return t},H.parseParenArrowList=function(t,e,n){return this.parseArrowExpression(this.startNodeAt(t,e),n)};var $=[];H.parseNew=function(){var t=this.startNode(),e=this.parseIdent(!0);if(6<=this.options.ecmaVersion&&this.eat(w.dot)){t.meta=e;var n=this.containsEsc;return t.property=this.parseIdent(!0),("target"!==t.property.name||n)&&this.raiseRecoverable(t.property.start,"The only valid meta property for new is new.target"),this.inFunction||this.raiseRecoverable(t.start,"new.target can only be used in functions"),this.finishNode(t,"MetaProperty")}var r=this.start,i=this.startLoc;return t.callee=this.parseSubscripts(this.parseExprAtom(),r,i,!0),this.eat(w.parenL)?t.arguments=this.parseExprList(w.parenR,8<=this.options.ecmaVersion,!1):t.arguments=$,this.finishNode(t,"NewExpression")},H.parseTemplateElement=function(t){var e=t.isTagged,n=this.startNode();return this.type===w.invalidTemplate?(e||this.raiseRecoverable(this.start,"Bad escape sequence in untagged template literal"),n.value={raw:this.value,cooked:null}):n.value={raw:this.input.slice(this.start,this.end).replace(/\r\n?/g,"\n"),cooked:this.value},this.next(),n.tail=this.type===w.backQuote,this.finishNode(n,"TemplateElement")},H.parseTemplate=function(t){void 0===t&&(t={});var e=t.isTagged;void 0===e&&(e=!1);var n=this.startNode();this.next(),n.expressions=[];var r=this.parseTemplateElement({isTagged:e});for(n.quasis=[r];!r.tail;)this.type===w.eof&&this.raise(this.pos,"Unterminated template literal"),this.expect(w.dollarBraceL),n.expressions.push(this.parseExpression()),this.expect(w.braceR),n.quasis.push(r=this.parseTemplateElement({isTagged:e}));return this.next(),this.finishNode(n,"TemplateLiteral")},H.isAsyncProp=function(t){return!t.computed&&"Identifier"===t.key.type&&"async"===t.key.name&&(this.type===w.name||this.type===w.num||this.type===w.string||this.type===w.bracketL||this.type.keyword||9<=this.options.ecmaVersion&&this.type===w.star)&&!S.test(this.input.slice(this.lastTokEnd,this.start))},H.parseObj=function(t,e){var n=this.startNode(),r=!0,i={};for(n.properties=[],this.next();!this.eat(w.braceR);){if(r)r=!1;else if(this.expect(w.comma),this.afterTrailingComma(w.braceR))break;var o=this.parseProperty(t,e);t||this.checkPropClash(o,i,e),n.properties.push(o)}return this.finishNode(n,t?"ObjectPattern":"ObjectExpression")},H.parseProperty=function(t,e){var n,r,i,o,a=this.startNode();if(9<=this.options.ecmaVersion&&this.eat(w.ellipsis))return t?(a.argument=this.parseIdent(!1),this.type===w.comma&&this.raise(this.start,"Comma is not permitted after the rest element"),this.finishNode(a,"RestElement")):(this.type===w.parenL&&e&&(e.parenthesizedAssign<0&&(e.parenthesizedAssign=this.start),e.parenthesizedBind<0&&(e.parenthesizedBind=this.start)),a.argument=this.parseMaybeAssign(!1,e),this.type===w.comma&&e&&e.trailingComma<0&&(e.trailingComma=this.start),this.finishNode(a,"SpreadElement"));6<=this.options.ecmaVersion&&(a.method=!1,a.shorthand=!1,(t||e)&&(i=this.start,o=this.startLoc),t||(n=this.eat(w.star)));var s=this.containsEsc;return this.parsePropertyName(a),!t&&!s&&8<=this.options.ecmaVersion&&!n&&this.isAsyncProp(a)?(r=!0,n=9<=this.options.ecmaVersion&&this.eat(w.star),this.parsePropertyName(a,e)):r=!1,this.parsePropertyValue(a,t,n,r,i,o,e,s),this.finishNode(a,"Property")},H.parsePropertyValue=function(t,e,n,r,i,o,a,s){if((n||r)&&this.type===w.colon&&this.unexpected(),this.eat(w.colon))t.value=e?this.parseMaybeDefault(this.start,this.startLoc):this.parseMaybeAssign(!1,a),t.kind="init";else if(6<=this.options.ecmaVersion&&this.type===w.parenL)e&&this.unexpected(),t.kind="init",t.method=!0,t.value=this.parseMethod(n,r);else if(e||s||!(5<=this.options.ecmaVersion)||t.computed||"Identifier"!==t.key.type||"get"!==t.key.name&&"set"!==t.key.name||this.type===w.comma||this.type===w.braceR)6<=this.options.ecmaVersion&&!t.computed&&"Identifier"===t.key.type?(this.checkUnreserved(t.key),t.kind="init",e?t.value=this.parseMaybeDefault(i,o,t.key):this.type===w.eq&&a?(a.shorthandAssign<0&&(a.shorthandAssign=this.start),t.value=this.parseMaybeDefault(i,o,t.key)):t.value=t.key,t.shorthand=!0):this.unexpected();else{(n||r)&&this.unexpected(),t.kind=t.key.name,this.parsePropertyName(t),t.value=this.parseMethod(!1);var u="get"===t.kind?0:1;if(t.value.params.length!==u){var c=t.value.start;"get"===t.kind?this.raiseRecoverable(c,"getter should have no params"):this.raiseRecoverable(c,"setter should have exactly one param")}else"set"===t.kind&&"RestElement"===t.value.params[0].type&&this.raiseRecoverable(t.value.params[0].start,"Setter cannot use rest params")}},H.parsePropertyName=function(t){if(6<=this.options.ecmaVersion){if(this.eat(w.bracketL))return t.computed=!0,t.key=this.parseMaybeAssign(),this.expect(w.bracketR),t.key;t.computed=!1}return t.key=this.type===w.num||this.type===w.string?this.parseExprAtom():this.parseIdent(!0)},H.initFunction=function(t){t.id=null,6<=this.options.ecmaVersion&&(t.generator=!1,t.expression=!1),8<=this.options.ecmaVersion&&(t.async=!1)},H.parseMethod=function(t,e){var n=this.startNode(),r=this.inGenerator,i=this.inAsync,o=this.yieldPos,a=this.awaitPos,s=this.inFunction;return this.initFunction(n),6<=this.options.ecmaVersion&&(n.generator=t),8<=this.options.ecmaVersion&&(n.async=!!e),this.inGenerator=n.generator,this.inAsync=n.async,this.yieldPos=0,this.awaitPos=0,this.inFunction=!0,this.enterFunctionScope(),this.expect(w.parenL),n.params=this.parseBindingList(w.parenR,!1,8<=this.options.ecmaVersion),this.checkYieldAwaitInDefaultParams(),this.parseFunctionBody(n,!1),this.inGenerator=r,this.inAsync=i,this.yieldPos=o,this.awaitPos=a,this.inFunction=s,this.finishNode(n,"FunctionExpression")},H.parseArrowExpression=function(t,e,n){var r=this.inGenerator,i=this.inAsync,o=this.yieldPos,a=this.awaitPos,s=this.inFunction;return this.enterFunctionScope(),this.initFunction(t),8<=this.options.ecmaVersion&&(t.async=!!n),this.inGenerator=!1,this.inAsync=t.async,this.yieldPos=0,this.awaitPos=0,this.inFunction=!0,t.params=this.toAssignableList(e,!0),this.parseFunctionBody(t,!0),this.inGenerator=r,this.inAsync=i,this.yieldPos=o,this.awaitPos=a,this.inFunction=s,this.finishNode(t,"ArrowFunctionExpression")},H.parseFunctionBody=function(t,e){var n=e&&this.type!==w.braceL,r=this.strict,i=!1;if(n)t.body=this.parseMaybeAssign(),t.expression=!0,this.checkParams(t,!1);else{var o=7<=this.options.ecmaVersion&&!this.isSimpleParamList(t.params);r&&!o||(i=this.strictDirective(this.end))&&o&&this.raiseRecoverable(t.start,"Illegal 'use strict' directive in function with non-simple parameter list");var a=this.labels;this.labels=[],i&&(this.strict=!0),this.checkParams(t,!r&&!i&&!e&&this.isSimpleParamList(t.params)),t.body=this.parseBlock(!1),t.expression=!1,this.adaptDirectivePrologue(t.body.body),this.labels=a}this.exitFunctionScope(),this.strict&&t.id&&this.checkLVal(t.id,"none"),this.strict=r},H.isSimpleParamList=function(t){for(var e=0,n=t;e<n.length;e+=1)if("Identifier"!==n[e].type)return!1;return!0},H.checkParams=function(t,e){for(var n={},r=0,i=t.params;r<i.length;r+=1){var o=i[r];this.checkLVal(o,"var",e?null:n)}},H.parseExprList=function(t,e,n,r){for(var i=[],o=!0;!this.eat(t);){if(o)o=!1;else if(this.expect(w.comma),e&&this.afterTrailingComma(t))break;var a=void 0;n&&this.type===w.comma?a=null:this.type===w.ellipsis?(a=this.parseSpread(r),r&&this.type===w.comma&&r.trailingComma<0&&(r.trailingComma=this.start)):a=this.parseMaybeAssign(!1,r),i.push(a)}return i},H.checkUnreserved=function(t){var e=t.start,n=t.end,r=t.name;this.inGenerator&&"yield"===r&&this.raiseRecoverable(e,"Can not use 'yield' as identifier inside a generator"),this.inAsync&&"await"===r&&this.raiseRecoverable(e,"Can not use 'await' as identifier inside an async function"),this.isKeyword(r)&&this.raise(e,"Unexpected keyword '"+r+"'"),this.options.ecmaVersion<6&&-1!==this.input.slice(e,n).indexOf("\\")||(this.strict?this.reservedWordsStrict:this.reservedWords).test(r)&&(this.inAsync||"await"!==r||this.raiseRecoverable(e,"Can not use keyword 'await' outside an async function"),this.raiseRecoverable(e,"The keyword '"+r+"' is reserved"))},H.parseIdent=function(t,e){var n=this.startNode();return t&&"never"===this.options.allowReserved&&(t=!1),this.type===w.name?n.name=this.value:this.type.keyword?(n.name=this.type.keyword,"class"!==n.name&&"function"!==n.name||this.lastTokEnd===this.lastTokStart+1&&46===this.input.charCodeAt(this.lastTokStart)||this.context.pop()):this.unexpected(),this.next(),this.finishNode(n,"Identifier"),t||this.checkUnreserved(n),n},H.parseYield=function(){this.yieldPos||(this.yieldPos=this.start);var t=this.startNode();return this.next(),this.type===w.semi||this.canInsertSemicolon()||this.type!==w.star&&!this.type.startsExpr?(t.delegate=!1,t.argument=null):(t.delegate=this.eat(w.star),t.argument=this.parseMaybeAssign()),this.finishNode(t,"YieldExpression")},H.parseAwait=function(){this.awaitPos||(this.awaitPos=this.start);var t=this.startNode();return this.next(),t.argument=this.parseMaybeUnary(null,!0),this.finishNode(t,"AwaitExpression")};var Y=U.prototype;Y.raise=function(t,e){var n=N(this.input,t);e+=" ("+n.line+":"+n.column+")";var r=new SyntaxError(e);throw r.pos=t,r.loc=n,r.raisedAt=this.pos,r},Y.raiseRecoverable=Y.raise,Y.curPosition=function(){if(this.options.locations)return new I(this.curLine,this.pos-this.lineStart)};var J=U.prototype,Q=Object.assign||function(t){for(var e=[],n=arguments.length-1;0<n--;)e[n]=arguments[n+1];for(var r=0,i=e;r<i.length;r+=1){var o=i[r];for(var a in o)R(o,a)&&(t[a]=o[a])}return t};J.enterFunctionScope=function(){this.scopeStack.push({var:{},lexical:{},childVar:{},parentLexical:{}})},J.exitFunctionScope=function(){this.scopeStack.pop()},J.enterLexicalScope=function(){var t=this.scopeStack[this.scopeStack.length-1],e={var:{},lexical:{},childVar:{},parentLexical:{}};this.scopeStack.push(e),Q(e.parentLexical,t.lexical,t.parentLexical)},J.exitLexicalScope=function(){var t=this.scopeStack.pop(),e=this.scopeStack[this.scopeStack.length-1];Q(e.childVar,t.var,t.childVar)},J.canDeclareVarName=function(t){var e=this.scopeStack[this.scopeStack.length-1];return!R(e.lexical,t)&&!R(e.parentLexical,t)},J.canDeclareLexicalName=function(t){var e=this.scopeStack[this.scopeStack.length-1];return!R(e.lexical,t)&&!R(e.var,t)&&!R(e.childVar,t)},J.declareVarName=function(t){this.scopeStack[this.scopeStack.length-1].var[t]=!0},J.declareLexicalName=function(t){this.scopeStack[this.scopeStack.length-1].lexical[t]=!0};var Z=function(t,e,n){this.type="",this.start=e,this.end=0,t.options.locations&&(this.loc=new L(t,n)),t.options.directSourceFile&&(this.sourceFile=t.options.directSourceFile),t.options.ranges&&(this.range=[e,0])},tt=U.prototype;function et(t,e,n,r){return t.type=e,t.end=n,this.options.locations&&(t.loc.end=r),this.options.ranges&&(t.range[1]=n),t}tt.startNode=function(){return new Z(this,this.start,this.startLoc)},tt.startNodeAt=function(t,e){return new Z(this,t,e)},tt.finishNode=function(t,e){return et.call(this,t,e,this.lastTokEnd,this.lastTokEndLoc)},tt.finishNodeAt=function(t,e,n,r){return et.call(this,t,e,n,r)};var nt=function(t,e,n,r,i){this.token=t,this.isExpr=!!e,this.preserveSpace=!!n,this.override=r,this.generator=!!i},rt={b_stat:new nt("{",!1),b_expr:new nt("{",!0),b_tmpl:new nt("${",!1),p_stat:new nt("(",!1),p_expr:new nt("(",!0),q_tmpl:new nt("`",!0,!0,function(t){return t.tryReadTemplateToken()}),f_stat:new nt("function",!1),f_expr:new nt("function",!0),f_expr_gen:new nt("function",!0,!1,null,!0),f_gen:new nt("function",!1,!1,null,!0)},it=U.prototype;it.initialContext=function(){return[rt.b_stat]},it.braceIsBlock=function(t){var e=this.curContext();return e===rt.f_expr||e===rt.f_stat||(t!==w.colon||e!==rt.b_stat&&e!==rt.b_expr?t===w._return||t===w.name&&this.exprAllowed?S.test(this.input.slice(this.lastTokEnd,this.start)):t===w._else||t===w.semi||t===w.eof||t===w.parenR||t===w.arrow||(t===w.braceL?e===rt.b_stat:t!==w._var&&t!==w.name&&!this.exprAllowed):!e.isExpr)},it.inGeneratorContext=function(){for(var t=this.context.length-1;1<=t;t--){var e=this.context[t];if("function"===e.token)return e.generator}return!1},it.updateContext=function(t){var e,n=this.type;n.keyword&&t===w.dot?this.exprAllowed=!1:(e=n.updateContext)?e.call(this,t):this.exprAllowed=n.beforeExpr},w.parenR.updateContext=w.braceR.updateContext=function(){if(1!==this.context.length){var t=this.context.pop();t===rt.b_stat&&"function"===this.curContext().token&&(t=this.context.pop()),this.exprAllowed=!t.isExpr}else this.exprAllowed=!0},w.braceL.updateContext=function(t){this.context.push(this.braceIsBlock(t)?rt.b_stat:rt.b_expr),this.exprAllowed=!0},w.dollarBraceL.updateContext=function(){this.context.push(rt.b_tmpl),this.exprAllowed=!0},w.parenL.updateContext=function(t){var e=t===w._if||t===w._for||t===w._with||t===w._while;this.context.push(e?rt.p_stat:rt.p_expr),this.exprAllowed=!0},w.incDec.updateContext=function(){},w._function.updateContext=w._class.updateContext=function(t){t.beforeExpr&&t!==w.semi&&t!==w._else&&(t!==w.colon&&t!==w.braceL||this.curContext()!==rt.b_stat)?this.context.push(rt.f_expr):this.context.push(rt.f_stat),this.exprAllowed=!1},w.backQuote.updateContext=function(){this.curContext()===rt.q_tmpl?this.context.pop():this.context.push(rt.q_tmpl),this.exprAllowed=!1},w.star.updateContext=function(t){if(t===w._function){var e=this.context.length-1;this.context[e]===rt.f_expr?this.context[e]=rt.f_expr_gen:this.context[e]=rt.f_gen}this.exprAllowed=!0},w.name.updateContext=function(t){var e=!1;6<=this.options.ecmaVersion&&t!==w.dot&&("of"===this.value&&!this.exprAllowed||"yield"===this.value&&this.inGeneratorContext())&&(e=!0),this.exprAllowed=e};var ot={$LONE:["ASCII","ASCII_Hex_Digit","AHex","Alphabetic","Alpha","Any","Assigned","Bidi_Control","Bidi_C","Bidi_Mirrored","Bidi_M","Case_Ignorable","CI","Cased","Changes_When_Casefolded","CWCF","Changes_When_Casemapped","CWCM","Changes_When_Lowercased","CWL","Changes_When_NFKC_Casefolded","CWKCF","Changes_When_Titlecased","CWT","Changes_When_Uppercased","CWU","Dash","Default_Ignorable_Code_Point","DI","Deprecated","Dep","Diacritic","Dia","Emoji","Emoji_Component","Emoji_Modifier","Emoji_Modifier_Base","Emoji_Presentation","Extender","Ext","Grapheme_Base","Gr_Base","Grapheme_Extend","Gr_Ext","Hex_Digit","Hex","IDS_Binary_Operator","IDSB","IDS_Trinary_Operator","IDST","ID_Continue","IDC","ID_Start","IDS","Ideographic","Ideo","Join_Control","Join_C","Logical_Order_Exception","LOE","Lowercase","Lower","Math","Noncharacter_Code_Point","NChar","Pattern_Syntax","Pat_Syn","Pattern_White_Space","Pat_WS","Quotation_Mark","QMark","Radical","Regional_Indicator","RI","Sentence_Terminal","STerm","Soft_Dotted","SD","Terminal_Punctuation","Term","Unified_Ideograph","UIdeo","Uppercase","Upper","Variation_Selector","VS","White_Space","space","XID_Continue","XIDC","XID_Start","XIDS"],General_Category:["Cased_Letter","LC","Close_Punctuation","Pe","Connector_Punctuation","Pc","Control","Cc","cntrl","Currency_Symbol","Sc","Dash_Punctuation","Pd","Decimal_Number","Nd","digit","Enclosing_Mark","Me","Final_Punctuation","Pf","Format","Cf","Initial_Punctuation","Pi","Letter","L","Letter_Number","Nl","Line_Separator","Zl","Lowercase_Letter","Ll","Mark","M","Combining_Mark","Math_Symbol","Sm","Modifier_Letter","Lm","Modifier_Symbol","Sk","Nonspacing_Mark","Mn","Number","N","Open_Punctuation","Ps","Other","C","Other_Letter","Lo","Other_Number","No","Other_Punctuation","Po","Other_Symbol","So","Paragraph_Separator","Zp","Private_Use","Co","Punctuation","P","punct","Separator","Z","Space_Separator","Zs","Spacing_Mark","Mc","Surrogate","Cs","Symbol","S","Titlecase_Letter","Lt","Unassigned","Cn","Uppercase_Letter","Lu"],Script:["Adlam","Adlm","Ahom","Anatolian_Hieroglyphs","Hluw","Arabic","Arab","Armenian","Armn","Avestan","Avst","Balinese","Bali","Bamum","Bamu","Bassa_Vah","Bass","Batak","Batk","Bengali","Beng","Bhaiksuki","Bhks","Bopomofo","Bopo","Brahmi","Brah","Braille","Brai","Buginese","Bugi","Buhid","Buhd","Canadian_Aboriginal","Cans","Carian","Cari","Caucasian_Albanian","Aghb","Chakma","Cakm","Cham","Cherokee","Cher","Common","Zyyy","Coptic","Copt","Qaac","Cuneiform","Xsux","Cypriot","Cprt","Cyrillic","Cyrl","Deseret","Dsrt","Devanagari","Deva","Duployan","Dupl","Egyptian_Hieroglyphs","Egyp","Elbasan","Elba","Ethiopic","Ethi","Georgian","Geor","Glagolitic","Glag","Gothic","Goth","Grantha","Gran","Greek","Grek","Gujarati","Gujr","Gurmukhi","Guru","Han","Hani","Hangul","Hang","Hanunoo","Hano","Hatran","Hatr","Hebrew","Hebr","Hiragana","Hira","Imperial_Aramaic","Armi","Inherited","Zinh","Qaai","Inscriptional_Pahlavi","Phli","Inscriptional_Parthian","Prti","Javanese","Java","Kaithi","Kthi","Kannada","Knda","Katakana","Kana","Kayah_Li","Kali","Kharoshthi","Khar","Khmer","Khmr","Khojki","Khoj","Khudawadi","Sind","Lao","Laoo","Latin","Latn","Lepcha","Lepc","Limbu","Limb","Linear_A","Lina","Linear_B","Linb","Lisu","Lycian","Lyci","Lydian","Lydi","Mahajani","Mahj","Malayalam","Mlym","Mandaic","Mand","Manichaean","Mani","Marchen","Marc","Masaram_Gondi","Gonm","Meetei_Mayek","Mtei","Mende_Kikakui","Mend","Meroitic_Cursive","Merc","Meroitic_Hieroglyphs","Mero","Miao","Plrd","Modi","Mongolian","Mong","Mro","Mroo","Multani","Mult","Myanmar","Mymr","Nabataean","Nbat","New_Tai_Lue","Talu","Newa","Nko","Nkoo","Nushu","Nshu","Ogham","Ogam","Ol_Chiki","Olck","Old_Hungarian","Hung","Old_Italic","Ital","Old_North_Arabian","Narb","Old_Permic","Perm","Old_Persian","Xpeo","Old_South_Arabian","Sarb","Old_Turkic","Orkh","Oriya","Orya","Osage","Osge","Osmanya","Osma","Pahawh_Hmong","Hmng","Palmyrene","Palm","Pau_Cin_Hau","Pauc","Phags_Pa","Phag","Phoenician","Phnx","Psalter_Pahlavi","Phlp","Rejang","Rjng","Runic","Runr","Samaritan","Samr","Saurashtra","Saur","Sharada","Shrd","Shavian","Shaw","Siddham","Sidd","SignWriting","Sgnw","Sinhala","Sinh","Sora_Sompeng","Sora","Soyombo","Soyo","Sundanese","Sund","Syloti_Nagri","Sylo","Syriac","Syrc","Tagalog","Tglg","Tagbanwa","Tagb","Tai_Le","Tale","Tai_Tham","Lana","Tai_Viet","Tavt","Takri","Takr","Tamil","Taml","Tangut","Tang","Telugu","Telu","Thaana","Thaa","Thai","Tibetan","Tibt","Tifinagh","Tfng","Tirhuta","Tirh","Ugaritic","Ugar","Vai","Vaii","Warang_Citi","Wara","Yi","Yiii","Zanabazar_Square","Zanb"]};Array.prototype.push.apply(ot.$LONE,ot.General_Category),ot.gc=ot.General_Category,ot.sc=ot.Script_Extensions=ot.scx=ot.Script;var at=U.prototype,st=function(t){this.parser=t,this.validFlags="gim"+(6<=t.options.ecmaVersion?"uy":"")+(9<=t.options.ecmaVersion?"s":""),this.source="",this.flags="",this.start=0,this.switchU=!1,this.switchN=!1,this.pos=0,this.lastIntValue=0,this.lastStringValue="",this.lastAssertionIsQuantifiable=!1,this.numCapturingParens=0,this.maxBackReference=0,this.groupNames=[],this.backReferenceNames=[]};function ut(t){return t<=65535?String.fromCharCode(t):(t-=65536,String.fromCharCode(55296+(t>>10),56320+(1023&t)))}function ct(t){return 36===t||40<=t&&t<=43||46===t||63===t||91<=t&&t<=94||123<=t&&t<=125}function lt(t){return 65<=t&&t<=90||97<=t&&t<=122}function ft(t){return lt(t)||95===t}function ht(t){return 48<=t&&t<=57}function pt(t){return 48<=t&&t<=57||65<=t&&t<=70||97<=t&&t<=102}function dt(t){return 65<=t&&t<=70?t-65+10:97<=t&&t<=102?t-97+10:t-48}function yt(t){return 48<=t&&t<=55}st.prototype.reset=function(t,e,n){var r=-1!==n.indexOf("u");this.start=0|t,this.source=e+"",this.flags=n,this.switchU=r&&6<=this.parser.options.ecmaVersion,this.switchN=r&&9<=this.parser.options.ecmaVersion},st.prototype.raise=function(t){this.parser.raiseRecoverable(this.start,"Invalid regular expression: /"+this.source+"/: "+t)},st.prototype.at=function(t){var e=this.source,n=e.length;if(n<=t)return-1;var r=e.charCodeAt(t);return!this.switchU||r<=55295||57344<=r||n<=t+1?r:(r<<10)+e.charCodeAt(t+1)-56613888},st.prototype.nextIndex=function(t){var e=this.source,n=e.length;if(n<=t)return n;var r=e.charCodeAt(t);return!this.switchU||r<=55295||57344<=r||n<=t+1?t+1:t+2},st.prototype.current=function(){return this.at(this.pos)},st.prototype.lookahead=function(){return this.at(this.nextIndex(this.pos))},st.prototype.advance=function(){this.pos=this.nextIndex(this.pos)},st.prototype.eat=function(t){return this.current()===t&&(this.advance(),!0)},at.validateRegExpFlags=function(t){for(var e=t.validFlags,n=t.flags,r=0;r<n.length;r++){var i=n.charAt(r);-1===e.indexOf(i)&&this.raise(t.start,"Invalid regular expression flag"),-1<n.indexOf(i,r+1)&&this.raise(t.start,"Duplicate regular expression flag")}},at.validateRegExpPattern=function(t){this.regexp_pattern(t),!t.switchN&&9<=this.options.ecmaVersion&&0<t.groupNames.length&&(t.switchN=!0,this.regexp_pattern(t))},at.regexp_pattern=function(t){t.pos=0,t.lastIntValue=0,t.lastStringValue="",t.lastAssertionIsQuantifiable=!1,t.numCapturingParens=0,t.maxBackReference=0,t.groupNames.length=0,t.backReferenceNames.length=0,this.regexp_disjunction(t),t.pos!==t.source.length&&(t.eat(41)&&t.raise("Unmatched ')'"),(t.eat(93)||t.eat(125))&&t.raise("Lone quantifier brackets")),t.maxBackReference>t.numCapturingParens&&t.raise("Invalid escape");for(var e=0,n=t.backReferenceNames;e<n.length;e+=1){var r=n[e];-1===t.groupNames.indexOf(r)&&t.raise("Invalid named capture referenced")}},at.regexp_disjunction=function(t){for(this.regexp_alternative(t);t.eat(124);)this.regexp_alternative(t);this.regexp_eatQuantifier(t,!0)&&t.raise("Nothing to repeat"),t.eat(123)&&t.raise("Lone quantifier brackets")},at.regexp_alternative=function(t){for(;t.pos<t.source.length&&this.regexp_eatTerm(t););},at.regexp_eatTerm=function(t){return this.regexp_eatAssertion(t)?(t.lastAssertionIsQuantifiable&&this.regexp_eatQuantifier(t)&&t.switchU&&t.raise("Invalid quantifier"),!0):!(t.switchU?!this.regexp_eatAtom(t):!this.regexp_eatExtendedAtom(t))&&(this.regexp_eatQuantifier(t),!0)},at.regexp_eatAssertion=function(t){var e=t.pos;if(t.lastAssertionIsQuantifiable=!1,t.eat(94)||t.eat(36))return!0;if(t.eat(92)){if(t.eat(66)||t.eat(98))return!0;t.pos=e}if(t.eat(40)&&t.eat(63)){var n=!1;if(9<=this.options.ecmaVersion&&(n=t.eat(60)),t.eat(61)||t.eat(33))return this.regexp_disjunction(t),t.eat(41)||t.raise("Unterminated group"),t.lastAssertionIsQuantifiable=!n,!0}return t.pos=e,!1},at.regexp_eatQuantifier=function(t,e){return void 0===e&&(e=!1),!!this.regexp_eatQuantifierPrefix(t,e)&&(t.eat(63),!0)},at.regexp_eatQuantifierPrefix=function(t,e){return t.eat(42)||t.eat(43)||t.eat(63)||this.regexp_eatBracedQuantifier(t,e)},at.regexp_eatBracedQuantifier=function(t,e){var n=t.pos;if(t.eat(123)){var r=0,i=-1;if(this.regexp_eatDecimalDigits(t)&&(r=t.lastIntValue,t.eat(44)&&this.regexp_eatDecimalDigits(t)&&(i=t.lastIntValue),t.eat(125)))return-1!==i&&i<r&&!e&&t.raise("numbers out of order in {} quantifier"),!0;t.switchU&&!e&&t.raise("Incomplete quantifier"),t.pos=n}return!1},at.regexp_eatAtom=function(t){return this.regexp_eatPatternCharacters(t)||t.eat(46)||this.regexp_eatReverseSolidusAtomEscape(t)||this.regexp_eatCharacterClass(t)||this.regexp_eatUncapturingGroup(t)||this.regexp_eatCapturingGroup(t)},at.regexp_eatReverseSolidusAtomEscape=function(t){var e=t.pos;if(t.eat(92)){if(this.regexp_eatAtomEscape(t))return!0;t.pos=e}return!1},at.regexp_eatUncapturingGroup=function(t){var e=t.pos;if(t.eat(40)){if(t.eat(63)&&t.eat(58)){if(this.regexp_disjunction(t),t.eat(41))return!0;t.raise("Unterminated group")}t.pos=e}return!1},at.regexp_eatCapturingGroup=function(t){if(t.eat(40)){if(9<=this.options.ecmaVersion?this.regexp_groupSpecifier(t):63===t.current()&&t.raise("Invalid group"),this.regexp_disjunction(t),t.eat(41))return t.numCapturingParens+=1,!0;t.raise("Unterminated group")}return!1},at.regexp_eatExtendedAtom=function(t){return t.eat(46)||this.regexp_eatReverseSolidusAtomEscape(t)||this.regexp_eatCharacterClass(t)||this.regexp_eatUncapturingGroup(t)||this.regexp_eatCapturingGroup(t)||this.regexp_eatInvalidBracedQuantifier(t)||this.regexp_eatExtendedPatternCharacter(t)},at.regexp_eatInvalidBracedQuantifier=function(t){return this.regexp_eatBracedQuantifier(t,!0)&&t.raise("Nothing to repeat"),!1},at.regexp_eatSyntaxCharacter=function(t){var e=t.current();return!!ct(e)&&(t.lastIntValue=e,t.advance(),!0)},at.regexp_eatPatternCharacters=function(t){for(var e=t.pos,n=0;-1!==(n=t.current())&&!ct(n);)t.advance();return t.pos!==e},at.regexp_eatExtendedPatternCharacter=function(t){var e=t.current();return!(-1===e||36===e||40<=e&&e<=43||46===e||63===e||91===e||94===e||124===e||(t.advance(),0))},at.regexp_groupSpecifier=function(t){if(t.eat(63)){if(this.regexp_eatGroupName(t))return-1!==t.groupNames.indexOf(t.lastStringValue)&&t.raise("Duplicate capture group name"),void t.groupNames.push(t.lastStringValue);t.raise("Invalid group")}},at.regexp_eatGroupName=function(t){if(t.lastStringValue="",t.eat(60)){if(this.regexp_eatRegExpIdentifierName(t)&&t.eat(62))return!0;t.raise("Invalid capture group name")}return!1},at.regexp_eatRegExpIdentifierName=function(t){if(t.lastStringValue="",this.regexp_eatRegExpIdentifierStart(t)){for(t.lastStringValue+=ut(t.lastIntValue);this.regexp_eatRegExpIdentifierPart(t);)t.lastStringValue+=ut(t.lastIntValue);return!0}return!1},at.regexp_eatRegExpIdentifierStart=function(t){var e,n=t.pos,r=t.current();return t.advance(),92===r&&this.regexp_eatRegExpUnicodeEscapeSequence(t)&&(r=t.lastIntValue),d(e=r,!0)||36===e||95===e?(t.lastIntValue=r,!0):(t.pos=n,!1)},at.regexp_eatRegExpIdentifierPart=function(t){var e,n=t.pos,r=t.current();return t.advance(),92===r&&this.regexp_eatRegExpUnicodeEscapeSequence(t)&&(r=t.lastIntValue),y(e=r,!0)||36===e||95===e||8204===e||8205===e?(t.lastIntValue=r,!0):(t.pos=n,!1)},at.regexp_eatAtomEscape=function(t){return!!(this.regexp_eatBackReference(t)||this.regexp_eatCharacterClassEscape(t)||this.regexp_eatCharacterEscape(t)||t.switchN&&this.regexp_eatKGroupName(t))||(t.switchU&&(99===t.current()&&t.raise("Invalid unicode escape"),t.raise("Invalid escape")),!1)},at.regexp_eatBackReference=function(t){var e=t.pos;if(this.regexp_eatDecimalEscape(t)){var n=t.lastIntValue;if(t.switchU)return n>t.maxBackReference&&(t.maxBackReference=n),!0;if(n<=t.numCapturingParens)return!0;t.pos=e}return!1},at.regexp_eatKGroupName=function(t){if(t.eat(107)){if(this.regexp_eatGroupName(t))return t.backReferenceNames.push(t.lastStringValue),!0;t.raise("Invalid named reference")}return!1},at.regexp_eatCharacterEscape=function(t){return this.regexp_eatControlEscape(t)||this.regexp_eatCControlLetter(t)||this.regexp_eatZero(t)||this.regexp_eatHexEscapeSequence(t)||this.regexp_eatRegExpUnicodeEscapeSequence(t)||!t.switchU&&this.regexp_eatLegacyOctalEscapeSequence(t)||this.regexp_eatIdentityEscape(t)},at.regexp_eatCControlLetter=function(t){var e=t.pos;if(t.eat(99)){if(this.regexp_eatControlLetter(t))return!0;t.pos=e}return!1},at.regexp_eatZero=function(t){return 48===t.current()&&!ht(t.lookahead())&&(t.lastIntValue=0,t.advance(),!0)},at.regexp_eatControlEscape=function(t){var e=t.current();return 116===e?(t.lastIntValue=9,t.advance(),!0):110===e?(t.lastIntValue=10,t.advance(),!0):118===e?(t.lastIntValue=11,t.advance(),!0):102===e?(t.lastIntValue=12,t.advance(),!0):114===e&&(t.lastIntValue=13,t.advance(),!0)},at.regexp_eatControlLetter=function(t){var e=t.current();return!!lt(e)&&(t.lastIntValue=e%32,t.advance(),!0)},at.regexp_eatRegExpUnicodeEscapeSequence=function(t){var e,n=t.pos;if(t.eat(117)){if(this.regexp_eatFixedHexDigits(t,4)){var r=t.lastIntValue;if(t.switchU&&55296<=r&&r<=56319){var i=t.pos;if(t.eat(92)&&t.eat(117)&&this.regexp_eatFixedHexDigits(t,4)){var o=t.lastIntValue;if(56320<=o&&o<=57343)return t.lastIntValue=1024*(r-55296)+(o-56320)+65536,!0}t.pos=i,t.lastIntValue=r}return!0}if(t.switchU&&t.eat(123)&&this.regexp_eatHexDigits(t)&&t.eat(125)&&0<=(e=t.lastIntValue)&&e<=1114111)return!0;t.switchU&&t.raise("Invalid unicode escape"),t.pos=n}return!1},at.regexp_eatIdentityEscape=function(t){if(t.switchU)return!!this.regexp_eatSyntaxCharacter(t)||!!t.eat(47)&&(t.lastIntValue=47,!0);var e=t.current();return!(99===e||t.switchN&&107===e||(t.lastIntValue=e,t.advance(),0))},at.regexp_eatDecimalEscape=function(t){t.lastIntValue=0;var e=t.current();if(49<=e&&e<=57){for(;t.lastIntValue=10*t.lastIntValue+(e-48),t.advance(),48<=(e=t.current())&&e<=57;);return!0}return!1},at.regexp_eatCharacterClassEscape=function(t){var e,n=t.current();if(100===(e=n)||68===e||115===e||83===e||119===e||87===e)return t.lastIntValue=-1,t.advance(),!0;if(t.switchU&&9<=this.options.ecmaVersion&&(80===n||112===n)){if(t.lastIntValue=-1,t.advance(),t.eat(123)&&this.regexp_eatUnicodePropertyValueExpression(t)&&t.eat(125))return!0;t.raise("Invalid property name")}return!1},at.regexp_eatUnicodePropertyValueExpression=function(t){var e=t.pos;if(this.regexp_eatUnicodePropertyName(t)&&t.eat(61)){var n=t.lastStringValue;if(this.regexp_eatUnicodePropertyValue(t)){var r=t.lastStringValue;return this.regexp_validateUnicodePropertyNameAndValue(t,n,r),!0}}if(t.pos=e,this.regexp_eatLoneUnicodePropertyNameOrValue(t)){var i=t.lastStringValue;return this.regexp_validateUnicodePropertyNameOrValue(t,i),!0}return!1},at.regexp_validateUnicodePropertyNameAndValue=function(t,e,n){ot.hasOwnProperty(e)&&-1!==ot[e].indexOf(n)||t.raise("Invalid property name")},at.regexp_validateUnicodePropertyNameOrValue=function(t,e){-1===ot.$LONE.indexOf(e)&&t.raise("Invalid property name")},at.regexp_eatUnicodePropertyName=function(t){var e=0;for(t.lastStringValue="";ft(e=t.current());)t.lastStringValue+=ut(e),t.advance();return""!==t.lastStringValue},at.regexp_eatUnicodePropertyValue=function(t){var e,n=0;for(t.lastStringValue="";ft(e=n=t.current())||ht(e);)t.lastStringValue+=ut(n),t.advance();return""!==t.lastStringValue},at.regexp_eatLoneUnicodePropertyNameOrValue=function(t){return this.regexp_eatUnicodePropertyValue(t)},at.regexp_eatCharacterClass=function(t){if(t.eat(91)){if(t.eat(94),this.regexp_classRanges(t),t.eat(93))return!0;t.raise("Unterminated character class")}return!1},at.regexp_classRanges=function(t){for(;this.regexp_eatClassAtom(t);){var e=t.lastIntValue;if(t.eat(45)&&this.regexp_eatClassAtom(t)){var n=t.lastIntValue;!t.switchU||-1!==e&&-1!==n||t.raise("Invalid character class"),-1!==e&&-1!==n&&n<e&&t.raise("Range out of order in character class")}}},at.regexp_eatClassAtom=function(t){var e=t.pos;if(t.eat(92)){if(this.regexp_eatClassEscape(t))return!0;if(t.switchU){var n=t.current();(99===n||yt(n))&&t.raise("Invalid class escape"),t.raise("Invalid escape")}t.pos=e}var r=t.current();return 93!==r&&(t.lastIntValue=r,t.advance(),!0)},at.regexp_eatClassEscape=function(t){var e=t.pos;if(t.eat(98))return t.lastIntValue=8,!0;if(t.switchU&&t.eat(45))return t.lastIntValue=45,!0;if(!t.switchU&&t.eat(99)){if(this.regexp_eatClassControlLetter(t))return!0;t.pos=e}return this.regexp_eatCharacterClassEscape(t)||this.regexp_eatCharacterEscape(t)},at.regexp_eatClassControlLetter=function(t){var e=t.current();return!(!ht(e)&&95!==e||(t.lastIntValue=e%32,t.advance(),0))},at.regexp_eatHexEscapeSequence=function(t){var e=t.pos;if(t.eat(120)){if(this.regexp_eatFixedHexDigits(t,2))return!0;t.switchU&&t.raise("Invalid escape"),t.pos=e}return!1},at.regexp_eatDecimalDigits=function(t){var e=t.pos,n=0;for(t.lastIntValue=0;ht(n=t.current());)t.lastIntValue=10*t.lastIntValue+(n-48),t.advance();return t.pos!==e},at.regexp_eatHexDigits=function(t){var e=t.pos,n=0;for(t.lastIntValue=0;pt(n=t.current());)t.lastIntValue=16*t.lastIntValue+dt(n),t.advance();return t.pos!==e},at.regexp_eatLegacyOctalEscapeSequence=function(t){if(this.regexp_eatOctalDigit(t)){var e=t.lastIntValue;if(this.regexp_eatOctalDigit(t)){var n=t.lastIntValue;e<=3&&this.regexp_eatOctalDigit(t)?t.lastIntValue=64*e+8*n+t.lastIntValue:t.lastIntValue=8*e+n}else t.lastIntValue=e;return!0}return!1},at.regexp_eatOctalDigit=function(t){var e=t.current();return yt(e)?(t.lastIntValue=e-48,t.advance(),!0):(t.lastIntValue=0,!1)},at.regexp_eatFixedHexDigits=function(t,e){for(var n=t.pos,r=t.lastIntValue=0;r<e;++r){var i=t.current();if(!pt(i))return t.pos=n,!1;t.lastIntValue=16*t.lastIntValue+dt(i),t.advance()}return!0};var vt=function(t){this.type=t.type,this.value=t.value,this.start=t.start,this.end=t.end,t.options.locations&&(this.loc=new L(t,t.startLoc,t.endLoc)),t.options.ranges&&(this.range=[t.start,t.end])},gt=U.prototype;function mt(t){return t<=65535?String.fromCharCode(t):(t-=65536,String.fromCharCode(55296+(t>>10),56320+(1023&t)))}gt.next=function(){this.options.onToken&&this.options.onToken(new vt(this)),this.lastTokEnd=this.end,this.lastTokStart=this.start,this.lastTokEndLoc=this.endLoc,this.lastTokStartLoc=this.startLoc,this.nextToken()},gt.getToken=function(){return this.next(),new vt(this)},"undefined"!=typeof Symbol&&(gt[Symbol.iterator]=function(){var t=this;return{next:function(){var e=t.getToken();return{done:e.type===w.eof,value:e}}}}),gt.curContext=function(){return this.context[this.context.length-1]},gt.nextToken=function(){var t=this.curContext();return t&&t.preserveSpace||this.skipSpace(),this.start=this.pos,this.options.locations&&(this.startLoc=this.curPosition()),this.pos>=this.input.length?this.finishToken(w.eof):t.override?t.override(this):void this.readToken(this.fullCharCodeAtPos())},gt.readToken=function(t){return d(t,6<=this.options.ecmaVersion)||92===t?this.readWord():this.getTokenFromCode(t)},gt.fullCharCodeAtPos=function(){var t=this.input.charCodeAt(this.pos);return t<=55295||57344<=t?t:(t<<10)+this.input.charCodeAt(this.pos+1)-56613888},gt.skipBlockComment=function(){var t,e=this.options.onComment&&this.curPosition(),n=this.pos,r=this.input.indexOf("*/",this.pos+=2);if(-1===r&&this.raise(this.pos-2,"Unterminated comment"),this.pos=r+2,this.options.locations)for(E.lastIndex=n;(t=E.exec(this.input))&&t.index<this.pos;)++this.curLine,this.lineStart=t.index+t[0].length;this.options.onComment&&this.options.onComment(!0,this.input.slice(n+2,r),n,this.pos,e,this.curPosition())},gt.skipLineComment=function(t){for(var e=this.pos,n=this.options.onComment&&this.curPosition(),r=this.input.charCodeAt(this.pos+=t);this.pos<this.input.length&&!T(r);)r=this.input.charCodeAt(++this.pos);this.options.onComment&&this.options.onComment(!1,this.input.slice(e+t,this.pos),e,this.pos,n,this.curPosition())},gt.skipSpace=function(){var t=this;t:for(;this.pos<this.input.length;){var e=t.input.charCodeAt(t.pos);switch(e){case 32:case 160:++t.pos;break;case 13:10===t.input.charCodeAt(t.pos+1)&&++t.pos;case 10:case 8232:case 8233:++t.pos,t.options.locations&&(++t.curLine,t.lineStart=t.pos);break;case 47:switch(t.input.charCodeAt(t.pos+1)){case 42:t.skipBlockComment();break;case 47:t.skipLineComment(2);break;default:break t}break;default:if(!(8<e&&e<14||5760<=e&&k.test(String.fromCharCode(e))))break t;++t.pos}}},gt.finishToken=function(t,e){this.end=this.pos,this.options.locations&&(this.endLoc=this.curPosition());var n=this.type;this.type=t,this.value=e,this.updateContext(n)},gt.readToken_dot=function(){var t=this.input.charCodeAt(this.pos+1);if(48<=t&&t<=57)return this.readNumber(!0);var e=this.input.charCodeAt(this.pos+2);return 6<=this.options.ecmaVersion&&46===t&&46===e?(this.pos+=3,this.finishToken(w.ellipsis)):(++this.pos,this.finishToken(w.dot))},gt.readToken_slash=function(){var t=this.input.charCodeAt(this.pos+1);return this.exprAllowed?(++this.pos,this.readRegexp()):61===t?this.finishOp(w.assign,2):this.finishOp(w.slash,1)},gt.readToken_mult_modulo_exp=function(t){var e=this.input.charCodeAt(this.pos+1),n=1,r=42===t?w.star:w.modulo;return 7<=this.options.ecmaVersion&&42===t&&42===e&&(++n,r=w.starstar,e=this.input.charCodeAt(this.pos+2)),61===e?this.finishOp(w.assign,n+1):this.finishOp(r,n)},gt.readToken_pipe_amp=function(t){var e=this.input.charCodeAt(this.pos+1);return e===t?this.finishOp(124===t?w.logicalOR:w.logicalAND,2):61===e?this.finishOp(w.assign,2):this.finishOp(124===t?w.bitwiseOR:w.bitwiseAND,1)},gt.readToken_caret=function(){return 61===this.input.charCodeAt(this.pos+1)?this.finishOp(w.assign,2):this.finishOp(w.bitwiseXOR,1)},gt.readToken_plus_min=function(t){var e=this.input.charCodeAt(this.pos+1);return e===t?45!==e||this.inModule||62!==this.input.charCodeAt(this.pos+2)||0!==this.lastTokEnd&&!S.test(this.input.slice(this.lastTokEnd,this.pos))?this.finishOp(w.incDec,2):(this.skipLineComment(3),this.skipSpace(),this.nextToken()):61===e?this.finishOp(w.assign,2):this.finishOp(w.plusMin,1)},gt.readToken_lt_gt=function(t){var e=this.input.charCodeAt(this.pos+1),n=1;return e===t?(n=62===t&&62===this.input.charCodeAt(this.pos+2)?3:2,61===this.input.charCodeAt(this.pos+n)?this.finishOp(w.assign,n+1):this.finishOp(w.bitShift,n)):33!==e||60!==t||this.inModule||45!==this.input.charCodeAt(this.pos+2)||45!==this.input.charCodeAt(this.pos+3)?(61===e&&(n=2),this.finishOp(w.relational,n)):(this.skipLineComment(4),this.skipSpace(),this.nextToken())},gt.readToken_eq_excl=function(t){var e=this.input.charCodeAt(this.pos+1);return 61===e?this.finishOp(w.equality,61===this.input.charCodeAt(this.pos+2)?3:2):61===t&&62===e&&6<=this.options.ecmaVersion?(this.pos+=2,this.finishToken(w.arrow)):this.finishOp(61===t?w.eq:w.prefix,1)},gt.getTokenFromCode=function(t){switch(t){case 46:return this.readToken_dot();case 40:return++this.pos,this.finishToken(w.parenL);case 41:return++this.pos,this.finishToken(w.parenR);case 59:return++this.pos,this.finishToken(w.semi);case 44:return++this.pos,this.finishToken(w.comma);case 91:return++this.pos,this.finishToken(w.bracketL);case 93:return++this.pos,this.finishToken(w.bracketR);case 123:return++this.pos,this.finishToken(w.braceL);case 125:return++this.pos,this.finishToken(w.braceR);case 58:return++this.pos,this.finishToken(w.colon);case 63:return++this.pos,this.finishToken(w.question);case 96:if(this.options.ecmaVersion<6)break;return++this.pos,this.finishToken(w.backQuote);case 48:var e=this.input.charCodeAt(this.pos+1);if(120===e||88===e)return this.readRadixNumber(16);if(6<=this.options.ecmaVersion){if(111===e||79===e)return this.readRadixNumber(8);if(98===e||66===e)return this.readRadixNumber(2)}case 49:case 50:case 51:case 52:case 53:case 54:case 55:case 56:case 57:return this.readNumber(!1);case 34:case 39:return this.readString(t);case 47:return this.readToken_slash();case 37:case 42:return this.readToken_mult_modulo_exp(t);case 124:case 38:return this.readToken_pipe_amp(t);case 94:return this.readToken_caret();case 43:case 45:return this.readToken_plus_min(t);case 60:case 62:return this.readToken_lt_gt(t);case 61:case 33:return this.readToken_eq_excl(t);case 126:return this.finishOp(w.prefix,1)}this.raise(this.pos,"Unexpected character '"+mt(t)+"'")},gt.finishOp=function(t,e){var n=this.input.slice(this.pos,this.pos+e);return this.pos+=e,this.finishToken(t,n)},gt.readRegexp=function(){for(var t,e,n=this.pos;;){this.pos>=this.input.length&&this.raise(n,"Unterminated regular expression");var r=this.input.charAt(this.pos);if(S.test(r)&&this.raise(n,"Unterminated regular expression"),t)t=!1;else{if("["===r)e=!0;else if("]"===r&&e)e=!1;else if("/"===r&&!e)break;t="\\"===r}++this.pos}var i=this.input.slice(n,this.pos);++this.pos;var o=this.pos,a=this.readWord1();this.containsEsc&&this.unexpected(o);var s=this.regexpState||(this.regexpState=new st(this));s.reset(n,i,a),this.validateRegExpFlags(s),this.validateRegExpPattern(s);var u=null;try{u=new RegExp(i,a)}catch(t){}return this.finishToken(w.regexp,{pattern:i,flags:a,value:u})},gt.readInt=function(t,e){for(var n=this.pos,r=0,i=0,o=null==e?1/0:e;i<o;++i){var a,s=this.input.charCodeAt(this.pos);if(t<=(a=97<=s?s-97+10:65<=s?s-65+10:48<=s&&s<=57?s-48:1/0))break;++this.pos,r=r*t+a}return this.pos===n||null!=e&&this.pos-n!==e?null:r},gt.readRadixNumber=function(t){this.pos+=2;var e=this.readInt(t);return null==e&&this.raise(this.start+2,"Expected number in radix "+t),d(this.fullCharCodeAtPos())&&this.raise(this.pos,"Identifier directly after number"),this.finishToken(w.num,e)},gt.readNumber=function(t){var e=this.pos;t||null!==this.readInt(10)||this.raise(e,"Invalid number");var n=2<=this.pos-e&&48===this.input.charCodeAt(e);n&&this.strict&&this.raise(e,"Invalid number"),n&&/[89]/.test(this.input.slice(e,this.pos))&&(n=!1);var r=this.input.charCodeAt(this.pos);46!==r||n||(++this.pos,this.readInt(10),r=this.input.charCodeAt(this.pos)),69!==r&&101!==r||n||(43!==(r=this.input.charCodeAt(++this.pos))&&45!==r||++this.pos,null===this.readInt(10)&&this.raise(e,"Invalid number")),d(this.fullCharCodeAtPos())&&this.raise(this.pos,"Identifier directly after number");var i=this.input.slice(e,this.pos),o=n?parseInt(i,8):parseFloat(i);return this.finishToken(w.num,o)},gt.readCodePoint=function(){var t;if(123===this.input.charCodeAt(this.pos)){this.options.ecmaVersion<6&&this.unexpected();var e=++this.pos;t=this.readHexChar(this.input.indexOf("}",this.pos)-this.pos),++this.pos,1114111<t&&this.invalidStringToken(e,"Code point out of bounds")}else t=this.readHexChar(4);return t},gt.readString=function(t){for(var e=this,n="",r=++this.pos;;){e.pos>=e.input.length&&e.raise(e.start,"Unterminated string constant");var i=e.input.charCodeAt(e.pos);if(i===t)break;92===i?(n+=e.input.slice(r,e.pos),n+=e.readEscapedChar(!1),r=e.pos):(T(i,10<=e.options.ecmaVersion)&&e.raise(e.start,"Unterminated string constant"),++e.pos)}return n+=this.input.slice(r,this.pos++),this.finishToken(w.string,n)};var bt={};gt.tryReadTemplateToken=function(){this.inTemplateElement=!0;try{this.readTmplToken()}catch(t){if(t!==bt)throw t;this.readInvalidTemplateToken()}this.inTemplateElement=!1},gt.invalidStringToken=function(t,e){if(this.inTemplateElement&&9<=this.options.ecmaVersion)throw bt;this.raise(t,e)},gt.readTmplToken=function(){for(var t=this,e="",n=this.pos;;){t.pos>=t.input.length&&t.raise(t.start,"Unterminated template");var r=t.input.charCodeAt(t.pos);if(96===r||36===r&&123===t.input.charCodeAt(t.pos+1))return t.pos!==t.start||t.type!==w.template&&t.type!==w.invalidTemplate?(e+=t.input.slice(n,t.pos),t.finishToken(w.template,e)):36===r?(t.pos+=2,t.finishToken(w.dollarBraceL)):(++t.pos,t.finishToken(w.backQuote));if(92===r)e+=t.input.slice(n,t.pos),e+=t.readEscapedChar(!0),n=t.pos;else if(T(r)){switch(e+=t.input.slice(n,t.pos),++t.pos,r){case 13:10===t.input.charCodeAt(t.pos)&&++t.pos;case 10:e+="\n";break;default:e+=String.fromCharCode(r)}t.options.locations&&(++t.curLine,t.lineStart=t.pos),n=t.pos}else++t.pos}},gt.readInvalidTemplateToken=function(){for(;this.pos<this.input.length;this.pos++)switch(this.input[this.pos]){case"\\":++this.pos;break;case"$":if("{"!==this.input[this.pos+1])break;case"`":return this.finishToken(w.invalidTemplate,this.input.slice(this.start,this.pos))}this.raise(this.start,"Unterminated template")},gt.readEscapedChar=function(t){var e=this.input.charCodeAt(++this.pos);switch(++this.pos,e){case 110:return"\n";case 114:return"\r";case 120:return String.fromCharCode(this.readHexChar(2));case 117:return mt(this.readCodePoint());case 116:return"\t";case 98:return"\b";case 118:return"\v";case 102:return"\f";case 13:10===this.input.charCodeAt(this.pos)&&++this.pos;case 10:return this.options.locations&&(this.lineStart=this.pos,++this.curLine),"";default:if(48<=e&&e<=55){var n=this.input.substr(this.pos-1,3).match(/^[0-7]+/)[0],r=parseInt(n,8);return 255<r&&(n=n.slice(0,-1),r=parseInt(n,8)),this.pos+=n.length-1,e=this.input.charCodeAt(this.pos),"0"===n&&56!==e&&57!==e||!this.strict&&!t||this.invalidStringToken(this.pos-1-n.length,t?"Octal literal in template string":"Octal literal in strict mode"),String.fromCharCode(r)}return String.fromCharCode(e)}},gt.readHexChar=function(t){var e=this.pos,n=this.readInt(16,t);return null===n&&this.invalidStringToken(e,"Bad character escape sequence"),n},gt.readWord1=function(){for(var t=this,e="",n=!(this.containsEsc=!1),r=this.pos,i=6<=this.options.ecmaVersion;this.pos<this.input.length;){var o=t.fullCharCodeAtPos();if(y(o,i))t.pos+=o<=65535?1:2;else{if(92!==o)break;t.containsEsc=!0,e+=t.input.slice(r,t.pos);var a=t.pos;117!==t.input.charCodeAt(++t.pos)&&t.invalidStringToken(t.pos,"Expecting Unicode escape sequence \\uXXXX"),++t.pos;var s=t.readCodePoint();(n?d:y)(s,i)||t.invalidStringToken(a,"Invalid Unicode escape"),e+=mt(s),r=t.pos}n=!1}return e+this.input.slice(r,this.pos)},gt.readWord=function(){var t=this.readWord1(),e=w.name;return this.keywords.test(t)&&(this.containsEsc&&this.raiseRecoverable(this.start,"Escape sequence in keyword "+t),e=x[t]),this.finishToken(e,t)};var xt,_t,wt,St="5.7.3";function Et(t,e){return new U(e,t).parse()}function Tt(t,e,n){var r=new U(n,t,e);return r.nextToken(),r.parseExpression()}function kt(t,e){return new U(e,t)}function Ot(t,e,n){xt=t,_t=e,wt=n}},function(t,e,n){"use strict";t.exports="#version 300 es\n__HEADER__;\nprecision highp float;\nprecision highp int;\nprecision highp sampler2D;\n\nconst float LOOP_MAX = __LOOP_MAX__;\n\n__CONSTANTS__;\n\nin vec2 vTexCoord;\n\nvec2 integerMod(vec2 x, float y) {\n  vec2 res = floor(mod(x, y));\n  return res * step(1.0 - floor(y), -res);\n}\n\nvec3 integerMod(vec3 x, float y) {\n  vec3 res = floor(mod(x, y));\n  return res * step(1.0 - floor(y), -res);\n}\n\nvec4 integerMod(vec4 x, vec4 y) {\n  vec4 res = floor(mod(x, y));\n  return res * step(1.0 - floor(y), -res);\n}\n\nfloat integerMod(float x, float y) {\n  float res = floor(mod(x, y));\n  return res * (res > floor(y) - 1.0 ? 0.0 : 1.0);\n}\n\nint integerMod(int x, int y) {\n  return x - (y * int(x/y));\n}\n\n__DIVIDE_WITH_INTEGER_CHECK__;\n\n// Here be dragons!\n// DO NOT OPTIMIZE THIS CODE\n// YOU WILL BREAK SOMETHING ON SOMEBODY'S MACHINE\n// LEAVE IT AS IT IS, LEST YOU WASTE YOUR OWN TIME\nconst vec2 MAGIC_VEC = vec2(1.0, -256.0);\nconst vec4 SCALE_FACTOR = vec4(1.0, 256.0, 65536.0, 0.0);\nconst vec4 SCALE_FACTOR_INV = vec4(1.0, 0.00390625, 0.0000152587890625, 0.0); // 1, 1/256, 1/65536\nfloat decode32(vec4 rgba) {\n  __DECODE32_ENDIANNESS__;\n  rgba *= 255.0;\n  vec2 gte128;\n  gte128.x = rgba.b >= 128.0 ? 1.0 : 0.0;\n  gte128.y = rgba.a >= 128.0 ? 1.0 : 0.0;\n  float exponent = 2.0 * rgba.a - 127.0 + dot(gte128, MAGIC_VEC);\n  float res = exp2(round(exponent));\n  rgba.b = rgba.b - 128.0 * gte128.x;\n  res = dot(rgba, SCALE_FACTOR) * exp2(round(exponent-23.0)) + res;\n  res *= gte128.y * -2.0 + 1.0;\n  return res;\n}\n\nvec4 encode32(float f) {\n  float F = abs(f);\n  float sign = f < 0.0 ? 1.0 : 0.0;\n  float exponent = floor(log2(F));\n  float mantissa = (exp2(-exponent) * F);\n  // exponent += floor(log2(mantissa));\n  vec4 rgba = vec4(F * exp2(23.0-exponent)) * SCALE_FACTOR_INV;\n  rgba.rg = integerMod(rgba.rg, 256.0);\n  rgba.b = integerMod(rgba.b, 128.0);\n  rgba.a = exponent*0.5 + 63.5;\n  rgba.ba += vec2(integerMod(exponent+127.0, 2.0), sign) * 128.0;\n  rgba = floor(rgba);\n  rgba *= 0.003921569; // 1/255\n  __ENCODE32_ENDIANNESS__;\n  return rgba;\n}\n// Dragons end here\n\nfloat decode(vec4 rgba, int x, int bitRatio) {\n  if (bitRatio == 1) {\n    return decode32(rgba);\n  }\n  __DECODE32_ENDIANNESS__;\n  int channel = integerMod(x, bitRatio);\n  if (bitRatio == 4) {\n    return rgba[channel] * 255.0;\n  }\n  else {\n    return rgba[channel*2] * 255.0 + rgba[channel*2 + 1] * 65280.0;\n  }\n}\n\nint index;\nivec3 threadId;\n\nivec3 indexTo3D(int idx, ivec3 texDim) {\n  int z = int(idx / (texDim.x * texDim.y));\n  idx -= z * int(texDim.x * texDim.y);\n  int y = int(idx / texDim.x);\n  int x = int(integerMod(idx, texDim.x));\n  return ivec3(x, y, z);\n}\n\nfloat get(sampler2D tex, ivec2 texSize, ivec3 texDim, int bitRatio,  int z, int y, int x) {\n  ivec3 xyz = ivec3(x, y, z);\n  __GET_WRAPAROUND__;\n  int index = xyz.x + texDim.x * (xyz.y + texDim.y * xyz.z);\n  __GET_TEXTURE_CHANNEL__;\n  int w = texSize.x;\n  vec2 st = vec2(float(integerMod(index, w)), float(index / w)) + 0.5;\n  __GET_TEXTURE_INDEX__;\n  vec4 texel = texture(tex, st / vec2(texSize));\n  __GET_RESULT__;\n  \n}\n\nvec4 getImage2D(sampler2D tex, ivec2 texSize, ivec3 texDim, int z, int y, int x) {\n  ivec3 xyz = ivec3(x, y, z);\n  __GET_WRAPAROUND__;\n  int index = xyz.x + texDim.x * (xyz.y + texDim.y * xyz.z);\n  __GET_TEXTURE_CHANNEL__;\n  int w = texSize.x;\n  vec2 st = vec2(float(integerMod(index, w)), float(index / w)) + 0.5;\n  __GET_TEXTURE_INDEX__;\n  return texture(tex, st / vec2(texSize));\n}\n\nvec4 getImage3D(sampler2DArray tex, ivec2 texSize, ivec3 texDim, int z, int y, int x) {\n  ivec3 xyz = ivec3(x, y, z);\n  __GET_WRAPAROUND__;\n  int index = xyz.x + texDim.x * (xyz.y + texDim.y * xyz.z);\n  __GET_TEXTURE_CHANNEL__;\n  int w = texSize.x;\n  vec2 st = vec2(float(integerMod(index, w)), float(index / w)) + 0.5;\n  __GET_TEXTURE_INDEX__;\n  return texture(tex, vec3(st / vec2(texSize), z));\n}\n\nfloat get(sampler2D tex, ivec2 texSize, ivec3 texDim, int bitRatio, int y, int x) {\n  return get(tex, texSize, texDim, bitRatio, 0, y, x);\n}\n\nfloat get(sampler2D tex, ivec2 texSize, ivec3 texDim, int bitRatio, int x) {\n  return get(tex, texSize, texDim, bitRatio, 0, 0, x);\n}\n\nvec4 getImage2D(sampler2D tex, ivec2 texSize, ivec3 texDim, int y, int x) {\n  return getImage2D(tex, texSize, texDim, 0, y, x);\n}\n\nvec4 getImage2D(sampler2D tex, ivec2 texSize, ivec3 texDim, int x) {\n  return getImage2D(tex, texSize, texDim, 0, 0, x);\n}\n\nvec4 actualColor;\nvoid color(float r, float g, float b, float a) {\n  actualColor = vec4(r,g,b,a);\n}\n\nvoid color(float r, float g, float b) {\n  color(r,g,b,1.0);\n}\n\n__MAIN_PARAMS__;\n__MAIN_CONSTANTS__;\n__KERNEL__;\n\nvoid main(void) {\n  index = int(vTexCoord.s * float(uTexSize.x)) + int(vTexCoord.t * float(uTexSize.y)) * uTexSize.x;\n  __MAIN_RESULT__;\n}"},function(t,e,n){"use strict";t.exports="#version 300 es\nprecision highp float;\nprecision highp int;\nprecision highp sampler2D;\n\nin vec2 aPos;\nin vec2 aTexCoord;\n\nout vec2 vTexCoord;\nuniform vec2 ratio;\n\nvoid main(void) {\n  gl_Position = vec4((aPos + vec2(1)) * ratio + vec2(-1), 0, 1);\n  vTexCoord = aTexCoord;\n}"},function(t,e,n){"use strict";var r=n(10),i=n(159);function o(t){return/^function /.test(t)&&(t=t.substring(9)),t.replace(/[_]typeof/g,"typeof")}function a(t){return t.replace(/[_]typeof/g,"typeof")}t.exports=function(t,e){return"() => {\n    "+i.toString()+";\n    const utils = {\n      allPropertiesOf: "+a(r.allPropertiesOf.toString())+",\n      clone: "+a(r.clone.toString())+",\n      checkOutput: "+a(r.checkOutput.toString())+"\n    };\n    const Utils = utils;\n    let Input = function() {};\n    class "+(e||"Kernel")+" {\n      constructor() {        \n        this.argumentsLength = 0;\n        this._canvas = null;\n        this._webGl = null;\n        this.built = false;\n        this.program = null;\n        this.paramNames = "+JSON.stringify(t.paramNames)+";\n        this.paramTypes = "+JSON.stringify(t.paramTypes)+";\n        this.texSize = "+JSON.stringify(t.texSize)+";\n        this.output = "+JSON.stringify(t.output)+";\n        this._kernelString = `"+t._kernelString+"`;\n        this.output = "+JSON.stringify(t.output)+";\n\t\t    this.run = function() {\n          this.run = null;\n          this.build();\n          return this.run.apply(this, arguments);\n        }.bind(this);\n        this.thread = {\n          x: 0,\n          y: 0,\n          z: 0\n        };\n      }\n      setCanvas(canvas) { this._canvas = canvas; return this; }\n      setWebGl(webGl) { this._webGl = webGl; return this; }\n      setInput(Type) { Input = Type; }\n      "+o(t.build.toString())+"\n      "+o(t.setupParams.toString())+"\n      "+o(t.setupConstants.toString())+"\n      run () { "+t.kernelString+" }\n      getKernelString() { return this._kernelString; }\n      "+o(t.validateOptions.toString())+"\n    };\n    return kernelRunShortcut(new Kernel());\n  };"}},function(t,e,n){"use strict";function r(t){return(r="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t})(t)}var i=function(){function t(t,e){for(var n=0;n<e.length;n++){var r=e[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(t,r.key,r)}}return function(e,n,r){return n&&t(e.prototype,n),r&&t(e,r),e}}(),o=n(102),a=n(10);t.exports=function(t){function e(){return function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,e),function(t,e){if(!t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!e||"object"!==r(e)&&"function"!=typeof e?t:e}(this,(e.__proto__||Object.getPrototypeOf(e)).apply(this,arguments))}return function(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function, not "+r(e));t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,enumerable:!1,writable:!0,configurable:!0}}),e&&(Object.setPrototypeOf?Object.setPrototypeOf(t,e):t.__proto__=e)}(e,o),i(e,[{key:"validateOptions",value:function(){this.texSize=a.dimToTexSize({floatTextures:this.floatTextures,floatOutput:this.floatOutput},this.output,!0)}}]),e}()},function(t,e,n){"use strict";function r(t){return(r="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t})(t)}var i=function(){function t(t,e){for(var n=0;n<e.length;n++){var r=e[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(t,r.key,r)}}return function(e,n,r){return n&&t(e.prototype,n),r&&t(e,r),e}}(),o=n(162),a=n(10);t.exports=function(t){function e(){return function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,e),function(t,e){if(!t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!e||"object"!==r(e)&&"function"!=typeof e?t:e}(this,(e.__proto__||Object.getPrototypeOf(e)).apply(this,arguments))}return function(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function, not "+r(e));t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,enumerable:!1,writable:!0,configurable:!0}}),e&&(Object.setPrototypeOf?Object.setPrototypeOf(t,e):t.__proto__=e)}(e,o),i(e,[{key:"validateOptions",value:function(){this._webGl.getExtension("EXT_color_buffer_float"),this.texSize=a.dimToTexSize({floatTextures:this.floatTextures,floatOutput:this.floatOutput},this.output,!0)}}]),e}()},function(t,e,n){"use strict";var r=function(){function t(t,e){for(var n=0;n<e.length;n++){var r=e[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(t,r.key,r)}}return function(e,n,r){return n&&t(e.prototype,n),r&&t(e,r),e}}();n(246),t.exports=function(){function t(){!function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,t)}return r(t,null,[{key:"validateKernelObj",value:function(t){if(null===t)throw"KernelObj being validated is NULL";if("string"==typeof t){try{t=JSON.parse(t)}catch(t){throw console.error(t),"Failed to convert KernelObj from JSON string"}if(null===t)throw"Invalid (NULL) KernelObj JSON string representation"}if(!0!==t.isKernelObj)throw"Failed missing isKernelObj flag check";return t}},{key:"loadKernelObj",value:function(t,e){t=validateKernelObj(t)}}]),t}()},function(t,e,n){"use strict";var r=n(10);t.exports=function(t,e){var n=e.toString();return new Function("return function "+t+" ("+r.getParamNamesFromString(n).join(", ")+") {"+r.getFunctionBodyFromString(n)+"}")()}},function(t,e,n){"use strict";function r(t){return(r="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t})(t)}Object.defineProperty(e,"__esModule",{value:!0});var i=function(){function t(t,e){for(var n=0;n<e.length;n++){var r=e[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(t,r.key,r)}}return function(e,n,r){return n&&t(e.prototype,n),r&&t(e,r),e}}(),o=n(630),a=function(t){function e(t){!function(t,n){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this);var n=function(t,e){if(!t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!e||"object"!==r(e)&&"function"!=typeof e?t:e}(this,(e.__proto__||Object.getPrototypeOf(e)).call(this,{objectMode:!0}));if(!(t=t||{}).neuralNetwork)throw new Error("no neural network specified");var i=t.neuralNetwork;n.neuralNetwork=i,n.dataFormatDetermined=!1,n.i=0,n.size=0,n.count=0,n.sum=0,n.floodCallback=t.floodCallback,n.doneTrainingCallback=t.doneTrainingCallback,i.updateTrainingOptions(t);var o=i.trainOpts;return n.iterations=o.iterations,n.errorThresh=o.errorThresh,n.log=o.log,n.logPeriod=o.logPeriod,n.callbackPeriod=o.callbackPeriod,n.callback=o.callback,n.on("finish",n.finishStreamIteration.bind(n)),n}return function(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function, not "+r(e));t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,enumerable:!1,writable:!0,configurable:!0}}),e&&(Object.setPrototypeOf?Object.setPrototypeOf(t,e):t.__proto__=e)}(e,o.Writable),i(e,[{key:"endInputs",value:function(){this.write(!1)}},{key:"_write",value:function(t,e,n){if(!t)return this.emit("finish"),n();if(!this.dataFormatDetermined)return this.size++,this.neuralNetwork.addFormat(t),this.firstDatum=this.firstDatum||t,n();this.count++;var r=this.neuralNetwork.formatData(t);this.sum+=this.neuralNetwork.trainPattern(r[0],!0),n()}},{key:"finishStreamIteration",value:function(){if(this.dataFormatDetermined&&this.size!==this.count&&this.log("This iteration's data length was different from the first."),!this.dataFormatDetermined){var t=this.neuralNetwork.formatData(this.firstDatum);return this.neuralNetwork.verifyIsInitialized(t),this.dataFormatDetermined=!0,void("function"==typeof this.floodCallback&&this.floodCallback())}var e=this.sum/this.size;if(this.log&&this.i%this.logPeriod==0&&this.log("iterations: "+this.i+", training error: "+e),this.callback&&this.i%this.callbackPeriod==0&&this.callback({error:e,iterations:this.i}),this.sum=0,this.count=0,this.i++,this.i<this.iterations&&e>this.errorThresh){if("function"==typeof this.floodCallback)return this.floodCallback()}else if("function"==typeof this.doneTrainingCallback)return this.doneTrainingCallback({error:e,iterations:this.i})}}]),e}();e.default=a},function(t,e,n){t.exports=i;var r=n(67).EventEmitter;function i(){r.call(this)}n(53)(i,r),i.Readable=n(163),i.Writable=n(640),i.Duplex=n(641),i.Transform=n(642),i.PassThrough=n(643),(i.Stream=i).prototype.pipe=function(t,e){var n=this;function i(e){t.writable&&!1===t.write(e)&&n.pause&&n.pause()}function o(){n.readable&&n.resume&&n.resume()}n.on("data",i),t.on("drain",o),t._isStdio||e&&!1===e.end||(n.on("end",s),n.on("close",u));var a=!1;function s(){a||(a=!0,t.end())}function u(){a||(a=!0,"function"==typeof t.destroy&&t.destroy())}function c(t){if(l(),0===r.listenerCount(this,"error"))throw t}function l(){n.removeListener("data",i),t.removeListener("drain",o),n.removeListener("end",s),n.removeListener("close",u),n.removeListener("error",c),t.removeListener("error",c),n.removeListener("end",l),n.removeListener("close",l),t.removeListener("close",l)}return n.on("error",c),t.on("error",c),n.on("end",l),n.on("close",l),t.on("close",l),t.emit("pipe",n),t}},function(t,e,n){"use strict";e.byteLength=function(t){var e=c(t),n=e[0],r=e[1];return 3*(n+r)/4-r},e.toByteArray=function(t){for(var e,n=c(t),r=n[0],a=n[1],s=new o(3*(r+(h=a))/4-h),u=0,l=0<a?r-4:r,f=0;f<l;f+=4)e=i[t.charCodeAt(f)]<<18|i[t.charCodeAt(f+1)]<<12|i[t.charCodeAt(f+2)]<<6|i[t.charCodeAt(f+3)],s[u++]=e>>16&255,s[u++]=e>>8&255,s[u++]=255&e;var h;return 2===a&&(e=i[t.charCodeAt(f)]<<2|i[t.charCodeAt(f+1)]>>4,s[u++]=255&e),1===a&&(e=i[t.charCodeAt(f)]<<10|i[t.charCodeAt(f+1)]<<4|i[t.charCodeAt(f+2)]>>2,s[u++]=e>>8&255,s[u++]=255&e),s},e.fromByteArray=function(t){for(var e,n=t.length,i=n%3,o=[],a=0,s=n-i;a<s;a+=16383)o.push(l(t,a,s<a+16383?s:a+16383));return 1===i?(e=t[n-1],o.push(r[e>>2]+r[e<<4&63]+"==")):2===i&&(e=(t[n-2]<<8)+t[n-1],o.push(r[e>>10]+r[e>>4&63]+r[e<<2&63]+"=")),o.join("")};for(var r=[],i=[],o="undefined"!=typeof Uint8Array?Uint8Array:Array,a="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/",s=0,u=a.length;s<u;++s)r[s]=a[s],i[a.charCodeAt(s)]=s;function c(t){var e=t.length;if(0<e%4)throw new Error("Invalid string. Length must be a multiple of 4");var n=t.indexOf("=");return-1===n&&(n=e),[n,n===e?0:4-n%4]}function l(t,e,n){for(var i,o,a=[],s=e;s<n;s+=3)i=(t[s]<<16&16711680)+(t[s+1]<<8&65280)+(255&t[s+2]),a.push(r[(o=i)>>18&63]+r[o>>12&63]+r[o>>6&63]+r[63&o]);return a.join("")}i["-".charCodeAt(0)]=62,i["_".charCodeAt(0)]=63},function(t,e){e.read=function(t,e,n,r,i){var o,a,s=8*i-r-1,u=(1<<s)-1,c=u>>1,l=-7,f=n?i-1:0,h=n?-1:1,p=t[e+f];for(f+=h,o=p&(1<<-l)-1,p>>=-l,l+=s;0<l;o=256*o+t[e+f],f+=h,l-=8);for(a=o&(1<<-l)-1,o>>=-l,l+=r;0<l;a=256*a+t[e+f],f+=h,l-=8);if(0===o)o=1-c;else{if(o===u)return a?NaN:1/0*(p?-1:1);a+=Math.pow(2,r),o-=c}return(p?-1:1)*a*Math.pow(2,o-r)},e.write=function(t,e,n,r,i,o){var a,s,u,c=8*o-i-1,l=(1<<c)-1,f=l>>1,h=23===i?Math.pow(2,-24)-Math.pow(2,-77):0,p=r?0:o-1,d=r?1:-1,y=e<0||0===e&&1/e<0?1:0;for(e=Math.abs(e),isNaN(e)||e===1/0?(s=isNaN(e)?1:0,a=l):(a=Math.floor(Math.log(e)/Math.LN2),e*(u=Math.pow(2,-a))<1&&(a--,u*=2),2<=(e+=1<=a+f?h/u:h*Math.pow(2,1-f))*u&&(a++,u/=2),l<=a+f?(s=0,a=l):1<=a+f?(s=(e*u-1)*Math.pow(2,i),a+=f):(s=e*Math.pow(2,f-1)*Math.pow(2,i),a=0));8<=i;t[n+p]=255&s,p+=d,s/=256,i-=8);for(a=a<<i|s,c+=i;0<c;t[n+p]=255&a,p+=d,a/=256,c-=8);t[n+p-d]|=128*y}},function(t,e){},function(t,e,n){"use strict";var r=n(104).Buffer,i=n(635);t.exports=function(){function t(){!function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,t),this.head=null,this.tail=null,this.length=0}return t.prototype.push=function(t){var e={data:t,next:null};0<this.length?this.tail.next=e:this.head=e,this.tail=e,++this.length},t.prototype.unshift=function(t){var e={data:t,next:this.head};0===this.length&&(this.tail=e),this.head=e,++this.length},t.prototype.shift=function(){if(0!==this.length){var t=this.head.data;return 1===this.length?this.head=this.tail=null:this.head=this.head.next,--this.length,t}},t.prototype.clear=function(){this.head=this.tail=null,this.length=0},t.prototype.join=function(t){if(0===this.length)return"";for(var e=this.head,n=""+e.data;e=e.next;)n+=t+e.data;return n},t.prototype.concat=function(t){if(0===this.length)return r.alloc(0);if(1===this.length)return this.head.data;for(var e,n,i=r.allocUnsafe(t>>>0),o=this.head,a=0;o;)e=i,n=a,o.data.copy(e,n),a+=o.data.length,o=o.next;return i},t}(),i&&i.inspect&&i.inspect.custom&&(t.exports.prototype[i.inspect.custom]=function(){var t=i.inspect({length:this.length});return this.constructor.name+" "+t})},function(t,e){},function(t,e,n){(function(t){var r=void 0!==t&&t||"undefined"!=typeof self&&self||window,i=Function.prototype.apply;function o(t,e){this._id=t,this._clearFn=e}e.setTimeout=function(){return new o(i.call(setTimeout,r,arguments),clearTimeout)},e.setInterval=function(){return new o(i.call(setInterval,r,arguments),clearInterval)},e.clearTimeout=e.clearInterval=function(t){t&&t.close()},o.prototype.unref=o.prototype.ref=function(){},o.prototype.close=function(){this._clearFn.call(r,this._id)},e.enroll=function(t,e){clearTimeout(t._idleTimeoutId),t._idleTimeout=e},e.unenroll=function(t){clearTimeout(t._idleTimeoutId),t._idleTimeout=-1},e._unrefActive=e.active=function(t){clearTimeout(t._idleTimeoutId);var e=t._idleTimeout;0<=e&&(t._idleTimeoutId=setTimeout(function(){t._onTimeout&&t._onTimeout()},e))},n(637),e.setImmediate="undefined"!=typeof self&&self.setImmediate||void 0!==t&&t.setImmediate||this&&this.setImmediate,e.clearImmediate="undefined"!=typeof self&&self.clearImmediate||void 0!==t&&t.clearImmediate||this&&this.clearImmediate}).call(this,n(15))},function(t,e,n){(function(t,e){!function(t,n){"use strict";if(!t.setImmediate){var r,i,o,a,s,u=1,c={},l=!1,f=t.document,h=Object.getPrototypeOf&&Object.getPrototypeOf(t);h=h&&h.setTimeout?h:t,r="[object process]"==={}.toString.call(t.process)?function(t){e.nextTick(function(){d(t)})}:function(){if(t.postMessage&&!t.importScripts){var e=!0,n=t.onmessage;return t.onmessage=function(){e=!1},t.postMessage("","*"),t.onmessage=n,e}}()?(a="setImmediate$"+Math.random()+"$",s=function(e){e.source===t&&"string"==typeof e.data&&0===e.data.indexOf(a)&&d(+e.data.slice(a.length))},t.addEventListener?t.addEventListener("message",s,!1):t.attachEvent("onmessage",s),function(e){t.postMessage(a+e,"*")}):t.MessageChannel?((o=new MessageChannel).port1.onmessage=function(t){d(t.data)},function(t){o.port2.postMessage(t)}):f&&"onreadystatechange"in f.createElement("script")?(i=f.documentElement,function(t){var e=f.createElement("script");e.onreadystatechange=function(){d(t),e.onreadystatechange=null,i.removeChild(e),e=null},i.appendChild(e)}):function(t){setTimeout(d,0,t)},h.setImmediate=function(t){"function"!=typeof t&&(t=new Function(""+t));for(var e=new Array(arguments.length-1),n=0;n<e.length;n++)e[n]=arguments[n+1];var i={callback:t,args:e};return c[u]=i,r(u),u++},h.clearImmediate=p}function p(t){delete c[t]}function d(t){if(l)setTimeout(d,0,t);else{var e=c[t];if(e){l=!0;try{!function(t){var e=t.callback,r=t.args;switch(r.length){case 0:e();break;case 1:e(r[0]);break;case 2:e(r[0],r[1]);break;case 3:e(r[0],r[1],r[2]);break;default:e.apply(n,r)}}(e)}finally{p(t),l=!1}}}}}("undefined"==typeof self?void 0===t?this:t:self)}).call(this,n(15),n(50))},function(t,e,n){(function(e){function n(t){try{if(!e.localStorage)return!1}catch(t){return!1}var n=e.localStorage[t];return null!=n&&"true"===String(n).toLowerCase()}t.exports=function(t,e){if(n("noDeprecation"))return t;var r=!1;return function(){if(!r){if(n("throwDeprecation"))throw new Error(e);n("traceDeprecation")?console.trace(e):console.warn(e),r=!0}return t.apply(this,arguments)}}}).call(this,n(15))},function(t,e,n){"use strict";t.exports=o;var r=n(264),i=n(74);function o(t){if(!(this instanceof o))return new o(t);r.call(this,t)}i.inherits=n(53),i.inherits(o,r),o.prototype._transform=function(t,e,n){n(null,t)}},function(t,e,n){t.exports=n(164)},function(t,e,n){t.exports=n(54)},function(t,e,n){t.exports=n(163).Transform},function(t,e,n){t.exports=n(163).PassThrough},function(t,e,n){"use strict";function r(t){return(r="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t})(t)}Object.defineProperty(e,"__esModule",{value:!0});var i=a(n(31)),o=a(n(266));function a(t){return t&&t.__esModule?t:{default:t}}var s=function(t){function e(t,n){!function(t,n){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this);var i=function(t,e){if(!t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!e||"object"!==r(e)&&"function"!=typeof e?t:e}(this,(e.__proto__||Object.getPrototypeOf(e)).call(this,t,n));return i.rows=t,i.columns=n,i.weights=(0,o.default)(t*n),i.deltas=(0,o.default)(t*n),i}return function(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function, not "+r(e));t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,enumerable:!1,writable:!0,configurable:!0}}),e&&(Object.setPrototypeOf?Object.setPrototypeOf(t,e):t.__proto__=e)}(e,i.default),e}();e.default=s},function(t,e,n){"use strict";Object.defineProperty(e,"__esModule",{value:!0}),e.default=function(t,e){t.rows=parseInt(e.rows),t.columns=parseInt(e.columns),t.weights=e.weights.slice(0),t.deltas=e.deltas.slice(0);for(var n=0;n<e.weights.length;n++)t.weights[n]=-e.weights[n],t.deltas[n]=0}},function(t,e,n){"use strict";Object.defineProperty(e,"__esModule",{value:!0}),e.default=function(t,e,n){for(var r=0;r<e.weights.length;r++)t.weights[r]=e.weights[r]+n.weights[r],t.deltas[r]=0}},function(t,e,n){"use strict";Object.defineProperty(e,"__esModule",{value:!0}),e.default=function(t,e,n){for(var r=0;r<t.deltas.length;r++)e.deltas[r]=t.deltas[r],n.deltas[r]=t.deltas[r]}},function(t,e,n){"use strict";Object.defineProperty(e,"__esModule",{value:!0}),e.default=function(t){for(var e=0;e<t.weights.length;e++)t.weights[e]=1,t.deltas[e]=0}},function(t,e,n){"use strict";Object.defineProperty(e,"__esModule",{value:!0}),e.default=function(t,e,n){for(var r=e.rows,i=e.columns,o=n.columns,a=0;a<r;a++)for(var s=i*a,u=o*a,c=0;c<o;c++){for(var l=0,f=0;f<i;f++){var h=s+f,p=o*f+c;l+=e.weights[h]*n.weights[p],e.deltas[h]=0,n.deltas[p]=0}t.weights[u+c]=l}}},function(t,e,n){"use strict";Object.defineProperty(e,"__esModule",{value:!0}),e.default=function(t,e,n){for(var r=e.rows,i=e.columns,o=n.columns,a=0;a<r;a++)for(var s=i*a,u=o*a,c=0;c<o;c++)for(var l=0;l<i;l++){var f=s+l,h=o*l+c,p=t.deltas[u+c];e.deltas[f]+=n.weights[h]*p,n.deltas[h]+=e.weights[f]*p}}},function(t,e,n){"use strict";Object.defineProperty(e,"__esModule",{value:!0}),e.default=function(t,e,n){for(var r=e.weights,i=0;i<r.length;i++)t.weights[i]=e.weights[i]*n.weights[i],t.deltas[i]=0}},function(t,e,n){"use strict";Object.defineProperty(e,"__esModule",{value:!0}),e.default=function(t,e,n){for(var r=0;r<e.weights.length;r++)e.deltas[r]=n.weights[r]*t.deltas[r],n.deltas[r]=e.weights[r]*t.deltas[r]}},function(t,e,n){"use strict";Object.defineProperty(e,"__esModule",{value:!0}),e.default=function(t,e){for(var n=0;n<e.weights.length;n++)t.weights[n]=Math.max(0,e.weights[n]),t.deltas[n]=0}},function(t,e,n){"use strict";Object.defineProperty(e,"__esModule",{value:!0}),e.default=function(t,e){for(var n=0;n<t.deltas.length;n++)e.deltas[n]=0<e.weights[n]?t.deltas[n]:0}},function(t,e,n){"use strict";Object.defineProperty(e,"__esModule",{value:!0}),e.default=function(t,e,n){for(var r=e.columns,i=r*n,o=0;o<r;o++)t.weights[o]=e.weights[i+o],t.deltas[o]=0}},function(t,e,n){"use strict";Object.defineProperty(e,"__esModule",{value:!0}),e.default=function(t,e,n){for(var r=e.columns,i=r*n,o=0;o<r;o++)e.deltas[i+o]=t.deltas[o]}},function(t,e,n){"use strict";Object.defineProperty(e,"__esModule",{value:!0}),e.default=function(t,e){for(var n=0;n<e.weights.length;n++)t.weights[n]=1/(1+Math.exp(-e.weights[n])),t.deltas[n]=0}},function(t,e,n){"use strict";Object.defineProperty(e,"__esModule",{value:!0}),e.default=function(t,e){for(var n=0;n<t.deltas.length;n++){var r=t.weights[n];e.deltas[n]=r*(1-r)*t.deltas[n]}}},function(t,e,n){"use strict";Object.defineProperty(e,"__esModule",{value:!0}),e.default=function(t,e){for(var n=0;n<e.weights.length;n++)t.weights[n]=Math.tanh(e.weights[n]),t.deltas[n]=0}},function(t,e,n){"use strict";Object.defineProperty(e,"__esModule",{value:!0}),e.default=function(t,e){for(var n=0;n<t.deltas.length;n++){var r=t.weights[n];e.deltas[n]=(1-r*r)*t.deltas[n]}}},function(t,e,n){"use strict";Object.defineProperty(e,"__esModule",{value:!0}),e.default=function(t,e){this.length=0,this.prop=e;for(var n=this.table={},r=0;r<t.length;r++)for(var i=t[r][e],o=0;o<i.length;o++)for(var a in i[o])n.hasOwnProperty(a)||(n[a]=this.length++)}},function(t,e,n){"use strict";function r(t){return(r="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t})(t)}Object.defineProperty(e,"__esModule",{value:!0});var i=function(){function t(t,e){for(var n=0;n<e.length;n++){var r=e[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(t,r.key,r)}}return function(e,n,r){return n&&t(e.prototype,n),r&&t(e,r),e}}(),o=(s(n(31)),s(n(271))),a=s(n(165));function s(t){return t&&t.__esModule?t:{default:t}}var u=function(t){function e(){return function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,e),function(t,e){if(!t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!e||"object"!==r(e)&&"function"!=typeof e?t:e}(this,(e.__proto__||Object.getPrototypeOf(e)).apply(this,arguments))}return function(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function, not "+r(e));t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,enumerable:!1,writable:!0,configurable:!0}}),e&&(Object.setPrototypeOf?Object.setPrototypeOf(t,e):t.__proto__=e)}(e,a.default),i(e,[{key:"getModel",value:function(t,e){return o.default.prototype.getModel.call(this,t,e)}},{key:"getEquation",value:function(t,e,n,r){return o.default.prototype.getEquation.call(this,t,e,n,r)}}]),e}();e.default=u},function(t,e,n){"use strict";function r(t){return(r="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t})(t)}Object.defineProperty(e,"__esModule",{value:!0});var i=function(){function t(t,e){for(var n=0;n<e.length;n++){var r=e[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(t,r.key,r)}}return function(e,n,r){return n&&t(e.prototype,n),r&&t(e,r),e}}(),o=(s(n(31)),s(n(272))),a=s(n(165));function s(t){return t&&t.__esModule?t:{default:t}}var u=function(t){function e(){return function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,e),function(t,e){if(!t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!e||"object"!==r(e)&&"function"!=typeof e?t:e}(this,(e.__proto__||Object.getPrototypeOf(e)).apply(this,arguments))}return function(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function, not "+r(e));t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,enumerable:!1,writable:!0,configurable:!0}}),e&&(Object.setPrototypeOf?Object.setPrototypeOf(t,e):t.__proto__=e)}(e,a.default),i(e,[{key:"getModel",value:function(t,e){return o.default.prototype.getModel(t,e)}},{key:"getEquation",value:function(t,e,n,r){return o.default.prototype.getEquation(t,e,n,r)}}]),e}();e.default=u},function(t,e,n){"use strict";function r(t){if(Array.isArray(t)){for(var e=0,n=Array(t.length);e<t.length;e++)n[e]=t[e];return n}return Array.from(t)}Object.defineProperty(e,"__esModule",{value:!0}),e.default=function(t,e){var n="number"==typeof t.inputSize&&"number"==typeof t.outputSize&&0<t.inputSize&&0<t.outputSize&&[t.inputSize].concat(r(t.hiddenLayers),[t.outputSize]);if((e=Object.assign({line:{width:"0.5",color:"black"},inputs:{color:"rgba(0, 128, 0, 0.5)",label:!1},outputs:{color:"rgba(100, 149, 237, 0.5)"},hidden:{color:"rgba(255, 127, 80, 0.5)"},fontSize:"14px",radius:"8",width:"400",height:"250"},e)).inputs.label=e.inputs.label.length==t.inputSize&&e.inputs.label,n){var i='<svg  xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink" version="1.1" width="'+e.width+'" height="'+e.height+'">',o=e.width/n.length;return n.forEach(function(t,a){var s=e.height/t;[].concat(r(Array(t))).forEach(function(t,r){if(0==a)i+='<rect x="'+(o/2-e.radius)+'" y="'+(s/2+r*s-e.radius)+'" width="'+2*e.radius+'" height="'+2*e.radius+'" stroke="black" stroke-width="1" fill="'+e.inputs.color+'" />',i+='<line x1="'+o/4+'" y1="'+(s/2+r*s)+'" x2="'+(o/2-e.radius)+'" y2="'+(s/2+r*s)+'" style="stroke:'+e.line.color+";stroke-width:"+e.line.width+'" />',e.inputs.label&&(i+='<text x="'+o/8+'" y="'+(s/2+r*s-5)+'" fill="black" font-size= "'+e.fontSize+'">'+e.inputs.label[r]+"</text>");else{var u=e.height/n[a-1];a==n.length-1?(i+='<circle cx="'+(o/2+a*o)+'" cy="'+(s/2+r*s)+'" r="'+e.radius+'" stroke="black" stroke-width="1" fill="'+e.outputs.color+'" />',i+='<line x1="'+(o/2+a*o+e.radius)+'" y1="'+(s/2+r*s)+'" x2="'+(o/2+a*o+o/4)+'" y2="'+(s/2+r*s)+'" style="stroke:'+e.line.color+";stroke-width:"+e.line.width+'" />'):i+='<circle cx="'+(o/2+a*o)+'" cy="'+(s/2+r*s)+'" r="'+e.radius+'" stroke="black" stroke-width="1" fill="'+e.hidden.color+'" />';for(var c=0;c<n[a-1];c++)i+='<line x1="'+(o/2+(a-1)*o+e.radius)+'" y1="'+(u/2+c*u)+'" x2="'+(o/2+a*o-e.radius)+'" y2="'+(s/2+r*s)+'" style="stroke:'+e.line.color+";stroke-width:"+e.line.width+'" />'}})}),i+="</svg>"}return!1}},function(t,e,n){(function(t,n){function r(t){return(r="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t})(t)}var i="Expected a function",o="__lodash_hash_undefined__",a=1,s=2,u=1/0,c=9007199254740991,l="[object Arguments]",f="[object Array]",h="[object Boolean]",p="[object Date]",d="[object Error]",y="[object Function]",v="[object GeneratorFunction]",g="[object Map]",m="[object Number]",b="[object Object]",x="[object Promise]",_="[object RegExp]",w="[object Set]",S="[object String]",E="[object Symbol]",T="[object WeakMap]",k="[object ArrayBuffer]",O="[object DataView]",A=/\.|\[(?:[^[\]]*|(["'])(?:(?!\1)[^\\]|\\.)*?\1)\]/,j=/^\w*$/,P=/^\./,R=/[^.[\]]+|\[(?:(-?\d+(?:\.\d+)?)|(["'])((?:(?!\2)[^\\]|\\.)*?)\2)\]|(?=(?:\.|\[\])(?:\.|\[\]|$))/g,C=/\\(\\)?/g,I=/^\[object .+?Constructor\]$/,L=/^(?:0|[1-9]\d*)$/,N={};N["[object Float32Array]"]=N["[object Float64Array]"]=N["[object Int8Array]"]=N["[object Int16Array]"]=N["[object Int32Array]"]=N["[object Uint8Array]"]=N["[object Uint8ClampedArray]"]=N["[object Uint16Array]"]=N["[object Uint32Array]"]=!0,N[l]=N[f]=N[k]=N[h]=N[O]=N[p]=N[d]=N[y]=N[g]=N[m]=N[b]=N[_]=N[w]=N[S]=N[T]=!1;var F="object"==(void 0===t?"undefined":r(t))&&t&&t.Object===Object&&t,M="object"==("undefined"==typeof self?"undefined":r(self))&&self&&self.Object===Object&&self,D=F||M||Function("return this")(),U="object"==r(e)&&e&&!e.nodeType&&e,G=U&&"object"==r(n)&&n&&!n.nodeType&&n,z=G&&G.exports===U&&F.process,B=function(){try{return z&&z.binding("util")}catch(t){}}(),V=B&&B.isTypedArray;function W(t,e){for(var n=-1,r=t?t.length:0;++n<r;)if(e(t[n],n,t))return!0;return!1}function X(t){var e=!1;if(null!=t&&"function"!=typeof t.toString)try{e=!!(t+"")}catch(t){}return e}function K(t){var e=-1,n=Array(t.size);return t.forEach(function(t,r){n[++e]=[r,t]}),n}function q(t){var e=-1,n=Array(t.size);return t.forEach(function(t){n[++e]=t}),n}var H,$,Y,J=Array.prototype,Q=Function.prototype,Z=Object.prototype,tt=D["__core-js_shared__"],et=(H=/[^.]+$/.exec(tt&&tt.keys&&tt.keys.IE_PROTO||""))?"Symbol(src)_1."+H:"",nt=Q.toString,rt=Z.hasOwnProperty,it=Z.toString,ot=RegExp("^"+nt.call(rt).replace(/[\\^$.*+?()[\]{}|]/g,"\\$&").replace(/hasOwnProperty|(function).*?(?=\\\()| for .+?(?=\\\])/g,"$1.*?")+"$"),at=D.Symbol,st=D.Uint8Array,ut=Z.propertyIsEnumerable,ct=J.splice,lt=($=Object.keys,Y=Object,function(t){return $(Y(t))}),ft=Dt(D,"DataView"),ht=Dt(D,"Map"),pt=Dt(D,"Promise"),dt=Dt(D,"Set"),yt=Dt(D,"WeakMap"),vt=Dt(Object,"create"),gt=Kt(ft),mt=Kt(ht),bt=Kt(pt),xt=Kt(dt),_t=Kt(yt),wt=at?at.prototype:void 0,St=wt?wt.valueOf:void 0,Et=wt?wt.toString:void 0;function Tt(t){var e=-1,n=t?t.length:0;for(this.clear();++e<n;){var r=t[e];this.set(r[0],r[1])}}function kt(t){var e=-1,n=t?t.length:0;for(this.clear();++e<n;){var r=t[e];this.set(r[0],r[1])}}function Ot(t){var e=-1,n=t?t.length:0;for(this.clear();++e<n;){var r=t[e];this.set(r[0],r[1])}}function At(t){var e=-1,n=t?t.length:0;for(this.__data__=new Ot;++e<n;)this.add(t[e])}function jt(t){this.__data__=new kt(t)}function Pt(t,e){for(var n=t.length;n--;)if(Ht(t[n][0],e))return n;return-1}function Rt(t,e){for(var n=0,r=(e=zt(e,t)?[e]:Nt(e)).length;null!=t&&n<r;)t=t[Xt(e[n++])];return n&&n==r?t:void 0}function Ct(t,e){return e<t}function It(t,e){return null!=t&&e in Object(t)}function Lt(t,e,n,r,i){return t===e||(null==t||null==e||!te(t)&&!ee(e)?t!=t&&e!=e:function(t,e,n,r,i,o){var u=Yt(t),c=Yt(e),y=f,v=f;u||(y=(y=Ut(t))==l?b:y),c||(v=(v=Ut(e))==l?b:v);var x=y==b&&!X(t),T=v==b&&!X(e),A=y==v;if(A&&!x)return o||(o=new jt),u||ie(t)?Ft(t,e,n,r,i,o):function(t,e,n,r,i,o,u){switch(n){case O:if(t.byteLength!=e.byteLength||t.byteOffset!=e.byteOffset)return!1;t=t.buffer,e=e.buffer;case k:return!(t.byteLength!=e.byteLength||!r(new st(t),new st(e)));case h:case p:case m:return Ht(+t,+e);case d:return t.name==e.name&&t.message==e.message;case _:case S:return t==e+"";case g:var c=K;case w:var l=o&s;if(c||(c=q),t.size!=e.size&&!l)return!1;var f=u.get(t);if(f)return f==e;o|=a,u.set(t,e);var y=Ft(c(t),c(e),r,i,o,u);return u.delete(t),y;case E:if(St)return St.call(t)==St.call(e)}return!1}(t,e,y,n,r,i,o);if(!(i&s)){var j=x&&rt.call(t,"__wrapped__"),P=T&&rt.call(e,"__wrapped__");if(j||P){var R=j?t.value():t,C=P?e.value():e;return o||(o=new jt),n(R,C,r,i,o)}}return!!A&&(o||(o=new jt),function(t,e,n,r,i,o){var a=i&s,u=oe(t),c=u.length;if(c!=oe(e).length&&!a)return!1;for(var l=c;l--;){var f=u[l];if(!(a?f in e:rt.call(e,f)))return!1}var h=o.get(t);if(h&&o.get(e))return h==e;var p=!0;o.set(t,e),o.set(e,t);for(var d=a;++l<c;){var y=t[f=u[l]],v=e[f];if(r)var g=a?r(v,y,f,e,t,o):r(y,v,f,t,e,o);if(!(void 0===g?y===v||n(y,v,r,i,o):g)){p=!1;break}d||(d="constructor"==f)}if(p&&!d){var m=t.constructor,b=e.constructor;m!=b&&"constructor"in t&&"constructor"in e&&!("function"==typeof m&&m instanceof m&&"function"==typeof b&&b instanceof b)&&(p=!1)}return o.delete(t),o.delete(e),p}(t,e,n,r,i,o))}(t,e,Lt,n,r,i))}function Nt(t){return Yt(t)?t:Wt(t)}function Ft(t,e,n,r,i,o){var u=i&s,c=t.length,l=e.length;if(c!=l&&!(u&&c<l))return!1;var f=o.get(t);if(f&&o.get(e))return f==e;var h=-1,p=!0,d=i&a?new At:void 0;for(o.set(t,e),o.set(e,t);++h<c;){var y=t[h],v=e[h];if(r)var g=u?r(v,y,h,e,t,o):r(y,v,h,t,e,o);if(void 0!==g){if(g)continue;p=!1;break}if(d){if(!W(e,function(t,e){if(!d.has(e)&&(y===t||n(y,t,r,i,o)))return d.add(e)})){p=!1;break}}else if(y!==v&&!n(y,v,r,i,o)){p=!1;break}}return o.delete(t),o.delete(e),p}function Mt(t,e){var n,i,o=t.__data__;return("string"==(i=r(n=e))||"number"==i||"symbol"==i||"boolean"==i?"__proto__"!==n:null===n)?o["string"==typeof e?"string":"hash"]:o.map}function Dt(t,e){var n,r=null==(n=t)?void 0:n[e];return function(t){return!(!te(t)||(e=t,et&&et in e))&&(Qt(t)||X(t)?ot:I).test(Kt(t));var e}(r)?r:void 0}Tt.prototype.clear=function(){this.__data__=vt?vt(null):{}},Tt.prototype.delete=function(t){return this.has(t)&&delete this.__data__[t]},Tt.prototype.get=function(t){var e=this.__data__;if(vt){var n=e[t];return n===o?void 0:n}return rt.call(e,t)?e[t]:void 0},Tt.prototype.has=function(t){var e=this.__data__;return vt?void 0!==e[t]:rt.call(e,t)},Tt.prototype.set=function(t,e){return this.__data__[t]=vt&&void 0===e?o:e,this},kt.prototype.clear=function(){this.__data__=[]},kt.prototype.delete=function(t){var e=this.__data__,n=Pt(e,t);return!(n<0||(n==e.length-1?e.pop():ct.call(e,n,1),0))},kt.prototype.get=function(t){var e=this.__data__,n=Pt(e,t);return n<0?void 0:e[n][1]},kt.prototype.has=function(t){return-1<Pt(this.__data__,t)},kt.prototype.set=function(t,e){var n=this.__data__,r=Pt(n,t);return r<0?n.push([t,e]):n[r][1]=e,this},Ot.prototype.clear=function(){this.__data__={hash:new Tt,map:new(ht||kt),string:new Tt}},Ot.prototype.delete=function(t){return Mt(this,t).delete(t)},Ot.prototype.get=function(t){return Mt(this,t).get(t)},Ot.prototype.has=function(t){return Mt(this,t).has(t)},Ot.prototype.set=function(t,e){return Mt(this,t).set(t,e),this},At.prototype.add=At.prototype.push=function(t){return this.__data__.set(t,o),this},At.prototype.has=function(t){return this.__data__.has(t)},jt.prototype.clear=function(){this.__data__=new kt},jt.prototype.delete=function(t){return this.__data__.delete(t)},jt.prototype.get=function(t){return this.__data__.get(t)},jt.prototype.has=function(t){return this.__data__.has(t)},jt.prototype.set=function(t,e){var n=this.__data__;if(n instanceof kt){var r=n.__data__;if(!ht||r.length<199)return r.push([t,e]),this;n=this.__data__=new Ot(r)}return n.set(t,e),this};var Ut=function(t){return it.call(t)};function Gt(t,e){return!!(e=null==e?c:e)&&("number"==typeof t||L.test(t))&&-1<t&&t%1==0&&t<e}function zt(t,e){if(Yt(t))return!1;var n=r(t);return!("number"!=n&&"symbol"!=n&&"boolean"!=n&&null!=t&&!ne(t))||j.test(t)||!A.test(t)||null!=e&&t in Object(e)}function Bt(t){return t==t&&!te(t)}function Vt(t,e){return function(n){return null!=n&&n[t]===e&&(void 0!==e||t in Object(n))}}(ft&&Ut(new ft(new ArrayBuffer(1)))!=O||ht&&Ut(new ht)!=g||pt&&Ut(pt.resolve())!=x||dt&&Ut(new dt)!=w||yt&&Ut(new yt)!=T)&&(Ut=function(t){var e=it.call(t),n=e==b?t.constructor:void 0,r=n?Kt(n):void 0;if(r)switch(r){case gt:return O;case mt:return g;case bt:return x;case xt:return w;case _t:return T}return e});var Wt=qt(function(t){var e;t=null==(e=t)?"":function(t){if("string"==typeof t)return t;if(ne(t))return Et?Et.call(t):"";var e=t+"";return"0"==e&&1/t==-u?"-0":e}(e);var n=[];return P.test(t)&&n.push(""),t.replace(R,function(t,e,r,i){n.push(r?i.replace(C,"$1"):e||t)}),n});function Xt(t){if("string"==typeof t||ne(t))return t;var e=t+"";return"0"==e&&1/t==-u?"-0":e}function Kt(t){if(null!=t){try{return nt.call(t)}catch(t){}try{return t+""}catch(t){}}return""}function qt(t,e){if("function"!=typeof t||e&&"function"!=typeof e)throw new TypeError(i);var n=function n(){var r=arguments,i=e?e.apply(this,r):r[0],o=n.cache;if(o.has(i))return o.get(i);var a=t.apply(this,r);return n.cache=o.set(i,a),a};return n.cache=new(qt.Cache||Ot),n}function Ht(t,e){return t===e||t!=t&&e!=e}function $t(t){return ee(e=t)&&Jt(e)&&rt.call(t,"callee")&&(!ut.call(t,"callee")||it.call(t)==l);var e}qt.Cache=Ot;var Yt=Array.isArray;function Jt(t){return null!=t&&Zt(t.length)&&!Qt(t)}function Qt(t){var e=te(t)?it.call(t):"";return e==y||e==v}function Zt(t){return"number"==typeof t&&-1<t&&t%1==0&&t<=c}function te(t){var e=r(t);return!!t&&("object"==e||"function"==e)}function ee(t){return!!t&&"object"==r(t)}function ne(t){return"symbol"==r(t)||ee(t)&&it.call(t)==E}var re,ie=V?(re=V,function(t){return re(t)}):function(t){return ee(t)&&Zt(t.length)&&!!N[it.call(t)]};function oe(t){return Jt(t)?function(t,e){var n=Yt(t)||$t(t)?function(t,e){for(var n=-1,r=Array(t);++n<t;)r[n]=e(n);return r}(t.length,String):[],r=n.length,i=!!r;for(var o in t)!e&&!rt.call(t,o)||i&&("length"==o||Gt(o,r))||n.push(o);return n}(t):function(t){if(n=(e=t)&&e.constructor,e!==("function"==typeof n&&n.prototype||Z))return lt(t);var e,n,r=[];for(var i in Object(t))rt.call(t,i)&&"constructor"!=i&&r.push(i);return r}(t)}function ae(t){return t}n.exports=function(t,e){return t&&t.length?function(t,e,n){for(var r=-1,i=t.length;++r<i;){var o=t[r],a=e(o);if(null!=a&&(void 0===s?a==a&&!ne(a):n(a,s)))var s=a,u=o}return u}(t,function(t){return"function"==typeof t?t:null==t?ae:"object"==r(t)?Yt(t)?(e=t[0],n=t[1],zt(e)&&Bt(n)?Vt(Xt(e),n):function(t){var r,i,o,u=void 0===(i=null==(r=t)?void 0:Rt(r,e))?void 0:i;return void 0===u&&u===n?null!=(o=t)&&function(t,e,n){for(var r,i=-1,o=(e=zt(e,t)?[e]:Nt(e)).length;++i<o;){var a=Xt(e[i]);if(!(r=null!=t&&n(t,a)))break;t=t[a]}return r||!!(o=t?t.length:0)&&Zt(o)&&Gt(a,o)&&(Yt(t)||$t(t))}(o,e,It):Lt(n,u,void 0,a|s)}):function(t){var e=function(t){for(var e=oe(t),n=e.length;n--;){var r=e[n],i=t[r];e[n]=[r,i,Bt(i)]}return e}(t);return 1==e.length&&e[0][2]?Vt(e[0][0],e[0][1]):function(n){return n===t||function(t,e,n,r){var i=n.length,o=i;if(null==t)return!o;for(t=Object(t);i--;){var u=n[i];if(u[2]?u[1]!==t[u[0]]:!(u[0]in t))return!1}for(;++i<o;){var c=(u=n[i])[0],l=t[c],f=u[1];if(u[2]){if(void 0===l&&!(c in t))return!1}else{var h,p=new jt;if(!(void 0===h?Lt(f,l,r,a|s,p):h))return!1}}return!0}(n,0,e)}}(t):zt(i=t)?(u=Xt(i),function(t){return null==t?void 0:t[u]}):(o=i,function(t){return Rt(t,o)});var e,n,i,o,u}(e),Ct):void 0}}).call(this,n(15),n(60)(t))},function(t,e,n){var r=n(38),i=n(667),o=n(668),a=Math.max,s=Math.min;t.exports=function(t,e,n){var u,c,l,f,h,p,d=0,y=!1,v=!1,g=!0;if("function"!=typeof t)throw new TypeError("Expected a function");function m(e){var n=u,r=c;return u=c=void 0,d=e,f=t.apply(r,n)}function b(t){var n=t-p;return void 0===p||e<=n||n<0||v&&l<=t-d}function x(){var t,n,r=i();if(b(r))return _(r);h=setTimeout(x,(n=e-((t=r)-p),v?s(n,l-(t-d)):n))}function _(t){return h=void 0,g&&u?m(t):(u=c=void 0,f)}function w(){var t,n=i(),r=b(n);if(u=arguments,c=this,p=n,r){if(void 0===h)return d=t=p,h=setTimeout(x,e),y?m(t):f;if(v)return h=setTimeout(x,e),m(p)}return void 0===h&&(h=setTimeout(x,e)),f}return e=o(e)||0,r(n)&&(y=!!n.leading,l=(v="maxWait"in n)?a(o(n.maxWait)||0,e):l,g="trailing"in n?!!n.trailing:g),w.cancel=function(){void 0!==h&&clearTimeout(h),u=p=c=h=void(d=0)},w.flush=function(){return void 0===h?f:_(i())},w}},function(t,e,n){var r=n(25);t.exports=function(){return r.Date.now()}},function(t,e,n){var r=n(38),i=n(70),o=/^\s+|\s+$/g,a=/^[-+]0x[0-9a-f]+$/i,s=/^0b[01]+$/i,u=/^0o[0-7]+$/i,c=parseInt;t.exports=function(t){if("number"==typeof t)return t;if(i(t))return NaN;if(r(t)){var e="function"==typeof t.valueOf?t.valueOf():t;t=r(e)?e+"":e}if("string"!=typeof t)return 0===t?t:+t;t=t.replace(o,"");var n=s.test(t);return n||u.test(t)?c(t.slice(2),n?2:8):a.test(t)?NaN:+t}},function(t,e,n){var r=n(34)("mysam-core/hooks/lowercase");t.exports=function(){for(var t=arguments.length,e=new Array(t),n=0;n<t;n++)e[n]=arguments[n];return function(t){r("Lowercasing",e);for(var n=0;n<e.length;n++){var i=e[n];t.data[i]=t.data[i].toLowerCase()}return t}}},function(t,e,n){var r=n(34)("mysam-core/hooks/extract-action"),i=n(151).extractor;t.exports=function(){return function(t){var e=t.result,n=e.action,o=i(n.text).tag(n.tags||{}).extract(e.text),a=o.tags,s=o.extracted,u=Object.assign({},n,{tags:a,text:e.text});return r("Extracted action",u),t.result=Object.assign({},e,{action:u,extracted:s,reference:n}),t}}},function(t,e,n){var r=n(34)("mysam-core/hooks/add-tokenization");t.exports=function(){return function(t){var e=t.result.text||t.result.action.text;return t.app.service("tokenize").create({text:e}).then(function(e){return r("Adding tokenization",e),t.result=Object.assign({},e,t.result),t})}}},function(t,e,n){var r=n(673),i=n(674),o=n(273),a=n(91);t.exports=function(){this.service("trainings").hooks({before:{all:a(),create:i()},after:{all:o("action",{service:"actions"}),create:r()}})}},function(t,e,n){var r=n(209),i=n(34)("mysam-core/hooks/add-classification"),o=n(151).extractor;t.exports=function(){return function(t){var e=t.result,n=e.text,a=e.action,s=o(n).tag(a.tags||{}).extract(n).extracted,u={_id:r(n),confidence:1,reference:a,action:a,extracted:s};return t.app.service("tokenize").create({text:n}).then(function(t){return Object.assign(u,t)}).then(function(e){return i("Adding classification",e),t.result=Object.assign({classification:e},t.result),t})}}},function(t,e,n){function r(t){return(r="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t})(t)}var i=n(675);t.exports=function(){return function(t){var e=t.data;if("object"===r(e.action)){var n=t.app.service("actions");return n.find({query:i(e.action,"text"),paginate:!1}).then(function(t){if(1<t.length)throw new Error("Ambigious action");return 1===t.length?t[0]:n.create(Object.assign({},e.action,{text:e.text}))}).then(function(n){return e.action=n._id,t})}}}},function(t,e,n){var r=n(233),i=n(210),o=n(676),a=n(97),s=n(68),u=n(680),c=n(682),l=n(227),f=c(function(t,e){var n={};if(null==t)return n;var c=!1;e=r(e,function(e){return e=a(e,t),c||(c=1<e.length),e}),s(t,l(t),n),c&&(n=i(n,7,u));for(var f=e.length;f--;)o(n,e[f]);return n});t.exports=f},function(t,e,n){var r=n(97),i=n(677),o=n(678),a=n(71);t.exports=function(t,e){return e=r(e,t),null==(t=o(t,e))||delete t[a(i(e))]}},function(t,e){t.exports=function(t){var e=null==t?0:t.length;return e?t[e-1]:void 0}},function(t,e,n){var r=n(154),i=n(679);t.exports=function(t,e){return e.length<2?t:r(t,i(e,0,-1))}},function(t,e){t.exports=function(t,e,n){var r=-1,i=t.length;e<0&&(e=i<-e?0:i+e),(n=i<n?i:n)<0&&(n+=i),i=n<e?0:n-e>>>0,e>>>=0;for(var o=Array(i);++r<i;)o[r]=t[r+e];return o}},function(t,e,n){var r=n(681);t.exports=function(t){return r(t)?void 0:t}},function(t,e,n){var r=n(61),i=n(149),o=n(39),a=Function.prototype,s=Object.prototype,u=a.toString,c=s.hasOwnProperty,l=u.call(Object);t.exports=function(t){if(!o(t)||"[object Object]"!=r(t))return!1;var e=i(t);if(null===e)return!0;var n=c.call(e,"constructor")&&e.constructor;return"function"==typeof n&&n instanceof n&&u.call(n)==l}},function(t,e,n){var r=n(683),i=n(686),o=n(688);t.exports=function(t){return o(i(t,void 0,r),t+"")}},function(t,e,n){var r=n(684);t.exports=function(t){return null!=t&&t.length?r(t,1):[]}},function(t,e,n){var r=n(148),i=n(685);t.exports=function t(e,n,o,a,s){var u=-1,c=e.length;for(o||(o=i),s||(s=[]);++u<c;){var l=e[u];0<n&&o(l)?1<n?t(l,n-1,o,a,s):r(s,l):a||(s[s.length]=l)}return s}},function(t,e,n){var r=n(62),i=n(140),o=n(26),a=r?r.isConcatSpreadable:void 0;t.exports=function(t){return o(t)||i(t)||!!(a&&t&&t[a])}},function(t,e,n){var r=n(687),i=Math.max;t.exports=function(t,e,n){return e=i(void 0===e?t.length-1:e,0),function(){for(var o=arguments,a=-1,s=i(o.length-e,0),u=Array(s);++a<s;)u[a]=o[e+a];a=-1;for(var c=Array(e+1);++a<e;)c[a]=o[a];return c[e]=n(u),r(t,this,c)}}},function(t,e){t.exports=function(t,e,n){switch(n.length){case 0:return t.call(e);case 1:return t.call(e,n[0]);case 2:return t.call(e,n[0],n[1]);case 3:return t.call(e,n[0],n[1],n[2])}return t.apply(e,n)}},function(t,e,n){var r=n(689),i=n(691)(r);t.exports=i},function(t,e,n){var r=n(690),i=n(217),o=n(152),a=i?function(t,e){return i(t,"toString",{configurable:!0,enumerable:!1,value:r(e),writable:!0})}:o;t.exports=a},function(t,e){t.exports=function(t){return function(){return t}}},function(t,e){var n=Date.now;t.exports=function(t){var e=0,r=0;return function(){var i=n(),o=16-(i-r);if(r=i,0<o){if(800<=++e)return arguments[0]}else e=0;return t.apply(void 0,arguments)}}},function(t,e,n){var r=n(91);t.exports=function(){this.service("actions").hooks({before:r()})}}])});